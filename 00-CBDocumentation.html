<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="content-type" content="text/html;charset=utf-8" />
	<title>CB Documentation</title>
	<link rel="shortcut icon" type="image/x-icon" href="lib/img/index.png" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link type="text/css" rel="stylesheet" href="lib/css/bootstrap.min.css" />
	<link type="text/css" rel="stylesheet" href="lib/css/highlight.css" />
	<link type="text/css" rel="stylesheet" href="lib/css/bootstrap.odyseus.css" />
	<style type="text/css">
h5.panel-title > a {
	position: relative !important;
	display: block !important;
	font-size: 14px !important;
	font-weight: 600 !important;
	text-decoration: none !important;
	top: 0 !important;
	left: 0 !important;
	width: 100% !important;
	height: 100% !important;
	outline: none !important;
}
</style>
</head>

<body data-spy="scroll" data-target="#index-sidebar" data-offset="140">
<noscript><div class="alert alert-danger">
<strong>Oh snap! This page needs JavaScript enabled to display correctly.</strong>
</div></noscript>
<div id="mainarea" style="display:none;">
<span id="headmenu">
<!-- Inserted via jQuery -->
</span>
<a id="effing_index"></a>
<div class="container cb-docs-container">
<div id="cb_jumbotron" class="jumbotron">
	<div class="container">
		<h1>Unofficial Custom Buttons documentation</h1>
		<p>This documentation is based on the <a href="http://custombuttons.sourceforge.net/forum/viewtopic.php?t=291#p1449">recovered documentation</a> from the old Custom Buttons forum and also contains code snippets from the <a href="http://forum.mozilla-russia.org/viewtopic.php?id=55963">Mozilla Russian forum</a>.</p>
	</div>
</div>
<div class="row">
<div class="col-md-9" role="main">
<div class="panel panel-info">
	<div class="panel-heading">
		<h3 class="panel-title"><strong>About Custom Buttons add-on</strong></h3>
	</div>
	<div class="panel-body">
	<strong>
<p>Custom Buttons allows you to create custom toolbarbuttons that can perform almost any task within your application. The language used in this buttons is JavaScript.</p>
<p>People who have never used or seen this scripting language, <a class="internal_link" href="#nav_js_basics">at the end of this documentation</a> will find a basic guide to JavaScript.</p>
	</strong>
	</div>
</div>
<div class="panel panel-info">
	<div class="panel-heading">
		<h3 class="panel-title"><strong>About this documentation</strong></h3>
	</div>
	<div class="panel-body">
	<ul>
	<strong>
		<li>You can double click on code blocks to select all code.</li>
		<li>Code blocks highlighted in <span class="text-success">green</span> are from the official Custom Buttons documentation.</li>
		<li>Code blocks highlighted in <span class="text-danger">red</span> are modified/added by me (Odyseus).</li>
		<li>Code blocks highlighted in <span class="text-warning">orange</span> are extracted from the Russian forum.</li>
		<li>I've made very minor changes to the examples of the original documentation. Like replacing all instances of &quot;Components.classes&quot; for the variable &quot;Cc&quot;, etc.</li>
		<li>I have also added examples that were removed from the original documentation, like &quot;menu-button&quot; and &quot;menu&quot; buttons examples.</li>
	</strong>
	</ul>
	</div>
</div>
<!-- Start content main -->
<div class="cb-docs-section">
<h1 id="nav_getting_started" class="page-header">Getting started</h1>
<a id="cb_basics"></a>
<h3 id="nav_getting_started-1">Description of the user inteface</h3>
	<div class="img" style="text-align:center;">
		<img src="lib/img/CBDoc-UI.png" width="auto" height="auto" />
	</div>
</br>
<ol>
	<li><b>Button URL: </b>By entering a button URI into this field, a currently installed button can be updated with code from said URI. Or install a new button.</li>
	<li><b>Name: </b>Name of the button.</li>
	<li><b>Image: </b>Image for the button. An image can be:
		<ul>
			<li>An URL containing an online image, e.g., &quot;https://duckduckgo.com/favicon.ico&quot;.</li>
			<li>A &quot;chrome&quot; URL, e.g., &quot;chrome://branding/content/icon32.png&quot;.</li>
			<li>A &quot;file:///&quot; URI, e.g., &quot;file:///C:/Users/UserName/Desktop/Image.png&quot;, &quot;file:///home/UserName/Pictures/Image.png&quot;.</li>
			<li>A data URI, e.g., &quot;data:image/png;base64,...base64 code...&quot;.</li>
			<li>A &quot;moz-icon&quot;, e.g., &quot;moz-icon://.png?size=16&quot;.</li>
		</ul>
	</li>
	<li><b>Browse: </b>It allows you to browse for a local image.</li>
	<li><b>=&gt; base64: </b>It converts any image from any source to Base64 format. This facilitates sharing the button without worrying about the source of the image.</li>
	<li><b>Tabs</b>
<div class="panel-group" id="tabs-accordion">
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#tabs-accordion" href="#about_code_tab">Code</a></h5>
		</div>
		<div id="about_code_tab" class="panel-collapse collapse">
			<div class="panel-body">
<p>The code inside this tab is executed every time the button is clicked with left mouse button.</p>
			</div>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#tabs-accordion" href="#about_init_tab">Initialization code</a></h5>
		</div>
		<div id="about_init_tab" class="panel-collapse collapse">
			<div class="panel-body">
<p>The code inside this tab is executed every time the button is initialized.</p>
<p>A button is initialized when:</p>
<ul>
	<li>The application starts.</li>
	<li>The button is edited and saved, either by pressing the &quot;OK&quot; or the &quot;Save&quot; buttons.</li>
	<li>Leaving the applications customize mode. In applications using <a href="https://developer.mozilla.org/docs/Mozilla/JavaScript_code_modules/CustomizableUI.jsm">CustomizableUI.jsm</a> (Australis), the button also is initialized each time is moved from toolbar to toolbar while in customize mode.</li>
	<li>Can also be programmatically initialized with <code>this.init();</code> and/or <code>self.init();</code></li>
</ul>
			</div>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#tabs-accordion" href="#about_help_tab">Help</a></h5>
		</div>
		<div id="about_help_tab" class="panel-collapse collapse">
			<div class="panel-body">
<p>The content of this tab is diplayed when the menuitem "Button Help" from the Custom Buttons context menu is clicked. The Help tab of a Custom Buttons button can also be used in several usefull ways.</p>
<div class="panel-group" id="help-tab-accordion">
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#help-tab-accordion" href="#help-tab-accordion-1">
&quot;Button Help&quot; menu item selective display</a></h5>
		</div>
		<div id="help-tab-accordion-1" class="panel-collapse collapse">
			<div class="panel-body">
<p>By default, there is a "separator" [,] that can be used to "divide" the Help tab content.</p>
<h4>Example:</h4>
<div class="centered_image">
<img src="lib/img/CBDoc-About-Help01.png" />
</div><br>
<p>The &quot;Button Help&quot; menu item from the button shown in the image above will display...</p>
<div class="centered_image">
<img src="lib/img/CBDoc-About-Help02.png" />
</div><br>
<p>...and the rest of the content can be called as follow...</p>
<pre><code>/*Code*/
var usefulCode = this.Help.split("[,]")[1];

alert(usefulCode);</code></pre>
<p>or...</p>
<pre><code>/*Code*/
var usefulCode = self.getAttribute("Help").split("[,]")[1];

alert(usefulCode);</code></pre>
<p>...whose result will be...</p>
<div class="centered_image">
<img src="lib/img/CBDoc-About-Help03.png" />
</div><br>
			</div>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#help-tab-accordion" href="#help-tab-accordion-2">
Selective use of the Help tab - Example 1</a></h5>
		</div>
		<div id="help-tab-accordion-2" class="panel-collapse collapse">
			<div class="panel-body">
<p>Using the same "separator" [,] as in the previous example, the content of the Help tab can be "divided" into several parts in order to use these parts separately.</p>
<div class="centered_image">
<img src="lib/img/CBDoc-About-Help04.png" />
</div><br>
<p>The different parts can be called like this...</p>
<pre><code>var usefulCodePartOne = this.Help.split("[,]")[1];

var usefulCodePartTwo = this.Help.split("[,]")[2];

var usefulCodePartThree = this.Help.split("[,]")[3];</code></pre>
<p>...or like this...</p>
<pre><code>var usefulCodePartOne = self.getAttribute("Help").split("[,]")[1];

var usefulCodePartTwo = self.getAttribute("Help").split("[,]")[2];

var usefulCodePartThree = self.getAttribute("Help").split("[,]")[3];</code></pre>
			</div>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#help-tab-accordion" href="#help-tab-accordion-3">
Selective use of the Help tab - Example 2</a></h5>
		</div>
		<div id="help-tab-accordion-3" class="panel-collapse collapse">
			<div class="panel-body">
<p>This procedure is the one I like and use in my buttons. I like it because I do not have to remember nor pay attention to the index in which the code I want is, which would be necessary to recall in the example number one.</p>
<div class="tweaked_by_odyseus panel-body">
	<ul class="nav nav-tabs" style="margin-bottom: 15px;">
		<li class="active init-tab"><a href="#about_help_tab-init-tab" rel="nofollow" data-toggle="tab">Initialization Tab</a></li>
		<li class="help-tab"><a href="#about_help_tab-help-tab" rel="nofollow" data-toggle="tab">Help Tab</a></li>
	</ul>
	<div class="tab-content">
		<div class="tab-pane fade active in init-tab" id="about_help_tab-init-tab">
<pre><code>/*Initialization*/
var usefulCodeOne = getHelp(&quot;MarkerOne&quot;);

var usefulCodeTwo = getHelp(&quot;MarkerTwo&quot;);

var usefulCodeThree = getHelp(&quot;MarkerThree&quot;);

function getHelp(aMarker) { // Get specific data from the Help tab.
	return document.getElementById(self.id).getAttribute(&quot;Help&quot;).split(&quot;&lt;!--&quot; + aMarker + &quot;--&gt;&quot;)[1];
}</code></pre>
		</div>
		<div class="tab-pane fade help-tab" id="about_help_tab-help-tab">
<pre><code>IMPORTANT!!! Markers should ALWAYS exist in pairs and be unique.

&lt;!--MarkerThree--&gt;
Usefull code that can be called from JavaScript.
&lt;!--MarkerThree--&gt;

&lt;!--MarkerOne--&gt;
Usefull code that can be called from JavaScript.
&lt;!--MarkerOne--&gt;

&lt;!--MarkerTwo--&gt;
Usefull code that can be called from JavaScript.
&lt;!--MarkerTwo--&gt;</code></pre>
		</div>
	</div>
</div>
			</div>
		</div>
	</div>
</div>
			</div>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#tabs-accordion" href="#about_button_settings_tab">Button settings</a></h5>
		</div>
		<div id="about_button_settings_tab" class="panel-collapse collapse">
			<div class="panel-body">
<p>In this tab a hotkey can be configured to execute the button. To delete an already configured hotkey, focus/click the &quot;Hotkey&quot; textbox and press <kbd>Esc</kbd>.</p>
			</div>
		</div>
	</div>
</div>
</li>
	<li><b>Save: </b>By pressing &quot;Save&quot;, all changes made to the button are saved and the button is re-initialized.</li>
	<li><b>OK: </b>By pressing &quot;OK&quot;, the edit window is closed, all changes made to the button are saved and the button is re-initialized.</li>
	<li><b>Edit external...: </b>It allows to edit the content of the current selected tab in an external editor.
	<div class="panel panel-default">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" href="#about_external_editor">About &quot;Edit external...&quot;</a></h5>
		</div>
		<div id="about_external_editor" class="panel-collapse collapse">
			<div class="panel-body">
<h5><b>How to use this feature without losing your mind</b></h5>
<p>Every time you press the &quot;Edit external...&quot; button to edit a button, a temporary file is created inside your profile folder (inside a folder called <em>Temp_ExternalEditor</em>) and opened with the text editor of your choice. While you are editing this file, <em>DO NOT</em> re-focus the edit window of the button you are editing. Once you've made all changes you needed/wanted, <em>SAVE</em> the file and <em>THEN</em> re-focus the edit window of the button and save the button. The instant the edit window is focused, that temporary file <em>no longer exists/is deleted</em>.</p>
<h5><b>Notes</b></h5>
<ul>
	<li>To avoid headaches, use a text editor that deserves to be called as such. That is, <em>anything but the Windows Notepad</em>!</li>
	<li>To change the text editor, reset the preference called &quot;extensions.custombuttons.external_editor&quot;. When you press again the &quot;Edit external...&quot; button, you will be able to choose another editor.</li>
</ul>
			</div>
		</div>
	</div>
	</li>
	<li><b>Cancel: </b>By pressing &quot;Cancel&quot;, the edit window is closed, all changes to the button are discarded and the button is not re-initialized.</li>
</ol>

<h3 id="nav_getting_started-2">Your First Custom Button</h3>

<div>
<ul>
<li>Left click <b>View → Add new button… in the Menu Bar</b> - or right click a toolbar and left <b>click Add new button…</b></li>
<li>Type <b>Hello World</b> in the <b>"Name"</b> field.</li>
<li>Type <b>http://www.mozilla.org/favicon.ico</b> in the <b>"Image"</b> field.</li>
<li>Type <code>alert(&quot;Hello world&quot;);</code> on a blank line in the <b>&quot;Code&quot;</b> section.</li>
<li>Left click <b>OK</b> to close the <b>Edit button</b> dialog.</li>
<li>Left click <b>View → Toolbars → Customize…</b> in the Menu Bar - or right click a toolbar and left click <b>Customize…</b>.</li>
<li>Find the button and drag it to a toolbar.</li>
<li>Left click <b>Done</b> to close the <b>Customize Toolbar</b> window.</li>
<li>Left click the button to show the alert.</li>
<li>Right click the button to show the context popup.</li>
</ul>
</div>

<h3 id="nav_getting_started-3">Context Popup</h3>
<table class="table table-bordered table-condensed table-striped">
	<thead>
		<tr>
			<th>Image</th>
			<th>Action</th>
			<th>Comments</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td rowspan="9" align="center">
				<img src="lib/img/CBDoc-Context-popup.png" />
			</td>
			<td>Edit button...</td>
			<td></td>
		</tr>
		<tr>
			<td>Delete button</td>
			<td></td>
		</tr>
		<tr>
			<td>Clone button</td>
			<td>Middle click to add new blank button.</td>
		</tr>
		<tr>
			<td>Copy to clipboard</td>
			<td></td>
		</tr>
		<tr>
			<td>Update Button</td>
			<td>Hidden unless clipboard has a button URL.</td>
		</tr>
		<tr>
			<td>Bookmark Button</td>
			<td></td>
		</tr>
		<tr>
			<td>Button Help</td>
			<td>Hidden unless "Help" section has text.</td>
		</tr>
		<tr>
			<td>Customize...</td>
			<td></td>
		</tr>
		<tr>
			<td>Add new button...</td>
			<td></td>
		</tr>
	</tbody>
</table>
<h3 id="nav_getting_started-4">Editor Keyboard Shortcuts</h3>
<table class="table table-bordered table-condensed table-striped table-hover">
	<thead>
		<tr>
			<th>Shortcut</th>
			<th>Action</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><kbd>Ctrl + F</kbd></td>
			<td>Open search dialog in forward direction.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + Shift + F</kbd></td>
			<td>Open search dialog in backward direction.</td>
		</tr>
		<tr>
			<td><kbd>F3</kbd></td>
			<td>Find next.</td>
		</tr>
		<tr>
			<td><kbd>Shift + F3</kbd> </td>
			<td>Find previous.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + /</kbd> </td>
			<td>Incremental search.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + H</kbd></td>
			<td>Open replace dialog in forward direction.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + Shift + H</kbd></td>
			<td>Open replace dialog in backward direction.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + Shift + A</kbd></td>
			<td>Comment or uncomment selected lines.</td>
		</tr>
		<tr>
			<td><kbd>Tab</kbd></td>
			<td>Indent selected lines.</td>
		</tr>
		<tr>
			<td><kbd>Shift + Tab</kbd></td>
			<td>Unindent selected lines.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + W</kbd></td>
			<td>Toggle word wrapping.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + G</kbd></td>
			<td>Goto line number.</td>
		</tr>
		<tr>
			<td><kbd>F9</kbd></td>
			<td>Execute code from "Code" section.</td>
		</tr>
		<tr>
			<td><kbd>F11</kbd></td>
			<td>Maximize or restore editor window.</td>
		</tr>
		<tr>
			<td><kbd>Ctrl + Enter</kbd></td>
			<td>Save changes and close editor.</td>
		</tr>
  </tbody>
</table>

<h3 id="nav_getting_started-5">Custom Buttons Options</h3>
<div class="img" style="text-align:center;">
	<img src="lib/img/CBDoc-Options.png" width="auto" height="auto" />
</div></br>
<table class="table table-bordered table-condensed table-striped">
	<thead>
		<tr>
			<th>Option</th>
			<th>Comments</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><b>Show "Save" button in code editor</b></td>
			<td></td>
		</tr>
		<tr>
			<td><b>Disable buttons initialization</b></td>
			<td>For debug purposes.</td>
		</tr>
		<tr>
			<td><b>Enable install buttons from mail messages</b></td>
			<td>Only on Thunderbird/SeaMonkey.</td>
		</tr>
		<tr>
			<td><b>Save size and position of editor windows separately for each custom button</b></td>
			<td></td>
		</tr>
  </tbody>
</table>

<h3 id="nav_getting_started-6">Command Line Parameter</h3>
<dl class="dl-horizontal">
	<dt><b>firefox.exe</b></dt><dd>-custombuttons disable-buttons-initialization</dd>
	<dt><b>seamonkey.exe</b></dt><dd>-custombuttons disable-buttons-initialization</dd>
	<dt><b>thunderbird.exe</b></dt><dd>-custombuttons disable-buttons-initialization</dd>
	<dt><b>sunbird.exe</b></dt><dd>-custombuttons disable-buttons-initialization</dd>
	<dt><b>kompozer.exe</b></dt><dd>-custombuttons disable-buttons-initialization</dd>
	<dt><b>flock.exe</b></dt><dd>-custombuttons disable-buttons-initialization</dd>
</dl>
<a id="cb_basic_examples"></a>
<h3 id="nav_getting_started-7">Predefined Variables</h3>
<pre class="official_docs"><code>/*Code*/
alert(Cc == Components.classes);
alert(Ci == Components.interfaces);
alert(Cu == Components.utils);
alert(Cr == Components.results);
alert(self == this);
alert(xulns == &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);
alert(xhtmlns == &quot;http://www.w3.org/1999/xhtml&quot;);</code></pre>

<h3 id="nav_getting_started-8">Using Mouse Handlers</h3>

<div class="alert alert-warning">
  <p><em>All middle click events with modifiers are &quot;broken&quot;. Web browsers nowadays do not allow the use of modifier keys (Alt, Ctrl, etc.) in conjunction with the middle mouse button.</em></p>
</div>

<pre class="official_docs"><code>/*Initialization code*/
// right click button and shift - open custom button context popup
this.buttonClick = function (event) {
	event.preventDefault();
	if (event.button == 0 &amp;&amp; !event.altKey &amp;&amp; !event.ctrlKey &amp;&amp; !event.shiftKey)
		alert(&quot;  left click&quot;);
	if (event.button == 1 &amp;&amp; !event.altKey &amp;&amp; !event.ctrlKey &amp;&amp; !event.shiftKey)
		alert(&quot;middle click&quot;);
	if (event.button == 2 &amp;&amp; !event.altKey &amp;&amp; !event.ctrlKey &amp;&amp; !event.shiftKey)
		alert(&quot; right click&quot;);
	if (event.button == 2 &amp;&amp; !event.altKey &amp;&amp; !event.ctrlKey &amp;&amp; event.shiftKey)
		gShowPopup(this);
}
this.setAttribute(&quot;onclick&quot;, &quot;this.buttonClick(event)&quot;);</code></pre>


<pre class="official_docs"><code>/*Initialization code*/
this.   leftclick = function(event) { alert(&quot;   leftclick&quot;); }
this.  aleftclick = function(event) { alert(&quot;  aleftclick&quot;); } // a for alt
this.  cleftclick = function(event) { alert(&quot;  cleftclick&quot;); } // c for ctrl
this.  sleftclick = function(event) { alert(&quot;  sleftclick&quot;); } // s for shift
this.    midclick = function(event) { alert(&quot;    midclick&quot;); }
this.   amidclick = function(event) { alert(&quot;   amidclick&quot;); }
this.   cmidclick = function(event) { alert(&quot;   cmidclick&quot;); }
this.   smidclick = function(event) { alert(&quot;   smidclick&quot;); }
this.  rightclick = function(event) { alert(&quot;  rightclick&quot;);   gShowPopup(this); }
this. arightclick = function(event) { alert(&quot; arightclick&quot;); }
this. crightclick = function(event) { alert(&quot; crightclick&quot;); }
this. srightclick = function(event) { alert(&quot; srightclick&quot;); } // not available
this.  leftDclick = function(event) { alert(&quot;  leftDclick&quot;); } // capital d for double
this. aleftDclick = function(event) { alert(&quot; aleftDclick&quot;); }
this. cleftDclick = function(event) { alert(&quot; cleftDclick&quot;); }
this. sleftDclick = function(event) { alert(&quot; sleftDclick&quot;); }
this.   midDclick = function(event) { alert(&quot;   midDclick&quot;); }
this.  amidDclick = function(event) { alert(&quot;  amidDclick&quot;); }
this.  cmidDclick = function(event) { alert(&quot;  cmidDclick&quot;); }
this.  smidDclick = function(event) { alert(&quot;  smidDclick&quot;); }
this. rightDclick = function(event) { alert(&quot; rightDclick&quot;); }
this.arightDclick = function(event) { alert(&quot;arightDclick&quot;); }
this.crightDclick = function(event) { alert(&quot;crightDclick&quot;); }
this.srightDclick = function(event) { alert(&quot;srightDclick&quot;); } // not available
this.setAttribute(&quot;onclick&quot;, &quot;custombuttons.gQuot.mHandler(event, this)&quot;);
this.setAttribute(&quot;ondblclick&quot;, &quot;custombuttons.gQuot.mHandler(event, this)&quot;);</code></pre>

<pre class="official_docs"><code>/*Initialization code*/
this.acsleftDclick = function (event) {
	alert(&quot;alt ctrl shift left double click&quot;);
}
this.setAttribute(&quot;ondblclick&quot;, &quot;custombuttons.gQuot.mHandler(event, this)&quot;);</code></pre>


<h3 id="nav_getting_started-9">Change Button Image</h3>
<pre class="official_docs"><code>/*Initialization code*/
this.image = &quot;http://www.mozilla.org/favicon.ico&quot;;
this.setAttribute(&quot;onmouseup&quot;, &quot;this.image = 'chrome://custombuttons/skin/button.png'&quot;);
this.setAttribute(&quot;onmousedown&quot;, &quot;this.image = 'chrome://custombuttons/skin/stdicons/rbutton.png'&quot;);
this.setAttribute(&quot;onmouseout&quot;, &quot;this.image = 'chrome://custombuttons/skin/stdicons/gbutton.png'&quot;);
this.setAttribute(&quot;onmouseover&quot;, &quot;this.image = 'chrome://custombuttons/skin/stdicons/bbutton.png'&quot;);</code></pre>


<h3 id="nav_getting_started-10">Change Button Opacity</h3>
<pre class="official_docs"><code>/*Initialization code*/
this.style.opacity = &quot;0.65&quot;;
this.setAttribute(&quot;onmouseout&quot;, &quot;custombuttons.ButtonDim(event)&quot;);
this.setAttribute(&quot;onmouseover&quot;, &quot;custombuttons.ButtonBrt(event)&quot;);</code></pre>

<h3 id="nav_getting_started-11">Run Once Per Session</h3>
<pre class="official_docs"><code>/*Initialization code*/
// click &quot;Save&quot; or &quot;OK&quot; in the editor initializes one button
// close the customize toolbar window initializes all buttons
var uid = &quot;__unique_identifier_&quot; + this.id;
if (!(uid in window)) {
	alert(&quot;test&quot;);
	window[uid] = true;
}
// comment in the next line to re-execute
// delete window[uid];</code></pre>

<h3 id="nav_getting_started-12">Using DOM Inspector in Firefox, SeaMonkey, Thunderbird</h3>
<pre class="official_docs"><code>/*Code*/
if (typeof(inspectDOMDocument) == &quot;undefined&quot;) {
	alert(&quot;DOM Inspector is not enabled or installed.&quot;);
	return;
}
function runInspector(node) {
	if (node instanceof Document) {
		inspectDOMDocument(node);
	} else if (node instanceof Node) {
		inspectDOMNode(node);
	} else if (node !== null &amp;&amp; typeof(node) != &quot;undefined&quot;) {
		inspectObject(node);
	}
}
runInspector(document);
runInspector(content.document);
runInspector(document.getElementsByTagName(&quot;toolbar&quot;)[0]);
runInspector(document.getElementById(&quot;custombuttons-button0&quot;));
runInspector(navigator);
runInspector(Cc[&quot;@mozilla.org/xre/app-info;1&quot;].
	getService(Ci.nsIXULAppInfo));</code></pre>

<h3 id="nav_getting_started-13">Using onDestroy Method</h3>
<pre class="official_docs"><code>/*Initialization code*/
// constructor example - change button type property
// destructor  example - close window
// update      example - edit button
// delete      example - delete button
LOG(&quot;test 2&quot;);
this.onDestroy = function (reason) {
	LOG(&quot;test 1&quot;);
	if (reason == &quot;constructor&quot;)
		LOG(&quot;constructor&quot;);
	if (reason == &quot;destructor&quot;)
		LOG(&quot;destructor&quot;);
	if (reason == &quot;update&quot;)
		LOG(&quot;update&quot;);
	if (reason == &quot;delete&quot;)
		LOG(&quot;delete&quot;);
}</code></pre>

<h3 id="nav_getting_started-14">Using Commands</h3>
<pre class="official_docs"><code>/*Code*/
// some commands are only legal when there is a selection or when the focus is on a text field
var cmd;
cmd = &quot;cmd_paste&quot;; // cmd_paste command is implemented by a controller
cmd = &quot;cmd_close&quot;;
var controller = document.commandDispatcher.getControllerForCommand(cmd);
if (controller) {
	if (controller.isCommandEnabled(cmd)) {
		controller.doCommand(cmd);
	}
} else {
	var element = document.getElementById(cmd);
	if (element) {
		element.doCommand();
	}
}</code></pre>

<pre class="official_docs"><code>/*Code*/
goDoCommand(&quot;cmd_paste&quot;);</code></pre>

<pre class="official_docs"><code>/*Code*/
document.getElementById(&quot;cmd_close&quot;).doCommand();</code></pre>

<h3 id="nav_getting_started-15">Using Style Sheet Service - Firefox, SeaMonkey and Thunderbird</h3>
<h3>Example 1</h3>
<pre class="official_docs"><code>/*Initialization code*/
// #000000 black
// #0000FF blue
// #00FF00 lime
// #00FFFF aqua
// #FF0000 red
// #FF00FF fuchsia
// #FFFF00 yellow
// #FFFFFF white
var ios = Cc[&quot;@mozilla.org/network/io-service;1&quot;].
	getService(Ci.nsIIOService);
var sss = Cc[&quot;@mozilla.org/content/style-sheet-service;1&quot;].
	getService(Ci.nsIStyleSheetService);
var css = &quot;menubar             { background: #00FF00 !important; }&quot;;
css += &quot;#&quot; + this.id + &quot;       { background: #000000 !important; }&quot;;
css += &quot;#&quot; + this.id + &quot;:hover { background: #FFFFFF !important; }&quot;;
var uss = ios.newURI(&quot;data:text/css,&quot; + encodeURIComponent(css), null, null);
// comment out the next line to disable style
if (!sss.sheetRegistered(uss, sss.USER_SHEET))
	sss.loadAndRegisterSheet(uss, sss.USER_SHEET);
this.onDestroy = function (reason) {
	if (reason == &quot;update&quot;) {
		var uss = ios.newURI(&quot;data:text/css,&quot; + encodeURIComponent(css), null, null);
		if (sss.sheetRegistered(uss, sss.USER_SHEET))
			sss.unregisterSheet(uss, sss.USER_SHEET);
	}
	if (reason == &quot;delete&quot;) {
		var uss = ios.newURI(&quot;data:text/css,&quot; + encodeURIComponent(css), null, null);
		if (sss.sheetRegistered(uss, sss.USER_SHEET))
			sss.unregisterSheet(uss, sss.USER_SHEET);
		alert(&quot;style sheet unregistered&quot;);
	}
}</code></pre>

<h3>Example 2</h3>
<div class="tweaked_by_odyseus panel-body">
	<ul class="nav nav-tabs" style="margin-bottom: 15px;">
		<li class="active init-tab"><a href="#nav_getting_started-15-init-tab" rel="nofollow" data-toggle="tab">Initialization Tab</a></li>
		<li class="help-tab"><a href="#nav_getting_started-15-help-tab" rel="nofollow" data-toggle="tab">Help Tab</a></li>
	</ul>
	<div class="tab-content">
		<div class="tab-pane fade active in init-tab" id="nav_getting_started-15-init-tab">
<pre><code>/*Initialization*/
const _CSS = &quot;__stylesheet_&quot; + this.id; // Create a unique identifier to store the CSS.

var css = this.Help.replace(/_this_id_/gm, this.id); // Get the CSS from the &quot;Help&quot; tab of this button.

function styleSheet(aCSS, aRemFlag) {
	var sss = Cc[&quot;@mozilla.org/content/style-sheet-service;1&quot;]
		.getService(Ci.nsIStyleSheetService);
	var ios = Cc[&quot;@mozilla.org/network/io-service;1&quot;]
		.getService(Ci.nsIIOService);
	var uri = ios.newURI(&quot;data:text/css,&quot; + encodeURIComponent(aCSS), null, null);
	if (sss.sheetRegistered(uri, sss.USER_SHEET))
		sss.unregisterSheet(uri, sss.USER_SHEET);
	if (aRemFlag)
		return;
	sss.loadAndRegisterSheet(uri, sss.USER_SHEET);
	window[_CSS] = aCSS; // Store the CSS in window so it can be compared in the future.
}

if (!(_CSS in window))             // If no CSS is stored in window...
	styleSheet(css);                 // ...store it and register it.
else if (window[_CSS] !== css) {   // If the CSS stored in window is different from the CSS you want...
	styleSheet(window[_CSS], true);  // ...unregister it...
	setTimeout(function () {         // ...give it time to unregister...
		styleSheet(css);               // ...and finally, register it.
	}, 500);
}

this.onDestroy = function (aReason) {
	if (aReason === &quot;update&quot; || aReason === &quot;delete&quot;) { // If the button is updated or deleted...
		styleSheet(window[_CSS], true);                   // ...unregister the CSS...
		delete window[_CSS];                              // ...and delete it from window.
	}
};</code></pre>
		</div>
		<div class="tab-pane fade help-tab" id="nav_getting_started-15-help-tab">
<pre><code>/*!
 * 1- Here, the stylesheet doesn't need to be escaped, which would be necessary if
 * the stylesheet were stored inside the initialization tab.
 * 2- Every time you make a change to this stylesheet and save the button, the
 * stylesheet will be &quot;re-registered&quot; and show the changes immediately.
 * 3- &quot;_this_id_&quot; is a placeholder that will be replaced with the actual id of this button
 * every time the stylesheet is loaded.
 */
menubar {
	background: #00FF00 !important;
}
#_this_id_ {
	background: #000000 !important;
}
#_this_id_:hover {
	background: #FFFFFF !important;
}

/* Remove accelerator containers from ALL menus and submenus */
.menu-accel-container {
	display: none !important;
}
/* Remove accelerator containers from ALL menus and submenus */

/* Show button label */
toolbarbutton[id=&quot;_this_id_&quot;] &gt; label.toolbarbutton-text {
	display: inline !important;
	color: white !important;
	font-weight: bold !important;
	padding: 0 5px 0 5px !important;
}
/* Show button label */</code></pre>
		</div>
	</div>
</div>

<h3 id="nav_getting_started-16">Using Event Listeners - Firefox and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var browser = gBrowser.getBrowserForTab(gBrowser.addTab(&quot;about:logo&quot;));
browser.addEventListener(&quot;load&quot;, function (event) {
	browser.removeEventListener(&quot;load&quot;, arguments.callee, true);
	alert(&quot;test&quot;);
}, true);
</code></pre>

<pre class="official_docs"><code>/*Code*/
// custom button event listener is deleted automatically when a button is destroyed
var browser = gBrowser.getBrowserForTab(gBrowser.addTab(&quot;about:logo&quot;));
addEventListener(&quot;load&quot;, function (event) {
	removeEventListener(&quot;load&quot;, arguments.callee, true, browser);
	alert(&quot;test&quot; + &quot;\n&quot; + &quot;handlers length: &quot; + this._handlers.length);
}, true, browser);</code></pre>

<h3 id="nav_getting_started-17">Using Error Console</h3>

<pre class="official_docs"><code>/*Code*/
var consoleService = Cc[&quot;@mozilla.org/consoleservice;1&quot;].
	getService(Ci.nsIConsoleService);
consoleService.logStringMessage(&quot;test 1&quot;);
LOG(&quot;test 2&quot;);
alert(LOG(2 + 2));
try {
	toErrorConsole(); // console2.mozdev.org
} catch (e) {
	toJavaScriptConsole();
}</code></pre>

<pre class="official_docs"><code>/*Code*/
// left click entry in error console to go directly to the error
this.is.an.error;</code></pre>

<pre class="official_docs"><code>Error : this.is is undefined
Source File : chrome : //custombuttons/content/button.js?windowId=Firefox&amp;amp;id=custombuttons-button0@code
Line : 3</code></pre>

<h3 id="nav_getting_started-18">Toggle Page Style - Firefox, SeaMonkey and Thunderbird</h3>
<pre class="official_docs"><code>/*Code*/
var element = content.document.getElementById(&quot;blackify&quot;);
if (element) {
	element.parentNode.removeChild(element);
} else {
	var style = content.document.createElement(&quot;style&quot;);
	style.setAttribute(&quot;type&quot;, &quot;text/css&quot;);
	style.setAttribute(&quot;id&quot;, &quot;blackify&quot;);
	style.innerHTML = &quot;*         { background: #000000 !important; }&quot; +
		&quot;*         {      color: #CCCCCC !important; }&quot; +
		&quot;a         {      color: #FFCC66 !important; }&quot; +
		&quot;a:hover   {      color: #FFFFCC !important; }&quot; +
		&quot;a:visited {      color: #FFB720 !important; }&quot;;
	content.document.getElementsByTagName(&quot;head&quot;)[0].appendChild(style);
}</code></pre>


</div>
<!-- End content main -->
<!-- Start content nav_working_with_buttons-->
<div class="cb-docs-section">
<h1 id="nav_working_with_buttons" class="page-header">Working with buttons, mouse, menus, etc</h1>
<h3 id="nav_working_with_buttons-menu-type">Toolbar Button Type 'menu' - Firefox and SeaMonkey</h3>
<p>The following three examples create the exact same button. The difference lies in the way the menu for this button is created. In the first example, the menu is created by parsing a variable that stores an XML string. In the second example, the menu is created with pure JavaScript. And in the third example, the menu is stored indide the &quot;Help&quot; tab of the button.</p>
<h3 id="nav_working_with_buttons-menu-type-ex1">Example 1 - Menu created from an XML string</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
/**
 *   left click on button    - Open menu popup
 *  right click on button    - Open custom button context popup
 *   left click on menuitems - Open page in the current tab
 * middle click on menuitems - Open page in a new tab in the background
 *  right click on menuitems - Open page in a new tab in the foreground
 */

const cbNS = &quot;http://xsms.nm.ru/custombuttons/&quot;;

// xulns = http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul.
// Is a global variable defined by Custom Buttons.
var menu =  &quot;&lt;menupopup xmlns=\&quot;&quot; + xulns + &quot;\&quot; xmlns:cb=\&quot;&quot; + cbNS + &quot;\&quot;&quot; +
	&quot; onclick=\&quot;this.parentNode.menuClick(event);\&quot;&gt;&quot; +
	&quot;&lt;menu&quot; +
	&quot; class=\&quot;menu-iconic\&quot;&quot; +
	&quot; image=\&quot;chrome://global/skin/dirListing/folder.png\&quot;&quot; +
	&quot; label=\&quot;Search\&quot;&gt;&quot; +
	&quot;&lt;menupopup&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://www.google.com/favicon.ico\&quot;&quot; +
	&quot; label=\&quot;Google\&quot;&quot; +
	&quot; cb:url=\&quot;http://www.google.com/\&quot;/&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://search.yahoo.com/favicon.ico\&quot;&quot; +
	&quot; label=\&quot;Yahoo\&quot;&quot; +
	&quot; cb:url=\&quot;http://search.yahoo.com/\&quot;/&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://www.bing.com/favicon.ico\&quot;&quot; +
	&quot; label=\&quot;Bing\&quot;&quot; +
	&quot; cb:url=\&quot;http://www.bing.com/\&quot;/&gt;&quot; +
	&quot;&lt;menuseparator/&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; label=\&quot;Open All in Tabs\&quot;&quot; +
	&quot; onclick=\&quot;document.getElementById(\'&quot; + this.id + &quot;\').openAllInTabs(event);\&quot;/&gt;&quot; +
	&quot;&lt;/menupopup&gt;&quot; +
	&quot;&lt;/menu&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://en.wikipedia.org/favicon.ico\&quot;&quot; +
	&quot; label=\&quot;Wikipedia\&quot;&quot; +
	&quot; cb:url=\&quot;http://en.wikipedia.org/\&quot;/&gt;&quot; +
	&quot;&lt;/menupopup&gt;&quot;;

this.appendChild($XML(menu)); // This appends the menu itself to the button.

var nodeList = this.getElementsByTagName(&quot;menuitem&quot;); // Gets all menuitems in this button.

for (var i = 0; i &lt; nodeList.length; i++) { // This loop sets the tooltip for each menuitem.
	var label = nodeList[i].getAttribute(&quot;label&quot;);
	var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
	if (label &amp;&amp; url)
		nodeList[i].setAttribute(&quot;tooltiptext&quot;, label + &quot;\n&quot; + url);
}

this.type = &quot;menu&quot;;

this.orient = &quot;horizontal&quot;;

this.menuClick = function (event) {
	event.preventDefault();
	event.stopPropagation();
	this.open = false; // This closes the popup after middle/right clicks on menuitems.
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url &amp;&amp; event.button == 0) // Left click
		loadURI(url);
	if (url &amp;&amp; event.button == 1) // Middle click
		gBrowser.addTab(url);
	if (url &amp;&amp; event.button == 2) // Right click
		gBrowser.selectedTab = gBrowser.addTab(url);
};

this.openAllInTabs = function (event) {
	var nodeList = event.target.parentNode.childNodes;
	for (var i = 0; i &lt; nodeList.length; i++) {
		var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
		if (url)
			gBrowser.addTab(url);
	}
};

function $XML(aXML) { // Return parsed XML
	aXML = aXML.replace(/&gt;\s+&lt;/g, &quot;&gt;&lt;&quot;); // Linearize XML
	return (new DOMParser).parseFromString(aXML, &quot;application/xml&quot;).documentElement;
}</code></pre>
<h3 id="nav_working_with_buttons-menu-type-ex2">Example 2 - Menu created with JavaScript</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
/**
 *   left click on button    - Open menu popup
 *  right click on button    - Open custom button context popup
 *   left click on menuitems - Open page in the current tab
 * middle click on menuitems - Open page in a new tab in the background
 *  right click on menuitems - Open page in a new tab in the foreground
 */

const cbNS = &quot;http://xsms.nm.ru/custombuttons/&quot;;

// xulns = http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul.
// Is a global variable defined by Custom Buttons.
var mainPopup = document.createElementNS(xulns, &quot;menupopup&quot;);
mainPopup.setAttribute(&quot;xmlns:cb&quot;, cbNS);
mainPopup.setAttribute(&quot;onclick&quot;, &quot;this.parentNode.menuClick(event);&quot;);

var subMenu = mainPopup.appendChild(document.createElementNS(xulns, &quot;menu&quot;));
subMenu.setAttribute(&quot;class&quot;, &quot;menu-iconic&quot;);
subMenu.setAttribute(&quot;label&quot;, &quot;Search&quot;);
subMenu.setAttribute(&quot;image&quot;, &quot;chrome://global/skin/dirListing/folder.png&quot;);

var subPopup = subMenu.appendChild(document.createElementNS(xulns, &quot;menupopup&quot;));

var mItem1 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem1.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem1.setAttribute(&quot;label&quot;, &quot;Google&quot;);
mItem1.setAttribute(&quot;image&quot;, &quot;http://www.google.com/favicon.ico&quot;);
mItem1.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;https://www.google.com&quot;);

var mItem2 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem2.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem2.setAttribute(&quot;label&quot;, &quot;Yahoo&quot;);
mItem2.setAttribute(&quot;image&quot;, &quot;http://search.yahoo.com/favicon.ico&quot;);
mItem2.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;https://search.yahoo.com&quot;);

var mItem3 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem3.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem3.setAttribute(&quot;label&quot;, &quot;Bing&quot;);
mItem3.setAttribute(&quot;image&quot;, &quot;http://www.bing.com/favicon.ico&quot;);
mItem3.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;https://www.bing.com&quot;);

subPopup.appendChild(document.createElementNS(xulns, &quot;menuseparator&quot;));

var mItem4 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem4.setAttribute(&quot;label&quot;, &quot;Open All in Tabs&quot;);
mItem4.setAttribute(&quot;onclick&quot;, &quot;document.getElementById('&quot; + this.id + &quot;').openAllInTabs(event);&quot;);

var mItem5 = mainPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem5.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem5.setAttribute(&quot;label&quot;, &quot;Wikipedia&quot;);
mItem5.setAttribute(&quot;image&quot;, &quot;http://en.wikipedia.org/favicon.ico&quot;);
mItem5.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;http://en.wikipedia.org&quot;);

this.appendChild(mainPopup); // This appends the menu itself to the button.

var nodeList = this.getElementsByTagName(&quot;menuitem&quot;); // Gets all menuitems in this button.

for (var i = 0; i &lt; nodeList.length; i++) { // This loop sets the tooltip for each menuitem.
	var label = nodeList[i].getAttribute(&quot;label&quot;);
	var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
	if (label &amp;&amp; url)
		nodeList[i].setAttribute(&quot;tooltiptext&quot;, label + &quot;\n&quot; + url);
}

this.type = &quot;menu&quot;;

this.orient = &quot;horizontal&quot;;

this.menuClick = function (event) {
	event.preventDefault();
	event.stopPropagation();
	this.open = false; // This closes the popup after middle/right clicks on menuitems.
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url &amp;&amp; event.button == 0) // Left click
		loadURI(url);
	if (url &amp;&amp; event.button == 1) // Middle click
		gBrowser.addTab(url);
	if (url &amp;&amp; event.button == 2) // Right click
		gBrowser.selectedTab = gBrowser.addTab(url);
};

this.openAllInTabs = function (event) {
	var nodeList = event.target.parentNode.childNodes;
	for (var i = 0; i &lt; nodeList.length; i++) {
		var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
		if (url)
			gBrowser.addTab(url);
	}
};</code></pre>

<h3 id="nav_working_with_buttons-menu-type-ex3">Example 3 - Menu stored inside "Help" tab</h3>
<div class="tweaked_by_odyseus panel-body">
	<ul class="nav nav-tabs" style="margin-bottom: 15px;">
		<li class="active init-tab"><a href="#nav_working_with_buttons-menu-type-init-tab" rel="nofollow" data-toggle="tab">Initialization Tab</a></li>
		<li class="help-tab"><a href="#nav_working_with_buttons-menu-type-help-tab" rel="nofollow" data-toggle="tab">Help Tab</a></li>
	</ul>
	<div class="tab-content">
		<div class="tab-pane fade active in init-tab" id="nav_working_with_buttons-menu-type-init-tab">
<pre><code>/*Initialization code*/
/**
 *   left click on button    - Open menu popup
 *  right click on button    - Open custom button context popup
 *   left click on menuitems - Open page in the current tab
 * middle click on menuitems - Open page in a new tab in the background
 *  right click on menuitems - Open page in a new tab in the foreground
 */

const cbNS = &quot;http://xsms.nm.ru/custombuttons/&quot;;

var menu = this.Help.replace(/_this_id_/gm, this.id);

this.appendChild($XML(menu)); // This appends the menu itself to the button.

var nodeList = this.getElementsByTagName(&quot;menuitem&quot;); // Gets all menuitems in this button.

for (var i = 0; i &lt; nodeList.length; i++) { // This loop sets the tooltip for each menuitem.
	var label = nodeList[i].getAttribute(&quot;label&quot;);
	var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
	if (label &amp;&amp; url)
		nodeList[i].setAttribute(&quot;tooltiptext&quot;, label + &quot;\n&quot; + url);
}

this.type = &quot;menu&quot;;

this.orient = &quot;horizontal&quot;;

this.menuClick = function (event) {
	event.preventDefault();
	event.stopPropagation();
	this.open = false; // This closes the popup after middle/right clicks on menuitems.
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url &amp;&amp; event.button == 0) // Left click
		loadURI(url);
	if (url &amp;&amp; event.button == 1) // Middle click
		gBrowser.addTab(url);
	if (url &amp;&amp; event.button == 2) // Right click
		gBrowser.selectedTab = gBrowser.addTab(url);
};

this.openAllInTabs = function (event) {
	var nodeList = event.target.parentNode.childNodes;
	for (var i = 0; i &lt; nodeList.length; i++) {
		var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
		if (url)
			gBrowser.addTab(url);
	}
};

function $XML(aXML) { // Return parsed XML
	aXML = aXML.replace(/&gt;\s+&lt;/g, &quot;&gt;&lt;&quot;); // Linearize XML
	return (new DOMParser).parseFromString(aXML, &quot;application/xml&quot;).documentElement;
}</code></pre>
		</div>
		<div class="tab-pane fade help-tab" id="nav_working_with_buttons-menu-type-help-tab">
<pre><code>&lt;!--
 Here can be used &quot;pure&quot; XML (XUL to be precise) without the need to escape it.
--&gt;
&lt;menupopup xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;
	 xmlns:cb=&quot;http://xsms.nm.ru/custombuttons/&quot;
	 onclick=&quot;this.parentNode.menuClick(event);&quot;&gt;
	&lt;menu
	 class=&quot;menu-iconic&quot;
	 image=&quot;chrome://global/skin/dirListing/folder.png&quot;
	 label=&quot;Search&quot;&gt;
		&lt;menupopup&gt;
			&lt;menuitem
			 class=&quot;menuitem-iconic&quot;
			 image=&quot;http://www.google.com/favicon.ico&quot;
			 label=&quot;Google&quot;
			 cb:url=&quot;http://www.google.com/&quot;/&gt;
			&lt;menuitem
			 class=&quot;menuitem-iconic&quot;
			 image=&quot;http://search.yahoo.com/favicon.ico&quot;
			 label=&quot;Yahoo&quot;
			 cb:url=&quot;http://search.yahoo.com/&quot;/&gt;
			&lt;menuitem
			 class=&quot;menuitem-iconic&quot;
			 image=&quot;http://www.bing.com/favicon.ico&quot;
			 label=&quot;Bing&quot;
			 cb:url=&quot;http://www.bing.com/&quot;/&gt;
			&lt;menuseparator/&gt;
			&lt;menuitem
			 label=&quot;Open All in Tabs&quot;
			 onclick=&quot;document.getElementById('_this_id_').openAllInTabs(event);&quot;/&gt;
		&lt;/menupopup&gt;
	&lt;/menu&gt;
	&lt;menuitem
	 class=&quot;menuitem-iconic&quot;
	 image=&quot;http://en.wikipedia.org/favicon.ico&quot;
	 label=&quot;Wikipedia&quot;
	 cb:url=&quot;http://en.wikipedia.org/&quot;/&gt;
&lt;/menupopup&gt;</code></pre>
		</div>
	</div>
</div>
<h3 id="nav_working_with_buttons-menu-button-type">Toolbar Button Type 'menu-button' - Firefox and SeaMonkey</h3>
<p>The following three examples create the exact same button. The difference lies in the way the menu for this button is created. In the first example, the menu is created by parsing a variable that stores an XML string. In the second example, the menu is created with pure JavaScript. And in the third example, the menu is stored indide the &quot;Help&quot; tab of the button.</p>
<h3 id="nav_working_with_buttons-menu-button-type-ex1">Example 1 - Menu created by parsing an XML string</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
/**
 *   Left click on button               - Open page in a new window
 *   Left click on           dropmarker - Open menu popup
 *  Right click on button or dropmarker - Open custom button context popup
 *   Left click on menuitems            - Open page in the current tab
 * Middle click on menuitems            - Open page in a new tab in the background
 *  Right click on menuitems            - Open page in a new tab in the foreground
 */

const cbNS = &quot;http://xsms.nm.ru/custombuttons/&quot;;

// xulns = http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul.
// Is a global variable defined by Custom Buttons.
var menu = &quot;&lt;menupopup xmlns=\&quot;&quot; + xulns + &quot;\&quot; xmlns:cb=\&quot;&quot; + cbNS + &quot;\&quot;&quot; +
	&quot; onclick=\&quot;this.parentNode.menuClick(event)\&quot;&quot; +
	&quot; oncommand=\&quot;this.parentNode.menuCommand(event)\&quot;&gt;&quot; +
	&quot;&lt;menu class=\&quot;menu-iconic\&quot;&quot; +
	&quot; image=\&quot;chrome://global/skin/dirListing/folder.png\&quot; label=\&quot;Search\&quot;&gt;&quot; +
	&quot;&lt;menupopup&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://www.google.com/favicon.ico\&quot;&quot; +
	&quot; label = \&quot;Google\&quot;&quot; +
	&quot; cb:url=\&quot;https://www.google.com/\&quot;/&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://search.yahoo.com/favicon.ico\&quot;&quot; +
	&quot; label=\&quot;Yahoo\&quot;&quot; +
	&quot; cb:url=\&quot;https://search.yahoo.com/\&quot;/&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://www.bing.com/favicon.ico\&quot;&quot; +
	&quot; label=\&quot;Bing\&quot;&quot; +
	&quot; cb:url=\&quot;https://www.bing.com/\&quot;/&gt;&quot; +
	&quot;&lt;menuseparator/&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; label=\&quot;Open All in Tabs\&quot;&quot; +
	&quot; onclick=\&quot;document.getElementById('&quot; + this.id + &quot;').openAllInTabs(event);\&quot;/&gt;&quot; +
	&quot;&lt;/menupopup&gt;&quot; +
	&quot;&lt;/menu&gt;&quot; +
	&quot;&lt;menuitem&quot; +
	&quot; class=\&quot;menuitem-iconic\&quot;&quot; +
	&quot; image=\&quot;http://en.wikipedia.org/favicon.ico\&quot;&quot; +
	&quot; label=\&quot;Wikipedia\&quot;&quot; +
	&quot; cb:url=\&quot;http://en.wikipedia.org/\&quot;/&gt;&quot; +
	&quot;&lt;/menupopup&gt;&quot;;

this.appendChild($XML(menu)); // This appends the menu itself to the button.

var nodeList = this.getElementsByTagName(&quot;menuitem&quot;); // Gets all menuitems in this button.

for (var i = 0; i &lt; nodeList.length; i++) { // This loop sets the tooltip for each menuitem.
	var label = nodeList[i].getAttribute(&quot;label&quot;);
	var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
	if (label &amp;&amp; url)
		nodeList[i].setAttribute(&quot;tooltiptext&quot;, label + &quot;\n&quot; + url);
}

this.type = &quot;menu-button&quot;;

this.orient = &quot;horizontal&quot;;

this.menuClick = function (event) {
	event.preventDefault();
	event.stopPropagation();
	this.open = false; // This closes the popup after middle/right clicks on menuitems.
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url &amp;&amp; event.button == 1) // Middle click
		gBrowser.addTab(url);
	if (url &amp;&amp; event.button == 2) // Right click
		gBrowser.selectedTab = gBrowser.addTab(url);
};

this.menuCommand = function (event) { // Left click
	event.stopPropagation();
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url)
		loadURI(url);
};

this.buttonCommand = function (event) { // Left click on button, not dropmarker
	var url = &quot;about:config&quot;;
	window.open(url, &quot;_blank&quot;, &quot;chrome,centerscreen,width=640,height=480&quot;);
};

this.openAllInTabs = function (event) {
	var nodeList = event.target.parentNode.childNodes;
	for (var i = 0; i &lt; nodeList.length; i++) {
		var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
		if (url)
			gBrowser.addTab(url);
	}
};

this.setAttribute(&quot;oncommand&quot;, &quot;this.buttonCommand(event)&quot;);

function $XML(aXML) { // Return parsed XML
	aXML = aXML.replace(/&gt;\s+&lt;/g, &quot;&gt;&lt;&quot;); // Linearize XML
	return (new DOMParser).parseFromString(aXML, &quot;application/xml&quot;).documentElement;
}</code></pre>
<h3 id="nav_working_with_buttons-menu-button-type-ex2">Example 2 - Menu created with JavaScript</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
/**
 *   Left click on button               - Open page in a new window
 *   Left click on           dropmarker - Open menu popup
 *  Right click on button or dropmarker - Open custom button context popup
 *   Left click on menuitems            - Open page in the current tab
 * Middle click on menuitems            - Open page in a new tab in the background
 *  Right click on menuitems            - Open page in a new tab in the foreground
 */

const cbNS = &quot;http://xsms.nm.ru/custombuttons/&quot;;

// xulns = http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul.
// Is a global variable defined by Custom Buttons.
var mainPopup = document.createElementNS(xulns, &quot;menupopup&quot;);
mainPopup.setAttribute(&quot;xmlns:cb&quot;, cbNS);
mainPopup.setAttribute(&quot;onclick&quot;, &quot;this.parentNode.menuClick(event);&quot;);
mainPopup.setAttribute(&quot;oncommand&quot;, &quot;this.parentNode.menuCommand(event);&quot;);

var subMenu = mainPopup.appendChild(document.createElementNS(xulns, &quot;menu&quot;));
subMenu.setAttribute(&quot;class&quot;, &quot;menu-iconic&quot;);
subMenu.setAttribute(&quot;label&quot;, &quot;Search&quot;);
subMenu.setAttribute(&quot;image&quot;, &quot;chrome://global/skin/dirListing/folder.png&quot;);

var subPopup = subMenu.appendChild(document.createElementNS(xulns, &quot;menupopup&quot;));

var mItem1 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem1.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem1.setAttribute(&quot;label&quot;, &quot;Google&quot;);
mItem1.setAttribute(&quot;image&quot;, &quot;http://www.google.com/favicon.ico&quot;);
mItem1.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;https://www.google.com&quot;);

var mItem2 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem2.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem2.setAttribute(&quot;label&quot;, &quot;Yahoo&quot;);
mItem2.setAttribute(&quot;image&quot;, &quot;http://search.yahoo.com/favicon.ico&quot;);
mItem2.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;https://search.yahoo.com&quot;);

var mItem3 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem3.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem3.setAttribute(&quot;label&quot;, &quot;Bing&quot;);
mItem3.setAttribute(&quot;image&quot;, &quot;http://www.bing.com/favicon.ico&quot;);
mItem3.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;https://www.bing.com&quot;);

subPopup.appendChild(document.createElementNS(xulns, &quot;menuseparator&quot;));

var mItem4 = subPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem4.setAttribute(&quot;label&quot;, &quot;Open All in Tabs&quot;);
mItem4.setAttribute(&quot;onclick&quot;, &quot;document.getElementById('&quot; + this.id + &quot;').openAllInTabs(event);&quot;);

var mItem5 = mainPopup.appendChild(document.createElementNS(xulns, &quot;menuitem&quot;));
mItem5.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);
mItem5.setAttribute(&quot;label&quot;, &quot;Wikipedia&quot;);
mItem5.setAttribute(&quot;image&quot;, &quot;http://en.wikipedia.org/favicon.ico&quot;);
mItem5.setAttributeNS(cbNS, &quot;cb:url&quot;, &quot;http://en.wikipedia.org&quot;);

this.appendChild(mainPopup); // This appends the menu itself to the button.

var nodeList = this.getElementsByTagName(&quot;menuitem&quot;); // Gets all menuitems in this button.

for (var i = 0; i &lt; nodeList.length; i++) { // This loop sets the tooltip for each menuitem.
	var label = nodeList[i].getAttribute(&quot;label&quot;);
	var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
	if (label &amp;&amp; url)
		nodeList[i].setAttribute(&quot;tooltiptext&quot;, label + &quot;\n&quot; + url);
}

this.type = &quot;menu-button&quot;;

this.orient = &quot;horizontal&quot;;

this.menuClick = function (event) {
	event.preventDefault();
	event.stopPropagation();
	this.open = false; // This closes the popup after middle/right clicks on menuitems.
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url &amp;&amp; event.button == 1) // Middle click
		gBrowser.addTab(url);
	if (url &amp;&amp; event.button == 2) // Right click
		gBrowser.selectedTab = gBrowser.addTab(url);
};

this.menuCommand = function (event) { // Left click
	event.stopPropagation();
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url)
		loadURI(url);
};

this.buttonCommand = function (event) { // Left click on button, not dropmarker
	var url = &quot;about:config&quot;;
	window.open(url, &quot;_blank&quot;, &quot;chrome,centerscreen,width=640,height=480&quot;);
};

this.openAllInTabs = function (event) {
	var nodeList = event.target.parentNode.childNodes;
	for (var i = 0; i &lt; nodeList.length; i++) {
		var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
		if (url)
			gBrowser.addTab(url);
	}
};

this.setAttribute(&quot;oncommand&quot;, &quot;this.buttonCommand(event)&quot;);</code></pre>

<h3 id="nav_working_with_buttons-menu-button-type-ex3">Example 3 - Menu stored inside &quot;Help&quot; tab</h3>
<div class="tweaked_by_odyseus panel-body">
	<ul class="nav nav-tabs" style="margin-bottom: 15px;">
		<li class="active init-tab"><a href="#nav_working_with_buttons-menu-button-type-init-tab" rel="nofollow" data-toggle="tab">Initialization Tab</a></li>
		<li class="help-tab"><a href="#nav_working_with_buttons-menu-button-type-help-tab" rel="nofollow" data-toggle="tab">Help Tab</a></li>
	</ul>
	<div class="tab-content">
		<div class="tab-pane fade active in init-tab" id="nav_working_with_buttons-menu-button-type-init-tab">
<pre><code>/*Initialization code*/
/**
 *   Left click on button               - Open page in a new window
 *   Left click on           dropmarker - Open menu popup
 *  Right click on button or dropmarker - Open custom button context popup
 *   Left click on menuitems            - Open page in the current tab
 * Middle click on menuitems            - Open page in a new tab in the background
 *  Right click on menuitems            - Open page in a new tab in the foreground
 */

const cbNS = &quot;http://xsms.nm.ru/custombuttons/&quot;;

var menu = this.Help.replace(/_this_id_/gm, this.id);

this.appendChild($XML(menu)); // This appends the menu itself to the button.

var nodeList = this.getElementsByTagName(&quot;menuitem&quot;); // Gets all menuitems in this button.

for (var i = 0; i &lt; nodeList.length; i++) { // This loop sets the tooltip for each menuitem.
	var label = nodeList[i].getAttribute(&quot;label&quot;);
	var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
	if (label &amp;&amp; url)
		nodeList[i].setAttribute(&quot;tooltiptext&quot;, label + &quot;\n&quot; + url);
}

this.type = &quot;menu-button&quot;;

this.orient = &quot;horizontal&quot;;

this.menuClick = function (event) {
	event.preventDefault();
	event.stopPropagation();
	this.open = false; // This closes the popup after middle/right clicks on menuitems.
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url &amp;&amp; event.button == 1) // Middle click
		gBrowser.addTab(url);
	if (url &amp;&amp; event.button == 2) // Right click
		gBrowser.selectedTab = gBrowser.addTab(url);
};

this.menuCommand = function (event) { // Left click
	event.stopPropagation();
	var url = event.target.getAttributeNS(cbNS, &quot;url&quot;);
	if (url)
		loadURI(url);
};

this.buttonCommand = function (event) { // Left click on button, not dropmarker
	var url = &quot;about:config&quot;;
	window.open(url, &quot;_blank&quot;, &quot;chrome,centerscreen,width=640,height=480&quot;);
};

this.openAllInTabs = function (event) {
	var nodeList = event.target.parentNode.childNodes;
	for (var i = 0; i &lt; nodeList.length; i++) {
		var url = nodeList[i].getAttributeNS(cbNS, &quot;url&quot;);
		if (url)
			gBrowser.addTab(url);
	}
};

this.setAttribute(&quot;oncommand&quot;, &quot;this.buttonCommand(event)&quot;);

function $XML(aXML) { // Return parsed XML
	aXML = aXML.replace(/&gt;\s+&lt;/g, &quot;&gt;&lt;&quot;); // Linearize XML
	return (new DOMParser).parseFromString(aXML, &quot;application/xml&quot;).documentElement;
}
</code></pre>
		</div>
		<div class="tab-pane fade help-tab" id="nav_working_with_buttons-menu-button-type-help-tab">
<pre><code>&lt;!--
 Here can be used &quot;pure&quot; XML (XUL to be precise) without the need to escape it.
--&gt;
&lt;menupopup xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;
	 xmlns:cb=&quot;http://xsms.nm.ru/custombuttons/&quot;
	 onclick=&quot;this.parentNode.menuClick(event)&quot;
	 oncommand=&quot;this.parentNode.menuCommand(event)&quot;&gt;
	&lt;menu class=&quot;menu-iconic&quot;
		  image=&quot;chrome://global/skin/dirListing/folder.png&quot;
		  label=&quot;Search&quot;&gt;
		&lt;menupopup&gt;
			&lt;menuitem
			 class=&quot;menuitem-iconic&quot;
			 image=&quot;http://www.google.com/favicon.ico&quot;
			 label=&quot;Google&quot;
			 cb:url=&quot;https://www.google.com/&quot;/&gt;
			&lt;menuitem
			 class=&quot;menuitem-iconic&quot;
			 image=&quot;http://search.yahoo.com/favicon.ico&quot;
			 label=&quot;Yahoo&quot;
			 cb:url=&quot;https://search.yahoo.com/&quot;/&gt;
			&lt;menuitem
			 class=&quot;menuitem-iconic&quot;
			 image=&quot;http://www.bing.com/favicon.ico&quot;
			 label=&quot;Bing&quot;
			 cb:url=&quot;https://www.bing.com/&quot;/&gt;
			&lt;menuseparator/&gt;
			&lt;menuitem
			 label=&quot;Open All in Tabs&quot;
			 onclick=&quot;document.getElementById('_this_id_').openAllInTabs(event);&quot;/&gt;
		&lt;/menupopup&gt;
	&lt;/menu&gt;
	&lt;menuitem
	 class=&quot;menuitem-iconic&quot;
	 image=&quot;http://en.wikipedia.org/favicon.ico&quot;
	 label=&quot;Wikipedia&quot;
	 cb:url=&quot;http://en.wikipedia.org/&quot;/&gt;
&lt;/menupopup&gt;</code></pre>
		</div>
	</div>
</div>
<h3 id="nav_working_with_buttons-drag-and-drop">Drag&amp;Drop capabilities</h3>
<h3>Example 1</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
this.dragAndDropHandler = {
	handleEvent : function (aEvt) {
		var types = aEvt.dataTransfer.types; // All data types found in the dragged data.
		switch (aEvt.type) {
		case &quot;dragover&quot;:
			// Warning!!! The dragover event is triggered &quot;every few hundred milliseconds&quot;.
			// That's what MDN docs says. https://developer.mozilla.org/en-US/docs/Web/Events/dragover
			// In the past, I think to remember that said every 100 milliseconds.
			// So be carefull what you put in here because it will run several times per second.
			aEvt.preventDefault();
			break;
		case &quot;drop&quot;:
			if (types.contains(&quot;text/html&quot;) || types.contains(&quot;text/plain&quot;) ||
				types.contains(&quot;text/x-moz-text-internal&quot;)) {
				let data = aEvt.dataTransfer.getData('text/html');
				var urlArr = /href=&quot;?([^&quot;\s]+)&quot;?\s*/.exec(data); // Check if what is been dragged contains a link.
				if (!urlArr)                                               // If it's not a link...
					urlArr = aEvt.dataTransfer.getData('text/plain') ||
						aEvt.dataTransfer.getData('text/x-moz-text-internal'); // ...treat it as plain text.
				if (urlArr) {
					if (typeof urlArr === &quot;object&quot;)                // If an URL was found, log the URL...
						LOG(urlArr[1]);
					else                                           // ...else, log plain text.
						LOG(urlArr);
				}
			}
			aEvt.preventDefault();
			break;
		}
	}
};</code></pre>

<p><code>this.dragAndDropHandler</code> can be used by setting attributes...</p>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
// The &quot;drop&quot; event will not trigger if the &quot;dragover&quot; event is not declared.
this.setAttribute(&quot;ondragover&quot;, &quot;this.dragAndDropHandler.handleEvent(event);&quot;);

this.setAttribute(&quot;ondrop&quot;, &quot;this.dragAndDropHandler.handleEvent(event);&quot;);</code></pre>

<p>...or by adding event listeners.</p>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
var uid = &quot;__unique_identifier_&quot; + this.id;
if (!(uid in window)) { // Ensures that event listeners are added just once.
	window[uid] = true;
	// The &quot;drop&quot; event will not trigger if the &quot;dragover&quot; event is not declared.
	this.addEventListener(&quot;dragover&quot;, this.dragAndDropHandler, false);
	this.addEventListener(&quot;drop&quot;, this.dragAndDropHandler, false);
}</code></pre>

<h3>Example 2 - Simpler examples</h3>
<h4>By setting attributes</h4>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
// The &quot;drop&quot; event will not trigger if the &quot;dragover&quot; event is not declared.
this.ondragover = function (aEvt) {
	aEvt.preventDefault();
};

// This will log to the console all data types found in the droped data.
this.ondrop = function (aEvt) {
	var listOfTypes = [];
	for (var type = 0; type &lt; aEvt.dataTransfer.types.length; type++)
		listOfTypes.push(aEvt.dataTransfer.types[type]);
	LOG(listOfTypes.join(&quot;\n&quot;));
	aEvt.preventDefault();
};</code></pre>

<h4>By adding event listeners</h4>
<pre class="tweaked_by_odyseus"><code>/*Initialization code*/
var uid = &quot;__unique_identifier_&quot; + this.id;
if (!(uid in window)) { // Ensures that event listeners are added just once.
	window[uid] = true;
	// The &quot;drop&quot; event will not trigger if the &quot;dragover&quot; event is not declared.
	this.addEventListener(&quot;dragover&quot;, function (aEvt) {
		aEvt.preventDefault();
	}, false);

	// This will log to the console all data types found in the droped data.
	this.addEventListener(&quot;drop&quot;, function (aEvt) {
		var listOfTypes = [];
		for (var type = 0; type &lt; aEvt.dataTransfer.types.length; type++)
			listOfTypes.push(aEvt.dataTransfer.types[type]);
		LOG(listOfTypes.join(&quot;\n&quot;));
		aEvt.preventDefault();
	}, false);

}</code></pre>

<h3 id="nav_working_with_buttons-4">Examples of work with mouse clicks-different types of menu-the reaction of the button-etc</h3>
<h3>Button is pressed</h3>
<pre><code>this.checked = true;</code></pre>

<h3>Button is pressed</h3>
<pre><code>this.checked = false;</code></pre>

<h3>Processing mouse clicks</h3>
<pre><code>this.onclick = function (event) {
	if (event.button == 0) {
		// When you click LMB
	}
	else if (event.button == 1) {
		// When you click SCM
	}
	else if (event.button == 2 &amp;&amp; !event.ctrlKey &amp;&amp; !event.shiftKey &amp;&amp; !event.altKey &amp;&amp; !event.metaKey) {
		// When you click PTP no modifiers
	}
};
this.oncontextmenu = function (event) {
	if (event.button == 2 &amp;&amp; !event.ctrlKey &amp;&amp; !event.shiftKey &amp;&amp; !event.altKey &amp;&amp; !event.metaKey) {
		// Block context menu when clicking PTP no modifiers
		event.preventDefault();
		event.stopPropagation();
	}
};</code></pre>


<h3>Purpose mouse-move the shortcut menu button on SCM.</h3>

<pre><code>this.onclick = function (event) {
	
	if (event.button == 0){
		alert(&quot;LMB&quot;); // When you click LMB
	}
	
	
	else if (event.button == 1) {
		// When you click SCM 
		gShowPopup(this); // Show popup menu button
	}
	
	
	else if (event.button == 2 &amp;&amp; !event.ctrlKey &amp;&amp; !event.shiftKey &amp;&amp; !event.altKey &amp;&amp; !event.metaKey) {
		alert(&quot;PKM&quot;); // When you click PTP no modifiers 
	}
};

// Block context menu when clicking PTP no modifiers..............
this.oncontextmenu = function (event) {
	if (event.button == 2 &amp;&amp; !event.ctrlKey &amp;&amp; !event.shiftKey &amp;&amp; !event.altKey &amp;&amp; !event.metaKey) {
		event.preventDefault();
		event.stopPropagation();
	}
};</code></pre>

<h3>Changing images on the button when the mouse is clicked, etc (initialization)</h3>
<pre><code>// images encoded in base64. mouse over the button imgClosed imgOpen is not over the button button is pressed the Shad
var imgOpen = &quot;data:image/gif;base64,CODE&quot;;
var imgClosed = &quot;data:image/gif;base64,CODE&quot;;
var imgPress = &quot;data:image/gif;base64,CODE&quot;;

this.toggleImgOpen = function () {
	this.setAttribute(&quot;image&quot;,imgOpen);
}
this.toggleImgClosed = function () {
	this.setAttribute(&quot;image&quot;,imgClosed);
}
this.toggleImgPress = function () {
	this.setAttribute(&quot;image&quot;,imgPress);
}
this.setAttribute(&quot;onmouseover&quot;,&quot;this.toggleImgOpen();&quot;);
this.setAttribute(&quot;onmouseout&quot;, &quot;this.toggleImgClosed();&quot; );
this.setAttribute(&quot;onmousedown&quot;, &quot;this.toggleImgPress();&quot;);
this.toggleImgClosed();</code></pre>

<h3>Change the picture buttons</h3>
<pre><code>// icon - image encoded in base64 or the address of the file to the icon (for local addresses don't forget ol' double slashes in path)
var icon=&quot;data:image/x-icon;base64CODE&quot;;
//var icon=&quot;file:///C:\\WINDOWS\\pchealth\\helpctr\\System\\images\\16x16\\warning.gif&quot;
//var icon=&quot;chrome://global/skin/icons/information-16.png&quot;
this.image = icon; // changing the picture</code></pre>

<h3 id="">Hide dropmarker - for &quot;menu&quot; and/or &quot;menu-button&quot; types</h3>
<h3>Example 1</h3>
<pre class="from_russian_forum"><code>/*Initialization*/
this.hideDropMarker = function () {
	var dropMarker = document.getAnonymousElementByAttribute(self, &quot;class&quot;, &quot;toolbarbutton-menu-dropmarker&quot;);
	if (dropMarker) {
		dropMarker.setAttribute(&quot;hidden&quot;, &quot;true&quot;);
	} else {
		setTimeout(self.hideDropMarker, 10);
	}
}
this.hideDropMarker();</code></pre>
<h3>Example 2</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization*/
(function dropmarkerVisibility() {
	let dropMarker = document.getAnonymousElementByAttribute(self, &quot;class&quot;, &quot;toolbarbutton-menu-dropmarker&quot;);
	if (dropMarker)
		dropMarker.setAttribute(&quot;hidden&quot;, true);
	else
		setTimeout(function () {
			dropmarkerVisibility();
		}, 50);
})();</code></pre>

<h3 id="">Open menu on mouse over and hide on mouse out</h3>
<h3>Example 1</h3>
<pre class="from_russian_forum"><code>/*Initialization*/
this.timer = 0;

// Opens de menu on mouse over.
this.onmouseover = function (event) {
	this.open = true;
	clearTimeout(this.timer);
};

// Closes de menu on mouse out.
this.onmouseout = function (event) {
	if (!event.relatedTarget || Array.indexOf(this.getElementsByTagName(&quot;*&quot;), event.relatedTarget) === -1) {
		clearTimeout(this.timer);
		this.timer = setTimeout(function () {
				self.open = false;
			}, 200); // 200 - delay for closing the menu in milliseconds.
	}
};</code></pre>

<h3>Example 2 - variation with open delay</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization*/
this.timer = 0;

// Opens de menu on mouse over.
this.onmouseover = function () {
	clearTimeout(this.timer);
	this.timer = setTimeout(function () {
			self.open = true;
		}, 200); // 200 - delay for open the menu in milliseconds.
};

// Closes de menu on mouse out.
this.onmouseout = function () {
	clearTimeout(this.timer);
	this.timer = setTimeout(function () {
			self.open = false;
		}, 200); // 200 - delay for closing the menu in milliseconds.
};</code></pre>

<h3>Example 3 - variation targeting the menu popup</h3>
<pre class="tweaked_by_odyseus"><code>/*Initialization*/
let thisMenupopup = this.getElementsByTagName(&quot;menupopup&quot;)[0];

if (thisMenupopup) {
	this.timer = 0;

	// Opens de menu on mouse over.
	this.onmouseover = function () {
		clearTimeout(this.timer);
		this.timer = setTimeout(function () {
				thisMenupopup.openPopup(self, &quot;after_start&quot;, 0, 0, false, false);
			}, 200); // 200 - delay for open the menu in milliseconds.
	};

	// Closes de menu on mouse out.
	this.onmouseout = function () {
		clearTimeout(this.timer);
		this.timer = setTimeout(function () {
				thisMenupopup.hidePopup();
			}, 200); // 200 - delay for closing the menu in milliseconds.
	};
}</code></pre>

<h3>Different ways to move buttons</h3>

<h3>ID button</h3>
<pre><code>
	this.id
</code></pre>

<h3>Moving buttons 1</h3>
<pre><code>this.classList.remove(&quot;toolbarbutton-1&quot;);
document.getElementById(&quot;statusbar-display&quot;).appendChild(this);</code></pre>

<h3>Moving buttons 2</h3>
<pre><code>var idbut = this.id;
(function () {
	var appButton = document.getElementById(idbut);
	var navBar = document.getElementById('statusbar-display');
	navBar.insertBefore(appButton, navBar.lastChild);
})();</code></pre>

<h3>Adding or moving an element interface to the specified position</h3>
<pre><code>function addNewChildOnParentAtPosition(newChild, idParent, position) {
	try {
		var parent = window.document.getElementById(idParent);
		if ((null == position) || (-1 == position)) {
			parent.appendChild(newChild);
			return true;
		}
		if (parent.childNodes) {
			if (position &lt; parent.childNodes.length)
				parent.insertBefore(newChild, parent.childNodes[position]);
			else
				parent.appendChild(newChild);
		}
	} catch (ex) {
		custombuttons.alertSlide(&quot;Error!&quot;, &quot;Can not move the item!&quot;); //ERROR!!
		return false;
	}
	return true;
}</code></pre>

<h3>Append an item if there is not, if there is, going get the id element and skip creation.</h3>
<pre><code>var mytestb = window.document.createElement(&quot;toolbarbutton&quot;);
mytestb.setAttribute(&quot;id&quot;, &quot;mytestb127&quot;); //new item id
//the new item icon
mytestb.setAttribute(&quot;image&quot;, &quot;data:image/png;base64,CODE&quot;);
document.getElementById(&quot;toolbar-menubar&quot;).appendChild(mytestb); //Add an item in the menu-bar

var newChild = window.document.getElementById(&quot;mytestb127&quot;); // get an element by ID
var idParent = &quot;statusbar-display&quot;; //specify the ID of the parent element which will be moving
var position = 0; //the position numbers, or before after
addNewChildOnParentAtPosition(newChild, idParent, position); // call the move an item</code></pre>

<h3>Remove item from the context menu</h3>
<pre><code>var node = document.getElementById(&quot;Item ID&quot;);
if (node.parentNode) {
	node.parentNode.removeChild(node);
}</code></pre>

</div>
<!-- End content nav_working_with_buttons -->
<!-- Start content nav_notifications -->
<div class="cb-docs-section">
<h1 id="nav_notifications" class="page-header">Prompts, alerts, etc</h1>

	<h3>Examples of the various output messages, examples of data requests from the user and so forth</h3>

<h3 id="nav_notifications-1">Using Prompt Dialogs</h3>

<pre class="official_docs"><code>/*Code*/
createMsg(&quot;title&quot;).aMsg(&quot;message&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
custombuttons.alertBox(&quot;title&quot;, &quot;description&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
custombuttons.alertSlide(&quot;title&quot;, &quot;description&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
// close window or click cancel alerts &quot;false,default,false&quot;
var box = custombuttons.promptBox(&quot;title&quot;, &quot;description&quot;, &quot;default&quot;);
if (box[0]) {
	alert(box[0] + &quot;,&quot; + box[1] + &quot;,&quot; + box[2]);
} else {
	alert(box[0] + &quot;,&quot; + box[1] + &quot;,&quot; + box[2]);
}</code></pre>


<pre class="official_docs"><code>/*Code*/
// close window or click cancel alerts &quot;false,default,true&quot;
var box = custombuttons.promptBox(&quot;title&quot;, &quot;description&quot;, &quot;default&quot;, {
		value : true,
		prompt : &quot;option&quot;
	});
if (box[0]) {
	alert(box[0] + &quot;,&quot; + box[1] + &quot;,&quot; + box[2]);
} else {
	alert(box[0] + &quot;,&quot; + box[1] + &quot;,&quot; + box[2]);
}</code></pre>


<pre class="official_docs"><code>/*Code*/
// close window alerts &quot;option b&quot;
var box = custombuttons.confirmBox(&quot;title&quot;, &quot;description&quot;, &quot;option a&quot;, &quot;option b&quot;);
if (box) {
	alert(&quot;option a&quot;);
} else {
	alert(&quot;option b&quot;);
}</code></pre>


<pre class="official_docs"><code>/*Code*/
// close window alerts &quot;option c&quot;
var box = custombuttons.confirmBox3(&quot;title&quot;, &quot;description&quot;, &quot;option a&quot;, &quot;option c&quot;, &quot;option b&quot;);
if (box == 0)
	alert(&quot;option a&quot;);
if (box == 1)
	alert(&quot;option c&quot;);
if (box == 2)
	alert(&quot;option b&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
// close window or click cancel alerts &quot;false,option a&quot;
var arr = [&quot;option a&quot;, &quot;option b&quot;, &quot;option c&quot;];
var box = custombuttons.selectBox(&quot;title&quot;, &quot;description&quot;, arr);
if (box[0]) {
	alert(box[0] + &quot;,&quot; + arr[box[1].value]);
} else {
	alert(box[0] + &quot;,&quot; + arr[box[1].value]);
}</code></pre>


<pre class="official_docs"><code>/*Code*/
// close window or click no alerts &quot;option a,true,option b,true,option c,true&quot;
var arr = new Array();
arr[0] = [&quot;option a&quot;, true];
arr[1] = [&quot;option b&quot;, true];
arr[2] = [&quot;option c&quot;, true];
var dialog = custombuttons.checkboxDialog(this, arr,
		&quot;title&quot;, &quot;group&quot;, &quot;header&quot;, &quot;description&quot;, &quot;yes&quot;, &quot;no&quot;,
		&quot;help&quot;, &quot;help message&quot;, &quot;disclosure&quot;, &quot;disclosure message&quot;);
if (dialog) {
	alert(arr);
	for (var i = 0; i &lt; dialog.chosen.length; i++)
		alert(dialog.chosen[i].index + &quot;,&quot; + dialog.chosen[i].label);
} else {
	alert(arr);
}</code></pre>


<pre class="official_docs"><code>/*Code*/
// close window or click no alerts &quot;option a,true,option b,false,option c,false&quot;
var arr = new Array();
arr[0] = [&quot;option a&quot;, true];
arr[1] = [&quot;option b&quot;, false];
arr[2] = [&quot;option c&quot;, false];
var dialog = custombuttons.radioboxDialog(this, arr,
		&quot;title&quot;, &quot;group&quot;, &quot;header&quot;, &quot;description&quot;, &quot;yes&quot;, &quot;no&quot;,
		&quot;help&quot;, &quot;help message&quot;, &quot;disclosure&quot;, &quot;disclosure message&quot;);
if (dialog) {
	alert(arr);
	for (var i = 0; i &lt; dialog.chosen.length; i++)
		alert(dialog.chosen[i].index + &quot;,&quot; + dialog.chosen[i].label);
} else {
	alert(arr);
}</code></pre>

<h3 id="nav_notifications-not-function">Notification function - Firefox, SeaMonkey and Thunderbird</h3>
<p>This function is similar to the <code>custombuttons.alertSlide</code> function, but this one allows you to use a custom image. It also works (should) on platforms that don't implement <a href="https://developer.mozilla.org/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIAlertsService">nsIAlertsService</a>.</p>
<pre class="tweaked_by_odyseus"><code>function notifyme(aImg, aTitle, aMsg) {
	let notFeature = custombuttons.getPrefs(&quot;notification.feature.enabled&quot;);
	try {
		let nsIAlertsService = Cc['@mozilla.org/alerts-service;1'].getService(Ci.nsIAlertsService);
		if (!notFeature) {
			custombuttons.setPrefs(&quot;notification.feature.enabled&quot;, true);
			setTimeout(function () {
				nsIAlertsService.showAlertNotification(aImg, aTitle, aMsg, false, &quot;&quot;, null);
				custombuttons.setPrefs(&quot;notification.feature.enabled&quot;, false);
			}, 100);
		} else
			nsIAlertsService.showAlertNotification(aImg, aTitle, aMsg, false, &quot;&quot;, null);
	} catch (aEr) {
		let win = Cc['@mozilla.org/embedcomp/window-watcher;1']
			.getService(Ci.nsIWindowWatcher)
			.openWindow(null, 'chrome://global/content/alerts/alert.xul',
				'_blank', 'chrome,titlebar=no,popup=yes', null);
		win.arguments = [aImg, aTitle, aMsg, false, ''];
	}
}

// Usage
notifyme(&quot;chrome://branding/content/icon32.png&quot;, &quot;Title&quot;, &quot;Message&quot;);</code></pre>

<h3 id="nav_notifications-doorhanger">Doorhanger notifications - Firefox and SeaMonkey</h3>
<p>This is a very basic example of usage of the <a href="https://developer.mozilla.org/docs/Mozilla/JavaScript_code_modules/PopupNotifications.jsm">PopupNotifications.jsm</a> module.</p>
<pre class="tweaked_by_odyseus"><code>function notify(aMsg, aDel) {
	let nt = PopupNotifications.show(gBrowser.selectedBrowser, self.id +
			&quot;-Door-Hanger&quot;, aMsg, self.id, null, null, null);
	(aDel) &amp;&amp; nt.remove();
}

// Usage
notify(&quot;Message&quot;);          // Show door hanger notification
setTimeout(function () {
	notify(&quot;&quot;, true);         // Remove after...
}, 5000);                   // ...5 seconds.</code></pre>
<h3>Display a pop-up message option 1 native</h3>
<pre><code>
var alertsService = Cc["@mozilla.org/alerts-service;1"].getService(Ci.nsIAlertsService);
alertsService.showAlertNotification("chrome://global/skin/icons/information-32.png", "Title", "Message text", false, "", null, "");
</code></pre>

<h3>Display a pop-up message option 3 (the suspension of the program, and an OK button, the so-called Alert)</h3>
<pre><code>alert(&quot;Message text&quot;);</code></pre>

<pre><code>alert(&quot;1&quot;);</code></pre>

<pre><code>alert(n);
alert(n);</code></pre>

<h3>The ToolTip when the mouse pauses over the button</h3>
<pre><code>this.tooltipText = &quot;This is the ToolTip&quot;;</code></pre>

<h3>The ToolTip when the mouse pauses over the button option with the update information</h3>
<pre><code>var a = &quot;This is the ToolTip&quot;;
this.onmouseover = function (event) {
	this.tooltipText = a;
};</code></pre>

<h3>Draw text on the button for FF 3.6 (initialization)</h3>
<pre><code>var _this = this;
var text = &quot;Test&quot;; // text
var fontcolor = &quot;#ff1010&quot;; //the color of the text
var fontstyle = &quot;bold 12pt times&quot;; //font style
//---the dimensions of the button, the offset of the text, the size of the area to be cleaned look below


var canvas = document.createElementNS(&quot;http://www.w3.org/1999/xhtml&quot;, &quot;canvas&quot;);
canvas.setAttribute(&quot;id&quot;, &quot;canvas&quot;);
// the dimensions of the button
canvas.setAttribute(&quot;style&quot;, &quot;min-width:16px;width:35px;max-width:40px;min-height:16px;height:16px;max-height:28px;&quot;);
canvas.setAttribute(&quot;width&quot;, &quot;35&quot;);
canvas.setAttribute(&quot;height&quot;, &quot;16&quot;);
//
_this.appendChild(canvas);
_this.image = &quot;data:&quot;;
_this.setAttribute(&quot;class&quot;, &quot;&quot;);
var pn = _this.parentNode;
var ns = _this.nextSibling;
var button = pn.removeChild(this);
if (ns)
	pn.insertBefore(button, ns);
else
	pn.appendChild(button);

function drawtext() {
	var ctx = canvas.getContext('2d');
	ctx.save();
	ctx.clearRect(0, 0, 90, 16); // the size of the area to be cleaned so that the image does not devolve on the old
	ctx.restore();
	var width = canvas.width;
	var height = canvas.height;
	var ctx = canvas.getContext('2d');
	ctx.save();
	//----the piece draws a string, optionally add a string copy it below and set its parameters (size, color, offset style)
	ctx.translate(0, 14); //text offset
	ctx.fillStyle = fontcolor;
	ctx.mozTextStyle = fontstyle;
	ctx.mozDrawText(text);
	//---------------------------------------------------------------------------------------
	ctx.restore();
}
drawtext();</code></pre>

<h3>draw text on the button for FF 4 + (initialization)</h3>
<pre><code>var _this = this;
var text = &quot;Test&quot;; // text
var fontcolor = &quot;#ff1010&quot;; //the color of the text
var fontstyle = &quot;bold 12pt times&quot;; //font style
//---the dimensions of the button, the offset of the text, the size of the area to be cleaned look below


var canvas = document.createElementNS(&quot;http://www.w3.org/1999/xhtml&quot;, &quot;canvas&quot;);
canvas.setAttribute(&quot;id1&quot;, &quot;canvas&quot;);
//--------------- the dimensions of the button ------------------------
canvas.setAttribute(&quot;style&quot;, &quot;min-width:16px;width:35px;max-width:40px;min-height:16px;height:16px;max-height:28px;&quot;);
canvas.setAttribute(&quot;width&quot;, &quot;35&quot;);
canvas.setAttribute(&quot;height&quot;, &quot;16&quot;);
//-------------------------------------------------------
_this.appendChild(canvas);
_this.image = &quot;data:&quot;;
_this.setAttribute(&quot;class&quot;, &quot;&quot;);
var pn = _this.parentNode;
var ns = _this.nextSibling;
var button = pn.removeChild(this);
if (ns)
	pn.insertBefore(button, ns);
else
	pn.appendChild(button);

function drawtext() {
	var ctx = canvas.getContext('2d');
	ctx.save();
	ctx.clearRect(0, 0, 90, 16); // the size of the area to be cleaned so that the image does not devolve on the old
	ctx.restore();
	var width = canvas.width;
	var height = canvas.height;
	var ctx = canvas.getContext('2d');
	ctx.save();
	//----the piece draws a string, optionally add a string copy it below and set its parameters (size, color, offset style)
	ctx.translate(0, 14); //text offset
	ctx.fillStyle = fontcolor;
	ctx.mozTextStyle = fontstyle;
	ctx.fillText(text, 0, 0);
	//---------------------------------------------------------------------------------------
	ctx.restore();
}
drawtext();</code></pre>

<h3>Play sound only supports .wav format.</h3>
<pre><code>var sndfile = &quot;C:\\WINDOWS\\Media\\notify.wav&quot;; // path to the file, do not forget about double the squint-eyed in a way
var sound = Cc[&quot;@mozilla.org/sound;1&quot;].createInstance(Ci.nsISound);
sound.playSystemSound(sndfile);</code></pre>
<h3>Data input through the prompt invitation</h3>
<pre><code>var a = prompt(&quot;Enter the data\nin this line:&quot;);
alert(&quot;you have entered:\n&quot; + a);</code></pre>

<h3>Data input through the prompt invitation option 2 (with checkboxes)</h3>
<pre><code>var box = custombuttons.promptBox(&quot;Title&quot;, &quot;Text&quot;, &quot;previously entered value&quot;, {
		value : true,
		prompt : &quot;checkbox text&quot;
	}); // value:true - State of a checkbox by default
alert(&quot;OK-true;Cancel-false = &quot; + box[0] + &quot;\nThe value entered = &quot; + box[1] + &quot;\nState of the checkbox = &quot; + box[2]);</code></pre>
</div>
<!-- End content nav_notifications -->
<!-- Start content nav_working_with_files -->

<div class="cb-docs-section">
<h1 id="nav_working_with_files" class="page-header">Working with files</h1>

<h3 id="nav_working_with_files-launch-notepad">Launch Notepad</h3>
<pre class="official_docs"><code>/*Code*/
var localFile = Cc[&quot;@mozilla.org/file/local;1&quot;].
	createInstance(Ci.nsILocalFile);
localFile.initWithPath(&quot;C:\\WINDOWS\\system32\\notepad.exe&quot;);
localFile.launch();</code></pre>

<h3 id="nav_working_with_files-readme-in-notepad">Open README.txt File in Notepad</h3>
<pre class="official_docs"><code>/*Code*/
var localFile = Cc[&quot;@mozilla.org/file/local;1&quot;].
	createInstance(Ci.nsILocalFile);
var process = Cc[&quot;@mozilla.org/process/util;1&quot;].
	createInstance(Ci.nsIProcess);
var args = [&quot;C:\\Program Files\\Mozilla Firefox\\README.txt&quot;];
localFile.initWithPath(&quot;C:\\WINDOWS\\system32\\notepad.exe&quot;);
process.init(localFile);
process.run(false, args, args.length);</code></pre>


<h3 id="nav_working_with_files-userChrome-in-notepad">Open userChrome.css File in Notepad</h3>
<pre class="official_docs"><code>/*Code*/
// chrome folder does not exist by default
var file = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].
	getService(Ci.nsIProperties).
	get(&quot;UChrm&quot;, Ci.nsIFile);
file.append(&quot;userChrome.css&quot;);
var localFile = Cc[&quot;@mozilla.org/file/local;1&quot;].
	createInstance(Ci.nsILocalFile);
var process = Cc[&quot;@mozilla.org/process/util;1&quot;].
	createInstance(Ci.nsIProcess);
var args = [file.path];
localFile.initWithPath(&quot;C:\\WINDOWS\\system32\\notepad.exe&quot;);
process.init(localFile);
process.run(false, args, args.length);</code></pre>

<h3 id="nav_working_with_files-personal-folder-in-explorer">Open Personal Folder in Explorer</h3>
<pre class="official_docs"><code>/*Code*/
// single pane
var localFile = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].
	getService(Ci.nsIProperties).
	get(&quot;Home&quot;, Ci.nsILocalFile);
localFile.reveal();</code></pre>

<pre class="official_docs"><code>/*Code*/
// default view
var file = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].
	getService(Ci.nsIProperties).
	get(&quot;Home&quot;, Ci.nsIFile);
var localFile = Cc[&quot;@mozilla.org/file/local;1&quot;].
	createInstance(Ci.nsILocalFile);
var process = Cc[&quot;@mozilla.org/process/util;1&quot;].
	createInstance(Ci.nsIProcess);
var args = [&quot;/e,&quot;, file.path];
localFile.initWithPath(&quot;C:\\WINDOWS\\explorer.exe&quot;);
process.init(localFile);
process.run(false, args, args.length);</code></pre>

<h3 id="nav_working_with_files-cb-folder-in-cmd">Open custombuttons Folder in Command Prompt</h3>
<pre class="official_docs"><code>/*Code*/
var file = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].
	getService(Ci.nsIProperties).
	get(&quot;ProfD&quot;, Ci.nsIFile);
file.append(&quot;custombuttons&quot;);
var environment = Cc[&quot;@mozilla.org/process/environment;1&quot;].
	getService(Ci.nsIEnvironment);
var localFile = Cc[&quot;@mozilla.org/file/local;1&quot;].
	createInstance(Ci.nsILocalFile);
var process = Cc[&quot;@mozilla.org/process/util;1&quot;].
	createInstance(Ci.nsIProcess);
var args = [&quot;/k&quot;, &quot;cd /d &quot; + file.path + &quot; &amp; title Custom Buttons &amp; dir&quot;];
localFile.initWithPath(environment.get(&quot;ComSpec&quot;));
process.init(localFile);
process.run(false, args, args.length);</code></pre>

<h3 id="nav_working_with_files-open-any">Function to open any file/folder</h3>
<pre class="tweaked_by_odyseus"><code>function openPath(aPath, aArgs) {
	var nsIFile = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsIFile);
	nsIFile.initWithPath(aPath);
	try {
		if (nsIFile.isDirectory())                                   // If aPath is a Directory...
			nsIFile.reveal();                                          // ...try to open it.
		else if (!nsIFile.isDirectory() &amp;&amp; !nsIFile.isExecutable())  // If aPath is not a Directory nor an executable...
			nsIFile.launch();                                          // ...try to launch it.
		else if (!nsIFile.isDirectory() &amp;&amp; nsIFile.isExecutable()) { // If aPath is an executable, try to execute it.
			var process = Cc[&quot;@mozilla.org/process/util;1&quot;].createInstance(Ci.nsIProcess);
			try {
				process.init(nsIFile);                               // Initialize nsIProcess.
				(aArgs === undefined || aArgs[0] === &quot;&quot;)             // Check if there are arguments.
				 ? process.runw(false, null, null)                   // Run nsIFile WITHOUT arguments...
				 : process.runw(false, aArgs, aArgs.length);         // ...or run nsIFile WITH arguments.
			} catch (aError) {
				Cu.reportError(aError);
			}
		}
	} catch (aError) {
		Cu.reportError(aError);
	}
}</code></pre>

<h3>Usage</h3>
<b>Usage:</b> <code>openPath(aPath, aArgs);</code>
<ul>
	<li><b>aPath:</b> Any valid and existent path. Absolute or &quot;constructed&quot;.
		<ul>
			<li><b>Path examples absolute:</b><br>
			<code>"C:\\Windows\\notepad.exe" // Windows path</code><br>
			<code>"/usr/bin/kwrite" // "Linux" path</code></li>
			<li><b>Path example from <a href="https://developer.mozilla.org/docs/JavaScript_OS.File">OS.File API</a>:</b><br>
			<code>OS.Constants.Path.desktopDir // Desktop path in all platforms</code></li>
			<li><b>Path example from <a href="https://developer.mozilla.org/Add-ons/Code_snippets/File_I_O">"Directory service"</a>:</b><br>
			<code>Services.dirsvc.get("Desk", Ci.nsIFile) // Desktop path in all platforms</code></li>
			<li><b>Path example "constructed" with <a href="https://developer.mozilla.org/docs/JavaScript_OS.File">OS.File API</a>:</b><br>
			<code>OS.Path.join(OS.Constants.Path.libDir, "seamonkey.exe")</code></li>
			<li><b>Path example "constructed" with <a href="https://developer.mozilla.org/Add-ons/Code_snippets/File_I_O">"Directory service"</a>:</b><br>
			<code>let baseDir = Services.dirsvc.get("CurProcD", Ci.nsIFile);</code><br>
			<code>baseDir.append("seamonkey.exe");</code></li>
		</ul>
	</li>
	<li><b>aArgs:</b> An array of arguments. ONLY for executable files.
		<ul>
			<li><b>Example with one argument:</b><br>
			<code>["arg"]</code></li>
			<li><b>Example with n arguments:</b><br>
			<code>["arg-1", "arg-2", "arg-n"]</code></li>
		</ul>
	</li>
</ul>
<b style="background:#FFC6C6;"></b>
<div class="alert alert-info">
  <strong>Note: it's MANDATORY to use double backslashes &quot;\\&quot; in all Windows paths.</strong>
</div>

<pre class="tweaked_by_odyseus"><code>/**
 * Practical examples
 */

// Open Desktop directory on any platform
// Option 1
openPath(OS.Constants.Path.desktopDir);
// Option 2
openPath(Services.dirsvc.get(&quot;Desk&quot;, Ci.nsIFile));

// Open Home directory on any platform
// Option 1
openPath(OS.Constants.Path.homeDir);
// Option 2
openPath(Services.dirsvc.get(&quot;Home&quot;, Ci.nsIFile));

// Execute a new instace of Firefox with profile selector.
// Short version
openPath(OS.Path.join(OS.Constants.Path.libDir, &quot;firefox.exe&quot;), [&quot;-no-remote&quot;, &quot;-p&quot;]);
// or long version...
let profDir = Services.dirsvc.get(&quot;CurProcD&quot;, Ci.nsIFile);
profDir.append(&quot;firefox.exe&quot;);
openPath(profDir, [&quot;-no-remote&quot;, &quot;-p&quot;]);

// Execute a new instace of SeaMonkey with profile selector.
// Short version
openPath(OS.Path.join(OS.Constants.Path.libDir, &quot;seamonkey.exe&quot;), [&quot;-no-remote&quot;, &quot;-p&quot;]);
// or long version...
let profDir = Services.dirsvc.get(&quot;CurProcD&quot;, Ci.nsIFile);
profDir.append(&quot;seamonkey.exe&quot;);
openPath(profDir, [&quot;-no-remote&quot;, &quot;-p&quot;]);

// Execute Notepad in Windows.
openPath(&quot;C:\\Windows\\notepad.exe&quot;);

// Execute KWrite in Linux.
openPath(&quot;/usr/bin/kwrite&quot;);

// Open a Firefox profile called &quot;default&quot; in Linux.
openPath(&quot;/usr/bin/firefox&quot;, [&quot;-no-remote&quot;, &quot;-p&quot;, &quot;default&quot;]);</code></pre>

<h3 id="nav_working_with_files-various-examples">Examples of different functions to work with files(read/write/create) and launch programs</h3>
<h3>File creation function</h3>
<pre><code>
function addfile(parentpath, filename) {
	var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
	file.initWithPath(parentpath);
	file.append(filename);
	if (!file.exists() || !file.isFile()) { // if it doesn't exist, create
		file.create(Ci.nsIFile.NORMAL_FILE_TYPE, 0666);
	}
}
</code></pre>

<h3>Folder add function</h3>
<pre><code>
function adddir(parentpath, newdir) {
	var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
	file.initWithPath(parentpath);
	file.append(newdir);
	if (!file.exists() || !file.isDirectory()) { // if it doesn't exist, create
		file.create(Ci.nsIFile.DIRECTORY_TYPE, 0777);
	}
}
</code></pre>

<h3>Profile address</h3>
<pre><code>var currProfD = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].getService(Ci.nsIProperties).get(&quot;ProfD&quot;, Ci.nsIFile);
var profileDir = currProfD.path;</code></pre>

<h3>Doubling slashes in the path.</h3>
<pre><code>function slashdouble(path) {
	var path = path.replace(/\\/g, &quot;\\&quot;)
		return (path)
}</code></pre>

<h3>Function of reading from file</h3>
<pre><code>function readfile(parentdir, filename, fileout) {
	var filefullpath = parentdir + &quot;\\&quot; + filename;
	var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
	file.initWithPath(filefullpath);
	Cu.import(&quot;resource://gre/modules/NetUtil.jsm&quot;);
	NetUtil.asyncFetch(file, function (inputStream, status) {
		if (!Components.isSuccessCode(status)) {
			data = &quot;An error occured&quot;; // To notify Interval func on error
			return;
		}
		data = NetUtil.readInputStreamToString(inputStream, inputStream.available());
		if (!data) {
			data = &quot;File contains no data&quot;;
		} // To notify Interval func on empty file
	});
}
readfile(feedsdir, &quot;myfeeds.txt&quot;);
var xInterval = setInterval(function () {
		if (typeof(data) == &quot;undefined&quot;) {
			return;
		} else {
			alert(data);
			clearInterval(xInterval);
			// Parser code here, data is valid
		}
	}, 1101);</code></pre>

<h3>Open folder</h3>
<pre><code>var Dir = &quot;C:\\windows\\Media&quot;; // the path to a folder, do not forget about the double slashes in the path
var nsLocalFile = Components.Constructor(&quot;@mozilla.org/file/local;1&quot;, &quot;nsILocalFile&quot;, &quot;initWithPath&quot;);
new nsLocalFile(Dir).reveal();</code></pre>

<h3>Save the file with a choice</h3>
<pre><code>MyFile = &quot;test&quot;; //the contents of the file
MyFilename = &quot;test.txt&quot;; // the file name
var nsIFilePicker = Ci.nsIFilePicker;
var fp = Cc[&quot;@mozilla.org/filepicker;1&quot;]
	.createInstance(nsIFilePicker);
fp.init(window, &quot;&quot;, fp.modeSave);
fp.defaultString = MyFilename;
fp.appendFilters(fp.filterHTML);
fp.appendFilters(fp.filterAll);
if (fp.show() == fp.returnCancel)
	return;
var stream = Cc['@mozilla.org/network/file-output-stream;1']
	.createInstance(Ci.nsIFileOutputStream);
stream.init(fp.file, 0x02 | 0x20 | 0x08, 0666, 0);
stream.write(MyFile, MyFile.length);
stream.close();</code></pre>

<h3>Converting strings to unicode</h3>
<pre><code>var mytext = &quot;Text&quot;
	var uc = Cc[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;].createInstance(Ci.nsIScriptableUnicodeConverter);
uc.charset = &quot;utf-8&quot;;
unicodetext = uc.ConvertFromUnicode(mytext);</code></pre>

<h3>To create a new resource resource:rootc</h3>
<pre><code>//icon
// data:image/png;base64,CODE

Cu.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);
var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
file.initWithPath(&quot;C:\\&quot;);

var ios = Cc[&quot;@mozilla.org/network/io-service;1&quot;].getService(Ci.nsIIOService);
var rph = ios.getProtocolHandler(&quot;resource&quot;).QueryInterface(Ci.nsIResProtocolHandler);
var uri = ios.newFileURI(file);
rph.setSubstitution(&quot;rootc&quot;, uri);

alert(&quot;resource:rootc&quot;)
getBrowser().selectedTab = getBrowser().addTab(&quot;resource:rootc&quot;);</code></pre>

<h3>Start external program with arguments</h3>
<pre><code>var prgpath = &quot;C:\\windows\\ping.exe&quot;; // the path to the executable file, do not forget about the double slashes in the path
var args = ['-n', '6', 'google.com']; // arguments are separated by a space. i.e. string bla.exe -open &quot;c:\program files\ololo\ololo.txt&quot; will have arguments var args = ['-open','&quot;c:\program', 'files\ololo\ololo.txt&quot;'];
var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
file.initWithPath(prgpath);
var process = Cc[&quot;@mozilla.org/process/util;1&quot;].createInstance(Ci.nsIProcess);
process.init(file);
process.run(false, args, args.length);</code></pre>

<h3>Function writes to the file, overwriting</h3>
<pre><code>function data2fileoverwrite(filepath, data) {
	var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
	file.initWithPath(filepath);
	Cu.import(&quot;resource://gre/modules/NetUtil.jsm&quot;);
	Cu.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);

	var ostream = FileUtils.openSafeFileOutputStream(file)
		var converter = Cc[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;].createInstance(Ci.nsIScriptableUnicodeConverter);
	converter.charset = &quot;UTF-8&quot;;
	var istream = converter.convertToInputStream(data);

	// The last argument (the callback) is optional.
	NetUtil.asyncCopy(istream, ostream, function (status) {
		if (!Components.isSuccessCode(status)) {
			// Handle error!
			return;
		}
		// Data has been written to the file.
	});
};</code></pre>

<h3>Feature writing to a file by adding at the end</h3>
<pre><code>function append2file(filepath, text) {
	var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
	file.initWithPath(filepath);
	var stream = Cc[&quot;@mozilla.org/network/file-output-stream;1&quot;].createInstance(Ci.nsIFileOutputStream);
	var converter = Cc[&quot;@mozilla.org/intl/converter-output-stream;1&quot;].createInstance(Ci.nsIConverterOutputStream);
	stream.init(file, 0x02 | 0x10, 0664, 0);
	converter.init(stream, &quot;UTF-8&quot;, 0, 0x1010);
	converter.writeString(&quot;\u101D\u101A&quot;); //If you want to add a new row
	converter.writeString(text);
	converter.close();
	stream.close();
}
append2file(&quot;C:\\testfile.txt&quot;, &quot;ololololololo!&quot;);</code></pre>

<h3>Select the file and getting his path</h3>
<pre><code>const nsIFilePicker = Ci.nsIFilePicker;
var fp = Cc[&quot;@mozilla.org/filepicker;1&quot;].createInstance(nsIFilePicker);
fp.init(window, &quot;Select any file!&quot;, nsIFilePicker.modeOpen);
fp.appendFilters(nsIFilePicker.filterAll | nsIFilePicker.filterText);

var rv = fp.show();
if (rv == nsIFilePicker.returnOK || rv == nsIFilePicker.returnReplace) {
	var file = fp.file;
	// Get the path as string. Note that you usually won't
	// need to work with the string paths.
	var path = fp.file.path;
	alert(&quot;You have chosen a file:\n&quot; + path);
	// work with returned nsILocalFile...
}</code></pre>
</div>
<!-- End content nav_working_with_files -->
<!-- Start content nav_d -->
<div class="cb-docs-section">
<h1 id="nav_d" class="page-header">Working with clipboard, text data, etc</h1>

<h3 id="nav_d-1">Using Clipboards</h3>

<pre class="official_docs"><code>/*Code*/
// copy string to system clipboard
var clipboard = Cc[&quot;@mozilla.org/widget/clipboardhelper;1&quot;].
	getService(Ci.nsIClipboardHelper);
clipboard.copyString(&quot;test&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
// internal clipboard - uppercase write, read, clear
gClipboard.Write(document.location.href);
alert(gClipboard.Read());
gClipboard.Clear();
alert(gClipboard.Read());</code></pre>

<pre class="official_docs"><code>/*Code*/
// system clipboard - lowercase write, read, clear
gClipboard.write(content.document.location.href);
alert(gClipboard.read());
gClipboard.clear();
alert(gClipboard.read());</code></pre>

<h3 id="nav_d-2">Export Commands to Clipboard</h3>
<pre class="official_docs"><code>/*Code*/
var commands = document.getElementsByTagName(&quot;command&quot;);
var out = new Array();
var info = Cc[&quot;@mozilla.org/xre/app-info;1&quot;].
	getService(Ci.nsIXULAppInfo);
out.push(info.name + &quot; &quot; + info.version, &quot;&quot;);
out.push('windowtype=&quot;' + document.documentElement.getAttribute(&quot;windowtype&quot;) + '&quot;', &quot;&quot;);
for (var i = 0; i &lt; commands.length; i++) {
	var id = commands[i].getAttribute(&quot;id&quot;);
	var oncommand = commands[i].getAttribute(&quot;oncommand&quot;);
	if (id &amp;&amp; oncommand)
		out.push(id);
}
var req = new XMLHttpRequest();
req.open(&quot;GET&quot;, &quot;chrome://global/content/platformHTMLBindings.xml&quot;, false);
req.send(null);
var doc = req.responseXML;
var handlers = doc.getElementsByTagName(&quot;handler&quot;);
for (var i = 0; i &lt; handlers.length; i++) {
	var command = handlers[i].getAttribute(&quot;command&quot;);
	if (command &amp;&amp; out.indexOf(command) == -1)
		out.push(command);
}
var clipboard = Cc[&quot;@mozilla.org/widget/clipboardhelper;1&quot;].
	getService(Ci.nsIClipboardHelper);
clipboard.copyString(out.join(&quot;\r\n&quot;));</code></pre>

<h3 id="nav_d-3">Using Special Files</h3>
<pre class="official_docs"><code>/*Code*/
var file = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].
	getService(Ci.nsIProperties).
	get(&quot;Home&quot;, Ci.nsIFile);
alert(file.path);
var uri = Cc[&quot;@mozilla.org/network/io-service;1&quot;].
	getService(Ci.nsIIOService).
	newFileURI(file);
alert(uri.spec);
var localFile = file.QueryInterface(Ci.nsILocalFile);
localFile.reveal();</code></pre>


<h3 id="nav_d-4">Export Special Files to Clipboard</h3>
<pre class="official_docs"><code>/*Code*/
var ds = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].
	getService(Ci.nsIProperties);
var nsDirectoryServiceDefs = [&quot;AppData&quot;, &quot;ApplMenu&quot;, &quot;Buckt&quot;, &quot;CmDeskP&quot;, &quot;CmPrgs&quot;, &quot;CmStrt&quot;,
	&quot;CntlPnl&quot;, &quot;Cntls&quot;, &quot;CookD&quot;, &quot;CurProcD&quot;, &quot;CurWorkD&quot;, &quot;Desk&quot;, &quot;DeskP&quot;, &quot;DeskV&quot;, &quot;DfltDwnld&quot;,
	&quot;Docs&quot;, &quot;Drivs&quot;, &quot;DrvD&quot;, &quot;Exts&quot;, &quot;Favs&quot;, &quot;Fnts&quot;, &quot;GreD&quot;, &quot;Home&quot;, &quot;IntrntSts&quot;, &quot;ISrch&quot;, &quot;LibD&quot;,
	&quot;LocalAppData&quot;, &quot;LocApp&quot;, &quot;LocDocs&quot;, &quot;LocDsk&quot;, &quot;LocFrmwrks&quot;, &quot;Locl&quot;, &quot;LoclIntrntPlgn&quot;, &quot;LocPrfs&quot;,
	&quot;Mov&quot;, &quot;Music&quot;, &quot;netH&quot;, &quot;NetW&quot;, &quot;OS2Dir&quot;, &quot;Pct&quot;, &quot;Pers&quot;, &quot;Prfs&quot;, &quot;PrntHd&quot;, &quot;Prnts&quot;, &quot;ProgF&quot;,
	&quot;Progs&quot;, &quot;Rcnt&quot;, &quot;Shdwn&quot;, &quot;SndTo&quot;, &quot;Strt&quot;, &quot;SysD&quot;, &quot;TmpD&quot;, &quot;Tmpls&quot;, &quot;Trsh&quot;, &quot;ULibDir&quot;, &quot;UsrApp&quot;,
	&quot;UsrDocs&quot;, &quot;UsrDsk&quot;, &quot;UsrFrmwrks&quot;, &quot;UsrIntrntPlgn&quot;, &quot;UsrPrfs&quot;, &quot;WinD&quot;, &quot;XCurProcD&quot;, &quot;XDGDesk&quot;,
	&quot;XDGDocs&quot;, &quot;XDGDwnld&quot;, &quot;XDGMusic&quot;, &quot;XDGPict&quot;, &quot;XDGPubSh&quot;, &quot;XDGTempl&quot;, &quot;XDGVids&quot;, &quot;XpcomLib&quot;];
var nsAppDirectoryServiceDefs = [&quot;AChrom&quot;, &quot;AChromDL&quot;, &quot;APluginsDL&quot;, &quot;APlugns&quot;, &quot;AppRegD&quot;,
	&quot;AppRegF&quot;, &quot;ARes&quot;, &quot;BMarks&quot;, &quot;cachePDir&quot;, &quot;DefProfLRt&quot;, &quot;DefProfRt&quot;, &quot;DefRt&quot;, &quot;DLoads&quot;,
	&quot;ExtPrefDL&quot;, &quot;LclSt&quot;, &quot;PrefD&quot;, &quot;PrefDL&quot;, &quot;PrefDOverride&quot;, &quot;PrefF&quot;, &quot;PrfDef&quot;, &quot;ProfD&quot;, &quot;profDef&quot;,
	&quot;ProfDefNoLoc&quot;, &quot;ProfLD&quot;, &quot;SHARED&quot;, &quot;SrchF&quot;, &quot;SrchPluginsDL&quot;, &quot;SrchPlugns&quot;, &quot;UChrm&quot;, &quot;UHist&quot;,
	&quot;UMimTyp&quot;, &quot;UPnls&quot;, &quot;UsrSrchPlugns&quot;, &quot;UStor&quot;, &quot;XPIClnupD&quot;];
var nsBrowserDirectoryServiceDefs = [&quot;ExistingPrefOverride&quot;];
var nsXULAppAPI = [&quot;ProfDS&quot;, &quot;ProfLDS&quot;, &quot;UAppData&quot;, &quot;XREAppDist&quot;, &quot;XREExeF&quot;, &quot;XREExtDL&quot;,
	&quot;XRESysLExtPD&quot;, &quot;XRESysSExtPD&quot;, &quot;XREUSysExt&quot;];
var props = new Array();
var out = new Array();
props = props.concat(nsDirectoryServiceDefs);
props = props.concat(nsAppDirectoryServiceDefs);
props = props.concat(nsBrowserDirectoryServiceDefs);
props = props.concat(nsXULAppAPI);
for (var i = 0; i &lt; props.length; i++) {
	if (ds.has(props[i])) {
		var file = ds.get(props[i], Ci.nsIFile);
		if (file &amp;&amp; file.path) {
			out.push([props[i], file.path]);
		}
	}
}
out.sort(function (a, b) {
	return a[1] &gt; b[1]
});
var width = out.reduce(function (a, b) {
		return a[0].length &gt; b[0].length ? a : b
	})[0].length;
for (var i = 0; i &lt; out.length; i++) {
	out[i] = out[i][0] + Array(width + 2 - out[i][0].length).join(&quot; &quot;) + out[i][1];
}
var clipboard = Cc[&quot;@mozilla.org/widget/clipboardhelper;1&quot;].
	getService(Ci.nsIClipboardHelper);
clipboard.copyString(out.join(&quot;\r\n&quot;));</code></pre>

<h3 id="nav_d-5">The clipboard, change the conversion getting different values, and so forth</h3>
<h3>Obtain the value from the Clipboard</h3>
<pre><code>var text = custombuttonsUtils.gClipboard.read();</code></pre>

<h3>Write the value to the Clipboard</h3>
<pre><code>var text = &quot;This text will be placed into the Clipboard&quot;;
const gClipboardHelper = Cc[&quot;@mozilla.org/widget/clipboardhelper;1&quot;].
	getService(Ci.nsIClipboardHelper);
gClipboardHelper.copyString(text);</code></pre>

<h3>Attention!! If you add one of the components of the string (for example, if you enter through the prompt):</h3>
<h3>add it with a numeric variable is like adding rows to it around, use the following option: </h3>
<pre><code>var a = prompt(&quot;Enter the number of:&quot;);
var b = 5;
var n = a + b;
var m = (+a) + (+b);
alert(&quot;a=&quot; + a + &quot;\nb=5\na+b=&quot; + n + &quot;\n(+a)+(+b)=&quot; + m);
// do not forget about this feature of javascript</code></pre>

<h3>Break a line into pieces at a delimiter</h3>
<pre><code>var stroka = &quot;123=43*44o=lol*=rm8658oo*=uenrnk7n*=4upa6m&quot;;
var chkpoint = &quot;*=&quot;; // This separator
var arrayOfStrings = stroka.split(chkpoint);
pervyi_element = arrayOfStrings[0]; //is 123 = 43 * 44o = lol
vtoroi_element = arrayOfStrings[1]; //equal to rm8658oo
//etc</code></pre>

<h3>The length of the string</h3>
<pre><code>var stroka = &quot;envosnvrohnorhnsonhoisd&quot;;
alert(stroka + &quot;=&quot; + stroka.length + &quot; characters&quot;);</code></pre>

<h3>Get a piece of string</h3>
<pre><code>var stroka = &quot;1234567890&quot;;
alert(stroka.substring(4, 7)); // 567
alert(stroka.substring(5)); // 67890</code></pre>

<h3>Converting strings to unicode</h3>
<pre><code>var mytext = &quot;sdlgsdlgsdlvnlsfndn&quot;;
var uc = Cc[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;].createInstance(Ci.nsIScriptableUnicodeConverter);
uc.charset = &quot;utf-8&quot;;
unicodetext = uc.ConvertFromUnicode(mytext);</code></pre>

<h3>URL decoding with (unescape)</h3>
<pre><code>var nn = unescape('%64%6f%63%75%6d%65%6e');
alert(nn);</code></pre>

<h3>Insert text into the text area on page option 1.</h3>
<pre><code>var text = &quot;Pasted text&quot;;
var cmd = &quot;cmd_insertText&quot;;
var controller = document.commandDispatcher.getControllerForCommand(cmd);
if (controller &amp;&amp; controller.isCommandEnabled(cmd)) {
	controller = controller.QueryInterface(Ci.nsICommandController);
	var params = Cc[&quot;@mozilla.org/embedcomp/command-params;1&quot;]
		.createInstance(Ci.nsICommandParams);
	params.setStringValue(&quot;state_data&quot;, text);
	controller.doCommandWithParams(cmd, params);
}</code></pre>

<h3>Insert text into the text field on page option 2.</h3>
<pre><code>var intext = &quot;The pasted text&quot;;
var theBox = document.commandDispatcher.focusedElement;
var pos = theBox.selectionStart;
var text = theBox.value.substring(0, pos) + intext + theBox.value.substring(pos, theBox.value.length);
theBox.value = text;
theBox.setSelectionRange(pos, pos + intext.length);</code></pre>

<h3>Paste the code into the current page version 1.</h3>
<pre><code>vnachalo = &quot;&lt; b&gt;This bold text and a line at the top of the page&lt; b&gt;&lt; hr&gt;&quot;;
vkonec = &quot;&lt; br&gt;&lt; u&gt;The underlined text and picture &lt; img src='http://www.mozilla.org/favicon.ico'&gt; at the end of the page&lt;/ u&gt;&quot;;
content.document.body.innerHTML = vnachalo + content.document.body.innerHTML + vkonec; // remove spaces from HTML tags for it to work</code></pre>

<h3>Paste the code into the current page version 2.</h3>
<pre><code>
var begin = &quot;&lt; b&gt;This bold text and a line at the top of the page&lt; b&gt;&lt; hr&gt;&quot;;
var end = &quot;&lt; br &gt;&lt; u &gt;The underlined text and picture &lt; img src='http://www.mozilla.org/favicon.ico'&gt; at the end of the page&lt;/ u &gt;&quot;;
var doc = content.document; // remove spaces from HTML tags for it to work
var body = doc.body || doc.documentElement;
body.insertBefore(createDocumentFragment(begin), body.firstChild);
body.appendChild(createDocumentFragment(end));
function createDocumentFragment(html) {
	var tmp = doc.createElementNS(&quot;http://www.w3.org/1999/xhtml&quot;, &quot;div&quot;);
	tmp.innerHTML = html;
	var df = doc.createDocumentFragment();
	while (tmp.hasChildNodes())
		df.appendChild(tmp.firstChild);
	return df;
}
</code></pre>

<h3>Paste the code into the current page option 3.</h3>
<pre><code>
	var begin = &quot;&lt; b &gt;This bold text and a line at the top of the page&lt; b &gt;&lt; hr &gt;&quot;;
	var end = &quot;&lt; br &gt;&lt; u &gt;The underlined text and picture &lt; img src='http://www.mozilla.org/favicon.ico'&gt; at the end of the page&lt;/ u &gt;&quot;;
	var doc = content.document; // remove spaces from HTML tags for it to work
	var body = doc.body || doc.documentElement;
	body.insertBefore(createDiv(begin), body.firstChild);
	body.appendChild(createDiv(end));
	function createDiv(html) {
		var div = doc.createElementNS(&quot;http://www.w3.org/1999/xhtml&quot;, &quot;div&quot;);
		div.innerHTML = html;
		return div;
	}
</code></pre>

<h3>Getting the date 1.</h3>
<pre><code>
	var t=new Date();
	var y=1900+t.getYear();
	var min=t.getMinutes(); if (min&lt;10){min=&quot;0&quot;+min};
	var h=t.getHours();
	var m=t.getMonth();switch(m){case 0: m=&quot;Jan&quot;;break;case 1: m=&quot;Feb&quot;;break;case 2: m=&quot;Mar&quot;;break;case 3: m=&quot;Apr&quot;;break;case 4: m=&quot;May&quot;;break;case 5: m=&quot;Jun&quot;;break;case 6: m=&quot;Jul&quot;;break;case 7: m=&quot;Aug&quot;;break;case 8: m=&quot;Sep&quot;;break;case 9: m=&quot;Oct&quot;;break;case 10: m=&quot;Nov&quot;;break;default: m=&quot;Dec&quot;;}
	var d=t.getDate();
	var curdate=y+&quot;-&quot;+d+&quot;-&quot;+m+&quot;_&quot;+h+&quot;:&quot;+min;
	alert(curdate)
</code></pre>

<h3>Getting the date 2.</h3>
<pre><code>
	var t=new Date();
	var y=1900+t.getYear();
	var min=t.getMinutes(); if (min&lt;10){min=&quot;0&quot;+min};
	var h=t.getHours();
	var m = [&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;, &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;][t.getMonth()];
	var d=t.getDate();
	var curdate=y+&quot;-&quot;+d+&quot;-&quot;+m+&quot;_&quot;+h+&quot;:&quot;+min;
	alert(curdate)
</code></pre>
</div>
<!-- End content nav_d -->
<!-- Start content nav_working_with_urls -->

<div class="cb-docs-section">
<h1 id="nav_working_with_urls" class="page-header">Working with URLs, tabs, UI elements and so on</h1>

<h3 id="nav_working_with_urls-1">Open Pages - Firefox and SeaMonkey</h3>

<pre class="official_docs"><code>/*Code*/
// open page in the current tab
loadURI(&quot;http://www.google.com/&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
// open page in a new tab in the background
gBrowser.addTab(&quot;http://www.google.com/&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
// open page in a new tab in the foreground
gBrowser.selectedTab = gBrowser.addTab(&quot;http://www.google.com/&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
// open page in a new window
window.open(&quot;http://www.google.com/&quot;);</code></pre>


<h3 id="nav_working_with_urls-2">Open Sidebar - Firefox</h3>
<pre class="official_docs"><code>/*Code*/
// open page in the side panel
openWebPanel(&quot;Firefox&quot;, &quot;about:logo&quot;);</code></pre>


<pre class="official_docs"><code>/*Code*/
// open and close a page in the side panel
if (document.getElementById(&quot;sidebar-title&quot;).value) {
toggleSidebar();
} else {
openWebPanel(&quot;Firefox&quot;, &quot;about:logo&quot;);
}</code></pre>


<h3 id="nav_working_with_urls-3">Using Bookmarklets - Firefox and SeaMonkey</h3>
<pre class="official_docs"><code>javascript:(function(){alert('test');})();</code></pre>

<pre class="official_docs"><code>/*Code*/
loadURI(&quot;javascript:(function(){alert('test');})();&quot;);</code></pre>

<pre class="official_docs"><code>javascript:(function(){alert(&quot;test&quot;);})();</code></pre>

<pre class="official_docs"><code>/*Code*/
loadURI('javascript:(function(){alert(&quot;test&quot;);})();');</code></pre>

<pre class="official_docs"><code>/*Code*/
// google &quot;greasemonkey location hack&quot; for more information
content.document.location.href = &quot;javascript:(&quot; + function() {
alert(&quot;test&quot;);
} + &quot;)()&quot;;</code></pre>

<h3 id="nav_working_with_urls-4">Select Tabs - Firefox and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
// next tab
gBrowser.tabContainer.advanceSelectedTab(1, true);</code></pre>


<pre class="official_docs"><code>/*Code*/
// previous tab
gBrowser.tabContainer.advanceSelectedTab(-1, true);</code></pre>

<h3 id="nav_working_with_urls-5">Move Tabs - Firefox and SeaMonkey</h3>
<pre class="official_docs"><code>
/*Code*/
// move tab forward
if (gBrowser.selectedTab.nextSibling) gBrowser.moveTabForward();
else gBrowser.moveTabToStart();
</code></pre>

<pre class="official_docs"><code>/*Code*/
// move tab backward
if (gBrowser.selectedTab.previousSibling) gBrowser.moveTabBackward();
else gBrowser.moveTabToEnd();</code></pre>

<h3 id="nav_working_with_urls-6">Reload Tabs - Firefox and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
gBrowser.reloadTab(gBrowser.selectedTab);</code></pre>

<pre class="official_docs"><code>/*Code*/
gBrowser.reloadAllTabs();</code></pre>

<h3 id="nav_working_with_urls-7">Remove Tabs - Firefox and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
gBrowser.removeTab(gBrowser.selectedTab);</code></pre>

<pre class="official_docs"><code>/*Code*/
gBrowser.removeAllTabsBut(gBrowser.selectedTab);</code></pre>

<h3>Navigate History - Firefox and SeaMonkey</h3>

<pre class="official_docs"><code>/*Code*/
// go back to the first page
gBrowser.webNavigation.gotoIndex(0);</code></pre>

<pre class="official_docs"><code>/*Code*/
// go forward to the last page
gBrowser.webNavigation.gotoIndex(gBrowser.webNavigation.sessionHistory.count - 1);</code></pre>

<h3 id="nav_working_with_urls-8">Toggle Toolbars - Firefox</h3>
<pre class="official_docs"><code>/*Code*/
var toolbar = document.getElementById(&quot;toolbar-menubar&quot;);
var visibility = toolbar.getAttribute(&quot;autohide&quot;) == &quot;true&quot;;
setToolbarVisibility(toolbar, visibility);</code></pre>

<pre class="official_docs"><code>/*Code*/
var toolbar = document.getElementById(&quot;nav-bar&quot;);
var visibility = toolbar.collapsed;
setToolbarVisibility(toolbar, visibility);</code></pre>


<pre class="official_docs"><code>/*Code*/
var toolbar = document.getElementById(&quot;PersonalToolbar&quot;);
var visibility = toolbar.collapsed;
setToolbarVisibility(toolbar, visibility);</code></pre>


<pre class="official_docs"><code>/*Code*/
var toolbar = document.getElementById(&quot;addon-bar&quot;);
var visibility = toolbar.collapsed;
setToolbarVisibility(toolbar, visibility);</code></pre>


<h3 id="nav_working_with_urls-9">Toggle Find Bar - Firefox, SeaMonkey and Thunderbird</h3>

<pre><code>
/*Code*/
var toolbar = document.getElementById(&quot;FindToolbar&quot;);
toolbar.hidden ? toolbar.onFindCommand() : toolbar.close();
</code></pre>

<h3 id="nav_working_with_urls-10">Toggle Tab Strip - Firefox and SeaMonkey</h3>

<pre><code>
/*Code*/
gBrowser.setStripVisibilityTo(!gBrowser.getStripVisibility());
</code></pre>

<h3 id="nav_working_with_urls-11">Execute Menu Item Command</h3>

<pre><code>
/*Code*/
document.getElementsByAttribute(&quot;label&quot;, &quot;Troubleshooting Information&quot;)[0].doCommand();
</code></pre>


<pre><code>
/*Code*/
// unicode hexadecimal 2026 - horizontal ellipsis character
document.getElementsByAttribute(&quot;label&quot;, &quot;Add new button\u2026&quot;)[0].doCommand();
</code></pre>

<h3 id="nav_working_with_urls-12">Observe Attribute Example - Firefox, SeaMonkey and Thunderbird</h3>

<pre><code>
/*Initialization code*/
// toggle attribute in customize toolbar window
var info = Cc[&quot;@mozilla.org/xre/app-info;1&quot;].
getService(Ci.nsIXULAppInfo);
var toolbox;
if (info.name == &quot;Firefox&quot; || info.name == &quot;SeaMonkey&quot;) {
toolbox = document.getElementById(&quot;navigator-toolbox&quot;);
}
if (info.name == &quot;Thunderbird&quot;) {
toolbox = document.getElementById(&quot;mail-toolbox&quot;);
}
var ob = &lt;observes
xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;
element={toolbox.id}
attribute=&quot;iconsize&quot;
onbroadcast={&quot;document.getElementById('&quot; + this.id + &quot;').change()&quot;}/&gt;;
this.appendChild(custombuttonsUtils.makeXML(ob));
this.change = function() {
if (toolbox.getAttribute(&quot;iconsize&quot;) == &quot;small&quot;) {
this.image = &quot;chrome://global/skin/icons/information-16.png&quot;;
alert('attribute for the &quot;Use Small Icons&quot; option is checked');
}
if (toolbox.getAttribute(&quot;iconsize&quot;) == &quot;large&quot;) {
this.image = &quot;chrome://global/skin/icons/information-24.png&quot;;
alert('attribute for the &quot;Use Small Icons&quot; option is not checked');
}
}
this.change();
</code></pre>
<h3 id="nav_working_with_urls-13">Various examples of the addresses-tabs-windows-and other things</h3>
<h3>Management of the browser window.</h3>
<pre class="from_russian_forum"><code>
	window.restore(); // Restore
	window.maximize(); // Expand
	window.minimize() // Collapse
	window.close(); // Close
	goQuitApplication();// Close all windows
	window.moveTo(0,0);// Move the window to the specified coordinates (upper left corner)
	window.resizeTo(1024,738);// Resize the window
</code></pre>

<h3>OPEN a new window size half the screen with the address or arbitrary html code.</h3>
<pre class="from_russian_forum"><code>
	var urla = &quot;http://custombuttons.mozdev.org/&quot;//---set the address or write code as in the line below
	var urlb = &quot;data:text/html,ololo!&quot;; //just text ololo!
	// 2 lines below to clear 1-HTML code of the page 2-collect the entire address
	var pagecode='&lt;html&gt;&lt;head&gt;&lt;title&gt;The title of the page&lt;/title&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;hr&gt;&lt;font size=+2 color=#ff1010&gt;&lt;b&gt;TEST&lt;/b&gt;&lt;/font&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;';
	var urlc = &quot;data:text/html,&quot;+pagecode;
	
	var sizex = screen.width/2; //------screen width/2
	var sizey = screen.height/2; //-----screen height/2
</code></pre>

<h3>Setup window:
	resizable   -  changing dimensions
	scrollbars  -  Show scroll bars
	menubar     -  the menu bar
	toolbar     -  browser panel
	location    -  Panel with the address bar
	personalbar -  custom panels
	status      -  status bar
</h3>
<pre class="from_russian_forum"><code>
	var winfeatures='resizable=yes,scrollbars=yes,menubar=yes,toolbar=yes,location=yes,personalbar=yes,status=yes,width=' + sizex + ',height=' +sizey;
	var wnd = window.open(url, this.name,winfeatures ); // actually open the window with the address url and settings winfeatures
	if (wnd.focus) wnd.focus(); 
</code></pre>

<h3>Add the current page to a specified folder in bookmarks</h3>
<pre class="from_russian_forum"><code>
	var folderName = &quot;test&quot;;
	var bmsvc = Cc[&quot;@mozilla.org/browser/nav-bookmarks-service;1&quot;].getService(Ci.nsINavBookmarksService);
	var menuFolder = bmsvc. bookmarksMenuFolder;
	var f = bmsvc. getChildFolder (menuFolder, folderName);
	if (f == 0){ bmsvc. createFolder (menuFolder, folderName, bmsvc. DEFAULT_INDEX);
	f = bmsvc. getChildFolder (menuFolder, folderName);}
	PlacesCommandHook. bookmarkCurrentPage (false, f);
</code></pre>

<h3>Open the url in a new tab without validation</h3>
<pre><code>
	var url=&quot;http://custombuttons.mozdev.org/&quot;;
	getBrowser (). selectedTab = getBrowser (). addTab (url);
</code></pre>

<h3>Open the url in a new tab if it is not empty, if empty then the current</h3>
<pre><code>
	var url=&quot;http://custombuttons.mozdev.org/&quot;;
	if (getBrowser().currentURI.spec == &quot;about:blank&quot;) loadURI (url);
	else{ getBrowser (). selectedTab = getBrowser (). addTab (url);
	};
</code></pre>

<h3>Open the url in a new tab if it is not empty, if empty then the current option 2. for FF 4+ </h3>
<pre><code>
	var url = &quot;http://custombuttons.mozdev.org/&quot;;
	if (
	(
	gBrowser.currentURI.spec == &quot;about:blank&quot;
	|| gBrowser.currentURI.spec == cbu.getPrefs(&quot;browser.newtab.url&quot;)
	)
	&amp;&amp; !gBrowser.selectedBrowser.webProgress.isLoadingDocument
	)
	loadURI(url);
	else
	gBrowser.selectedTab = gBrowser.addTab(url);
</code></pre>

<h3>Open a url in the current tab</h3>
<pre><code>
	var url=&quot;http://custombuttons.mozdev.org/&quot;;
	loadURI (url);
</code></pre>

<h3>Get the address of the current page</h3>
<pre><code>
	var url=getBrowser().currentURI.spec;
</code></pre>

<h3>Listener to load the page.</h3>
<pre><code>
	var appcontent = document.getElementById(&quot;appcontent&quot;);
	appcontent.removeEventListener(&quot;DOMContentLoaded&quot;, pageloadedok, true);
	appcontent.addEventListener(&quot;DOMContentLoaded&quot;, pageloadedok, true);
	function pageloadedok(){custombuttons.alertSlide(&quot;Page loaded&quot;,&quot;Page loaded&quot;)}
</code></pre>

<h3>Listener values change URL bar</h3>
<pre><code>
	var myExt_urlBarListener = {
		QueryInterface: function (aIID)
		{
			if (aIID.equals(Ci.nsIWebProgressListener) ||
			aIID.equals(Ci.nsISupportsWeakReference) ||
			aIID.equals(Ci.nsISupports))
			return this;
			throw Cr.NS_NOINTERFACE;
		},
		
		onLocationChange: function (aProgress, aRequest, aURI)
		{
			setTimeout(urlbarvaluechanged, 300);    
		},
		
		onStateChange: function (a, b, c, d) {},
		onProgressChange: function (a, b, c, d, e, f) {},
		onStatusChange: function (a, b, c, d) {},
		onSecurityChange: function (a, b, c) {}
	};
	
	gBrowser.addProgressListener(myExt_urlBarListener,Ci.nsIWebProgress.NOTIFY_LOCATION);
	function urlbarvaluechanged(){custombuttons.alertSlide(&quot;urlbar value changed&quot;, &quot;on &quot;+gURLBar.value);}
</code></pre>

<h3>Getting the current IP with duplicate in case the first server is unavailable.</h3>
<pre><code>
	var xmlhttp = new XMLHttpRequest();
	xmlhttp.open('GET', 'http://ip.xss.ru/', true);
	xmlhttp.onreadystatechange = function () {
		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {
				var ip = xmlhttp.responseText;
				ipok = ip. match (/\d?\d?\d\.\d?\d?\d\.\d?\d?\d\.\d?\d?\d/) [0];
				alert(&quot;1=&quot;+ipok);
				return ipok; 
			} else { getipalt(); }
			
		} 
	};
	xmlhttp.send(null);
	
	function getipalt(){
		xmlhttp.open('GET', 'http://www.myip.ru/ru-RU/index.php', true);
		xmlhttp.onreadystatechange = function () {
			if (xmlhttp.readyState == 4) {
				if (xmlhttp.status == 200) {
					var ip = xmlhttp.responseText;
					
					ipok = ip. match (/\d?\d?\d\.\d?\d?\d\.\d?\d?\d\.\d?\d?\d/) [0];
					alert(&quot;2=&quot;+ipok);
					return ipok; 
				}
			}
		};
		xmlhttp.send(null);     
	}
</code></pre>
</div>
<!-- End content nav_working_with_urls -->
<!-- Start content nav_f -->
<div class="cb-docs-section">
<h1 id="nav_f" class="page-header">Working with preferences (about:config)</h1>

<h3 id="nav_f-1">Open Config Manager</h3>

<pre class="official_docs"><code>/*Code*/
toOpenWindowByType(&quot;Preferences:ConfigManager&quot;, &quot;chrome://global/content/config.xul&quot;);</code></pre>

<h3 id="nav_f-2">Using Preferences</h3>
<h3 id="nav_f-2-pref-existence">Test preference existence</h3>

<h4>Custom Buttons' built-in</h4>
<pre class="official_docs"><code>/*Code*/
// test whether a preference exists
alert(custombuttons.isPref(&quot;dom.disable_open_during_load&quot;));
// Will alert "true" if the preference exists or "false" if it doesn't.</code></pre>

<h4>Native code - Using &quot;Services&quot; module</h4>
<pre class="tweaked_by_odyseus"><code>var prefType = Services.prefs.getPrefType(&quot;preference.name&quot;);

if (prefType === 0) // Inexistent
	alert(&quot;Preference doesn't exists.&quot;);
else if (prefType === 32) // String
	alert(&quot;Preference type is 'string'.&quot;);
else if (prefType === 64) // Integer
	alert(&quot;Preference type is 'integer'.&quot;);
else if (prefType === 128) // Boolean
	alert(&quot;Preference type is 'boolean'.&quot;);</code></pre>

<h3 id="nav_f-2-pref-get-value">Get preference value</h3>
<h4>Custom Buttons' built-in</h4>
<pre class="official_docs"><code>/*Code*/
// get preference
alert(custombuttons.getPrefs(&quot;dom.disable_open_during_load&quot;));</code></pre>

<h4>Native code - Using &quot;Services&quot; module</h4>
<pre class="tweaked_by_odyseus"><code>Services.prefs.getBoolPref("preference.name"); // Get "boolean" type preference

Services.prefs.getIntPref("preference.name"); // Get "integer" type preference

Services.prefs.getCharPref("preference.name"); // Get "string" type preference

Services.prefs.getComplexValue("preference.name",
		Ci.nsISupportsString).data; // Get "string" type preference with UNICODE support</code></pre>

<div class="panel-group" id="getchar-getcomplex-diff-accordion">
	<div class="panel panel-info">
		<div class="panel-heading">
<h5 class="panel-title"><a data-toggle="collapse" data-parent="#getchar-getcomplex-diff-accordion" href="#getchar-getcomplex-diff">
Differences between <em>getCharPref</em> and <em>getComplexValue</em></a></h5>
		</div>
		<div id="getchar-getcomplex-diff" class="panel-collapse collapse">
			<div class="panel-body">
<p>Given a &quot;string&quot; type preference with the value <em>C:\Folder\&#1087;&#1072;&#1087;&#1082;&#1072;\&#12501;&#12457;&#12523;&#12480;\&#22841;</em> (It's a Windows path with words in Russian, Japanese and Chinese).</p>
<p>Using <code>getCharPref</code> will output...</p>
<div class="centered_image">
<img src="lib/img/CBDoc-StringPref-1.png" />
<img width="32" height="32" src="lib/img/CBDoc-Thumb-Down.png" />
</div><br>
<p>And using <code>getComplexValue</code> will output...</p>
<div class="centered_image">
<img src="lib/img/CBDoc-StringPref-2.png" />
<img width="32" height="32" src="lib/img/CBDoc-Thumb-Up.png" />
</div><br>
			</div>
		</div>
	</div>
</div>

<h3 id="nav_f-2-pref-set-value">Set preference value</h3>
<h4>Custom Buttons' built-in</h4>
<pre class="official_docs"><code>/*Code*/
// set preference
custombuttons.setPrefs(&quot;dom.disable_open_during_load&quot;, false);</code></pre>

<pre class="official_docs"><code>/*Code*/
// toggle preference
var s = &quot;dom.disable_open_during_load&quot;;
custombuttons.setPrefs(s, !custombuttons.getPrefs(s));</code></pre>

<h4>Native code - Using &quot;Services&quot; module</h4>
<pre class="tweaked_by_odyseus"><code>
Services.prefs.setBoolPref(&quot;preference.name&quot;, true); // Set &quot;boolean&quot; type preference

Services.prefs.setBoolPref(&quot;preference.name&quot;,
	!Services.prefs.getBoolPref(&quot;preference.name&quot;)); // Toggle &quot;boolean&quot; type preference

Services.prefs.setIntPref(&quot;preference.name&quot;, 100); // Set &quot;integer&quot; type preference

Services.prefs.setCharPref(&quot;preference.name&quot;, &quot;Preference Value&quot;); // Set &quot;string&quot; type preference

// Set &quot;string&quot; type preference with UNICODE support
var str = Cc[&quot;@mozilla.org/supports-string;1&quot;].createInstance(Ci.nsISupportsString);
str.data = &quot;Preference &#20540;&quot;;
Services.prefs.setComplexValue(&quot;preference.name&quot;, Ci.nsISupportsString, str);
</code></pre>

<h3 id="nav_f-2-pref-other-methods">Other methods for handling preferences</h3>

<h4>Clear preference - Custom Buttons' built-in</h4>
<pre class="official_docs"><code>/*Code*/
// clear preference
custombuttons.clearPrefs(&quot;dom.disable_open_during_load&quot;);</code></pre>

<h4>Clear preference - Native code using &quot;Services&quot; module</h4>
<p>Called to clear a user set value from a specific preference. This will, in effect, reset the value to the default value. If no default value exists the preference will cease to exist.</p>
<pre class="tweaked_by_odyseus"><code>Services.prefs.clearUserPref("preference.name");</code></pre>

<h4>Observe Preferences - Firefox, SeaMonkey and Thunderbird</h4>
<pre class="official_docs"><code>/*Initialization code*/
// toggle preference in about:config
var prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]
	.getService(Ci.nsIPrefBranch);
var pref = &quot;dom.disable_open_during_load&quot;;
this.change = function () {
	var s = &quot;test 1\n&quot;; // increment to test observer
	if (prefs.getBoolPref(pref))
		alert(s + 'preference for the &quot;Block pop-up windows&quot; option is true');
	else
		alert(s + 'preference for the &quot;Block pop-up windows&quot; option is false');
};
this.obj = new Object();
this.obj.observe = this.change.bind(this);
// comment out the next line to disable observer
prefs.addObserver(pref, this.obj, false);
this.onDestroy = function (reason) {
	if (reason == &quot;update&quot;) {
		prefs.removeObserver(pref, this.obj);
	}
	if (reason == &quot;delete&quot;) {
		prefs.removeObserver(pref, this.obj);
		alert(&quot;observer unregistered&quot;);
	}
};</code></pre>

<h4><code>deleteBranch</code></h4>
<p>Called to remove all of the preferences referenced by this branch.</p>
<pre class="tweaked_by_odyseus"><code>var prefBranch = Services.prefs.getBranch(&quot;&quot;);

prefBranch.deleteBranch(&quot;extensions.custombuttons.&quot;); // Will DELETE ALL preferences from this branch</code></pre>

<h4><code>getChildList</code></h4>
<p>Returns an array of strings representing the child preferences of the root of this branch.</p>
<pre class="tweaked_by_odyseus"><code>var customButtonsBranch = Services.prefs.getChildList(&quot;extensions.custombuttons.&quot;, {});

// Log to console all preferences from &quot;extensions.custombuttons.&quot; branch
LOG(customButtonsBranch.join(&quot;\n&quot;));</code></pre>

<h4><code>lockPref</code></h4>
<p>Called to lock a specific preference. Locking a preference will cause the preference service to always return the default value regardless of whether there is a user set value or not.</p>
<pre class="tweaked_by_odyseus"><code>Services.prefs.lockPref(&quot;preference.name&quot;);</code></pre>

<h4><code>prefIsLocked</code></h4>
<p>Called to check if a specific preference is locked. If a preference is locked calling its Get method will always return the default value.</p>
<pre class="tweaked_by_odyseus"><code>alert(Services.prefs.prefIsLocked(&quot;preference.name&quot;));
// Will alert &quot;true&quot; if preference is locked or &quot;false&quot; if it's not locked.</code></pre>

<h4><code>unlockPref</code></h4>
<p>Called to unlock a specific preference. Unlocking a previously locked preference allows the preference service to once again return the user set value of the preference.</p>
<pre class="tweaked_by_odyseus"><code>Services.prefs.unlockPref(&quot;preference.name&quot;);</code></pre>

<h4><code>prefHasUserValue</code></h4>
<p>Called to check if a specific preference has a user value associated to it.</p>
<pre class="tweaked_by_odyseus"><code>alert(Services.prefs.prefHasUserValue(&quot;preference.name&quot;));
// Will alert &quot;true&quot; if preference has a user set value or &quot;false&quot; if it doesn't.</code></pre>

<h3 id="nav_f-4">Examples of read-write config settings and registry windows</h3>
<h3>Check whether there is a setting in about: config (CustomButton's built-in)</h3>
<pre><code>
	var n=custombuttons.isPref(&amp;amp;quot;dom.disable_open_during_load&amp;amp;quot;);
	alert(n);
</code></pre>

<h3>Get a parameter value in about:config (CustomButton's built-in)</h3>
<pre><code>
	var n=custombuttons.getPrefs(&quot;image.http.accept&quot;);
	alert(n);
</code></pre>

<h3>Set the value in about: config (CustomButton's built-in)</h3>
<pre><code>
	var n=&quot;browser.download.dir&quot;;//option
	var z=&quot;C:\Documents and Settings\Administrator\Desktop&quot;;//Boolean value to set 0-false 1-true
	custombuttons.setPrefs(n,z);
</code></pre>

<h3>Reset the value in about:config (CustomButton's built-in)</h3>
<pre><code>
	custombuttons.clearPrefs(&quot;dom.disable_open_during_load&quot;);
</code></pre>

<h3>Toggle boolean value in about:config (CustomButton's built-in)</h3>
<pre><code>
	var s = &quot;dom.disable_open_during_load&quot;;
	custombuttons.setPrefs(s, !custombuttons.getPrefs(s));
</code></pre>

<h3>Set the value in about:config (native means (Firefox))</h3>
<h3>When a data type does not match, see note!</h3>
<pre><code>
	var prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;].getService(Ci.nsIPrefService);
	this.PS = Cc['@mozilla.org/preferences-service;1'] .getService(Ci.nsIPrefBranch);
	var n=&quot;browser.download.dir&quot;;//option
	var z=&quot;C:\Documents and Settings\Administrator\Desktop&quot;;//Boolean value to set 0-false 1-true
	this.PS.setBoolPref(n,z);//for Boolean
	this.PS.setCharPref(n,z);//for string
	this.PS.setIntPref(n,z);//for integer
</code></pre>

<h3>Get a parameter value in about:config (native means (Firefox))</h3>
<h3>If the data type is a mistake, see note!</h3>
<pre><code>
	var prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;].getService(Ci.nsIPrefService);
	this.PS = Cc['@mozilla.org/preferences-service;1'] .getService(Ci.nsIPrefBranch);
	var n=&quot;browser.download.dir&quot;;//option
	var z=this.PS.getBoolPref(n);//for Boolean
	var z=this.PS.getCharPref(n);//for string
	var z=this.PS.getIntPref(n);//for integer
</code></pre>

<h3>Reset the value in about:config (native means (Firefox))</h3>
<pre><code>
	this.PS = Cc['@mozilla.org/preferences-service;1'] .getService(Ci.nsIPrefBranch);
	var n=&quot;general.useragent.override&quot;;//option
	this.PS.clearUserPref(n);
</code></pre>

<h3>Obtain the value from the Windows registry</h3>
<pre><code>
	var path=&quot;SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon&quot;;
	var pref=&quot;DefaultDomainName&quot;;
	var wrk = Cc[&quot;@mozilla.org/windows-registry-key;1&quot;].createInstance(Ci.nsIWindowsRegKey);
	wrk.open(wrk.ROOT_KEY_LOCAL_MACHINE,path,wrk.ACCESS_READ);
	
	/* -Description:
		wrk.ROOT_KEY_LOCAL_MACHINE - Select the registry key:
		ROOT_KEY_CLASSES_ROOT - HKEY_CLASSES_ROOT
		ROOT_KEY_CURRENT_USER - HKEY_CURRENT_USER
		ROOT_KEY_LOCAL_MACHINE-HKEY_LOCAL_MACHINE
		----------------
		wrk.ACCESS_READ-Select the type of access
		ACCESS_READ - for reading
		ACCESS_WRITE - for record-creation
		ACCESS_ALL - both
		---------------------------------
		wrk.readStringValue(pref) - data type (see box below)
		readStringValue() - string
		readBinaryValue() - binary
		readIntValue() - integer
	readInt64Value()- Advanced */
	
	var znachenie = wrk.readStringValue(pref);
	alert(znachenie);
	wrk.close();
</code></pre>

<h3>Write the value to the Windows registry</h3>
<pre><code>
	var path=&quot;SOFTWARE\\MDC\\Test&quot;;
	var pref=&quot;BorgWasHere&quot;;
	var znachenie=&quot;Resistance is Futile! Resistance is Futile!&quot;
	var wrk = Cc[&quot;@mozilla.org/windows-registry-key;1&quot;].createInstance(Ci.nsIWindowsRegKey);
	wrk.create(wrk.ROOT_KEY_CURRENT_USER,path,wrk.ACCESS_WRITE);
	
	/*-Description:
		wrk.ROOT_KEY_LOCAL_MACHINE - Select the registry key: 
		ROOT_KEY_CLASSES_ROOT -  HKEY_CLASSES_ROOT
		ROOT_KEY_CURRENT_USER -  HKEY_CURRENT_USER
		ROOT_KEY_LOCAL_MACHINE -  HKEY_LOCAL_MACHINE
		----------------
		wrk.ACCESS_READ - Select the type of access
		ACCESS_READ - for reading
		ACCESS_WRITE - for record-creation
		ACCESS_ALL - both
		---------------------------------
		wrk.readStringValue(pref) - data type (see box below)
		readStringValue() - string
		readBinaryValue() - binary
		readIntValue() - integer
	readInt64Value()- Advanced */
	
	wrk.writeStringValue(pref,znachenie);
	wrk.close();
</code></pre>

<h3>Open about:config in a separate window</h3>
<pre><code>
	toOpenWindowByType(&quot;Preferences:ConfigManager&quot;, &quot;chrome://global/content/config.xul&quot;);
</code></pre>

<h3>Work with about:config and files</h3>
<h3>Work with about:config and files.
	Getting the text entry in about:config.
	Optimized code to create groups of settings.
	Test if file exists.
Deleting a file (with validation).</h3>

<h3>Save the text in about:config</h3>
<pre><code>
	var text = &amp;quot;Tools for creators of Custom Buttons&amp;quot;;
	var pref = &amp;quot;custombuttons.button.test.text&amp;quot;;
	Application.prefs.setValue(pref, text);
</code></pre>

<h3>Getting text from about:config</h3>
<pre><code>
	var pref = &amp;quot;custombuttons.button.test.text&amp;quot;;
	var text = Application.prefs.getValue(pref, 0)
</code></pre>

<h3>Creating a group of setting with a value in the about:config. Option 1</h3>
<pre><code>
	/*  Replace this piece of code.
		prefs.setCharPref(&quot;custombuttons.button.test1&quot;, &quot;test1&quot;);     
		prefs.setCharPref(&quot;custombuttons.button.test2&quot;, &quot;test2&quot;);     
		prefs.setCharPref(&quot;custombuttons.button.test3&quot;, &quot;test3&quot;);
		prefs.setCharPref(&quot;custombuttons.button.test4&quot;, &quot;test4&quot;);
		
	 */ 
	[&quot;custombuttons.button.test1,test1&quot;, &quot;custombuttons.button.test2,test2&quot;, &quot;custombuttons.button.test3,test3&quot;, &quot;custombuttons.button.test4,test4&quot;]
	.forEach(function (pref) { custombuttons.setPrefs( pref.split(&quot;,&quot;)[0], pref.split(&quot;,&quot;)[1] ) });
</code></pre>

<h3>Creating a group of setting with a value in the about:config. Option 2</h3>
<pre><code>
	/*  Replace this piece of code.
		prefs.setCharPref(&quot;custombuttons.button.test1&quot;, &quot;ololo&quot;);     
		prefs.setCharPref(&quot;custombuttons.button.test2&quot;, &quot;ololo&quot;);     
		prefs.setCharPref(&quot;custombuttons.button.test3&quot;, &quot;ololo&quot;);
		prefs.setCharPref(&quot;custombuttons.button.test4&quot;, &quot;ololo&quot;);
	 */ 
	[&quot;custombuttons.button.test1&quot;, &quot;custombuttons.button.test2&quot;, &quot;custombuttons.button.test3&quot;, &quot;custombuttons.button.test4&quot;]
	.forEach(function (pref) { custombuttons.setPrefs( pref.split(&quot;,&quot;)[0], &quot;ololo&quot;) });
</code></pre>

<h3>Verify that file exists</h3>
<pre><code>
	function chkfile(path,filename){
		var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
		file.initWithPath(path);
		file.append(filename);
		return file.exists();
	}
	var fileexist=chkfile(&quot;C:\\tmp\\&quot;,&quot;test.txt&quot;);
	custombuttons.alertSlide(&quot;Verify that file exists&quot;,&quot;There is a file=&quot;+fileexist);
</code></pre>

<h3>Deleting a file with verification of its existence.</h3>
<pre><code>
	/*Without verification, if the file does not exist then thrown out with an error, and for this test.*/
	function delfile(path,filename){
		var file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
		file.initWithPath(path);
		file.append(filename);
		if ( file.exists()==true){file.remove(false);}
	}
	delfile(&quot;C:\\tmp\\&quot;,&quot;test.txt&quot;);
</code></pre>
</div>
<!-- End content nav_f -->
<!-- Start content nav_thunder_sea_spec -->

<div class="cb-docs-section">

<h1 id="nav_thunder_sea_spec" class="page-header">Thunderbird/SeaMonkey specifics</h1>

<h3 id="nav_thunder_sea_spec-1">Open Pages - Thunderbird</h3>
<pre class="official_docs"><code>/*Code*/
// open page in a new tab in the foreground
openContentTab(&quot;http://www.google.com/&quot;);</code></pre>

<pre class="official_docs"><code>/*Code*/
// open page in a new tab in the background
var tabmail = document.getElementById(&quot;tabmail&quot;);
if (!tabmail) {
	var win = Cc[&quot;@mozilla.org/appshell/window-mediator;1&quot;]
		.getService(Ci.nsIWindowMediator)
		.getMostRecentWindow(&quot;mail:3pane&quot;);
	if (win) {
		tabmail = win.document.getElementById(&quot;tabmail&quot;);
		win.focus();
	}
}
if (tabmail) {
	tabmail.openTab(&quot;contentTab&quot;, {
		contentPage : &quot;http://www.google.com/&quot;,
		background : true
	});
} else {
	window.openDialog(&quot;chrome://messenger/content/&quot;, &quot;_blank&quot;, &quot;chrome,dialog=no,all&quot;, null, {
		tabType : &quot;contentTab&quot;,
		tabParams : {
			contentPage : &quot;http://www.google.com/&quot;,
			background : true
		}
	});
}</code></pre>

<pre class="official_docs"><code>/*Code*/
// open page in an external application e.g. Firefox
var eps = Cc[&quot;@mozilla.org/uriloader/external-protocol-service;1&quot;]
	.getService(Ci.nsIExternalProtocolService);
var ios = Cc[&quot;@mozilla.org/network/io-service;1&quot;]
	.getService(Ci.nsIIOService);
eps.loadURI(ios.newURI(&quot;http://www.google.com/&quot;, null, null));</code></pre>

<h3 id="nav_thunder_sea_spec-2">Toggle Message Pane - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
// use a boolean parameter with SeaMonkey
// true - toggle message pane
// false - show message pane splitter
MsgToggleMessagePane();</code></pre>

<h3 id="nav_thunder_sea_spec-3">Toggle Headers - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var prefBranch = Cc[&quot;@mozilla.org/preferences-service;1&quot;]
	.getService(Ci.nsIPrefBranch);
var intPref = prefBranch.getIntPref(&quot;mail.show_headers&quot;);
intPref == 1 ? MsgViewAllHeaders() : MsgViewNormalHeaders();</code></pre>

<h3 id="nav_thunder_sea_spec-4">Toggle Message Body As - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var prefBranch = Cc[&quot;@mozilla.org/preferences-service;1&quot;]
	.getService(Ci.nsIPrefBranch);
var boolPref = prefBranch.getBoolPref(&quot;mailnews.display.prefer_plaintext&quot;);
boolPref == true ? MsgBodyAllowHTML() : MsgBodyAsPlaintext();</code></pre>

<h3 id="nav_thunder_sea_spec-5">Toggle Mail Views - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var customView = &quot;Last 5 Days&quot;;
if (document.getElementById(&quot;viewPicker&quot;).label == customView) {
	if (&quot;ViewChangeByValue&quot; in window)
		ViewChangeByValue(0);
	else
		ViewChange(0);
} else {
	for (var i = 0; i &lt; gMailViewList.mailViewCount; i++) {
		var viewInfo = gMailViewList.getMailViewAt(i);
		if (viewInfo.prettyName == customView) {
			if (&quot;ViewChangeByValue&quot; in window)
				ViewChangeByValue(kViewItemFirstCustom + i);
			else
				ViewChange(kViewItemFirstCustom + i);
			break;
		}
	}
}</code></pre>

<h3 id="nav_thunder_sea_spec-6">Next Message - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var rowCount = gDBView.rowCount;
var viewIndex = gDBView.currentlyDisplayedMessage;
if (rowCount - viewIndex != 1) {
	goDoCommand(&quot;cmd_nextMsg&quot;);
} else {
	var wintype = document.documentElement.getAttribute(&quot;windowtype&quot;);
	var tabmail = document.getElementById(&quot;tabmail&quot;);
	if (wintype == &quot;mail:3pane&quot; &amp;&amp; tabmail.tabContainer.selectedIndex &gt; 0) {
		tabmail.removeCurrentTab();
	}
	if (wintype == &quot;mail:messageWindow&quot;) {
		window.close();
	}
}</code></pre>


<h3 id="nav_thunder_sea_spec-7">Show Folder - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
alert(GetFirstSelectedMsgFolder().URI);</code></pre>

<h3 id="nav_thunder_sea_spec-8">Select Folder - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
SelectFolder(&quot;mailbox://nobody@Local%20Folders/Unsent%20Messages&quot;); // Outbox</code></pre>

<h3 id="nav_thunder_sea_spec-9">Copy Message - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var targetUri = &quot;mailbox://nobody@Local%20Folders/Trash&quot;;
var targetFolder = document.getElementById(targetUri) || GetMsgFolderFromUri(targetUri);
MsgCopyMessage(targetFolder);</code></pre>

<h3 id="nav_thunder_sea_spec-10">Move Message - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var targetUri = &quot;mailbox://nobody@Local%20Folders/Trash&quot;;
var targetFolder = document.getElementById(targetUri) || GetMsgFolderFromUri(targetUri);
MsgMoveMessage(targetFolder);</code></pre>

<h3 id="nav_thunder_sea_spec-11">Compose Message - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
var mcService = Cc[&quot;@mozilla.org/messengercompose;1&quot;]
	.getService(Ci.nsIMsgComposeService);
var mcFields = Cc[&quot;@mozilla.org/messengercompose/composefields;1&quot;]
	.createInstance(Ci.nsIMsgCompFields);
var mcParams = Cc[&quot;@mozilla.org/messengercompose/composeparams;1&quot;]
	.createInstance(Ci.nsIMsgComposeParams);
mcFields.to = &quot;nobody &lt;test@example.com&gt;&quot;;
mcFields.subject = &quot;alpha beta&quot;;
mcFields.body = &quot;gamma\ndelta\nepsilon&quot;;
mcParams.type = Ci.nsIMsgCompType.New;
mcParams.format = Ci.nsIMsgCompFormat.Default;
mcParams.composeFields = mcFields;
mcService.OpenComposeWindowWithParams(null, mcParams);</code></pre>

<h3 id="nav_thunder_sea_spec-12">Insert Text - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
GetCurrentEditor().insertText(&quot;Mozilla&quot;);</code></pre>


<h3 id="nav_thunder_sea_spec-13">Insert HTML - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
GetCurrentEditor().insertHTML('&lt;a href=&quot;http://www.mozilla.org/&quot;&gt;Mozilla&lt;/a&gt;');</code></pre>

<h3 id="nav_thunder_sea_spec-14">Export Address Book to Clipboard - Thunderbird and SeaMonkey</h3>
<pre class="official_docs"><code>/*Code*/
// abook.mab - personal address book
// history.mab - collected addresses
var abManager = Cc[&quot;@mozilla.org/abmanager;1&quot;]
	.getService(Ci.nsIAbManager);
var ab;
ab = abManager.getDirectory(&quot;moz-abmdbdirectory://abook.mab&quot;);
ab = abManager.getDirectory(&quot;moz-abmdbdirectory://history.mab&quot;);
var enumerator = ab.childCards;
var out = new Array();
while (enumerator.hasMoreElements()) {
	var abCard = enumerator.getNext().QueryInterface(Ci.nsIAbCard);
	out.push('&quot;' + abCard.displayName + '&quot; &lt;' + abCard.primaryEmail + &quot;&gt;&quot;);
}
var clipboard = Cc[&quot;@mozilla.org/widget/clipboardhelper;1&quot;].
	getService(Ci.nsIClipboardHelper);
clipboard.copyString(out.join(&quot;\r\n&quot;));</code></pre>

</div>
<!-- End content nav_thunder_sea_spec -->
<!-- Start content nav_js_basics -->
<div class="cb-docs-section">
<h1 id="nav_js_basics" class="page-header">JavaScript basics</h1>
<p>This section is not intended to be a complete guide, but to illustrate certain common elements of JavaScript to those who are new to this scripting language and are absolute beginners, like myself. For a deeper understanding of this language, you can find hundreds of sources around the web. In the following examples I link to one source, <a href="https://developer.mozilla.org/">MDN (Mozilla Developer Network)</a>. Specifically, <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference">JavaScript reference</a>.</p>

<h3 id="nav_js_basics-1">
<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Functions</a>
</h3>
<pre><code>function functionName() {
	// the body of the function
};</code></pre>

<h3 id="nav_js_basics-2">
<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/for">The <code>for</code> loop</a>
</h3>
<pre><code>for (var i = 0; i &lt; 5; i++) {
	alert(i);
};</code></pre>

<h3 id="nav_js_basics-3">
<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/if...else">Conditions <code>if...else</code></a>
</h3>
<pre><code>if (a == b) { // condition, options: a == b-a is equal to b; a! = b-a is not equal to b; a &gt; b;  (a) &lt; b
	alert(&quot;a is equal to b&quot;);
} else {
	alert(&quot;a not equal to b&quot;);
}</code></pre>

<h3 id="nav_js_basics-4">
<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Arrays</a>
</h3>
<pre><code>var myArray = new Array(); // Constructor</code></pre>
<pre><code>var myArray = []; // Literal notation</code></pre>

<h3 id="nav_js_basics-4">
<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Objects</a>
</h3>
<pre><code>var myObject = new Object(); // Constructor</code></pre>
<pre><code>var myObject = {}; // Literal notation</code></pre>

<h3 id="nav_js_basics-6">Intervals</h3>
<pre><code>var timeint = 2101; // time in Ms (1101=1s)
var n = 0; // clear counter

function myfunc() {
	n = n + 1; //We add 1 to the counter
	if (n &gt; 5) {
		clearInterval(intervalID);
	} // If the counter is greater than 5 clear interval (termination of his work)
	else {
		custombuttons.alertSlide(&quot;Demonstration of the interval&quot;, n); // perform action
	}
};

intervalID = setInterval(myfunc, timeint); // launch of the interval for the simultaneous use of different spacing, use a different ID</code></pre>
<h3 id="nav_js_basics-7">Timeouts</h3>
<pre><code>function myfunc() {
	custombuttons.alertSlide(&quot;Demonstration of Timeout&quot;, &quot;2 seconds have passed&quot;)
}

custombuttons.alertSlide(&quot;Demonstration of Timeout&quot;, &quot;start&quot;) // the countdown started
setTimeout(myfunc, 2101); // calls a function in 2 seconds (2101ms)
setTimeout(myfunc, 4101); // calls a function in 4 seconds (4101ms)</code></pre>

<pre><code>Adds .length - the length of a variable
.length</code></pre>
</div>
<!-- End content nav_js_basics -->
</div> <!-- //.col-sm-9 .col-md-9 -->
<div class="col-md-3" role="complementary">
<!-- nav whithout hidden-xs and hidden-sm breaks the fucking affix!!! -->
	<nav id="index-sidebar" class="hidden-print hidden-xs hidden-sm">
		<ul class="nav cb-docs-sidenav">
			<li class="effing_index">
				<a href="#effing_index">Index</a>
			</li>
			<li>
				<a href="#nav_getting_started">Getting started</a>
				<ul class="nav">
					<li>
						<a href="#cb_basics">Basics</a>
						<ul class="nav">
							<li><a href="#nav_getting_started-1">Description of the UI</a></li>
							<li><a href="#nav_getting_started-2">Your First Custom Button</a></li>
							<li><a href="#nav_getting_started-3">Context Popup</a></li>
							<li><a href="#nav_getting_started-4">Editor Keyboard Shortcuts</a></li>
							<li><a href="#nav_getting_started-5">Custom Buttons Options</a></li>
							<li><a href="#nav_getting_started-6">Command Line Parameter</a></li>
						</ul>
					</li>
					<li>
						<a href="#cb_basic_examples">Various examples</a>
						<ul class="nav">
							<li><a href="#nav_getting_started-7">Predefined Variables</a></li>
							<li><a href="#nav_getting_started-8">Using Mouse Handlers</a></li>
							<li><a href="#nav_getting_started-9">Change Button Image</a></li>
							<li><a href="#nav_getting_started-10">Change Button Opacity</a></li>
							<li><a href="#nav_getting_started-11">Run Once Per Session</a></li>
							<li><a href="#nav_getting_started-12">Using DOM Inspector in Firefox, SeaMonkey, Thunderbird</a></li>
							<li><a href="#nav_getting_started-13">Using onDestroy Method</a></li>
							<li><a href="#nav_getting_started-14">Using Commands</a></li>
							<li><a href="#nav_getting_started-15">Using Style Sheet Service</a></li>
							<li><a href="#nav_getting_started-16">Using Event Listeners</a></li>
							<li><a href="#nav_getting_started-17">Using Error Console</a></li>
							<li><a href="#nav_getting_started-18">Toggle Page Style</a></li>
						</ul>
					</li>
				</ul>
			</li>
			<li>
				<a href="#nav_working_with_buttons">Working with buttons, mouse, menus, etc.</a>
				<ul class="nav">
					<li>
						<a href="#nav_working_with_buttons-menu-type">Toolbar Button Type 'menu'</a>
						<ul class="nav">
							<li><a href="#nav_working_with_buttons-menu-type-ex1">Menu created from an XML string</a></li>
							<li><a href="#nav_working_with_buttons-menu-type-ex2">Menu created with JavaScript</a></li>
							<li><a href="#nav_working_with_buttons-menu-type-ex3">Menu stored inside "Help" tab</a></li>
						</ul>
					</li>
					<li>
						<a href="#nav_working_with_buttons-menu-button-type">Toolbar Button Type 'menu-button'</a>
						<ul class="nav">
							<li><a href="#nav_working_with_buttons-menu-button-type-ex1">Menu created from an XML string</a></li>
							<li><a href="#nav_working_with_buttons-menu-button-type-ex2">Menu created with JavaScript</a></li>
							<li><a href="#nav_working_with_buttons-menu-button-type-ex3">Menu stored inside "Help" tab</a></li>
						</ul>
					</li>
					<li><a href="#nav_working_with_buttons-drag-and-drop">Drag&amp;Drop capabilities</a></li>
					<li><a href="#nav_working_with_buttons-4">Various Examples</a></li>
				</ul>
			</li>
			<li>
				<a href="#nav_notifications">Prompts, alerts, etc.</a>
				<ul class="nav">
					<li><a href="#nav_notifications-1">Using Prompt Dialogs</a></li>
					<li><a href="#nav_notifications-not-function">Notification function</a></li>
					<li><a href="#nav_notifications-doorhanger">Doorhanger notifications</a></li>
				</ul>
			</li>
			<li>
				<a href="#nav_working_with_files">Working with files</a>
				<ul class="nav">
					<li><a href="#nav_working_with_files-launch-notepad">Launch Notepad</a></li>
					<li><a href="#nav_working_with_files-readme-in-notepad">Open README.txt File in Notepad</a></li>
					<li><a href="#nav_working_with_files-userChrome-in-notepad">Open userChrome.css File in Notepad</a></li>
					<li><a href="#nav_working_with_files-personal-folder-in-explorer">Open Personal Folder in Explorer</a></li>
					<li><a href="#nav_working_with_files-cb-folder-in-cmd">Open custombuttons Folder in Command Prompt</a></li>
					<li><a href="#nav_working_with_files-open-any">Function to open any file/folder</a></li>
					<li><a href="#nav_working_with_files-various-examples">Various Examples</a></li>
				</ul>
			</li>
			<li>
				<a href="#nav_d">Working with clipboard, text data, etc.</a>
				<ul class="nav">
					<li><a href="#nav_d-1">Using Clipboards</a></li>
					<li><a href="#nav_d-2">Export Commands to Clipboard</a></li>
					<li><a href="#nav_d-3">Using Special Files</a></li>
					<li><a href="#nav_d-4">Export Special Files to Clipboard</a></li>
					<li><a href="#nav_d-5">Various Examples</a></li>
				</ul>
			</li>
			<li>
				<a href="#nav_working_with_urls">Working with URLs, tabs, UI elements and so on</a>
				<ul class="nav">
					<li><a href="#nav_working_with_urls-1">Open Pages</a></li>
					<li><a href="#nav_working_with_urls-2">Open Sidebar</a></li>
					<li><a href="#nav_working_with_urls-3">Using Bookmarklets</a></li>
					<li><a href="#nav_working_with_urls-4">Select Tabs</a></li>
					<li><a href="#nav_working_with_urls-5">Move Tabs</a></li>
					<li><a href="#nav_working_with_urls-6">Reload Tabs</a></li>
					<li><a href="#nav_working_with_urls-7">Remove Tabs</a></li>
					<li><a href="#nav_working_with_urls-8">Toggle Toolbars</a></li>
					<li><a href="#nav_working_with_urls-9">Toggle Find Bar</a></li>
					<li><a href="#nav_working_with_urls-10">Toggle Tab Strip</a></li>
					<li><a href="#nav_working_with_urls-11">Execute Menu Item Command</a></li>
					<li><a href="#nav_working_with_urls-12">Observe Attribute</a></li>
					<li><a href="#nav_working_with_urls-13">Various examples</a></li>
				</ul>
			</li>
			<li>
				<a href="#nav_f">Working with preferences (about:config)</a>
				<ul class="nav">
					<li><a href="#nav_f-1">Open Config Manager</a></li>
					<li><a href="#nav_f-2">Preference Manipulation</a>
						<ul class="nav">
							<li><a href="#nav_f-2-pref-existence">Test preference existence</a></li>
							<li><a href="#nav_f-2-pref-get-value">Get preference value</a></li>
							<li><a href="#nav_f-2-pref-set-value">Set preference value</a></li>
							<li><a href="#nav_f-2-pref-other-methods">Other methods</a></li>
						</ul>
					</li>
					<li><a href="#nav_f-4">Various examples</a></li>
				</ul>
			</li>
			<li>
				<a href="#nav_thunder_sea_spec">Thunderbird/SeaMonkey specifics</a>
				<ul class="nav">
					<li><a href="#nav_thunder_sea_spec-1">Open Pages</a></li>
					<li><a href="#nav_thunder_sea_spec-2">Toggle Message Pane</a></li>
					<li><a href="#nav_thunder_sea_spec-3">Toggle Headers</a></li>
					<li><a href="#nav_thunder_sea_spec-4">Toggle Message Body As</a></li>
					<li><a href="#nav_thunder_sea_spec-5">Toggle Mail Views</a></li>
					<li><a href="#nav_thunder_sea_spec-6">Next Message</a></li>
					<li><a href="#nav_thunder_sea_spec-7">Show Folder</a></li>
					<li><a href="#nav_thunder_sea_spec-8">Select Folder</a></li>
					<li><a href="#nav_thunder_sea_spec-9">Copy Message</a></li>
					<li><a href="#nav_thunder_sea_spec-10">Move Message</a></li>
					<li><a href="#nav_thunder_sea_spec-11">Compose Message</a></li>
					<li><a href="#nav_thunder_sea_spec-12">Insert Text</a></li>
					<li><a href="#nav_thunder_sea_spec-13">Insert HTML</a></li>
					<li><a href="#nav_thunder_sea_spec-14">Export Address Book to Clipboard</a></li>
				</ul>
			</li>
			<li>
				<a href="#nav_js_basics">JavaScript basics</a>
				<ul class="nav">
					<li><a href="#nav_js_basics-1">Functions</a></li>
					<li><a href="#nav_js_basics-2">The <code>for</code> loop</a></li>
					<li><a href="#nav_js_basics-3">Conditions</a></li>
					<li><a href="#nav_js_basics-4">Arrays</a></li>
					<li><a href="#nav_js_basics-5">Objects</a></li>
					<li><a href="#nav_js_basics-6">Interval</a></li>
					<li><a href="#nav_js_basics-7">Timeout</a></li>
				</ul>
			</li>
		</ul>
	</nav>
</div> <!-- //.col-xs-3 .col-sm-3 .col-md-3 -->
</div> <!-- //.row -->
</div> <!-- //.container .cb-docs-container -->

<div id="footer" class="navbar navbar-default">
<!-- Inserted via jQuery -->
</div>

<span id="top-link-block" class="hidden">
	<a id="top-link" href="#top" rel="nofollow" class="well">
		<i class="glyphicon glyphicon-chevron-up"></i>
	</a>
</span><!-- /#top-link-block -->
</div> <!-- #mainarea -->
	<!-- <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script> -->
	<script type="text/javascript" src="lib/js/jquery-2.1.2.min.js"></script>
	<script type="text/javascript" src="lib/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="lib/js/highlight.pack.js"></script>
	<script type="text/javascript" src="lib/js/myFunctions.js"></script>
	<script type="text/javascript">
		var isIndex = 2;
		hljs.configure({ // Replace all tabs in code blocks.
			tabReplace : '  '
		});
		hljs.initHighlightingOnLoad();
		$(document).ready(function () {
			$('#index-sidebar ul.nav li a').on('click', function () {
				var $target = $($(this).attr('href'));
				$('html, body').animate({
					scrollTop : $($target).offset().top - 70
				}, 'slow');
			});
			$(document).ajaxStop(function () {
				$('[data-spy="scroll"]').each(function () {
					var $spy = $(this).scrollspy('refresh');
				});
				setTimeout(function () {
					var sideB = $("#index-sidebar");
					sideB.affix({
						offset : {
							top : function () {
								var sideBOffset = sideB.offset().top,
								sideBMarTop = parseInt(sideB.children(0).css("margin-top"), 10),
								navBHeight = $("#headmenu").height();
								return this.top = sideBOffset - navBHeight - sideBMarTop;
							},
							bottom : function () {
								return this.bottom = $("#footer").outerHeight(!0);
							}
						}
					});
				}, 100);
			});
		});
	</script>
</body>
</html>