<?xml version="1.0" encoding="UTF-8"?>
<custombutton xmlns:cb="http://xsms.nm.ru/custombuttons/"
              xmlns:html="http://www.w3.org/1999/xhtml">
  <html:head>
    <html:title><![CDATA[Extensions Options Menu]]></html:title>
    <html:link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACV0lEQVR4Xi3OT2ibZQDH8c/7msT1pZqOtlQ32ulaGJVuB0UvMiyRCbZCT14MHUIzcaCCFcZAGOiKIB3UkyCeBBU86EGYiPZanTIZwnTWScdqbdM/U/vHN1mS5jGHHD637w9+TOM1vKrTtPe8419z7njflrmWt2yb9ocpE0p4CaW2KTjVdtKgkqsnloZCMYyHQjgeHguD4YndoeBDwagZpzCKsfbmNIzjZZxF0aiS+Qd/TUJvRRjYzQcf2DPhotP6TOBJTOE5FIlVPG/NZEvRpq6Wpcp/dR1RXlcmz5pUasWOUalJDQ+3AOC83aGb/SF7TfCdMHCzJ5zYHwjKghXhwC1NXwvmBbOCgheVMI4iGSOas0MXXfWTdWU/WnBjc5kKUqpZkUGibkIFC1IdetSdwZXInB3HJS7bUNR3aCQbr67VaeAuKthGNxbxhVcccNiw8275LbZgw+dm/OUFn/h5falODjVUUUeEHfQKjrhg0OueEunUH3nGfY7akwjWvWnSjEdxG3U0UEOKCAnu4l58605Gzq4EOWRsqLWDFI22/bY6AlJ0ATHOCR6XlcgogCruRx6dgDo6BGvYQQY1cazfu3p9atUlxxT0YxnXcQ2/o4I8yvjSx+ZdsYI9ucjbNj2rx3UMY9O+ryy67bKGX3R42hEnjXnIIr4xJvE3LuH7WCqSw1HUsOAfq96QdU63j+SdUTbrBhLUHJTzg7Ki4ELsHhlNVJHBiIMOOatTnwSRYYeVHEMT2n3WMqoZizZ8pmm/BWKxLQXbHlCxjkfUDGs98yeqUluoAf8DkrzrAnZsWyMAAAAASUVORK5CYII="/>
    <html:style type="text/css"><![CDATA[body { font-size: medium; margin: 0; }
body, code:before, help:before, initcode:before {
  font-family: "Verdana", sans-serif;
}
#wrapper { position: fixed; top: 1em; right: 1em; text-align: center; }
p { font-size: small; text-align: center; }
#button {
  background-color: rgb(85, 168, 2);
  background-image: linear-gradient(to bottom, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -moz-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -o-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -webkit-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  border: 1px solid rgb(58, 116, 4);
  border-radius: .5em;
  -moz-border-radius: .5em;
  -webkit-border-radius: .5em;
  padding: 0;
  margin-bottom: 1em;
  box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -moz-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -o-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -webkit-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
}
#button a {
  color: #000;
  text-shadow: -1pt -1px 0pt rgba(255, 255, 255, .5);
  padding: 1em;
  text-decoration: none;
}
#button a, code, code:before, initcode, initcode:before, help, help:before {
  display: block;
}
#credits { position: fixed; bottom: 1em; right: 1em; font-size: small; }
custombutton { background-color: rgb(171, 171, 171); margin: 1em; }
date, image, mode, accelkey { display: none; }
name { font-weight: bold; font-size: x-large; }
code:before, help:before, initcode:before {
  font-weight: bold;
  font-size: large;
  margin: 0 0 1em;
  padding: .5em;
}
code:before { content: "CODE"; }
help:before { content: "Help"; }
initcode:before { content: "Initialization Code"; }
code, initcode, help {
  background-color: rgb(255, 255, 255);
  border: 1px inset rgb(170, 170, 170);
  font: medium monospace;
  margin: 1em 1em 2em 0;
  padding: 1em;
  text-align: left;
  width: 840px;
  white-space: pre-wrap;
  word-wrap: break-word;
}
.clear { clear: both; }
]]></html:style>
  </html:head>
  <html:body>
    <html:div id="wrapper">
      <html:div id="button">
        <html:a href="custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3EExtensions%20Options%20Menu%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACV0lEQVR4Xi3OT2ibZQDH8c/7msT1pZqOtlQ32ulaGJVuB0UvMiyRCbZCT14MHUIzcaCCFcZAGOiKIB3UkyCeBBU86EGYiPZanTIZwnTWScdqbdM/U/vHN1mS5jGHHD637w9+TOM1vKrTtPe8419z7njflrmWt2yb9ocpE0p4CaW2KTjVdtKgkqsnloZCMYyHQjgeHguD4YndoeBDwagZpzCKsfbmNIzjZZxF0aiS+Qd/TUJvRRjYzQcf2DPhotP6TOBJTOE5FIlVPG/NZEvRpq6Wpcp/dR1RXlcmz5pUasWOUalJDQ+3AOC83aGb/SF7TfCdMHCzJ5zYHwjKghXhwC1NXwvmBbOCgheVMI4iGSOas0MXXfWTdWU/WnBjc5kKUqpZkUGibkIFC1IdetSdwZXInB3HJS7bUNR3aCQbr67VaeAuKthGNxbxhVcccNiw8275LbZgw+dm/OUFn/h5falODjVUUUeEHfQKjrhg0OueEunUH3nGfY7akwjWvWnSjEdxG3U0UEOKCAnu4l58605Gzq4EOWRsqLWDFI22/bY6AlJ0ATHOCR6XlcgogCruRx6dgDo6BGvYQQY1cazfu3p9atUlxxT0YxnXcQ2/o4I8yvjSx+ZdsYI9ucjbNj2rx3UMY9O+ryy67bKGX3R42hEnjXnIIr4xJvE3LuH7WCqSw1HUsOAfq96QdU63j+SdUTbrBhLUHJTzg7Ki4ELsHhlNVJHBiIMOOatTnwSRYYeVHEMT2n3WMqoZizZ8pmm/BWKxLQXbHlCxjkfUDGs98yeqUluoAf8DkrzrAnZsWyMAAAAASUVORK5CYII%3D%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5Bconst%20EXTENSION%20%3D%20Ci.nsIUpdateItem.TYPE_EXTENSION%3B%0A%0Afunction%20extProp%28aElement%2C%20aString%29%20%7B%0A%20%20var%20emRDF%20%3D%20%22http%3A//www.mozilla.org/2004/em-rdf%23%22%3B%0A%20%20var%20arc%20%3D%20RDFService.GetResource%28emRDF%20+%20aString%29%3B%0A%20%20var%20target%20%3D%20ExtensionManager.GetTarget%28aElement%2C%20arc%2C%20true%29%3B%0A%20%20if%20%28target%20instanceof%20Ci.nsIRDFLiteral%29%0A%20%20%20%20return%20target.Value%3B%0A%20%20if%20%28target%20instanceof%20Ci.nsIRDFInt%29%0A%20%20%20%20return%20target.Value%3B%0A%20%20return%20null%3B%0A%7D%0A%0Avar%20RDFService%20%3D%20Cc%5B%22@mozilla.org/rdf/rdf-service%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIRDFService%29%3B%0Avar%20RDFContainer%20%3D%20Cc%5B%22@mozilla.org/rdf/container%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIRDFContainer%29%3B%0Avar%20ExtensionManager%20%3D%20Cc%5B%22@mozilla.org/extensions/manager%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIExtensionManager%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.datasource%3B%0A%0Avar%20urn%2C%20root%3B%0Atry%20%7B%0A%20%20urn%20%3D%20%22urn%3Amozilla%3Aitem%3A%22%3B%0A%20%20root%20%3D%20RDFService.GetResource%28urn%20+%20%22root%22%29%3B%0A%7D%20catch%28err%29%20%7B%0A%20%20urn%20%3D%20%22urn%3Amozilla%3Aextension%3A%22%3B%0A%20%20root%20%3D%20RDFService.GetResource%28urn%20+%20%22root%22%29%3B%0A%7D%0A%0ARDFContainer.Init%28ExtensionManager%2C%20root%29%3B%0A%0Avar%20elements%20%3D%20RDFContainer.GetElements%28%29%3B%0Avar%20extensionArray%20%3D%20%5B%5D%3B%0Avar%20i%20%3D%20-1%3B%0Awhile%20%28elements.hasMoreElements%28%29%29%20%7B%0A%20%20i++%3B%0A%20%20var%20element%20%3D%20elements.getNext%28%29%3B%0A%20%20element.QueryInterface%28Ci.nsIRDFResource%29%3B%0A%20%20var%20prop_OptionsURL%20%3D%20extProp%28element%2C%20%22optionsURL%22%29%3B%0A%20%20if%20%28extProp%28element%2C%20%22type%22%29%20%3D%3D%20EXTENSION%20%26%26%20%20prop_OptionsURL%29%20%7B%0A%20%20%20%20var%20prop_name%20%3D%20extProp%28element%2C%20%22name%22%29%3B%0A%0A%20%20%20%20extensionArray%5Bi%5D%20%3D%20%7B%0A%20%20%20%20%20%20guid%3A%20element.Value.replace%28urn%2C%20%22%22%29%2C%0A%20%20%20%20%20%20name%3A%20prop_name.charAt%280%29.toUpperCase%28%29%20+%20prop_name.substr%281%29%2C%0A%20%20%20%20%20%20version%3A%20extProp%28element%2C%20%22version%22%29%2C%0A%20%20%20%20%20%20homepageURL%3A%20%28extProp%28element%2C%20%22homepageURL%22%29%20%21%3D%20undefined%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3F%20extProp%28element%2C%20%22homepageURL%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20%22http%3A//www.google.com/search%3Fq%3D%2522%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20prop_name.replace%28/%5Cs/g%2C%20%22+%22%29%20+%20%22%2522%22%2C%0A%20%20%20%20%20%20optionsURL%3A%20prop_OptionsURL%2C%0A%20%20%20%20%20%20iconURL%3A%20%28extProp%28element%2C%20%22iconURL%22%29%20%21%3D%20undefined%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3F%20extProp%28element%2C%20%22iconURL%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20%22chrome%3A//mozapps/skin/xpinstall/%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22xpinstallItemGeneric.png%22%2C%0A%20%20%20%20%20%20disabled%3A%20extProp%28element%2C%20%22userDisabled%22%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0AextensionArray.sort%28function%28a%2C%20b%29%20%7B%0A%20%20a%20%3D%20a.name.toLowerCase%28%29%3B%0A%20%20b%20%3D%20b.name.toLowerCase%28%29%3B%0A%20%20if%20%28a%20%3C%20b%29%20return%20-1%3B%0A%20%20if%20%28a%20%3E%20b%29%20return%201%3B%0A%20%20return%200%3B%0A%7D%29%0A%0A%0Avar%20features%20%3D%20%22chrome%2C%20dialog%20%3D%20no%2C%20resizable%2C%20%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22titlebar%2C%20toolbar%2C%20centerscreen%22%3B%0Avar%20extCommand%20%3D%20%22window.openDialog%28%27optionsURL%27%2C%20this.id%2C%20%27%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20features%20+%20%22%27%29%3B%22%3B%0A%0Avar%20mPopup%20%3D%20this.appendChild%28document.createElement%28%22menupopup%22%29%29%3B%0AmPopup.setAttribute%28%22datasources%22%2C%20%22rdf%3Anull%22%29%3B%0AmPopup.setAttribute%28%22ref%22%2C%20urn%20+%20%22root%22%29%3B%0AmPopup.setAttribute%28%22context%22%2C%20%22cbContext-extensions-popup%22%29%3B%0AmPopup.setAttribute%28%22oncommand%22%2C%20%22event.stopPropagation%28%29%22%29%3B%0A%0Afor%20%28var%20i%20%3D%200%3B%20i%20%3C%20extensionArray.length%3B%20i++%29%20%7B%0A%20%20var%20extArray%20%3D%20extensionArray%5Bi%5D%3B%0A%20%20try%20%7B%0A%20%20%20%20var%20mItem%20%3D%20document.createElement%28%22menuitem%22%29%3B%0A%20%20%20%20mItem.setAttribute%28%22id%22%2C%20urn%20+%20extArray.guid%29%3B%0A%20%20%20%20mItem.setAttribute%28%22GUID%22%2C%20extArray.guid%29%3B%0A%20%20%20%20mItem.setAttribute%28%22label%22%2C%20extArray.name%20+%20%22%20%22%20+%20extArray.version%29%3B%0A%20%20%20%20mItem.setAttribute%28%22tooltiptext%22%2C%20extArray.name%20+%20%22%20%22%20+%20extArray.version%29%3B%0A%20%20%20%20if%20%28extArray.iconURL%29%20%7B%0A%20%20%20%20%20%20mItem.setAttribute%28%22class%22%2C%20%22menuitem-iconic%20bookmark-item%22%29%3B%0A%20%20%20%20%20%20mItem.setAttribute%28%22image%22%2C%20extArray.iconURL%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28extArray.optionsURL%29%20%7B%0A%20%20%20%20%20%20mItem.setAttribute%28%22oncommand%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20extCommand.replace%28%22optionsURL%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20extArray.optionsURL%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28extArray.disabled%29%20%7B%0A%20%20%20%20%20%20mItem.setAttribute%28%22hidden%22%2C%20true%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20mItem.setAttribute%28%22homepageURL%22%2C%20extArray.homepageURL%29%3B%0A%20%20%20%20mPopup.appendChild%28mItem%29%3B%0A%20%20%7D%20catch%28e%29%20%7B%0A%20%20%7D%0A%7D%0A%0A%0Afunction%20addMenuItem%28aNode%2C%20aLabel%2C%20aCommand%29%20%7B%0A%20%20var%20mi%20%3D%20aNode.appendChild%28document.createElement%28%22menuitem%22%29%29%3B%0A%20%20mi.setAttribute%28%22label%22%2C%20aLabel%29%3B%0A%20%20mi.setAttribute%28%22oncommand%22%2C%20aCommand%29%3B%0A%0A%20%20mi.goHome%20%3D%20function%28aNode%29%20%7B%0A%20%20%20%20var%20loadInBackground%20%3D%0A%20%20%20%20%20%20%20%20nsPreferences.getBoolPref%28%22browser.tabs.loadBookmarksInBackground%22%29%3B%0A%20%20%20%20var%20url%20%3D%20aNode.getAttribute%28%22homepageURL%22%29%3B%0A%20%20%20%20if%20%28content.location%20%3D%3D%20%22about%3Ablank%22%29%20%7B%0A%20%20%20%20%20%20gBrowser.loadURI%28url%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gBrowser.loadOneTab%28url%2C%20null%2C%20null%2C%20null%2C%20loadInBackground%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20mi.browseDir%20%3D%20function%28aNode%29%20%7B%0A%20%20%20%20var%20GUID%20%3D%20aNode.getAttribute%28%22GUID%22%29%3B%0A%20%20%20%20var%20Cc%20%3D%20Components.classes%2C%20Ci%20%3D%20Components.interfaces%3B%0A%20%20%20%20var%20dirService%20%3D%20Cc%5B%22@mozilla.org/file/directory_service%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIProperties%29%3B%0A%20%20%20%20var%20dir%20%3D%20dirService.get%28%22ProfD%22%2C%20Ci.nsIFile%29%3B%0A%20%20%20%20dir.append%28%22extensions%22%29%3B%0A%20%20%20%20dir.append%28GUID%29%3B%0A%20%20%20%20if%20%28%21dir.exists%28%29%29%20%7B%0A%20%20%20%20%20%20alert%28%22Directory%20%22%20+%20dir.path%20+%20%22%20doesn%27t%20exist%21%22%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20localFileInterface%20%3D%20Cc%5B%22@mozilla.org/file/local%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.createInstance%28Ci.nsILocalFile%29%3B%0A%20%20%20%20localFileInterface.initWithPath%28dir.path%29%3B%0A%20%20%20%20var%20iDirectory%20%3D%20localFileInterface%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20iDirectory.reveal%28%29%3B%0A%20%20%20%20%7D%20catch%28ex%29%20%7B%0A%20%20%20%20%20%20var%20uri%20%3D%20Cc%5B%22@mozilla.org/network/io-service%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIIOService%29.newFileURI%28iDirectory%29%3B%0A%20%20%20%20%20%20var%20protocolSvc%20%3D%20Cc%5B%22@mozilla.org/uriloader/external-protocol-service%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIExternalProtocolService%29%3B%0A%20%20%20%20%20%20protocolSvc.loadUrl%28uri%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0A%0Afunction%20removeElementById%28aID%29%20%7B%0A%20%20var%20test%20%3D%20document.getElementById%28aID%29%3B%0A%20%20if%20%28test%29%20test.parentNode.removeChild%28test%29%3B%0A%7D%0A%0AremoveElementById%28%22cbContext-extensions-popup%22%29%3B%0A%0Avar%20mainPop%20%3D%20document.getElementById%28%22mainPopupSet%22%29%3B%0Avar%20context%20%3D%20mainPop.appendChild%28document.createElement%28%22popup%22%29%29%3B%0Acontext.id%20%3D%20%22cbContext-extensions-popup%22%3B%0Acontext.setAttribute%28%22oncommand%22%2C%20%22closeMenus%28document.popupNode%29%3B%22%29%3B%0A%0Avar%20contextItems%20%3D%20%5B%0A%20%20%7B%20label%3A%20%22Visit%20Home%20Page%22%2C%0A%20%20%20%20command%3A%20%22this.goHome%28document.popupNode%29%3B%22%20%7D%2C%0A%20%20%7B%20label%3A%20%22Browse%20Install%20Directory%22%2C%0A%20%20%20%20command%3A%20%22this.browseDir%28document.popupNode%29%3B%22%20%7D%0A%5D%3B%0A%0Afor%20%28var%20i%20in%20contextItems%29%20%7B%0A%20%20addMenuItem%28context%2C%20contextItems%5Bi%5D.label%2C%20contextItems%5Bi%5D.command%29%3B%0A%7D%0A%0Athis.type%20%3D%20%22menu-button%22%3B%0Athis.tooltipText%20%3D%20%22Extensions%22%3B%0A%0Athis.setAttribute%28%22onclick%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22if%20%28event.button%20%3D%3D%201%29%20gBrowser.loadOneTab%28%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%27chrome%3A//mozapps/content/extensions/extensions.xul%3F%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%3Dextensions%27%2C%20null%2C%20null%2C%20null%2C%20false%29%3B%22%29%3B%0A%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5B/*%20-------------------------------------------------------------%0A%20%20%20Extensions%20Menu%0A%20%20%20Based%20on%20snippet%20by%20onemen%0A%20%20%20http%3A//forums.mozillazine.org/viewtopic.php%3Fp%3D1774082%23p1774082%0A%20%20%20Modified%20by%20LouCypher%20%28aka%20Zoolcar9%29%0A%20%20%20-------------------------------------------------------------%20*/%0A%0Aif%28typeof%20BrowserOpenAddonsMgr%20%3D%3D%20%22function%22%29%20%7B%0A%20%20BrowserOpenAddonsMgr%28%29%3B%0A%7D%20else%20%7B%0A%20%20BrowserOpenExtensions%28%22extensions%22%29%3B%0A%7D%0A%5D%5D%3E%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E" rel="nofollow" title="Install Extensions Options Menu">
        <![CDATA[Install this button]]>
        </html:a>
      </html:div>
      <html:a href="https://addons.mozilla.org/addon/custom-buttons/?src=custom-buttons-xml">
        <![CDATA[What's this?]]>
      </html:a>
      <html:div id="credits">
        <html:a href="http://custombuttons.sourceforge.net/forum/viewtopic.php?t=78#p197">
          <![CDATA[Custom Buttons XML]]><html:br/><![CDATA[Exporter/Importer]]>
        </html:a>
      </html:div>
    </html:div>
  </html:body>
  <date id="date" value="20120329"/>
  <name>Extensions Options Menu</name>
  <image><![CDATA[data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACV0lEQVR4Xi3OT2ibZQDH8c/7msT1pZqOtlQ32ulaGJVuB0UvMiyRCbZCT14MHUIzcaCCFcZAGOiKIB3UkyCeBBU86EGYiPZanTIZwnTWScdqbdM/U/vHN1mS5jGHHD637w9+TOM1vKrTtPe8419z7njflrmWt2yb9ocpE0p4CaW2KTjVdtKgkqsnloZCMYyHQjgeHguD4YndoeBDwagZpzCKsfbmNIzjZZxF0aiS+Qd/TUJvRRjYzQcf2DPhotP6TOBJTOE5FIlVPG/NZEvRpq6Wpcp/dR1RXlcmz5pUasWOUalJDQ+3AOC83aGb/SF7TfCdMHCzJ5zYHwjKghXhwC1NXwvmBbOCgheVMI4iGSOas0MXXfWTdWU/WnBjc5kKUqpZkUGibkIFC1IdetSdwZXInB3HJS7bUNR3aCQbr67VaeAuKthGNxbxhVcccNiw8275LbZgw+dm/OUFn/h5falODjVUUUeEHfQKjrhg0OueEunUH3nGfY7akwjWvWnSjEdxG3U0UEOKCAnu4l58605Gzq4EOWRsqLWDFI22/bY6AlJ0ATHOCR6XlcgogCruRx6dgDo6BGvYQQY1cazfu3p9atUlxxT0YxnXcQ2/o4I8yvjSx+ZdsYI9ucjbNj2rx3UMY9O+ryy67bKGX3R42hEnjXnIIr4xJvE3LuH7WCqSw1HUsOAfq96QdU63j+SdUTbrBhLUHJTzg7Ki4ELsHhlNVJHBiIMOOatTnwSRYYeVHEMT2n3WMqoZizZ8pmm/BWKxLQXbHlCxjkfUDGs98yeqUluoAf8DkrzrAnZsWyMAAAAASUVORK5CYII=]]></image>
  <mode>0</mode>
  <initcode><![CDATA[const EXTENSION = Ci.nsIUpdateItem.TYPE_EXTENSION;

function extProp(aElement, aString) {
  var emRDF = "http://www.mozilla.org/2004/em-rdf#";
  var arc = RDFService.GetResource(emRDF + aString);
  var target = ExtensionManager.GetTarget(aElement, arc, true);
  if (target instanceof Ci.nsIRDFLiteral)
    return target.Value;
  if (target instanceof Ci.nsIRDFInt)
    return target.Value;
  return null;
}

var RDFService = Cc["@mozilla.org/rdf/rdf-service;1"]
                   .getService(Ci.nsIRDFService);
var RDFContainer = Cc["@mozilla.org/rdf/container;1"]
                     .getService(Ci.nsIRDFContainer);
var ExtensionManager = Cc["@mozilla.org/extensions/manager;1"]
                         .getService(Ci.nsIExtensionManager)
                         .datasource;

var urn, root;
try {
  urn = "urn:mozilla:item:";
  root = RDFService.GetResource(urn + "root");
} catch(err) {
  urn = "urn:mozilla:extension:";
  root = RDFService.GetResource(urn + "root");
}

RDFContainer.Init(ExtensionManager, root);

var elements = RDFContainer.GetElements();
var extensionArray = [];
var i = -1;
while (elements.hasMoreElements()) {
  i++;
  var element = elements.getNext();
  element.QueryInterface(Ci.nsIRDFResource);
  var prop_OptionsURL = extProp(element, "optionsURL");
  if (extProp(element, "type") == EXTENSION &&  prop_OptionsURL) {
    var prop_name = extProp(element, "name");

    extensionArray[i] = {
      guid: element.Value.replace(urn, ""),
      name: prop_name.charAt(0).toUpperCase() + prop_name.substr(1),
      version: extProp(element, "version"),
      homepageURL: (extProp(element, "homepageURL") != undefined)
                    ? extProp(element, "homepageURL")
                    : "http://www.google.com/search?q=%22" +
                      prop_name.replace(/\s/g, "+") + "%22",
      optionsURL: prop_OptionsURL,
      iconURL: (extProp(element, "iconURL") != undefined)
                ? extProp(element, "iconURL")
                : "chrome://mozapps/skin/xpinstall/" +
                  "xpinstallItemGeneric.png",
      disabled: extProp(element, "userDisabled")
    }
  }
}

extensionArray.sort(function(a, b) {
  a = a.name.toLowerCase();
  b = b.name.toLowerCase();
  if (a < b) return -1;
  if (a > b) return 1;
  return 0;
})


var features = "chrome, dialog = no, resizable, " +
               "titlebar, toolbar, centerscreen";
var extCommand = "window.openDialog('optionsURL', this.id, '" +
                                    features + "');";

var mPopup = this.appendChild(document.createElement("menupopup"));
mPopup.setAttribute("datasources", "rdf:null");
mPopup.setAttribute("ref", urn + "root");
mPopup.setAttribute("context", "cbContext-extensions-popup");
mPopup.setAttribute("oncommand", "event.stopPropagation()");

for (var i = 0; i < extensionArray.length; i++) {
  var extArray = extensionArray[i];
  try {
    var mItem = document.createElement("menuitem");
    mItem.setAttribute("id", urn + extArray.guid);
    mItem.setAttribute("GUID", extArray.guid);
    mItem.setAttribute("label", extArray.name + " " + extArray.version);
    mItem.setAttribute("tooltiptext", extArray.name + " " + extArray.version);
    if (extArray.iconURL) {
      mItem.setAttribute("class", "menuitem-iconic bookmark-item");
      mItem.setAttribute("image", extArray.iconURL);
    }
    if (extArray.optionsURL) {
      mItem.setAttribute("oncommand",
                         extCommand.replace("optionsURL",
                                            extArray.optionsURL));
    }
    if (extArray.disabled) {
      mItem.setAttribute("hidden", true);
    }
    mItem.setAttribute("homepageURL", extArray.homepageURL);
    mPopup.appendChild(mItem);
  } catch(e) {
  }
}


function addMenuItem(aNode, aLabel, aCommand) {
  var mi = aNode.appendChild(document.createElement("menuitem"));
  mi.setAttribute("label", aLabel);
  mi.setAttribute("oncommand", aCommand);

  mi.goHome = function(aNode) {
    var loadInBackground =
        nsPreferences.getBoolPref("browser.tabs.loadBookmarksInBackground");
    var url = aNode.getAttribute("homepageURL");
    if (content.location == "about:blank") {
      gBrowser.loadURI(url);
    } else {
      gBrowser.loadOneTab(url, null, null, null, loadInBackground);
    }
  }

  mi.browseDir = function(aNode) {
    var GUID = aNode.getAttribute("GUID");
    var Cc = Components.classes, Ci = Components.interfaces;
    var dirService = Cc["@mozilla.org/file/directory_service;1"]
                       .getService(Ci.nsIProperties);
    var dir = dirService.get("ProfD", Ci.nsIFile);
    dir.append("extensions");
    dir.append(GUID);
    if (!dir.exists()) {
      alert("Directory " + dir.path + " doesn't exist!");
      return;
    }

    var localFileInterface = Cc["@mozilla.org/file/local;1"]
                               .createInstance(Ci.nsILocalFile);
    localFileInterface.initWithPath(dir.path);
    var iDirectory = localFileInterface;
    try {
      iDirectory.reveal();
    } catch(ex) {
      var uri = Cc["@mozilla.org/network/io-service;1"]
                  .getService(Ci.nsIIOService).newFileURI(iDirectory);
      var protocolSvc = Cc["@mozilla.org/uriloader/external-protocol-service;1"]
                          .getService(Ci.nsIExternalProtocolService);
      protocolSvc.loadUrl(uri);
    }
  }
}


function removeElementById(aID) {
  var test = document.getElementById(aID);
  if (test) test.parentNode.removeChild(test);
}

removeElementById("cbContext-extensions-popup");

var mainPop = document.getElementById("mainPopupSet");
var context = mainPop.appendChild(document.createElement("popup"));
context.id = "cbContext-extensions-popup";
context.setAttribute("oncommand", "closeMenus(document.popupNode);");

var contextItems = [
  { label: "Visit Home Page",
    command: "this.goHome(document.popupNode);" },
  { label: "Browse Install Directory",
    command: "this.browseDir(document.popupNode);" }
];

for (var i in contextItems) {
  addMenuItem(context, contextItems[i].label, contextItems[i].command);
}

this.type = "menu-button";
this.tooltipText = "Extensions";

this.setAttribute("onclick",
                  "if (event.button == 1) gBrowser.loadOneTab(" +
                  "'chrome://mozapps/content/extensions/extensions.xul?" +
                  "type=extensions', null, null, null, false);");
]]></initcode>
  <code><![CDATA[/* -------------------------------------------------------------
   Extensions Menu
   Based on snippet by onemen
   http://forums.mozillazine.org/viewtopic.php?p=1774082#p1774082
   Modified by LouCypher (aka Zoolcar9)
   ------------------------------------------------------------- */

if(typeof BrowserOpenAddonsMgr == "function") {
  BrowserOpenAddonsMgr();
} else {
  BrowserOpenExtensions("extensions");
}
]]></code>
  <accelkey><![CDATA[]]></accelkey>
  <help><![CDATA[]]></help>
  <attributes/>
</custombutton>