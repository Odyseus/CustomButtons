<?xml version="1.0" encoding="UTF-8"?>
<custombutton xmlns:cb="http://xsms.nm.ru/custombuttons/" xmlns:html="http://www.w3.org/1999/xhtml">
<html:head>
	<html:title><![CDATA[Multi Translator]]></html:title>
	<html:link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEElEQVQ4jaXSSUtDUQyG4afWCbFQwRERkW5EBX+AFUHQlbgQRV2oG1EodtWFOOA82x/t4qTQSWnxg8CFc5O8ST4alcEKXvxDRVS7SRhHCeWI6yhQrovzvwpM4Qb3TfGNDzzgshsi6MM7TuK7Yx1iD+tBsNFt52IkViX88W6Sh7GEpyhQwYwOR5jHGR5xi9MocoUjZJHHdlC2aBVf2MUkeqJoCW/oxWKM9YyB30iGMBEFmnUsLfg+GrZoMHArmGt6G5W8UIgxLqJZgzKBfyAtLl/3ti85dANb0q4W2lHkJPPMSteYxRg+g6Bm7TvsaHOhfqxJRnrFMjYlb0zX/VcMopF2FDUVpPPlJEPVL3YgyLI/5FwmASoiChQAAAAASUVORK5CYII="/>
	<html:style type="text/css"><![CDATA[body{font-size:medium;margin:0}body,code:before,help:before,initcode:before{font-family:"Verdana",sans-serif}#wrapper{position:fixed;top:1em;right:1em;max-width:15%;text-align:center}#button{background-color:#299a0b;border:1px solid #3a7404;border-radius:.5em;padding:0;margin-bottom:1em;box-shadow:1px 2px 3px rgba(0,0,0,.25)}#button a{color:#f0f0f0;font-weight:700;text-shadow:-.5pt -.5px .5pt rgba(0,0,0,1);padding:.8em;text-decoration:none}:-moz-any-link:focus{color:grey;outline-color:transparent;text-decoration:none}#button a,code,code:before,initcode,initcode:before,help,help:before{display:block}#credits{position:fixed;bottom:1em;right:1em;font-size:small}#about{font-size:small}custombutton{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABAElEQVQ4jW2TQXLFMAhDff+b2vEHYw5AF38eVTNdZAIxCEkmw31VptU5T7mvOuepc56K2B2f85TZrEwr99VxptUwm2U2695PZVrH937KfZX76txsVsTus0yrEbEr0/4F4AyQc56eDMiI2F0IbYoj9h9ZSCV2XzXUA1BVL8BvBvSMiN20zWY38VZ5gDEkYtfAYTRToA3qiQJk2hcA7W8gpaxG0nPvp4aiQ5UCzOV2GKAgLUEfpsGCfaBR92TonapmdCoAjHTIgLa6/14gbgow8oj9uwe6SMQ0qTz9P9oDZOgCkfMNJnqWaV8P3ouDRorUXEA4H1wbtMmVjcrQ7TSb9QMtXcwa4wpbXgAAAABJRU5ErkJggg==) fixed #f6f6f1;margin:1em}date,image,mode,accelkey{display:none}name{font-weight:700;font-size:x-large}code:before,help:before,initcode:before{font-weight:700;font-size:large;margin:0 0 1em;padding:.5em}code:before{content:"Code Tab"}help:before{content:"Help Tab"}initcode:before{content:"Initialization Code Tab"}code,initcode,help{background-color:#fcfcfc;font-size:.875em;font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace!important;margin:1em 2em 1em 0 !important;padding:1em;text-align:left;box-shadow:2px 2px 0 rgba(170,160,130,0.5),4px 4px 0 rgba(200,190,165,0.5);max-width:80%;min-width:80%;white-space:pre-wrap;word-wrap:break-word}]]></html:style>
</html:head>
<html:body>
	<html:div id="wrapper">
		<html:div id="button">
			<html:a href="custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3EMulti%20Translator%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEElEQVQ4jaXSSUtDUQyG4afWCbFQwRERkW5EBX+AFUHQlbgQRV2oG1EodtWFOOA82x/t4qTQSWnxg8CFc5O8ST4alcEKXvxDRVS7SRhHCeWI6yhQrovzvwpM4Qb3TfGNDzzgshsi6MM7TuK7Yx1iD+tBsNFt52IkViX88W6Sh7GEpyhQwYwOR5jHGR5xi9MocoUjZJHHdlC2aBVf2MUkeqJoCW/oxWKM9YyB30iGMBEFmnUsLfg+GrZoMHArmGt6G5W8UIgxLqJZgzKBfyAtLl/3ti85dANb0q4W2lHkJPPMSteYxRg+g6Bm7TvsaHOhfqxJRnrFMjYlb0zX/VcMopF2FDUVpPPlJEPVL3YgyLI/5FwmASoiChQAAAAASUVORK5CYII%3D%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5Bif%20%28self.parentNode%20%26%26%20/%5Ewrapper-/.test%28self.parentNode.id%29%29%0A%09return%3B%0A%0Avar%20%24%20%3D%20this.MultiTranslator%20%3D%20%7B%0A%09init%3A%20function%28%29%20%7B%0A%09%09if%20%28%21%28%22Services%22%20in%20window%29%29%0A%09%09%09Cu.import%28%22resource%3A//gre/modules/Services.jsm%22%29%3B%0A%09%09if%20%28%21%28%22OS%22%20in%20window%29%29%0A%09%09%09Cu.import%28%22resource%3A//gre/modules/osfile.jsm%22%29%3B%0A%0A%09%09%24.initPrefs%28%29%3B%0A%0A%09%09if%20%28%21%28%24._UID%20in%20window%29%29%20%7B%0A%09%09%09window%5B%24._UID%5D%20%3D%20%7B%0A%09%09%09%09CustomizableUI%3A%20false%2C%0A%09%09%09%09Listeners%3A%20false%2C%0A%09%09%09%09CleanSlateTimer%3A%20null%2C%0A%09%09%09%09ElementCreationTimer%3A%20null%2C%0A%09%09%09%09ResizingTimer%3A%20null%2C%0A%09%09%09%09XULStyleSheet%3A%20false%2C%0A%09%09%09%09HTMLStyleSheet%3A%20false%2C%0A%09%09%09%09RandomID%3A%20false%2C%0A%09%09%09%09FrameScriptLoaded%3A%20false%2C%0A%09%09%09%09Preferences%3A%20%7B%7D%2C%0A%09%09%09%7D%3B%0A%09%09%7D%0A%0A%09%09self.tooltipText%20%3D%20%22%22%3B%0A%09%09self.setAttribute%28%22tooltip%22%2C%20%24._UID%20+%20%22_self_tooltip%22%29%3B%0A%09%09self.onclick%20%3D%20function%28aE%29%20%7B%0A%09%09%09switch%20%28aE.button%29%20%7B%0A%09%09%09%09case%200%3A%0A%09%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%09%09if%20%28%24._.pButtonClickActionLeft%20%21%3D%3D%200%20%26%26%20%21aE.shiftKey%20%26%26%20%21%24.accel%28aE%29%20%26%26%20%21aE.altKey%29%0A%09%09%09%09%09%09%24._buttonClickActions%28%24._.pButtonClickActionLeft%2C%20aE%29%3B%0A%09%09%09%09%09else%20if%20%28%24._.pButtonClickActionLeftCtrl%20%21%3D%3D%200%20%26%26%20%21aE.shiftKey%20%26%26%20%24.accel%28aE%29%20%26%26%20%21aE.altKey%29%0A%09%09%09%09%09%09%24._buttonClickActions%28%24._.pButtonClickActionLeftCtrl%2C%20aE%29%3B%0A%09%09%09%09%09else%20if%20%28%24._.pButtonClickActionLeftShift%20%21%3D%3D%200%20%26%26%20aE.shiftKey%20%26%26%20%21%24.accel%28aE%29%20%26%26%20%21aE.altKey%29%0A%09%09%09%09%09%09%24._buttonClickActions%28%24._.pButtonClickActionLeftShift%2C%20aE%29%3B%0A%09%09%09%09%09else%20if%20%28%24._.pButtonClickActionLeftCtrlShift%20%21%3D%3D%200%20%26%26%20aE.shiftKey%20%26%26%20%24.accel%28aE%29%20%26%26%20%21aE.altKey%29%0A%09%09%09%09%09%09%24._buttonClickActions%28%24._.pButtonClickActionLeftCtrlShift%2C%20aE%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%201%3A%0A%09%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%09%09if%20%28%24._.pButtonClickActionMiddle%20%21%3D%3D%200%20%26%26%20%21aE.shiftKey%20%26%26%20%21%24.accel%28aE%29%20%26%26%20%21aE.altKey%29%0A%09%09%09%09%09%09%24._buttonClickActions%28%24._.pButtonClickActionMiddle%2C%20aE%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%7D%3B%0A%0A%09%09if%20%28%21window%5B%24._UID%5D%5B%22RandomID%22%5D%29%20%7B%0A%09%09%09window%5B%24._UID%5D%5B%22RandomID%22%5D%20%3D%20parseInt%28Math.random%28%29%20*%2010000%2C%2010%29%3B%0A%09%09%7D%0A%09%09%24._randomID%20%3D%20window%5B%24._UID%5D%5B%22RandomID%22%5D%3B%0A%0A%09%09if%20%28%21window%5B%24._UID%5D%5B%22FrameScriptLoaded%22%5D%29%20%7B%0A%09%09%09window%5B%24._UID%5D%5B%22FrameScriptLoaded%22%5D%20%3D%20true%3B%0A%09%09%09%24._frameScript%20%3D%20%22data%3Aapplication/javascript%2C%22%20+%20encodeURIComponent%28%24.getHelp%28%22%25FrameScript%25%22%29%0A%09%09%09%09.replace%28/%25Translate_Sel_ID%25/g%2C%20%24._translateSelMsgID%29%0A%09%09%09%09.replace%28/%25On_Release_Icon_ID%25/g%2C%20%24._onReleaseIconMsgID%29%0A%09%09%09%09.replace%28/%25Move_Popup_ID%25/g%2C%20%24._movePopupMsgID%29%0A%09%09%09%09.replace%28/%25Cleanup_ID%25/g%2C%20%24._cleanupMsgID%29%0A%09%09%09%09.replace%28/%25Response_ID%25/g%2C%20%24._responseMsgID%29%29%3B%0A%09%09%09%24._globalMM.loadFrameScript%28%24._frameScript%2C%20true%29%3B%0A%09%09%09%24._globalMM.addMessageListener%28%24._responseMsgID%2C%20%24._messageResponse%29%3B%0A%09%09%7D%0A%0A%09%09for%20%28let%20p%20in%20%24.DefPrefs%29%20%7B%0A%09%09%09if%20%28%24.DefPrefs.hasOwnProperty%28p%29%29%0A%09%09%09%09window%5B%24._UID%5D%5B%22Preferences%22%5D%5Bp%5D%20%3D%20%24.gPref%28p%29%3B%0A%09%09%7D%0A%0A%09%09%24._%20%3D%20window%5B%24._UID%5D%5B%22Preferences%22%5D%3B%0A%0A%09%09%24.handleEngines%28%29%3B%0A%09%09%24.XULCSSLoader%28%29%3B%0A%09%09%24.HTMLCSSLoader%28%29%3B%0A%09%09%24.handlePrefObserver%28%29%3B%0A%09%09%24.addListeners%28%29%3B%0A%0A%09%09if%20%28%22CustomizableUI%22%20in%20window%29%20%7B%0A%09%09%09if%20%28%21window%5B%24._UID%5D%5B%22CustomizableUI%22%5D%29%20%7B%0A%09%09%09%09window%5B%24._UID%5D%5B%22CustomizableUI%22%5D%20%3D%20true%3B%0A%09%09%09%09CustomizableUI.addListener%28%7B%0A%09%09%09%09%09onCustomizeEnd%3A%20function%28aWindow%29%20%7B%0A%09%09%09%09%09%09var%20thisBtn%20%3D%20aWindow.document.getElementById%28self.id%29%3B%0A%09%09%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09%09%09aWindow%5B%24._UID%5D%5B%22CustomizableUI%22%5D%20%26%26%20thisBtn.MultiTranslator.selfDestroy%28%29%3B%0A%09%09%09%09%09%09%7D%2C%20Math.floor%28Math.random%28%29%20*%20%281%20+%202000%20-%20200%29%29%20+%20200%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%7D%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09addDestructor%28function%28aReason%29%20%7B%0A%09%09%09if%20%28aReason%20%3D%3D%3D%20%22delete%22%20%7C%7C%20aReason%20%3D%3D%3D%20%22update%22%29%20%7B%0A%09%09%09%09%24.unInit%28%29%3B%0A%09%09%09%7D%0A%09%09%09if%20%28aReason%20%3D%3D%3D%20%22delete%22%20%7C%7C%20aReason%20%3D%3D%3D%20%22destructor%22%29%20%7B%0A%09%09%09%09%24._mm.sendAsyncMessage%28%24._cleanUpMsgID%29%3B%0A%09%09%09%09%24._globalMM.removeDelayedFrameScript%28%24._frameScript%29%3B%0A%09%09%09%09%24._globalMM.removeMessageListener%28%24._responseMsgID%2C%20%24._messageResponse%29%3B%0A%09%09%09%7D%0A%09%09%09if%20%28aReason%20%3D%3D%3D%20%22delete%22%29%20%7B%0A%09%09%09%09%28Services.prefs.getBranch%28%24.Branch%29%29.deleteBranch%28%22%22%29%3B%0A%09%09%09%09Services.prefs.savePrefFile%28null%29%3B%0A%09%09%09%09delete%20window%5B%24._UID%5D%3B%0A%09%09%09%7D%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09loadItemsFile%3A%20function%28aPath%2C%20aObjName%29%20%7B%0A%09%09OS.File.read%28aPath%29.then%28function%20onSuccess%28aReadData%29%20%7B%0A%09%09%09let%20data%20%3D%20new%20TextDecoder%28%29.decode%28aReadData%29%3B%0A%09%09%09let%20count%20%3D%20aObjName%20%3D%3D%3D%20%22PanelEngines%22%20%3F%203%20%3A%202%3B%0A%09%09%09data%20%3D%20JSON.parse%28data%29%3B%0A%09%09%09if%20%28%21data%20%7C%7C%20data.length%20%3C%3D%200%29%0A%09%09%09%09return%3B%0A%09%09%09let%20customEnginesObj%20%3D%20%7B%7D%3B%0A%09%09%09try%20%7B%0A%09%09%09%09Array.prototype.slice.call%28data%29.forEach%28function%28aObj%29%20%7B%0A%09%09%09%09%09customEnginesObj%5B++count%5D%20%3D%20aObj%3B%0A%09%09%09%09%7D%29%3B%0A%09%09%09%7D%20finally%20%7B%0A%09%09%09%09%24%5BaObjName%5D%20%3D%20%24.mergeObj%28customEnginesObj%2C%20%24%5BaObjName%5D%29%3B%0A%09%09%09%09%24.isOKToCreateElements%20%3D%20true%3B%0A%09%09%09%7D%0A%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09OS.File.writeAtomic%28aPath%2C%20JSON.stringify%28%24.customEngines%5BaObjName%5D%2C%20null%2C%20%22%5Ct%22%29%2C%20%7B%0A%09%09%09%09tmpPath%3A%20aPath%20+%20%22.tmp%22%2C%0A%09%09%09%09noOverwrite%3A%20true%2C%0A%09%09%09%09encoding%3A%20%22utf-8%22%0A%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%24.loadItemsFile%28aPath%2C%20aObjName%29%3B%0A%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%09%7D%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09handleEngines%3A%20function%28%29%20%7B%0A%09%09%24.URLBarEngines%20%3D%20%24.defaultEngines.URLBarEngines%3B%0A%09%09%24.PanelEngines%20%3D%20%24.defaultEngines.PanelEngines%3B%0A%0A%09%09let%20anyCustomEnabled%20%3D%20%24._.pShowCustomURLBarEngines%20%7C%7C%20%24._.pShowCustomPanelEngines%3B%0A%09%09let%20storagePath%20%3D%20%24.storagePath%3B%0A%09%09if%20%28anyCustomEnabled%29%20%7B%0A%09%09%09%24.isOKToCreateElements%20%3D%20false%3B%0A%09%09%09let%20URLBarEnginesPath%20%3D%20OS.Path.join%28storagePath%2C%20%22URLBarEngines.json%22%29%3B%0A%09%09%09let%20PanelEnginesPath%20%3D%20OS.Path.join%28storagePath%2C%20%22PanelEngines.json%22%29%3B%0A%09%09%09%24._.pShowCustomURLBarEngines%20%26%26%20%24.loadItemsFile%28URLBarEnginesPath%2C%20%22URLBarEngines%22%29%3B%0A%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%24._.pShowCustomPanelEngines%20%26%26%20%24.loadItemsFile%28PanelEnginesPath%2C%20%22PanelEngines%22%29%3B%0A%09%09%09%7D%2C%20200%29%3B%0A%09%09%7D%20else%0A%09%09%09%24.isOKToCreateElements%20%3D%20true%3B%0A%09%09%28function%20retry%28%29%20%7B%0A%09%09%09clearTimeout%28window%5B%24._UID%5D%5B%22ElementCreationTimer%22%5D%29%3B%0A%09%09%09window%5B%24._UID%5D%5B%22ElementCreationTimer%22%5D%20%3D%20setTimeout%28function%28%29%20%7B%0A%09%09%09%09if%20%28%24.isOKToCreateElements%29%0A%09%09%09%09%09%24.createElements%28true%29%3B%0A%09%09%09%09else%0A%09%09%09%09%09retry%28%29%3B%0A%09%09%09%7D%2C%20parseInt%28%28anyCustomEnabled%20%3F%20200%20%3A%2010%29%2C%2010%29%29%3B%0A%09%09%7D%29%28%29%3B%0A%09%7D%2C%0A%0A%09customEngines%3A%20%7B%0A%09%09%22URLBarEngines%22%3A%20%5B%7B%0A%09%09%09%22label%22%3A%20%22Bing%20Translator%20Auto%20To%20English%22%2C%0A%09%09%09%22command%22%3A%20%22javascript%3A%28function%28%29%7Bvar%2520s%2520%3D%2520document.createElement%28%27scr%27+%27ipt%27%29%3B%22%20+%0A%09%09%09%09%22%2520s.type%2520%3D%2520%27text/javascript%27%3B%2520s.src%2520%3D%2520%27http%3A//labs.microsofttranslato%22%20+%0A%09%09%09%09%22r.com/bookmarklet/default.aspx%3Ff%3Djs%26to%3Den%27%3B%2520document.body.insertBefore%28s%2C%2520do%22%20+%0A%09%09%09%09%22cument.body.firstChild%29%3B%7D%29%28%29%22%2C%0A%09%09%09%22image%22%3A%201%2C%0A%09%09%09%22tooltip%22%3A%20%22%22%0A%09%09%7D%2C%20%7B%0A%09%09%09%22label%22%3A%20%22Google%20Translator%20Auto%20To%20English%22%2C%0A%09%09%09%22command%22%3A%20%22https%3A//translate.google.com/translate%3Fu%3D%25%25URL%25%25%26hl%3Dauto%26langpair%3Dauto%7Cen%22%20+%0A%09%09%09%09%22%26tbb%3D1%26ie%3DUTF-8%22%2C%0A%09%09%09%22image%22%3A%202%2C%0A%09%09%09%22tooltip%22%3A%20%22%22%0A%09%09%7D%5D%2C%0A%09%09%22PanelEngines%22%3A%20%5B%7B%0A%09%09%09%22label%22%3A%20%22Google%20En%20To%20Ru%22%2C%0A%09%09%09%22image%22%3A%202%2C%0A%09%09%09%22method%22%3A%20%22POST%22%2C%0A%09%09%09%22referer%22%3A%20%22https%3A//translate.google.com/%3Ftab%3DyT%23en%22%2C%0A%09%09%09%22action%22%3A%20%22https%3A//translate.google.com/%22%2C%0A%09%09%09%22post%22%3A%20%22client%3Dt%26hl%3Den%26sl%3Den%26tl%3Dru%26multires%3D1%26prev%3Dbtn%26ssel%3D0%26tsel%3D0%26sc%3D1%26text%3D%25%25TEXT%25%25%22%2C%0A%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%22xpath%22%3A%20%22.//span%5B@id%3D%5C%22result_box%5C%22%5D%7C.//div%5B@id%3D%5C%22result_box%5C%22%5D%22%2C%0A%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%22end%22%3A%20%22%22%0A%09%09%7D%2C%20%7B%0A%09%09%09%22label%22%3A%20%22Google%20Ru%20To%20En%22%2C%0A%09%09%09%22image%22%3A%202%2C%0A%09%09%09%22method%22%3A%20%22POST%22%2C%0A%09%09%09%22referer%22%3A%20%22https%3A//translate.google.com/%3Ftab%3DyT%23ru%22%2C%0A%09%09%09%22action%22%3A%20%22https%3A//translate.google.com/%22%2C%0A%09%09%09%22post%22%3A%20%22client%3Dt%26hl%3Dru%26sl%3Dru%26tl%3Den%26multires%3D1%26prev%3Dbtn%26ssel%3D0%26tsel%3D0%26sc%3D1%26text%3D%25%25TEXT%25%25%22%2C%0A%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%22xpath%22%3A%20%22.//span%5B@id%3D%5C%22result_box%5C%22%5D%7C.//div%5B@id%3D%5C%22result_box%5C%22%5D%22%2C%0A%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%22end%22%3A%20%22%22%0A%09%09%7D%2C%20%7B%0A%09%09%09%22label%22%3A%20%22Weblio%20Translation%20English-Japanese%22%2C%0A%09%09%09%22image%22%3A%20%22http%3A//www.westatic.com/img/favicon/ejje.ico%22%2C%0A%09%09%09%22method%22%3A%20%22POST%22%2C%0A%09%09%09%22referer%22%3A%20%22http%3A//translate.weblio.jp/%22%2C%0A%09%09%09%22action%22%3A%20%22http%3A//translate.weblio.jp/%22%2C%0A%09%09%09%22post%22%3A%20%22lp%3DEJ%26lpf%3D%26rt%3D%26translatedText%3D%26tlt%3Denglish%26prtRt%3D%26originalText%3D%25%25TEXT%25%25%26sentenceStyle%3Dspoken%22%2C%0A%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%22xpath%22%3A%20%22id%28%5C%22translatedText%5C%22%29%22%2C%0A%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%22end%22%3A%20%22%22%0A%09%09%7D%2C%20%7B%0A%09%09%09%22label%22%3A%20%22Weblio%20Translation%20Japanese-English%22%2C%0A%09%09%09%22image%22%3A%20%22http%3A//www.westatic.com/img/favicon/ejje.ico%22%2C%0A%09%09%09%22method%22%3A%20%22POST%22%2C%0A%09%09%09%22referer%22%3A%20%22http%3A//translate.weblio.jp/%22%2C%0A%09%09%09%22action%22%3A%20%22http%3A//translate.weblio.jp/%22%2C%0A%09%09%09%22post%22%3A%20%22lp%3DJE%26lpf%3D%26rt%3D%26translatedText%3D%26tlt%3Denglish%26prtRt%3D%26originalText%3D%25%25TEXT%25%25%26sentenceStyle%3Dspoken%22%2C%0A%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%22xpath%22%3A%20%22id%28%5C%22translatedText%5C%22%29%22%2C%0A%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%22end%22%3A%20%22%22%0A%09%09%7D%5D%0A%09%7D%2C%0A%0A%09defaultEngines%3A%20%7B%0A%09%09%22URLBarEngines%22%3A%20%7B%0A%09%09%09%221%22%3A%20%7B%0A%09%09%09%09%22label%22%3A%20%22Bing%20Translator%22%2C%0A%09%09%09%09%22command%22%3A%20%22javascript%3A%28function%28%29%7Bvar%2520s%2520%3D%2520document.createElement%28%27scr%27+%27ipt%27%29%3B%2520s.type%2520%3D%2520%27text/javascript%27%3B%2520s.src%2520%3D%2520%27http%3A//labs.microsofttranslator.com/bookmarklet/default.aspx%3Ff%3Djs%26to%3D%25%25LNGTO%25%25%27%3B%2520document.body.insertBefore%28s%2C%2520document.body.firstChild%29%3B%7D%29%28%29%22%2C%0A%09%09%09%09%22image%22%3A%201%2C%0A%09%09%09%09%22tooltip%22%3A%20%22Translate%20page%20with%20Bing%20Translator.%5Cn%5CnThe%20source%20language%20is%20auto%20detected.%20The%20destination%20language%20is%20set%20from%20the%20Page%20translator%20options%20menu.%22%0A%09%09%09%7D%2C%0A%09%09%09%222%22%3A%20%7B%0A%09%09%09%09%22label%22%3A%20%22Google%20Translator%22%2C%0A%09%09%09%09%22command%22%3A%20%22https%3A//translate.google.com/translate%3Fu%3D%25%25URL%25%25%26hl%3D%25%25LNGTO%25%25%26langpair%3D%25%25LNGFROM%25%25%7C%25%25LNGTO%25%25%26tbb%3D1%26ie%3DUTF-8%22%2C%0A%09%09%09%09%22image%22%3A%202%2C%0A%09%09%09%09%22tooltip%22%3A%20%22Translate%20page%20with%20Google%20Translator.%5Cn%5CnThe%20source/destination%20languages%20are%20set%20from%20the%20Page%20translator%20options%20menu.%22%0A%09%09%09%7D%0A%09%09%7D%2C%0A%09%09%22PanelEngines%22%3A%20%7B%0A%09%09%09%221%22%3A%20%7B%0A%09%09%09%09%22label%22%3A%20%22Bing%20Translator%22%2C%0A%09%09%09%09%22image%22%3A%201%2C%0A%09%09%09%09%22method%22%3A%20%22GET%22%2C%0A%09%09%09%09%22referer%22%3A%20%22http%3A//www.microsofttranslator.com/%22%2C%0A%09%09%09%09%22action%22%3A%20%22http%3A//api.microsofttranslator.com/V2/Ajax.svc/Translate%3Ffrom%3D%2522%25%25LNGFROM%25%25%2522%26to%3D%2522%25%25LNGTO%25%25%2522%26loc%3Den%26ctr%3D%26text%3D%25%25TEXT%25%25%22%2C%0A%09%09%09%09%22post%22%3A%20%22%22%2C%0A%09%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%09%22xpath%22%3A%20%22%22%2C%0A%09%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%09%22end%22%3A%20%22%22%0A%09%09%09%7D%2C%0A%09%09%09%222%22%3A%20%7B%0A%09%09%09%09%22label%22%3A%20%22Google%20Translator%22%2C%0A%09%09%09%09%22image%22%3A%202%2C%0A%09%09%09%09%22method%22%3A%20%22POST%22%2C%0A%09%09%09%09%22referer%22%3A%20%22https%3A//translate.google.com/%22%2C%0A%09%09%09%09%22action%22%3A%20%22https%3A//translate.google.com/%22%2C%0A%09%09%09%09%22post%22%3A%20%22client%3Dt%26hl%3Dauto%26sl%3D%25%25LNGFROM%25%25%26tl%3D%25%25LNGTO%25%25%26multires%3D1%26prev%3Dbtn%26ssel%3D0%26tsel%3D0%26sc%3D1%26text%3D%25%25TEXT%25%25%22%2C%0A%09%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%09%22xpath%22%3A%20%22.//span%5B@id%3D%5C%22result_box%5C%22%5D%7C.//div%5B@id%3D%5C%22result_box%5C%22%5D%22%2C%0A%09%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%09%22end%22%3A%20%22%22%0A%09%09%09%7D%2C%0A%09%09%09%223%22%3A%20%7B%0A%09%09%09%09%22label%22%3A%20%22Yandex%20Translator%22%2C%0A%09%09%09%09%22image%22%3A%203%2C%0A%09%09%09%09%22method%22%3A%20%22GET%22%2C%0A%09%09%09%09%22referer%22%3A%20%22https%3A//translate.yandex.net/%22%2C%0A%09%09%09%09%22action%22%3A%20%22https%3A//translate.yandex.net/api/v1.5/tr.json/translate%3Fkey%3D%25%25API_KEY%25%25%26lang%3D%25%25LNGTO%25%25%26text%3D%25%25TEXT%25%25%26options%3D1%22%2C%0A%09%09%09%09%22post%22%3A%20%22%22%2C%0A%09%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%09%22xpath%22%3A%20%22%22%2C%0A%09%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%09%22end%22%3A%20%22%22%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09populateSelfTooltip%3A%20function%28aN%29%20%7B%0A%09%09aN.textContent%20%3D%20%22%22%3B%0A%0A%09%09var%20grid%20%3D%20aN.appendChild%28%24.%24CNS%28%22grid%22%29%29%3B%0A%09%09var%20cols%20%3D%20grid.appendChild%28%24.%24CNS%28%22columns%22%29%29%3B%0A%09%09cols.appendChild%28%24.%24CNS%28%22column%22%2C%20%7B%0A%09%09%09flex%3A%202%0A%09%09%7D%29%29%3B%0A%09%09cols.appendChild%28%24.%24CNS%28%22column%22%2C%20%7B%0A%09%09%09flex%3A%203%0A%09%09%7D%29%29%3B%0A%09%09cols.appendChild%28%24.%24CNS%28%22column%22%2C%20%7B%0A%09%09%09flex%3A%201%0A%09%09%7D%29%29%3B%0A%09%09var%20rows%20%3D%20grid.appendChild%28%24.%24CNS%28%22rows%22%29%29%3B%0A%09%09//%20Append%20Row%0A%09%09let%20AR%20%3D%20function%28aRowsNode%2C%20aLabel1%2C%20aLabel2%2C%20aLabel3%2C%20aEmpty%29%20%7B%0A%09%09%09let%20row%20%3D%20%24.%24CNS%28%22row%22%29%3B%0A%09%09%09if%20%28aEmpty%29%20%7B%0A%09%09%09%09row.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09%09value%3A%20%22%20%22%2C%0A%09%09%09%09%09width%3A%200%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09row.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09%09value%3A%20aLabel1%2C%0A%09%09%09%09%09style%3A%20%22font-weight%3A%20bold%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09row.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09%09value%3A%20aLabel2%2C%0A%09%09%09%09%09style%3A%20%22font-weight%3A%20bold%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09let%20desc%20%3D%20%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09%09%09width%3A%20250%2C%0A%09%09%09%09%7D%29%3B%0A%09%09%09%09desc.textContent%20%3D%20aLabel3%3B%20//%20Use%20of%20%22textContent%22%20to%20achieve%20word%20wrap.%20%AC%AC%0A%09%09%09%09row.appendChild%28desc%29%3B%0A%09%09%09%7D%0A%09%09%09aRowsNode.appendChild%28row%29%3B%0A%09%09%7D%3B%0A%09%09let%20clickAction%20%3D%20function%28aAction%29%20%7B%0A%09%09%09switch%20%28aAction%29%20%7B%0A%09%09%09%09case%201%3A%0A%09%09%09%09%09return%20%22Open%20main%20menu%22%3B%0A%09%09%09%09case%202%3A%0A%09%09%09%09%09return%20%22Translate%20selection%22%3B%0A%09%09%09%09case%203%3A%0A%09%09%09%09%09return%20%22Translate%20current%20page%22%3B%0A%09%09%09%09case%204%3A%0A%09%09%09%09%09return%20%22Translate%20clipboard%20content%22%3B%0A%09%09%09%09case%205%3A%0A%09%09%09%09%09return%20%22Open%20page%20translation%20menu%22%3B%0A%09%09%09%09case%206%3A%0A%09%09%09%09%09return%20%22Open%20options%20window%22%3B%0A%09%09%09%7D%0A%09%09%7D%3B%0A%09%09AR%28rows%2C%20self.name%2C%20%22%u2192%22%2C%20%22ID%20%3D%20%22%20+%20self.id.slice%2820%29%29%3B%0A%09%09AR%28rows%2C%20null%2C%20null%2C%20null%2C%20true%29%3B%0A%09%09if%20%28%24._.pButtonClickActionLeft%20%21%3D%3D%200%29%0A%09%09%09AR%28rows%2C%20%22Left%20click%22%2C%20%22%u2192%22%2C%20clickAction%28%24._.pButtonClickActionLeft%29%29%3B%0A%09%09if%20%28%24._.pButtonClickActionMiddle%20%21%3D%3D%200%29%0A%09%09%09AR%28rows%2C%20%22Middle%20click%22%2C%20%22%u2192%22%2C%20clickAction%28%24._.pButtonClickActionMiddle%29%29%3B%0A%09%09if%20%28%24._.pButtonClickActionLeftCtrl%20%21%3D%3D%200%29%0A%09%09%09AR%28rows%2C%20%22Ctrl%20+%20Left%20click%22%2C%20%22%u2192%22%2C%20clickAction%28%24._.pButtonClickActionLeftCtrl%29%29%3B%0A%09%09if%20%28%24._.pButtonClickActionLeftShift%20%21%3D%3D%200%29%0A%09%09%09AR%28rows%2C%20%22Shift%20+%20Left%20click%22%2C%20%22%u2192%22%2C%20clickAction%28%24._.pButtonClickActionLeftShift%29%29%3B%0A%09%09if%20%28%24._.pButtonClickActionLeftCtrlShift%20%21%3D%3D%200%29%0A%09%09%09AR%28rows%2C%20%22Ctrl%20+%20Shift%20+%20Left%20click%22%2C%20%22%u2192%22%2C%20clickAction%28%24._.pButtonClickActionLeftCtrlShift%29%29%3B%0A%09%09AR%28rows%2C%20null%2C%20null%2C%20null%2C%20true%29%3B%0A%09%09if%20%28%24._.pTransOnRelease%29%20%7B%0A%09%09%09AR%28rows%2C%20%22Trans.%20selection%20trigger%22%2C%20%22%u2192%22%2C%20%22Automatic%20after%20release%22%29%3B%0A%09%09%09if%20%28%24._.pTransOnReleaseControlKey%20%26%26%20%24._.pTransOnRelease%29%0A%09%09%09%09AR%28rows%2C%20%22%22%2C%20%22%22%2C%20%24.accel%28%29%20+%20%22%20key%20is%20required%22%29%3B%0A%09%09%09if%20%28%24._.pTransOnReleaseShiftKey%20%26%26%20%24._.pTransOnRelease%29%0A%09%09%09%09AR%28rows%2C%20%22%22%2C%20%22%22%2C%20%22Shift%20key%20is%20required%22%29%3B%0A%09%09%09if%20%28%24._.pTransOnReleaseAltKey%20%26%26%20%24._.pTransOnRelease%29%0A%09%09%09%09AR%28rows%2C%20%22%22%2C%20%22%22%2C%20%22Alt%20key%20is%20required%22%29%3B%0A%09%09%7D%0A%09%09aN.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%20//%20Empty%20space%0A%09%09let%20desc%20%3D%20%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09style%3A%20%22font-weight%3Abold%3B%22%2C%0A%09%09%7D%29%3B%0A%09%09//%20Use%20of%20%22textContent%22%20to%20achieve%20word%20wrap.%20%AC%AC%0A%09%09desc.textContent%20%3D%20%22Read%20this%20button%20help%20for%20very%20important%20usage%20notes.%5Cn%22%20+%0A%09%09%09%22Right%20click%20on%20button%2C%20%5C%22Button%20Help%5C%22%20item.%22%3B%0A%09%09aN.appendChild%28desc%29%3B%0A%09%7D%2C%0A%0A%09_buttonClickActions%3A%20function%28aAction%2C%20aE%29%20%7B%0A%09%09switch%20%28aAction%29%20%7B%0A%09%09%09case%201%3A%20//%20Open%20Main%20Menu%0A%09%09%09%09let%20p%20%3D%20%24.%24%28%24._UID%20+%20%22_self_popup%22%29%3B%0A%09%09%09%09p%20%26%26%20p.openPopup%28self%2C%20%22after_start%22%2C%200%2C%200%2C%20false%2C%20null%2C%20null%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%202%3A%20//%20Translate%20selection%0A%09%09%09%09%24.translateSelection%28%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%203%3A%20//%20Translate%20current%20page%0A%09%09%09%09%24.translatePage%28aE%2C%20gBrowser.selectedTab.linkedBrowser.currentURI%2C%20false%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%204%3A%20//%20Translate%20clipboard%20content%0A%09%09%09%09%24.translateClipboardContent%28%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%205%3A%20//%20Open%20Page%20translation%20menu%0A%09%09%09%09let%20m%20%3D%20%24.%24%28%24._UID%20+%20%22_translationIconOnURLBarMenu%22%29%3B%0A%09%09%09%09m%20%26%26%20m.openPopup%28self%2C%20%22after_start%22%2C%200%2C%200%2C%20false%2C%20null%2C%20null%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%206%3A%20//%20Open%20options%20window%0A%09%09%09%09%24.openOptions%28%29%3B%0A%09%09%09%09break%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09_messageResponse%3A%20%7B%0A%09%09receiveMessage%3A%20function%28aMsg%29%20%7B%0A%09%09%09if%20%28aMsg.name%20%21%3D%3D%20%24._responseMsgID%29%0A%09%09%09%09return%3B%0A%09%09%09switch%20%28aMsg.data.id%29%20%7B%0A%09%09%09%09case%201%3A%20//%20Translate%20selection%20directly%0A%09%09%09%09case%202%3A%20//%20Translate%20selection%20from%20mouseover%20icon%0A%09%09%09%09%09%24.doTranslation%28aMsg.data.sel%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%203%3A%20//%20Move%20the%20popup%20to%20selection%0A%09%09%09%09%09if%20%28%24._.pPanelTransUseTextbox%29%20%7B%0A%09%09%09%09%09%09let%20d%20%3D%20%24.dummyPanel%3B%0A%09%09%09%09%09%09d%20%26%26%20d.openPopup%28null%2C%20%22%22%2C%200%2C%200%2C%20false%2C%20null%2C%20null%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09let%20p%20%3D%20%24.transPanel%3B%0A%09%09%09%09%09if%20%28p.state%20%3D%3D%3D%20%22open%22%29%0A%09%09%09%09%09%09p.moveTo%28aMsg.data.posX%2C%20aMsg.data.posY%29%3B%0A%09%09%09%09%09else%0A%09%09%09%09%09%09p.openPopupAtScreen%28aMsg.data.posX%2C%20aMsg.data.posY%2C%20false%29%3B%0A%09%09%09%09%09clearTimeout%28window%5B%24._UID%5D%5B%22ResizingTimer%22%5D%29%3B%0A%09%09%09%09%09window%5B%24._UID%5D%5B%22ResizingTimer%22%5D%20%3D%20setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09%09%24.sizeChange%28%29%3B%0A%09%09%09%09%09%7D%2C%2010%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%7D%2C%0A%09%7D%2C%0A%0A%09unInit%3A%20function%28%29%20%7B%0A%09%09let%20selfEls%20%3D%20document.getElementsByAttribute%28%22cb_id%22%2C%20%24._UID%29%3B%0A%09%09Array.prototype.slice.call%28selfEls%29.forEach%28function%28aEl%29%20%7B%20//%20Delete%20all%20elements%20created%20by%20this%20button.%0A%09%09%09aEl%20%26%26%20aEl.parentNode.removeChild%28aEl%29%3B%0A%09%09%7D%29%3B%0A%09%09clearTimeout%28window%5B%24._UID%5D%5B%22ElementCreationTimer%22%5D%29%3B%0A%09%09clearTimeout%28window%5B%24._UID%5D%5B%22ResizingTimer%22%5D%29%3B%0A%09%09clearTimeout%28window%5B%24._UID%5D%5B%22CleanSlateTimer%22%5D%29%3B%0A%09%09%24.handlePrefObserver%28true%29%3B%0A%09%09%24.removeListeners%28%29%3B%0A%09%7D%2C%0A%0A%09addListeners%3A%20function%28%29%20%7B%0A%09%09if%20%28%21window%5B%24._UID%5D%5B%22Listeners%22%5D%29%20%7B%0A%09%09%09window%5B%24._UID%5D%5B%22Listeners%22%5D%20%3D%20true%3B%0A%09%09%09%5B%22click%22%2C%20%22mousedown%22%2C%20%22mouseup%22%5D.forEach%28function%28aLi%29%20%7B%0A%09%09%09%09if%20%28%22gBrowser%22%20in%20window%29%20%7B%0A%09%09%09%09%09gBrowser.addEventListener%28aLi%2C%20%24.onReleaseListener%2C%20true%29%3B%0A%09%09%09%09%7D%20else%20if%20%28%24.%24%28%22tabpanelcontainer%22%29%29%20%7B%20//%20Thunderbird%20main%20window%0A%09%09%09%09%09%24.%24%28%22tabpanelcontainer%22%29.addEventListener%28aLi%2C%20%24.onReleaseListener%2C%20true%29%3B%0A%09%09%09%09%7D%20else%20if%20%28%24.%24%28%22messagepane%22%29%29%20%7B%20//%20Message%20window%0A%09%09%09%09%09%24.%24%28%22messagepanebox%22%29.addEventListener%28aLi%2C%20%24.onReleaseListener%2C%20true%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09//%20aInverse%20argument%20is%20for%20when%20removeListeners%20is%20called%20from%20prefObserver%20%28After%20the%20pTransOnRelease%20pref.%20is%20changed.%29.%0A%09removeListeners%3A%20function%28aInverse%29%20%7B%0A%09%09%5B%22click%22%2C%20%22mousedown%22%2C%20%22mouseup%22%5D.forEach%28function%28aLi%29%20%7B%0A%09%09%09if%20%28%22gBrowser%22%20in%20window%29%20%7B%0A%09%09%09%09gBrowser.removeEventListener%28aLi%2C%20%24.onReleaseListener%2C%20true%29%3B%0A%09%09%09%7D%20else%20if%20%28%24.%24%28%22tabpanelcontainer%22%29%29%20%7B%20//%20Thunderbird%20main%20window%0A%09%09%09%09%24.%24%28%22tabpanelcontainer%22%29.removeEventListener%28aLi%2C%20%24.onReleaseListener%2C%20true%29%3B%0A%09%09%09%7D%20else%20if%20%28%24.%24%28%22messagepane%22%29%29%20%7B%20//%20Message%20window%0A%09%09%09%09%24.%24%28%22messagepanebox%22%29.removeEventListener%28aLi%2C%20%24.onReleaseListener%2C%20true%29%3B%0A%09%09%09%7D%0A%09%09%7D%29%3B%0A%09%09let%20ctxM%20%3D%20%24.%24%28%22contentAreaContextMenu%22%29%20%7C%7C%20%24.%24%28%22mailContext%22%29%3B%0A%09%09ctxM.removeEventListener%28%22popupshowing%22%2C%20%24.contextMenuListener%2C%20false%29%3B%0A%09%09window%5B%24._UID%5D%5B%22Listeners%22%5D%20%3D%20false%3B%0A%09%7D%2C%0A%0A%09assignImages%3A%20function%28aN%29%20%7B%0A%09%09Array.prototype.slice.call%28aN.getElementsByAttribute%28%22data-panel-engine%22%2C%20%22*%22%29%29.forEach%28function%28aMI%29%20%7B%0A%09%09%09aMI%20%26%26%20aMI.setAttribute%28%22image%22%2C%20%24.getEng%28%22image%22%2C%0A%09%09%09%09Boolean%28Number%28aMI.getAttribute%28%22data-panel-engine%22%29%29%29%29%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09createElements%3A%20function%28aInit%29%20%7B%0A%09%09var%20popSet%20%3D%20%24.%24%28%22mainPopupSet%22%29%3B%0A%09%09let%20selfPop%20%3D%20%24.%24%28%24._UID%20+%20%22_self_popup%22%29%3B%0A%09%09let%20that%20%3D%20%22document.getElementById%28%27%22%20+%20self.id%20+%20%22%27%29.MultiTranslator.%22%3B%0A%09%09if%20%28popSet%20%26%26%20%21selfPop%29%20%7B%0A%09%09%09selfPop%20%3D%20popSet.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_self_popup%22%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09orient%3A%20%22vertical%22%2C%0A%09%09%09%09onpopupshowing%3A%20that%20+%20%22assignImages%28this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09onpopuphidden%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09oncommand%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09onclick%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09selfPop.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09label%3A%20%22Translate%20selection%22%2C%0A%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09%22data-panel-engine%22%3A%201%2C%0A%09%09%09%09key%3A%20%24._.pHotkeyTransSelEnabled%20%3F%20%22key%22%20+%20%24._UID%20+%20%22_translate_selection%22%20%3A%20%22%22%2C%0A%09%09%09%09onclick%3A%20that%20+%20%22translateSelection%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09if%20%28%22gBrowser%22%20in%20window%29%20%7B%0A%09%09%09%09selfPop.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Translate%20current%20page%22%2C%0A%09%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09%09%22data-panel-engine%22%3A%200%2C%0A%09%09%09%09%09key%3A%20%24._.pHotkeyTransPageEnabled%20%3F%20%22key%22%20+%20%24._UID%20+%20%22_translate_page%22%20%3A%20%22%22%2C%0A%09%09%09%09%09onclick%3A%20that%20+%20%22translatePage%28event%2C%20gBrowser.selectedTab.linkedBrowser.currentURI%2C%20true%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09selfPop.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09label%3A%20%22Translate%20clipboard%20content%22%2C%0A%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09%22data-panel-engine%22%3A%201%2C%0A%09%09%09%09key%3A%20%24._.pHotkeyTransClipEnabled%20%3F%20%22key%22%20+%20%24._UID%20+%20%22_translate_clipboard%22%20%3A%20%22%22%2C%0A%09%09%09%09onclick%3A%20that%20+%20%22translateClipboardContent%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09selfPop.appendChild%28%24.%24CNS%28%22menuseparator%22%29%29%3B%0A%09%09%09selfPop.appendChild%28%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09label%3A%20%22Options%22%2C%0A%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09onpopupshowing%3A%20that%20+%20%22populateOptionsPopup%28this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%0A%0A%09%09let%20keyset%20%3D%20%24.%24%28%24._UID%20+%20%22_keyset%22%29%3B%0A%09%09if%20%28popSet%20%26%26%20%21keyset%29%20%7B%20//%20Using%20%22my%20own%22%20keyset%20seems%20to%20minimize%20hotkeys%20erratic%20behaivor.%0A%09%09%09popSet.parentNode.appendChild%28%24.%24CNS%28%22keyset%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_keyset%22%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%0A%0A%09%09let%20selfTT%20%3D%20%24.%24%28%24._UID%20+%20%22_self_tooltip%22%29%3B%0A%09%09if%20%28popSet%20%26%26%20%21selfTT%29%20%7B%0A%09%09%09popSet.appendChild%28%24.%24CNS%28%22tooltip%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_self_tooltip%22%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09orient%3A%20%22vertical%22%2C%0A%09%09%09%09onpopupshowing%3A%20that%20+%20%22populateSelfTooltip%28this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09onpopuphidden%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%0A%0A%09%09let%20ctxM%20%3D%20%24.%24%28%22mailContext%22%29%20%7C%7C%20%24.%24%28%22contentAreaContextMenu%22%29%3B%0A%09%09let%20ctxTSelMI%20%3D%20%24.%24%28%24._UID%20+%20%22_translate_selection_context%22%29%3B%0A%09%09let%20ctxTPageMI%20%3D%20%24.%24%28%24._UID%20+%20%22_translate_page_context%22%29%3B%0A%09%09let%20ctxTPageM%20%3D%20%24.%24%28%24._UID%20+%20%22_translate_page_menu_context%22%29%3B%0A%09%09let%20ctxTClipMI%20%3D%20%24.%24%28%24._UID%20+%20%22_translate_clipboard_context%22%29%3B%0A%09%09let%20insertPoint%20%3D%20%24.%24%28%22mailContext-spell-suggestions-separator%22%29%20%7C%7C%20%24.%24%28%22spell-suggestions-separator%22%29%3B%0A%0A%09%09if%20%28ctxM%20%26%26%20%21ctxTSelMI%20%26%26%20%24._.pShowTransSelCtx%29%20%7B%0A%09%09%09ctxTSelMI%20%3D%20%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09label%3A%20%22Translate%20selection%22%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_translate_selection_context%22%2C%0A%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09image%3A%20%24.getEng%28%22image%22%2C%20true%29%2C%0A%09%09%09%09key%3A%20%24._.pHotkeyTransSelEnabled%20%3F%20%22key%22%20+%20%24._UID%20+%20%22_translate_selection%22%20%3A%20%22%22%2C%0A%09%09%09%09onclick%3A%20that%20+%20%22translateSelection%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%3B%0A%09%09%09ctxM.insertBefore%28ctxTSelMI%2C%20insertPoint.nextSibling%29%3B%0A%09%09%09ctxM.addEventListener%28%22popupshowing%22%2C%20%24.contextMenuListener%2C%20false%29%3B%0A%09%09%7D%0A%0A%09%09if%20%28%24._.pShowTransPageCtx%20%26%26%20%22gBrowser%22%20in%20window%29%20%7B%0A%09%09%09if%20%28%21%24._.pShowTransPageCtxMenuMode%20%26%26%20ctxM%20%26%26%20%21ctxTPageMI%29%20%7B%0A%09%09%09%09ctxTPageMI%20%3D%20%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Translate%20current%20page%22%2C%0A%09%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translate_page_context%22%2C%0A%09%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09%09image%3A%20%24.getEng%28%22image%22%2C%20false%29%2C%0A%09%09%09%09%09key%3A%20%24._.pHotkeyTransPageEnabled%20%3F%20%22key%22%20+%20%24._UID%20+%20%22_translate_page%22%20%3A%20%22%22%2C%0A%09%09%09%09%09onclick%3A%20that%20+%20%22translatePage%28event%2C%20gBrowser.selectedTab.linkedBrowser.currentURI%2C%20true%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%3B%0A%09%09%09%09ctxM.insertBefore%28ctxTPageMI%2C%20insertPoint.nextSibling%29%3B%0A%09%09%09%7D%20else%20if%20%28%24._.pShowTransPageCtxMenuMode%20%26%26%20ctxM%20%26%26%20%21ctxTPageM%29%20%7B%0A%09%09%09%09ctxTPageM%20%3D%20%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Translate%20current%20page%22%2C%0A%09%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translate_page_menu_context%22%2C%0A%09%09%09%09%09class%3A%20%22menu-iconic%22%2C%0A%09%09%09%09%09image%3A%20%24.images%5B0%5D%2C%0A%09%09%09%09%7D%29%3B%0A%09%09%09%09ctxTPageM.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09onpopupshowing%3A%20that%20+%20%22populateTranslatePageMenu%28this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09oncommand%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09onclick%3A%20that%20+%20%22translatePage%28event%2C%20gBrowser.selectedTab.linkedBrowser.currentURI%2C%20null%2C%20true%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09ctxM.insertBefore%28ctxTPageM%2C%20insertPoint.nextSibling%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09if%20%28ctxM%20%26%26%20%21ctxTClipMI%20%26%26%20%24._.pShowTransClipCtx%29%20%7B%0A%09%09%09ctxTClipMI%20%3D%20%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09label%3A%20%22Translate%20clipboard%20content%22%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_translate_clipboard_context%22%2C%0A%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09image%3A%20%24.getEng%28%22image%22%2C%20true%29%2C%0A%09%09%09%09key%3A%20%24._.pHotkeyTransClipEnabled%20%3F%20%22key%22%20+%20%24._UID%20+%20%22_translate_clipboard%22%20%3A%20%22%22%2C%0A%09%09%09%09onclick%3A%20that%20+%20%22translateClipboardContent%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%3B%0A%09%09%09ctxM.insertBefore%28ctxTClipMI%2C%20insertPoint.nextSibling%29%3B%0A%09%09%7D%0A%0A%09%09let%20transPanel%20%3D%20%24.transPanel%3B%0A%09%09if%20%28%21transPanel%29%20%7B%0A%09%09%09transPanel%20%3D%20popSet.appendChild%28%24.%24CNS%28%22panel%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_translationPanel%22%2C%0A%09%09%09%09label%3A%20%24.getEng%28%22label%22%2C%20true%29%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09orient%3A%20%22horizontal%22%2C%0A%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09close%3A%20%24._.pPanelTransShowTitleBar%2C%0A%09%09%09%09titlebar%3A%20%24._.pPanelTransShowTitleBar%20%3F%20%22normal%22%20%3A%20%22%22%2C%0A%09%09%09%09level%3A%20%22top%22%2C%0A%09%09%09%09backdrag%3A%20true%2C%0A%09%09%09%09noautohide%3A%20true%2C%0A%09%09%09%09width%3A%20%24._.pPanelTransMaxWidth%2C%0A%09%09%09%09maxwidth%3A%20screen.availWidth%2C%0A%09%09%09%09maxheight%3A%20screen.availHeight%2C%0A%09%09%09%09flex%3A%200%2C%0A%09%09%09%09onpopupshown%3A%20that%20+%20%22setPanelLangListLabel%28this%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09let%20resizerBoxLeft%20%3D%20transPanel.appendChild%28%24.%24CNS%28%22vbox%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_resizerBoxLeft%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09if%20%28%24._.pPanelTransShowTitleBar%29%20%7B%0A%09%09%09%09resizerBoxLeft.appendChild%28%24.%24CNS%28%22resizer%22%2C%20%7B%0A%09%09%09%09%09%22data-corner%22%3A%20true%2C%0A%09%09%09%09%09element%3A%20%24._UID%20+%20%22_translationPanel%22%2C%0A%09%09%09%09%09type%3A%20%22window%22%2C%0A%09%09%09%09%09dir%3A%20%22topleft%22%2C%0A%09%09%09%09%09left%3A%20%220%22%2C%0A%09%09%09%09%09top%3A%20%220%22%2C%0A%09%09%09%09%09width%3A%20%226%22%2C%0A%09%09%09%09%09height%3A%20%2210%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09resizerBoxLeft.appendChild%28%24.%24CNS%28%22resizer%22%2C%20%7B%0A%09%09%09%09%09element%3A%20%24._UID%20+%20%22_translationPanel%22%2C%0A%09%09%09%09%09type%3A%20%22window%22%2C%0A%09%09%09%09%09flex%3A%201%2C%0A%09%09%09%09%09dir%3A%20%22left%22%2C%0A%09%09%09%09%09width%3A%20%226%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09resizerBoxLeft.appendChild%28%24.%24CNS%28%22spacer%22%2C%20%7B%0A%09%09%09%09%09flex%3A%201%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09resizerBoxLeft.appendChild%28%24.%24CNS%28%22resizer%22%2C%20%7B%0A%09%09%09%09%22data-corner%22%3A%20true%2C%0A%09%09%09%09element%3A%20%24._UID%20+%20%22_translationPanel%22%2C%0A%09%09%09%09type%3A%20%22window%22%2C%0A%09%09%09%09dir%3A%20%22bottomleft%22%2C%0A%09%09%09%09left%3A%20%220%22%2C%0A%09%09%09%09bottom%3A%20%220%22%2C%0A%09%09%09%09width%3A%20%226%22%2C%0A%09%09%09%09height%3A%20%2210%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09let%20transPanelVBox%20%3D%20transPanel.appendChild%28%24.%24CNS%28%22vbox%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_translationPanelMainBox%22%2C%0A%09%09%09%09flex%3A%201%0A%09%09%09%7D%29%29%3B%0A%09%09%09if%20%28%24._.pPanelTransShowOptionsBox%29%20%7B%0A%09%09%09%09let%20optBox%20%3D%20transPanelVBox.appendChild%28%24.%24CNS%28%22hbox%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationOptionsBox%22%2C%0A%09%09%09%09%09flex%3A%201%2C%0A%09%09%09%09%09align%3A%20%22baseline%22%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09optBox.appendChild%28%24.%24CNS%28%22toolbarbutton%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationOptionsButton%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Options%22%2C%0A%09%09%09%09%09image%3A%20%24.getEng%28%22image%22%2C%20true%29%2C%0A%09%09%09%09%09type%3A%20%22menu%22%2C%0A%09%09%09%09%09popup%3A%20%24._UID%20+%20%22_translation_options%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09optBox.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09%09value%3A%20%22From%3A%20%22%2C%0A%09%09%09%09%09style%3A%20%22font-weight%3Abold%3B%22%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09optBox.appendChild%28%24.%24CNS%28%22toolbarbutton%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_languageSelectionButtonFrom%22%2C%0A%09%09%09%09%09type%3A%20%22menu%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Select%20source%20language%22%2C%0A%09%09%09%09%09_pref%3A%20%22pPanelTransFromLang%22%2C%0A%09%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09class%3A%20%24._UID%20+%20%22_lang_list%22%2C%0A%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%22data-langlist%22%3A%20%22%7B%27pref%27%3A%27pPanelTransFromLang%27%2C%20%27dir%27%3A%20%27from%27%7D%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09optBox.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09%09value%3A%20%22To%3A%20%22%2C%0A%09%09%09%09%09style%3A%20%22font-weight%3Abold%3B%22%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09optBox.appendChild%28%24.%24CNS%28%22toolbarbutton%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_languageSelectionButtonTo%22%2C%0A%09%09%09%09%09type%3A%20%22menu%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Select%20destination%20language%22%2C%0A%09%09%09%09%09_pref%3A%20%22pPanelTransToLang%22%2C%0A%09%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09class%3A%20%24._UID%20+%20%22_lang_list%22%2C%0A%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%22data-langlist%22%3A%20%22%7B%27pref%27%3A%27pPanelTransToLang%27%2C%20%27dir%27%3A%20%27to%27%7D%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09optBox.appendChild%28%24.%24CNS%28%22spacer%22%2C%20%7B%0A%09%09%09%09%09flex%3A%201%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09transPanelVBox.appendChild%28%24.%24CNS%28%22separator%22%2C%20%7B%0A%09%09%09%09%09class%3A%20%22thin%22%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09let%20vBox1%20%3D%20transPanelVBox.appendChild%28%24.%24CNS%28%22vbox%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_translationResultBox%22%2C%0A%09%09%09%09flex%3A%20100000%2C%0A%09%09%09%09onclick%3A%20that%20+%20%22clickOnTransResult%28this.firstChild.value%20%7C%7C%20this.firstChild.textContent%2C%20this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09if%20%28%24._.pPanelTransUseTextbox%29%20%7B%0A%09%09%09%09let%20dummyPanel%20%3D%20%24.dummyPanel%3B%0A%09%09%09%09if%20%28%21dummyPanel%29%20%7B%0A%09%09%09%09%09dummyPanel%20%3D%20popSet.appendChild%28%24.%24CNS%28%22panel%22%2C%20%7B%0A%09%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationPanelDummy%22%2C%0A%09%09%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09%09%09orient%3A%20%22vertical%22%2C%0A%09%09%09%09%09%09consumeoutsideclicks%3A%20%22false%22%2C%0A%09%09%09%09%09%09onpopupshown%3A%20%22this.onpopupshown%28event%29%3B%22%2C%0A%09%09%09%09%09%09style%3A%20%22opacity%3A0%20%21important%3B%22%2C%0A%09%09%09%09%09%09flex%3A%201%2C%0A%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%09dummyPanel.onpopupshown%20%3D%20function%28aE%29%20%7B%0A%09%09%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09%09%09aE.target.hidePopup%28%29%3B%0A%09%09%09%09%09%09%7D%2C%20100%29%3B%0A%09%09%09%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%09%09%09%7D%3B%0A%09%09%09%09%09dummyPanel.appendChild%28%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationResultContentDummy%22%2C%0A%09%09%09%09%09%09flex%3A%201%2C%0A%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%7D%0A%09%09%09%09vBox1.appendChild%28%24.%24CNS%28%22textbox%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationResultContent%22%2C%0A%09%09%09%09%09class%3A%20%22as_textbox%22%2C%0A%09%09%09%09%09flex%3A%20100000%2C%0A%09%09%09%09%09readonly%3A%20true%2C%0A%09%09%09%09%09focused%3A%20true%2C%0A%09%09%09%09%09multiline%3A%20true%2C%0A%09%09%09%09%09newlines%3A%20%22pasteintact%22%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09vBox1.appendChild%28%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationResultContent%22%2C%0A%09%09%09%09%09class%3A%20%22not_as_textbox%22%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09if%20%28%24._.pPanelTransShowFooter%29%20%7B%0A%09%09%09%09transPanelVBox.appendChild%28%24.%24CNS%28%22separator%22%2C%20%7B%0A%09%09%09%09%09class%3A%20%22thin%22%2C%0A%09%09%09%09%09%22data-opt%22%3A%20%22footer%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09let%20footerBox%20%3D%20transPanelVBox.appendChild%28%24.%24CNS%28%22hbox%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationResultFooterBox%22%2C%0A%09%09%09%09%09%22data-opt%22%3A%20%22footer%22%2C%0A%09%09%09%09%09align%3A%20%22baseline%22%2C%0A%09%09%09%09%09flex%3A%200%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09footerBox.appendChild%28%24.%24CNS%28%22spacer%22%2C%20%7B%0A%09%09%09%09%09flex%3A%201%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09footerBox.appendChild%28%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09%09%09value%3A%20%22Service%20provided%20by%20%22%2C%0A%09%09%09%09%09mousethrough%3A%20%22always%22%2C%0A%09%09%09%09%09style%3A%20%22margin-right%3A0%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09footerBox.appendChild%28%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationResultFooter%22%2C%0A%09%09%09%09%09mousethrough%3A%20%22never%22%2C%0A%09%09%09%09%09onclick%3A%20that%20+%20%22openPage%28this.url%2C%20event%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09style%3A%20%22margin-left%3A0%3Bfont-weight%3Abold%3Bcursor%3Apointer%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09let%20resizerBoxRight%20%3D%20transPanel.appendChild%28%24.%24CNS%28%22vbox%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_resizerBoxRight%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09if%20%28%21%24._.pPanelTransShowTitleBar%29%20%7B%0A%09%09%09%09resizerBoxRight.appendChild%28%24.%24CNS%28%22toolbarbutton%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationClosePanelButton%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Close%20panel%22%2C%0A%09%09%09%09%09oncommand%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09onclick%3A%20that%20+%20%22forceHidePanel%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09resizerBoxRight.appendChild%28%24.%24CNS%28%22resizer%22%2C%20%7B%0A%09%09%09%09%09%22data-corner%22%3A%20true%2C%0A%09%09%09%09%09element%3A%20%24._UID%20+%20%22_translationPanel%22%2C%0A%09%09%09%09%09type%3A%20%22window%22%2C%0A%09%09%09%09%09dir%3A%20%22topright%22%2C%0A%09%09%09%09%09right%3A%20%220%22%2C%0A%09%09%09%09%09top%3A%20%220%22%2C%0A%09%09%09%09%09width%3A%20%226%22%2C%0A%09%09%09%09%09height%3A%20%2210%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09resizerBoxRight.appendChild%28%24.%24CNS%28%22resizer%22%2C%20%7B%0A%09%09%09%09element%3A%20%24._UID%20+%20%22_translationPanel%22%2C%0A%09%09%09%09type%3A%20%22window%22%2C%0A%09%09%09%09flex%3A%201%2C%0A%09%09%09%09dir%3A%20%22right%22%2C%0A%09%09%09%09width%3A%20%226%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09resizerBoxRight.appendChild%28%24.%24CNS%28%22resizer%22%2C%20%7B%0A%09%09%09%09%22data-corner%22%3A%20true%2C%0A%09%09%09%09element%3A%20%24._UID%20+%20%22_translationPanel%22%2C%0A%09%09%09%09type%3A%20%22window%22%2C%0A%09%09%09%09dir%3A%20%22bottomright%22%2C%0A%09%09%09%09right%3A%20%220%22%2C%0A%09%09%09%09bottom%3A%20%220%22%2C%0A%09%09%09%09width%3A%20%226%22%2C%0A%09%09%09%09height%3A%20%2210%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09//%20Save%20panel%20width%0A%09%09%09resizerBoxRight.onmouseup%20%3D%20function%28aE%29%20%7B%0A%09%09%09%09%24.sPref%28%22pPanelTransMaxWidth%22%2C%20Number%28transPanel.width%29%29%3B%0A%09%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%09%7D%3B%0A%09%09%09//%20Remove%20all%20heights%20to%20allow%20resizing.%0A%09%09%09resizerBoxRight.onmousedown%20%3D%20resizerBoxLeft.onmousedown%20%3D%20function%28aE%29%20%7B%0A%09%09%09%09if%20%28aE.target.hasAttribute%28%22data-corner%22%29%29%20%7B%0A%09%09%09%09%09let%20resBox%20%3D%20%24.%24%28%24._UID%20+%20%22_translationResultBox%22%29%3B%0A%09%09%09%09%09resBox.style.height%20%3D%20resBox.style.minHeight%20%3D%20resBox.style.maxHeight%20%3D%20%22%22%3B%0A%09%09%09%09%7D%0A%09%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%09%7D%3B%0A%09%09%7D%0A%0A%09%09if%20%28%21%24.%24%28%24._UID%20+%20%22_languageSelectionTooltip%22%29%29%20%7B%0A%09%09%09let%20tt%20%3D%20popSet.appendChild%28%24.%24CNS%28%22tooltip%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_languageSelectionTooltip%22%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09tt.appendChild%28%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09%09value%3A%20%22%uD835%uDDDF%uD835%uDDF2%uD835%uDDF3%uD835%uDE01%20%uD835%uDDF0%uD835%uDDF9%uD835%uDDF6%uD835%uDDF0%uD835%uDDF8%3A%20Set%20language%22%0A%09%09%09%7D%29%29%3B%0A%09%09%09tt.appendChild%28%24.%24CNS%28%22description%22%2C%20%7B%0A%09%09%09%09value%3A%20%22%uD835%uDDE5%uD835%uDDF6%uD835%uDDF4%uD835%uDDF5%uD835%uDE01%20%uD835%uDDF0%uD835%uDDF9%uD835%uDDF6%uD835%uDDF0%uD835%uDDF8%3A%20Hide/Show%20language%20from%20list%22%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%0A%0A%09%09let%20m%20%3D%20%24.%24%28%24._UID%20+%20%22_translation_options%22%29%3B%0A%09%09if%20%28popSet%20%26%26%20%21m%29%20%7B%0A%09%09%09popSet.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09id%3A%20%24._UID%20+%20%22_translation_options%22%2C%0A%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09onpopupshowing%3A%20that%20+%20%22populateOptionsPopup%28this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09position%3A%20%22after_start%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%0A%0A%09%09%24.handleURLBarIcon%28%29%3B%0A%0A%09%09if%20%28aInit%29%20%7B%0A%09%09%09%24.createHotkeys%28%29%3B%0A%09%09%09%24.populateAllLangLists%28%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09handleURLBarIcon%3A%20function%28aRem%29%20%7B%0A%09%09var%20popSet%20%3D%20%24.%24%28%22mainPopupSet%22%29%3B%0A%09%09let%20icn%20%3D%20%24.urlBarIcon%3B%0A%09%09let%20that%20%3D%20%22document.getElementById%28%27%22%20+%20self.id%20+%20%22%27%29.MultiTranslator.%22%3B%0A%09%09if%20%28aRem%29%0A%09%09%09icn%20%26%26%20icn.parentNode.removeChild%28icn%29%3B%0A%09%09if%20%28%24._.pPageTransURLBarIconShow%29%20%7B%0A%09%09%09let%20URLBar%20%3D%20%24.%24%28%22urlbar-icons%22%29%3B%0A%09%09%09if%20%28URLBar%20%26%26%20%21%24.urlBarIcon%29%20%7B%0A%09%09%09%09URLBar.appendChild%28%24.%24CNS%28%22image%22%2C%20%7B%0A%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationIconOnURLBar%22%2C%0A%09%09%09%09%09tooltip%3A%20%24._UID%20+%20%22_translationIconOnURLBarTooltip%22%2C%0A%09%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09%09class%3A%20%22urlbar-icon%22%2C%0A%09%09%09%09%09context%3A%20%24._UID%20+%20%22_translation_options%22%2C%0A%09%09%09%09%09src%3A%20%24.getEng%28%22image%22%29%2C%0A%09%09%09%09%09oncommand%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09onclick%3A%20%28%24._.pPageTransURLBarIconMenuMode%20%3F%0A%09%09%09%09%09%09%09%22if%20%28event.button%20%3D%3D%3D%200%29%20document.getElementById%28%27%22%20+%20%24._UID%20+%0A%09%09%09%09%09%09%09%22_translationIconOnURLBarMenu%27%29.openPopup%28this%2C%20%27%27%2C%200%2C%200%2C%20false%2C%20null%2C%20null%29%3B%22%20%3A%0A%09%09%09%09%09%09%09that%20+%20%22translatePage%28event%2C%20gBrowser.selectedTab.linkedBrowser.currentURI%29%3B%22%29%20+%0A%09%09%09%09%09%09%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09if%20%28%21%24.%24%28%24._UID%20+%20%22_translationIconOnURLBarTooltip%22%29%29%20%7B%0A%09%09%09%09%09popSet.appendChild%28%24.%24CNS%28%22tooltip%22%2C%20%7B%0A%09%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationIconOnURLBarTooltip%22%2C%0A%09%09%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09%09%09onpopupshowing%3A%20that%20+%20%22updateIconOnURLBarTooltip%28this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%0A%09%09%09if%20%28%24._.pPageTransURLBarIconMenuMode%29%20%7B%0A%09%09%09%09if%20%28popSet%20%26%26%20%21%24.%24%28%24._UID%20+%20%22_translationIconOnURLBarMenu%22%29%29%20%7B%0A%09%09%09%09%09let%20urlMenu%20%3D%20popSet.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09%09id%3A%20%24._UID%20+%20%22_translationIconOnURLBarMenu%22%2C%0A%09%09%09%09%09%09orient%3A%20%22vertical%22%2C%0A%09%09%09%09%09%09cb_id%3A%20%24._UID%2C%0A%09%09%09%09%09%09position%3A%20%22after_start%22%2C%0A%09%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09%09onpopupshowing%3A%20that%20+%20%22populateTranslatePageMenu%28this%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%09oncommand%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%09onclick%3A%20that%20+%20%22translatePage%28event%2C%20gBrowser.selectedTab.linkedBrowser.currentURI%2C%20null%2C%20true%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09createHotkeys%3A%20function%28%29%20%7B%0A%09%09let%20that%20%3D%20%22document.getElementById%28%27%22%20+%20self.id%20+%20%22%27%29.MultiTranslator.%22%3B%0A%09%09let%20hotKeys%20%3D%20%5B%7B%0A%09%09%09id%3A%20%22key%22%20+%20%24._UID%20+%20%22_translate_selection%22%2C%0A%09%09%09combo%3A%20%24._.pHotkeyTransSel%2C%0A%09%09%09enabled%3A%20%24._.pHotkeyTransSelEnabled%2C%0A%09%09%09cmd%3A%20that%20+%20%22translateSelection%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%7D%2C%20%7B%0A%09%09%09id%3A%20%22key%22%20+%20%24._UID%20+%20%22_translate_page%22%2C%0A%09%09%09combo%3A%20%24._.pHotkeyTransPage%2C%0A%09%09%09enabled%3A%20%24._.pHotkeyTransPageEnabled%2C%0A%09%09%09cmd%3A%20that%20+%20%22translatePage%28event%2C%20gBrowser.selectedTab.linkedBrowser.currentURI%2C%20true%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%7D%2C%20%7B%0A%09%09%09id%3A%20%22key%22%20+%20%24._UID%20+%20%22_translate_clipboard%22%2C%0A%09%09%09combo%3A%20%24._.pHotkeyTransClip%2C%0A%09%09%09enabled%3A%20%24._.pHotkeyTransClipEnabled%2C%0A%09%09%09cmd%3A%20that%20+%20%22translateClipboardContent%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%7D%5D%3B%0A%09%09var%20keyset%20%3D%20%24.%24%28%24._UID%20+%20%22_keyset%22%29%3B%0A%09%09Array.prototype.slice.call%28hotKeys%29.forEach%28function%28aHK%2C%20aIndex%29%20%7B%0A%09%09%09let%20combo%20%3D%20%24.getCombo%28aHK%5B%22combo%22%5D.trim%28%29%29%3B%0A%09%09%09let%20key%20%3D%20combo.substring%28combo.lastIndexOf%28%22-%22%29%20+%201%2C%20combo.length%29%3B%0A%09%09%09let%20modifiers%20%3D%20combo.slice%280%2C%20-%28key.length%20+%201%29%29.split%28%22-%22%29.join%28%22%2C%22%29%3B%0A%09%09%09if%20%28key%20%26%26%20modifiers%20%26%26%20keyset%29%20%7B%0A%09%09%09%09let%20attr%20%3D%20key.length%20%3D%3D%3D%201%20%3F%20%22key%22%20%3A%20%22keycode%22%3B%0A%09%09%09%09let%20hk%20%3D%20keyset.appendChild%28%24.%24CNS%28%22key%22%2C%20%7B%0A%09%09%09%09%09id%3A%20aHK%5B%22id%22%5D%2C%0A%09%09%09%09%09modifiers%3A%20modifiers%2C%0A%09%09%09%09%09disabled%3A%20%21aHK%5B%22enabled%22%5D%2C%0A%09%09%09%09%09oncommand%3A%20aHK%5B%22cmd%22%5D%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09hk.setAttribute%28attr%2C%20key.length%20%3D%3D%3D%201%20%3F%20key%20%3A%20%22VK_%22%20+%20key%29%3B%20//%20Set%20%22keycode%22%20or%20%22key%22%20attribute.%0A%09%09%09%7D%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09getCombo%3A%20function%28aHKStr%29%20%7B%0A%09%09var%20prefix%20%3D%20%22%22%3B%0A%09%09if%20%28aHKStr.search%28%22Alt+%22%29%20%21%3D%3D%20-1%29%0A%09%09%09prefix%20+%3D%20%22alt-%22%3B%0A%09%09if%20%28aHKStr.search%28%22Ctrl+%22%29%20%21%3D%3D%20-1%29%0A%09%09%09prefix%20+%3D%20%22control-%22%3B%0A%09%09if%20%28aHKStr.search%28%22Shift+%22%29%20%21%3D%3D%20-1%29%0A%09%09%09prefix%20+%3D%20%22shift-%22%3B%0A%09%09if%20%28aHKStr.search%28%22Meta+%22%29%20%21%3D%3D%20-1%29%0A%09%09%09prefix%20+%3D%20%22meta-%22%3B%0A%09%09return%20prefix%20+%20aHKStr.substring%28aHKStr.lastIndexOf%28%22+%22%29%20+%201%2C%20aHKStr.length%29%3B%0A%09%7D%2C%0A%0A%09contextMenuListener%3A%20function%28%29%20%7B%0A%09%09let%20sCtx%20%3D%20%24.%24%28%24._UID%20+%20%22_translate_selection_context%22%29%3B%0A%09%09let%20pCtx%20%3D%20%24.%24%28%24._UID%20+%20%22_translate_page_context%22%29%3B%0A%09%09let%20cCtx%20%3D%20%24.%24%28%24._UID%20+%20%22_translate_clipboard_context%22%29%3B%0A%09%09sCtx.hidden%20%3D%20%21%28gContextMenu.isTextSelected%20%7C%7C%20gContextMenu.isContentSelected%29%3B%0A%09%09sCtx.image%20%3D%20%24.getEng%28%22image%22%2C%20true%29%3B%0A%09%09%24._.pPageTransURLBarIconMenuMode%20%7C%7C%20%28pCtx%20%26%26%20%28pCtx.image%20%3D%20%24.getEng%28%22image%22%2C%20false%29%29%29%3B%0A%09%09pCtx%20%26%26%20%28pCtx.image%20%3D%20%24.getEng%28%22image%22%2C%20true%29%29%3B%0A%09%7D%2C%0A%0A%09populateTranslatePageMenu%3A%20function%28aN%29%20%7B%0A%09%09aN.textContent%20%3D%20%22%22%3B%0A%0A%09%09let%20URLBEng%20%3D%20%24.URLBarEngines%3B%0A%09%09let%20img%20%3D%20function%28aObj%2C%20aKey%29%20%7B%0A%09%09%09if%20%28typeof%20aObj%5BaKey%5D.image%20%3D%3D%3D%20%22number%22%29%0A%09%09%09%09return%20%24.images%5BaObj%5BaKey%5D.image%5D%3B%0A%09%09%09return%20aObj%5BaKey%5D.image%3B%0A%09%09%7D%3B%0A%09%09for%20%28let%20book%20in%20URLBEng%29%20%7B%0A%09%09%09if%20%28URLBEng.hasOwnProperty%28book%29%29%20%7B%0A%09%09%09%09if%20%28%21%21URLBEng%5Bbook%5D.label%20%26%26%20%21%21URLBEng%5Bbook%5D.command%29%20%7B%0A%09%09%09%09%09aN.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09%09label%3A%20URLBEng%5Bbook%5D.label%2C%0A%09%09%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09%09%09tooltiptext%3A%20%21%21URLBEng%5Bbook%5D.tooltip%20%3F%20URLBEng%5Bbook%5D.tooltip%20%3A%20%22%22%2C%0A%09%09%09%09%09%09image%3A%20img%28URLBEng%2C%20parseInt%28book%2C%2010%29%29%20%7C%7C%20%22%22%2C%0A%09%09%09%09%09%09value%3A%20parseInt%28book%2C%2010%29%2C%0A%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09/**%0A%09%20*%20%5BtranslatePage%20description%5D%0A%09%20*%20@param%20%20%7BObject%7D%20aE%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Event%20that%20triggered%20this%20function.%0A%09%20*%20@param%20%20%7BObject%7D%20aURIOfSiteToTranslate%20URi%20of%20the%20site%20that%20will%20be%20translated.%0A%09%20*%20@param%20%20%7BBoolen%7D%20aHotKey%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20If%20the%20function%20is%20triggered%20by%20a%20hotkey.%0A%09%20*%20@param%20%20%7BInteger%7D%20aEngFromMenu%20%20%20%20%20%20%20%20%20%20If%20the%20function%20is%20triggered%20by%20the%20page%20translator%20menu%2C%0A%09%20*%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20get%20the%20engine%20from%20it.%0A%09%20*/%0A%09translatePage%3A%20function%28aE%2C%20aURIOfSiteToTranslate%2C%20aHotKey%2C%20aEngFromMenu%29%20%7B%0A%09%09aE.preventDefault%28%29%3B%0A%09%09if%20%28%21aURIOfSiteToTranslate.schemeIs%28%22http%22%29%20%26%26%0A%09%09%09%21aURIOfSiteToTranslate.schemeIs%28%22https%22%29%20%26%26%20%21%28%22gBrowser%22%20in%20window%29%29%0A%09%09%09return%20false%3B%0A%0A%09%09let%20btn%20%3D%20aE.button%3B%0A%09%09if%20%28btn%20%3D%3D%3D%202%29%0A%09%09%09return%3B%0A%09%09if%20%28btn%20%3D%3D%3D%200%20%7C%7C%20aHotKey%29%20//%20Left%20click%20and%20Hotkey%20triggers%20the%20same%20action.%0A%09%09%09%24.openURLIn%28%24._.pPageTransURLBarIconLeftClick%2C%20aURIOfSiteToTranslate.spec%2C%20aE.target.value%29%3B%0A%09%09else%20if%20%28btn%20%3D%3D%3D%201%29%0A%09%09%09%24.openURLIn%28%24._.pPageTransURLBarIconMiddleClick%2C%20aURIOfSiteToTranslate.spec%2C%20aEngFromMenu%29%3B%0A%09%09aE.stopPropagation%28%29%3B%0A%09%7D%2C%0A%0A%09openURLIn%3A%20function%28aWhere%2C%20aSiteToTranslate%2C%20aEngFromMenu%29%20%7B%0A%09%09var%20engine%20%3D%20aEngFromMenu%20%3F%20aEngFromMenu%20%3A%20%24._.pPageTransEngine%3B%0A%09%09var%20urlForNewTab%20%3D%20%28/%5Ejavascript%3A/.test%28%24.URLBarEngines%5Bengine%5D.command%29%20%3F%0A%09%09%09aSiteToTranslate%20%3A%0A%09%09%09%22about%3Ablank%22%29%3B%0A%09%09try%20%7B%0A%09%09%09if%20%28aWhere%20%3D%3D%3D%201%29%20%7B%0A%09%09%09%09window.addEventListener%28%22DOMContentLoaded%22%2C%20function%20_%28aE%29%20%7B%0A%09%09%09%09%09window.removeEventListener%28%22DOMContentLoaded%22%2C%20_%2C%20true%29%3B%0A%09%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09%09%24.doPageTranslation%28engine%2C%20aSiteToTranslate%2C%20%22current%22%2C%20%7B%0A%09%09%09%09%09%09%09inBackground%3A%20false%0A%09%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%09%7D%2C%20100%29%3B%0A%09%09%09%09%7D%2C%20true%29%3B%0A%09%09%09%7D%0A%09%09%7D%20finally%20%7B%0A%09%09%09switch%20%28aWhere%29%20%7B%0A%09%09%09%09case%200%3A%20//%20Current%0A%09%09%09%09%09%24.doPageTranslation%28engine%2C%20aSiteToTranslate%2C%20%22current%22%2C%20%7B%0A%09%09%09%09%09%09inBackground%3A%20false%0A%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%201%3A%20//%20Next%20to%20current%0A%09%09%09%09%09let%20pos%20%3D%20gBrowser.selectedTab._tPos%20%7C%7C%20gBrowser.tabContainer.selectedIndex%3B%20//%20Firefox%20%7C%7C%20SeaMonkey%0A%09%09%09%09%09gBrowser.moveTabTo%28gBrowser.selectedTab%20%3D%20gBrowser.addTab%28urlForNewTab%29%2C%20pos%20+%201%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%202%3A%20//%20New%20tab%20in%20background%0A%09%09%09%09%09%24.doPageTranslation%28engine%2C%20urlForNewTab%2C%20%22tab%22%2C%20%7B%0A%09%09%09%09%09%09inBackground%3A%20true%0A%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%203%3A%20//%20New%20tab%20in%20foreground%0A%09%09%09%09%09%24.doPageTranslation%28engine%2C%20urlForNewTab%2C%20%22tab%22%2C%20%7B%0A%09%09%09%09%09%09inBackground%3A%20false%0A%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09doPageTranslation%3A%20function%28aEngine%2C%20aSiteToTranslate%2C%20aWhere%2C%20aParams%29%20%7B%0A%09%09var%20lFrom%20%3D%20%24._.pPageTransFromLang%2C%0A%09%09%09lTo%20%3D%20%24._.pPageTransToLang%3B%0A%09%09var%20bookCmd%20%3D%20%24.URLBarEngines%5BaEngine%5D.command%3B%0A%09%09bookCmd%20%3D%20bookCmd.replace%28/%25%25LNGTO%25%25/g%2C%20lTo.toString%28%29%29%0A%09%09%09.replace%28/%25%25LNGFROM%25%25/g%2C%20%28%28lFrom%20%3D%3D%3D%20%22%22%20%26%26%20aEngine%20%3D%3D%3D%202%29%20%3F%20%22auto%22%20%3A%20lFrom.toString%28%29%29%29%0A%09%09%09.replace%28/%25%25URL%25%25/g%2C%20encodeURIComponent%28aSiteToTranslate%29%29%3B%0A%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09window.openUILinkIn%28bookCmd%2C%20aWhere%2C%20aParams%29%3B%0A%09%09%7D%2C%20100%29%3B%0A%09%7D%2C%0A%0A%09updateIconOnURLBarTooltip%3A%20function%28aN%29%20%7B%0A%09%09aN.textContent%20%3D%20%22%22%3B%0A%0A%09%09var%20eng%20%3D%20%24._.pPageTransEngine%2C%0A%09%09%09lC%20%3D%20%24._.pPageTransURLBarIconLeftClick%2C%0A%09%09%09mC%20%3D%20%24._.pPageTransURLBarIconMiddleClick%3B%0A%09%09let%20rows%20%3D%20aN.appendChild%28%24.%24CNS%28%22grid%22%29%29.appendChild%28%24.%24CNS%28%22rows%22%29%29%3B%0A%09%09let%20getWhere%20%3D%20function%28aWhere%29%20%7B%0A%09%09%09switch%20%28aWhere%29%20%7B%0A%09%09%09%09case%200%3A%0A%09%09%09%09%09return%20%22in%20current%20tab.%22%3B%0A%09%09%09%09case%201%3A%0A%09%09%09%09%09return%20%22in%20new%20tab%20next%20to%20current%20one.%22%3B%0A%09%09%09%09case%202%3A%0A%09%09%09%09%09return%20%22in%20a%20new%20tab%20in%20the%20background.%22%3B%0A%09%09%09%09case%203%3A%0A%09%09%09%09%09return%20%22in%20a%20new%20tab%20in%20the%20foreground.%22%3B%0A%09%09%09%7D%0A%09%09%7D%3B%0A%09%09let%20appendRow%20%3D%20function%28aLbl1%2C%20aLbl2%29%20%7B%0A%09%09%09let%20lbl1%20%3D%20rows.appendChild%28%24.%24CNS%28%22row%22%29%29%3B%0A%09%09%09lbl1.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09value%3A%20aLbl1%2C%0A%09%09%09%09style%3A%20%22font-weight%3A%20bold%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09lbl1.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09value%3A%20aLbl2%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%3B%0A%09%09appendRow%28%22Current%20engine%20%3A%20%22%2C%20%24.URLBarEngines%5Beng%5D.label%29%3B%0A%09%09rows.appendChild%28%24.%24CNS%28%22row%22%29%29.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09value%3A%20%22%20%22%2C%0A%09%09%7D%29%29%3B%0A%09%09appendRow%28%22Left%20click%20%3A%20%22%2C%20%28%24._.pPageTransURLBarIconMenuMode%20%3F%0A%09%09%09%22Open%20menu%20-%20Translate%20page%20%22%20%3A%0A%09%09%09%22Translate%20page%20%22%29%20+%20getWhere%28lC%29%29%3B%0A%09%09appendRow%28%22Middle%20click%20%3A%20%22%2C%20%22Translate%20page%20%22%20+%20getWhere%28mC%29%29%3B%0A%09%09rows.appendChild%28%24.%24CNS%28%22row%22%29%29.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09value%3A%20%22%20%22%2C%0A%09%09%7D%29%29%3B%0A%09%09appendRow%28%22Right%20click%20%3A%20%22%2C%20%22Open%20options%20menu.%22%29%3B%0A%09%7D%2C%0A%0A%09setPanelLangListLabel%3A%20function%28aPanel%29%20%7B%0A%09%09if%20%28%21%24._.pPanelTransShowOptionsBox%29%0A%09%09%09return%20true%3B%0A%09%09let%20mLs%20%3D%20%5B%24._UID%20+%20%22_languageSelectionButtonTo%22%2C%20%24._UID%20+%20%22_languageSelectionButtonFrom%22%5D%3B%0A%09%09Array.prototype.slice.call%28mLs%29.forEach%28function%28aBtnID%29%20%7B%0A%09%09%09let%20btn%20%3D%20%24.%24%28aBtnID%29%3B%0A%09%09%09btn.label%20%3D%20%24.langs%5B%24._%5Bbtn.getAttribute%28%22_pref%22%29%5D%5D%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09onReleaseListener%3A%20function%28aE%29%20%7B%0A%09%09switch%20%28aE.type%29%20%7B%0A%09%09%09case%20%22mouseup%22%3A%0A%09%09%09%09if%20%28aE.button%20%21%3D%3D%200%20%7C%7C%20%21%24.onReleaseModifiers%28aE%29%29%0A%09%09%09%09%09return%3B%0A%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09if%20%28%24._.pTransOnReleaseShowIcon%29%20%7B%0A%09%09%09%09%09%09if%20%28%24.transPanel.state%20%3D%3D%3D%20%22open%22%29%0A%09%09%09%09%09%09%09%24.translateSelection%28%29%3B%0A%09%09%09%09%09%09else%0A%09%09%09%09%09%09%09%24.onReleaseIcon%28aE%29%3B%0A%09%09%09%09%09%7D%20else%0A%09%09%09%09%09%09%24.translateSelection%28%29%3B%0A%09%09%09%09%7D%2C%20100%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%20%22click%22%3A%0A%09%09%09case%20%22mousedown%22%3A%0A%09%09%09%09if%20%28aE.button%20%21%3D%3D%200%20%26%26%20%21%24.onReleaseModifiers%28aE%29%29%0A%09%09%09%09%09return%3B%0A%0A%09%09%09%09if%20%28%21%24._.pPanelTransKeepItOpen%29%0A%09%09%09%09%09%24.forceHidePanel%28%29%3B%0A%09%09%09%09break%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09onReleaseModifiers%3A%20function%28aE%29%20%7B%0A%09%09let%20useCtrlKey%20%3D%20%24._.pTransOnReleaseControlKey%2C%0A%09%09%09useShiftKey%20%3D%20%24._.pTransOnReleaseShiftKey%2C%0A%09%09%09useAltKey%20%3D%20%24._.pTransOnReleaseAltKey%3B%0A%09%09if%20%28%24.accel%28aE%29%20%26%26%20aE.shiftKey%20%26%26%20aE.altKey%20%26%26%20%28%21useCtrlKey%20%7C%7C%20%21useShiftKey%20%7C%7C%20%21useAltKey%29%29%0A%09%09%09return%20false%3B%0A%09%09//%20XOR%20http%3A//www.howtocreate.co.uk/xor.html%0A%09%09if%20%28%24.accel%28aE%29%20%3F%20%21useCtrlKey%20%3A%20useCtrlKey%29%0A%09%09%09return%20false%3B%0A%09%09if%20%28aE.shiftKey%20%3F%20%21useShiftKey%20%3A%20useShiftKey%29%0A%09%09%09return%20false%3B%0A%09%09if%20%28aE.altKey%20%3F%20%21useAltKey%20%3A%20useAltKey%29%0A%09%09%09return%20false%3B%0A%09%09return%20true%3B%0A%09%7D%2C%0A%0A%09forceHidePanel%3A%20function%28%29%20%7B%0A%09%09let%20p%20%3D%20%24.transPanel%3B%0A%09%09%28p%20%26%26%20p.state%20%3D%3D%3D%20%22open%22%29%20%26%26%20p.hidePopup%28%29%3B%0A%09%7D%2C%0A%0A%09onReleaseIcon%3A%20function%28aE%29%20%7B%0A%09%09%24._mm.sendAsyncMessage%28%24._onReleaseIconMsgID%2C%20%7B%0A%09%09%09iconOffsetY%3A%20%24._.pTransOnReleaseIconOffsetY%2C%0A%09%09%09iconOffsetX%3A%20%24._.pTransOnReleaseIconOffsetX%2C%0A%09%09%09_UID%3A%20%24._UID%2C%0A%09%09%09clientY%3A%20aE.clientY%2C%0A%09%09%09clientX%3A%20aE.clientX%2C%0A%09%09%09image%3A%20%24.getEng%28%22image%22%2C%20true%29%2C%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09translateSelection%3A%20function%28%29%20%7B%0A%09%09%24._mm.sendAsyncMessage%28%24._translateSelMsgID%29%3B%0A%09%7D%2C%0A%0A%09translateClipboardContent%3A%20function%28%29%20%7B%0A%09%09%24.doTranslation%28gClipboard.read%28%29%29%3B%0A%09%7D%2C%0A%0A%09doTranslation%3A%20function%28aStr%29%20%7B%0A%09%09let%20engine%20%3D%20%24.getEng%28null%2C%20true%29%3B%0A%09%09engine%20%26%26%20%24.getTranslateResult%28aStr%2C%20engine%29%3B%0A%09%7D%2C%0A%0A%09getEng%3A%20function%28aProperty%2C%20aForPanel%29%20%7B%0A%09%09var%20engs%20%3D%20aForPanel%20%3F%20%24.PanelEngines%20%3A%20%24.URLBarEngines%3B%0A%09%09let%20selProp%20%3D%20function%28aProp%2C%20aKey%29%20%7B%0A%09%09%09switch%20%28aProp%29%20%7B%0A%09%09%09%09case%20%22image%22%3A%0A%09%09%09%09%09if%20%28typeof%20engs%5BaKey%5D.image%20%3D%3D%3D%20%22number%22%29%0A%09%09%09%09%09%09return%20%24.images%5Bengs%5BaKey%5D.image%5D%3B%0A%09%09%09%09%09return%20engs%5BaKey%5D.image%3B%0A%09%09%09%09case%20%22label%22%3A%0A%09%09%09%09%09return%20engs%5BaKey%5D.label%3B%0A%09%09%09%09default%3A%0A%09%09%09%09%09return%20aKey%3B%0A%09%09%09%7D%0A%09%09%7D%3B%0A%0A%09%09for%20%28var%20book%20in%20engs%29%20%7B%0A%09%09%09if%20%28engs.hasOwnProperty%28book%29%29%20%7B%0A%09%09%09%09if%20%28parseInt%28book%2C%2010%29%20%3D%3D%3D%20parseInt%28%28aForPanel%20%3F%20%24._.pPanelTransEngine%20%3A%20%24._.pPageTransEngine%29%2C%2010%29%29%0A%09%09%09%09%09return%20selProp%28aProperty%2C%20parseInt%28book%2C%2010%29%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09%24.sPref%28aForPanel%20%3F%20%22pPanelTransEngine%22%20%3A%20%22pPageTransEngine%22%2C%202%29%3B%20//%20Defaults%20to%20Google%20translator%0A%09%09return%20selProp%28aProperty%2C%202%29%3B%0A%09%7D%2C%0A%0A%09openFailSafeURL%3A%20function%28aURL%29%20%7B%0A%09%09if%20%28%21%28%22gBrowser%22%20in%20window%29%29%20%7B%0A%09%09%09try%20%7B%0A%09%09%09%09openContentTab%28aURL%29%3B%0A%09%09%09%7D%20catch%20%28aError%29%20%7B%0A%09%09%09%09loadURI%28aURL%29%3B%0A%09%09%09%7D%0A%09%09%09return%3B%0A%09%09%7D%0A%09%09switch%20%28%24._.pPanelTransFailSafeOpenURLWhere%29%20%7B%0A%09%09%09case%200%3A%20//%20Current%0A%09%09%09%09loadURI%28aURL%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%201%3A%20//%20Next%20to%20current%0A%09%09%09%09let%20pos%20%3D%20gBrowser.selectedTab._tPos%20%7C%7C%20gBrowser.tabContainer.selectedIndex%3B%20//%20Firefox%20%7C%7C%20SeaMonkey%0A%09%09%09%09gBrowser.moveTabTo%28gBrowser.selectedTab%20%3D%20gBrowser.addTab%28aURL%29%2C%20pos%20+%201%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%202%3A%20//%20New%20tab%20in%20background%0A%09%09%09%09gBrowser.addTab%28aURL%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%203%3A%20//%20New%20tab%20in%20foreground%0A%09%09%09%09gBrowser.selectedTab%20%3D%20gBrowser.addTab%28aURL%29%3B%0A%09%09%09%09break%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09getTranslateResult%3A%20function%28aStr%2C%20aEngine%29%20%7B%0A%09%09var%20Exp%2C%20xpath%2C%0A%09%09%09popEng%20%3D%20%24.PanelEngines%5BaEngine%5D%2C%0A%09%09%09maxLength%20%3D%20parseInt%28%24._.pPanelMaxStringLength%2C%2010%29%3B%0A%09%09var%20SUC%20%3D%20Cc%5B%22@mozilla.org/intl/scriptableunicodeconverter%22%5D%0A%09%09%09.createInstance%28Ci.nsIScriptableUnicodeConverter%29%3B%0A%09%09SUC.charset%20%3D%20popEng.code%3B%0A%09%09var%20str%20%3D%20SUC.ConvertFromUnicode%28aStr%29%2C%0A%09%09%09lgFrom%20%3D%20%24._.pPanelTransFromLang%2C%0A%09%09%09lgTo%20%3D%20%24._.pPanelTransToLang%3B%0A%09%09var%20url%3B%0A%09%09var%20data%3B%0A%09%09str%20%3D%20str.replace%28/%5Cs+/g%2C%20%22%20%22%29%3B%0A%09%09if%20%28%24._.pPanelTransFailSafe%20%26%26%20str.length%20%3E%20maxLength%20%26%26%20aEngine%20%3C%3D%203%29%20%7B%0A%09%09%09str%20%3D%20%24.%24escape%28str%29%3B%0A%09%09%09switch%20%28aEngine%29%20%7B%0A%09%09%09%09case%201%3A%0A%09%09%09%09%09%24.openFailSafeURL%28%22https%3A//www.bing.com/translator/%3Ffrom%3D%22%20+%20lgFrom%20+%20%22%26to%3D%22%20+%0A%09%09%09%09%09%09lgTo%20+%20%22%26text%3D%22%20+%20str%29%3B%0A%09%09%09%09%09return%3B%0A%09%09%09%09case%202%3A%0A%09%09%09%09%09%24.openFailSafeURL%28%22https%3A//translate.google.com/%3Fhl%3D%22%20+%20lgTo%20+%20%22%26eotf%3D0%26sl%3D%22%20+%0A%09%09%09%09%09%09lgFrom%20+%20%22%26tl%3D%22%20+%20lgTo%20+%20%22%26text%3D%22%20+%20str%29%3B%0A%09%09%09%09%09return%3B%0A%09%09%09%09case%203%3A%0A%09%09%09%09%09%24.openFailSafeURL%28%22https%3A//translate.yandex.com/%3Ffrom%3D%22%20+%20lgFrom%20+%20%22%26to%3D%22%20+%0A%09%09%09%09%09%09lgTo%20+%20%22%26text%3D%22%20+%20str%29%3B%0A%09%09%09%09%09return%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%09str%20%3D%20str.substring%280%2C%20maxLength%29%3B%0A%0A%09%09if%20%28%21popEng.method%29%0A%09%09%09popEng.method%20%3D%20%22GET%22%3B%0A%09%09if%20%28popEng.method%20%3D%3D%3D%20%22POST%22%29%20%7B%0A%09%09%09url%20%3D%20popEng.action%3B%0A%09%09%09data%20%3D%20popEng.post.replace%28/%25%25LNGTO%25%25/g%2C%20lgTo%29.replace%28/%25%25LNGFROM%25%25/g%2C%20lgFrom%29%3B%0A%09%09%09data%20%3D%20data.replace%28/%25%25TEXT%25%25/g%2C%20%24.%24escape%28str%29.replace%28/%5C+/g%2C%20%22%252B%22%29%29%3B%0A%09%09%7D%20else%20%7B%0A%09%09%09url%20%3D%20%28aEngine%20%3D%3D%3D%203%29%20%3F%0A%09%09%09%09popEng.action%20%3A%0A%09%09%09%09popEng.action.replace%28/%25%25LNGTO%25%25/g%2C%20lgTo%29.replace%28/%25%25LNGFROM%25%25/g%2C%20lgFrom%29%3B%0A%09%09%09url%20%3D%20url.replace%28/%25%25TEXT%25%25/g%2C%20%24.%24escape%28str%29.replace%28/%5C+/g%2C%20%22%252B%22%29%29%3B%0A%09%09%09data%20%3D%20null%3B%0A%09%09%7D%0A%09%09if%20%28%21popEng.xpath%20%7C%7C%20popEng.xpath%20%3D%3D%3D%20%22%22%29%0A%09%09%09Exp%20%3D%20new%20RegExp%28popEng.start%20+%20%22%28%28.%7C%5C%5Cr%7C%5C%5Cn%29*%29%22%20+%20popEng.end%2C%20%22i%22%29%3B%0A%09%09else%0A%09%09%09xpath%20%3D%20popEng.xpath%3B%0A%09%09%24.show%28%22Translating...%22%2C%20true%29%3B%0A%09%09if%20%28aEngine%20%3D%3D%3D%201%29%20%7B%0A%09%09%09%24.BingAPI%28popEng%2C%20url%29%3B%0A%09%09%7D%20else%20if%20%28aEngine%20%3D%3D%3D%203%29%20%7B%0A%09%09%09%24.YandexAPI%28popEng%2C%20url%29%3B%0A%09%09%7D%20else%20%7B%0A%09%09%09%24.CB_xmlhttpRequest%28%7B%0A%09%09%09%09method%3A%20popEng.method%2C%0A%09%09%09%09overrideMimeType%3A%20%22text/html%3B%20charset%3D%22%20+%20popEng.code%20%7C%7C%20%22UTF-8%22%2C%0A%09%09%09%09url%3A%20url%2C%0A%09%09%09%09data%3A%20data%2C%0A%09%09%09%09headers%3A%20%7B%0A%09%09%09%09%09%22Referer%22%3A%20popEng.referer%20%7C%7C%20%22%22%2C%0A%09%09%09%09%09%22Content-Type%22%3A%20%22application/x-www-form-urlencoded%22%0A%09%09%09%09%7D%2C%0A%09%09%09%09onload%3A%20function%28aRes%29%20%7B%0A%09%09%09%09%09gClipboard.write%28aRes.responseText%29%3B%0A%0A%09%09%09%09%09var%20txt%20%3D%20aRes.responseText.toString%28%29%3B%0A%09%09%09%09%09var%20res%20%3D%20null%3B%0A%09%09%09%09%09try%20%7B%0A%09%09%09%09%09%09if%20%28%21xpath%29%20%7B%0A%09%09%09%09%09%09%09res%20%3D%20txt.match%28new%20RegExp%28Exp.source%2C%20%22i%22%29%29%3B%0A%09%09%09%09%09%09%09res%20%3D%20RegExp.%241%3B%0A%09%09%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09%09%09var%20hdoc%20%3D%20%24.str2dom%28txt%29%3B%0A%09%09%09%09%09%09%09var%20result%20%3D%20hdoc.evaluate%28xpath%2C%20hdoc%2C%20null%2C%20XPathResult.ORDERED_NODE_SNAPSHOT_TYPE%2C%20null%29%3B%20//.not%28@value%20%3D%20%27auto%27%29%0A%09%09%09%09%09%09%09var%20node%20%3D%20result.snapshotLength%20%3E%200%20%3F%20result.snapshotItem%280%29%20%3A%20null%3B%0A%09%09%09%09%09%09%09res%20%3D%20node.innerText%20%7C%7C%20node.textContent%20%7C%7C%20node.value%3B%0A%09%09%09%09%09%09%09node%20%3D%20hdoc%20%3D%20result%20%3D%20null%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%7D%20catch%20%28e%29%20%7B%0A%09%09%09%09%09%09%24.show%28%22Failure%20to%20obtain.%22%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09if%20%28%21%21res%29%20%7B%0A%09%09%09%09%09%09%24.show%28res%29%3B%0A%09%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09%09%24.show%28%22Failure%20to%20obtain.%22%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%7D%2C%0A%09%09%09%09onerror%3A%20function%28aErr%29%20%7B%0A%09%09%09%09%09%24.show%28%22Error%20%22%20+%20aErr.status%20+%20%22%20occurred%20while%20receiving%20the%20document.%22%29%3B%0A%09%09%09%09%7D%2C%0A%09%09%09%09ontimeout%3A%20function%28%29%20%7B%0A%09%09%09%09%09%24.show%28%22Timeout.%20Couldn%27t%20obtain%20translation%20result.%22%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09YandexAPI%3A%20function%28aEngine%2C%20aURL%29%20%7B%0A%09%09let%20APIKeys%20%3D%20JSON.parse%28%24._.pAPIKeysYandex%29%3B%0A%09%09if%20%28%21APIKeys%20%7C%7C%20APIKeys.length%20%3D%3D%3D%200%29%20%7B%0A%09%09%09%24.show%28%22There%20are%20no%20valid%20API%20keys.%22%29%3B%0A%09%09%09return%20true%3B%0A%09%09%7D%0A%09%09var%20random%20%3D%20Math.floor%28Math.random%28%29%20*%20APIKeys.length%20-%201%29%20+%201%2C%0A%09%09%09lgFrom%20%3D%20%24._.pPanelTransFromLang%2C%0A%09%09%09lgTo%20%3D%20%24._.pPanelTransToLang%3B%0A%09%09let%20usedAPIKey%20%3D%20APIKeys%5Brandom%5D%3B%0A%09%09var%20url%20%3D%20aURL.replace%28%22%25%25API_KEY%25%25%22%2C%20usedAPIKey%29%0A%09%09%09.replace%28%22%25%25LNGTO%25%25%22%2C%20%28%28lgFrom%20%3D%3D%3D%20%22%22%29%20%3F%20lgTo%20%3A%20lgFrom%20+%20%22-%22%20+%20lgTo%29%29%3B%0A%09%09%24.CB_xmlhttpRequest%28%7B%0A%09%09%09method%3A%20aEngine.method%2C%0A%09%09%09overrideMimeType%3A%20%22text/html%3B%20charset%3D%22%20+%20aEngine.code%2C%0A%09%09%09url%3A%20url%2C%0A%09%09%09data%3A%20null%2C%0A%09%09%09headers%3A%20%7B%0A%09%09%09%09%22Content-Type%22%3A%20%22application/x-www-form-urlencoded%22%0A%09%09%09%7D%2C%0A%09%09%09onload%3A%20function%28aRes%29%20%7B%0A%09%09%09%09if%20%28aRes.readyState%20%3D%3D%3D%204%20%26%26%20aRes.status%20%3D%3D%3D%20200%29%20%7B%0A%09%09%09%09%09let%20txt%20%3D%20JSON.parse%28aRes.responseText%29.text.toString%28%29%3B%0A%09%09%09%09%09if%20%28txt%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09%09%24.show%28txt%29%3B%0A%09%09%09%09%09else%0A%09%09%09%09%09%09%24.show%28%22Failure%20to%20obtain.%22%29%3B%0A%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09try%20%7B%0A%09%09%09%09%09%09let%20res%20%3D%20JSON.parse%28aRes.responseText%29%3B%0A%09%09%09%09%09%09%24.show%28%22%uD835%uDDD8%uD835%uDDFF%uD835%uDDFF%uD835%uDDFC%uD835%uDDFF%3A%20%22%20+%20res.code%20+%0A%09%09%09%09%09%09%09%22%5Cn%uD835%uDDE0%uD835%uDDF2%uD835%uDE00%uD835%uDE00%uD835%uDDEE%uD835%uDDF4%uD835%uDDF2%3A%20%22%20+%20res.message%20+%0A%09%09%09%09%09%09%09%22%5Cn%uD835%uDDD4%uD835%uDDE3%uD835%uDDDC%20%uD835%uDDF8%uD835%uDDF2%uD835%uDE06%3A%20%22%20+%20usedAPIKey%29%3B%0A%09%09%09%09%09%7D%20catch%20%28aErr%29%20%7B%0A%09%09%09%09%09%09%24.show%28%22%uD835%uDDE8%uD835%uDDFB%uD835%uDDF8%uD835%uDDFB%uD835%uDDFC%uD835%uDE04%uD835%uDDFB%20%uD835%uDDF2%uD835%uDDFF%uD835%uDDFF%uD835%uDDFC%uD835%uDDFF.%22%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%7D%0A%09%09%09%7D%2C%0A%09%09%09onerror%3A%20function%28aErr%29%20%7B%0A%09%09%09%09%24.show%28%22Error%20%22%20+%20aErr.status%20+%20%22%20occurred%20while%20trying%20to%20obtain%20translation%20result.%22%29%3B%0A%09%09%09%7D%2C%0A%09%09%09ontimeout%3A%20function%28aErr%29%20%7B%0A%09%09%09%09%24.show%28%22Timeout.%20Couldn%27t%20obtain%20translation%20result.%5Cn%22%20+%20aErr%29%3B%0A%09%09%09%7D%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09BingAPI%3A%20function%28aEngine%2C%20aURL%29%20%7B%0A%09%09let%20APIKeys%20%3D%20JSON.parse%28%24._.pAPIKeysBing%29%3B%0A%09%09if%20%28%21APIKeys%20%7C%7C%20APIKeys.length%20%3D%3D%3D%200%29%20%7B%0A%09%09%09%24.show%28%22There%20are%20no%20valid%20API%20keys.%22%29%3B%0A%09%09%09return%20true%3B%0A%09%09%7D%0A%09%09var%20random%20%3D%20Math.floor%28Math.random%28%29%20*%20APIKeys.length%20-%201%29%20+%201%3B%0A%09%09let%20usedCLientID%20%3D%20APIKeys%5Brandom%5D%5B0%5D%3B%0A%09%09let%20usedCLientSecret%20%3D%20APIKeys%5Brandom%5D%5B1%5D%3B%0A%09%09%24.CB_xmlhttpRequest%28%7B%0A%09%09%09method%3A%20%22POST%22%2C%0A%09%09%09overrideMimeType%3A%20%22text/html%3B%20charset%3D%22%20+%20aEngine.code%2C%0A%09%09%09url%3A%20%22https%3A//datamarket.accesscontrol.windows.net/v2/OAuth2-13%22%2C%0A%09%09%09data%3A%20%22grant_type%3Dclient_credentials%22%20+%0A%09%09%09%09%22%26client_id%3D%22%20+%20encodeURIComponent%28usedCLientID%29%20+%0A%09%09%09%09%22%26client_secret%3D%22%20+%20encodeURIComponent%28usedCLientSecret%29%20+%0A%09%09%09%09%22%26scope%3Dhttp%3A//api.microsofttranslator.com%22%2C%0A%09%09%09headers%3A%20%7B%0A%09%09%09%09%22Content-Type%22%3A%20%22application/x-www-form-urlencoded%22%0A%09%09%09%7D%2C%0A%09%09%09onload%3A%20function%28aRes%29%20%7B%0A%09%09%09%09if%20%28aRes.readyState%20%3D%3D%3D%204%20%26%26%20aRes.status%20%3D%3D%3D%20200%29%20%7B%0A%09%09%09%09%09%24.CB_xmlhttpRequest%28%7B%0A%09%09%09%09%09%09method%3A%20aEngine.method%2C%0A%09%09%09%09%09%09overrideMimeType%3A%20%22text/html%3B%20charset%3D%22%20+%20aEngine.code%2C%0A%09%09%09%09%09%09url%3A%20aURL%2C%0A%09%09%09%09%09%09data%3A%20null%2C%0A%09%09%09%09%09%09headers%3A%20%7B%0A%09%09%09%09%09%09%09%22Authorization%22%3A%20%22bearer%20%22%20+%20JSON.parse%28aRes.responseText%29.access_token%2C%0A%09%09%09%09%09%09%09%22Content-Type%22%3A%20%22application/x-www-form-urlencoded%22%0A%09%09%09%09%09%09%7D%2C%0A%09%09%09%09%09%09onload%3A%20function%28aRes2%29%20%7B%0A%09%09%09%09%09%09%09if%20%28aRes2.readyState%20%3D%3D%3D%204%20%26%26%20aRes2.status%20%3D%3D%3D%20200%29%20%7B%0A%09%09%09%09%09%09%09%09let%20txt%20%3D%20aRes2.responseText.toString%28%29.replace%28/%5E%5C%22/g%2C%20%22%22%29.replace%28/%5C%22%24/g%2C%20%22%22%29%3B%0A%09%09%09%09%09%09%09%09//%20txt%20%3D%20txt.replace%28/%5Cn/g%2C%20%22%3Chtml%3Abr%20/%3E%22%29%3B%0A%09%09%09%09%09%09%09%09if%20%28txt%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09%09%09%09%09%24.show%28txt%29%3B%0A%09%09%09%09%09%09%09%09else%0A%09%09%09%09%09%09%09%09%09%24.show%28%22Failure%20to%20obtain.%22%29%3B%0A%09%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09%7D%2C%0A%09%09%09%09%09%09onerror%3A%20function%28aErr%29%20%7B%0A%09%09%09%09%09%09%09%24.show%28%22Error%20%22%20+%20aErr.status%20+%20%22%20occurred%20while%20trying%20to%20obtain%20translation%20result.%22%29%3B%0A%09%09%09%09%09%09%7D%2C%0A%09%09%09%09%09%09ontimeout%3A%20function%28%29%20%7B%0A%09%09%09%09%09%09%09%24.show%28%22Timeout.%20Couldn%27t%20obtain%20translation%20result.%22%29%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09try%20%7B%0A%09%09%09%09%09%09let%20res%20%3D%20JSON.parse%28aRes.responseText%29%3B%0A%09%09%09%09%09%09%24.show%28%22%uD835%uDDD8%uD835%uDDFF%uD835%uDDFF%uD835%uDDFC%uD835%uDDFF%3A%20%22%20+%20res.error%20+%0A%09%09%09%09%09%09%09%22%5Cn%uD835%uDDE0%uD835%uDDF2%uD835%uDE00%uD835%uDE00%uD835%uDDEE%uD835%uDDF4%uD835%uDDF2%3A%20%22%20+%20res.error_description%20+%0A%09%09%09%09%09%09%09%22%5Cn%uD835%uDDD6%uD835%uDDF9%uD835%uDDF6%uD835%uDDF2%uD835%uDDFB%uD835%uDE01%20%uD835%uDDDC%uD835%uDDD7%3A%20%22%20+%20usedCLientID%20+%0A%09%09%09%09%09%09%09%22%5Cn%uD835%uDDD6%uD835%uDDF9%uD835%uDDF6%uD835%uDDF2%uD835%uDDFB%uD835%uDE01%20%uD835%uDDE6%uD835%uDDF2%uD835%uDDF0%uD835%uDDFF%uD835%uDDF2%uD835%uDE01%3A%20%22%20+%20usedCLientSecret%29%3B%0A%09%09%09%09%09%7D%20catch%20%28aErr%29%20%7B%0A%09%09%09%09%09%09%24.show%28%22%uD835%uDDE8%uD835%uDDFB%uD835%uDDF8%uD835%uDDFB%uD835%uDDFC%uD835%uDE04%uD835%uDDFB%20%uD835%uDDF2%uD835%uDDFF%uD835%uDDFF%uD835%uDDFC%uD835%uDDFF.%22%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%7D%0A%09%09%09%7D%2C%0A%09%09%09onerror%3A%20function%28aErr%29%20%7B%0A%09%09%09%09%24.show%28%22Error%20%22%20+%20aErr.status%20+%20%22%20occurred%20while%20trying%20to%20obtain%20Bing%20API%20credentials.%22%29%3B%0A%09%09%09%7D%2C%0A%09%09%09ontimeout%3A%20function%28%29%20%7B%0A%09%09%09%09%24.show%28%22Timeout.%20Couldn%27t%20obtain%20Bing%20API%20credentials.%22%29%3B%0A%09%09%09%7D%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09str2dom%3A%20function%28aStr%29%20%7B%0A%09%09var%20xsl%20%3D%20%28new%20DOMParser%28%29%29.parseFromString%28%5B%0A%09%09%09%22%3C%3Fxml%20version%3D%5C%221.0%5C%22%3F%3E%22%2C%0A%09%09%09%22%3Cstylesheet%20version%3D%5C%221.0%5C%22%20xmlns%3D%5C%22http%3A//www.w3.org/1999/XSL/Transform%5C%22%3E%22%2C%0A%09%09%09%22%3Coutput%20method%3D%5C%22html%5C%22/%3E%22%2C%0A%09%09%09%22%3C/stylesheet%3E%22%0A%09%09%5D.join%28%22%5Cn%22%29%2C%20%22text/xml%22%29%3B%0A%0A%09%09var%20xsltp%20%3D%20new%20XSLTProcessor%28%29%3B%0A%09%09xsltp.importStylesheet%28xsl%29%3B%0A%09%09var%20htmldoc%20%3D%20xsltp.transformToDocument%28document.implementation.createDocument%28%22%22%2C%20%22%22%2C%20null%29%29%3B%0A%0A%09%09var%20range%20%3D%20htmldoc.createRange%28%29%3B%0A%09%09htmldoc.appendChild%28htmldoc.createElement%28%22html%22%29%29%3B%0A%09%09range.selectNodeContents%28htmldoc.documentElement%29%3B%0A%0A%09%09htmldoc.documentElement.appendChild%28range.createContextualFragment%28aStr%29%29%3B%0A%09%09return%20htmldoc%3B%0A%09%7D%2C%0A%0A%09req%3A%20null%2C%0A%09CB_xmlhttpRequest%3A%20function%28aObj%29%20%7B%0A%09%09if%20%28typeof%28aObj%29%20%21%3D%3D%20%22object%22%20%7C%7C%20%28typeof%28aObj.url%29%20%21%3D%3D%20%22string%22%20%26%26%20%21%28aObj.url%20instanceof%20String%29%29%29%0A%09%09%09return%3B%0A%09%09if%20%28%21%24.req%29%0A%09%09%09%24.req%20%3D%20new%20XMLHttpRequest%28%29%3B%0A%09%09var%20req%20%3D%20%24.req%3B%0A%09%09req.abort%28%29%3B%0A%09%09req.timeout%20%3D%20%24.TIMEOUT%3B%0A%0A%09%09req.reqestUrl%20%3D%20aObj.url%3B%0A%09%09req.open%28aObj.method%20%7C%7C%20%22GET%22%2C%20aObj.url%2C%20true%29%3B%0A%0A%09%09if%20%28typeof%28aObj.headers%29%20%3D%3D%3D%20%22object%22%29%20%7B%0A%09%09%09for%20%28var%20i%20in%20aObj.headers%29%0A%09%09%09%09req.setRequestHeader%28i%2C%20aObj.headers%5Bi%5D%2C%20false%29%3B%0A%09%09%7D%0A%0A%09%09%5B%22onload%22%2C%20%22onerror%22%2C%20%22onreadystatechange%22%2C%20%22ontimeout%22%5D.forEach%28function%28k%29%20%7B%0A%09%09%09if%20%28aObj%5Bk%5D%20%26%26%20%28typeof%28aObj%5Bk%5D%29%20%3D%3D%3D%20%22function%22%20%7C%7C%20aObj%5Bk%5D%20instanceof%20Function%29%29%0A%09%09%09%09req%5Bk%5D%20%3D%20function%28%29%20%7B%0A%09%09%09%09%09aObj%5Bk%5D%28%7B%0A%09%09%09%09%09%09status%3A%20%28req.readyState%20%3D%3D%3D%204%29%20%3F%20req.status%20%3A%200%2C%0A%09%09%09%09%09%09statusText%3A%20%28req.readyState%20%3D%3D%3D%204%29%20%3F%20req.statusText%20%3A%20%22%22%2C%0A%09%09%09%09%09%09responseHeaders%3A%20%28req.readyState%20%3D%3D%3D%204%29%20%3F%20req.getAllResponseHeaders%28%29%20%3A%20%22%22%2C%0A%09%09%09%09%09%09responseText%3A%20req.responseText%2C%0A%09%09%09%09%09%09readyState%3A%20req.readyState%2C%0A%09%09%09%09%09%09finalUrl%3A%20%28req.readyState%20%3D%3D%3D%204%29%20%3F%20req.channel.URI.spec%20%3A%20%22%22%0A%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%7D%3B%0A%09%09%7D%29%3B%0A%0A%09%09if%20%28aObj.overrideMimeType%29%0A%09%09%09req.overrideMimeType%28aObj.overrideMimeType%29%3B%0A%09%09if%20%28typeof%20aObj.data%20%3D%3D%3D%20%22string%22%29%0A%09%09%09req.send%28aObj.data%29%3B%20//%20For%20POST%0A%09%09else%0A%09%09%09req.send%28null%29%3B%20//%20For%20GET%0A%09%7D%2C%0A%0A%09openPage%3A%20function%28aURL%2C%20aE%29%20%7B%0A%09%09try%20%7B%0A%09%09%09gBrowser.selectedTab%20%3D%20gBrowser.addTab%28aURL%29%3B%0A%09%09%7D%20catch%20%28aEr%29%20%7B%0A%09%09%09try%20%7B%0A%09%09%09%09openContentTab%28aURL%29%3B%0A%09%09%09%7D%20catch%20%28aError%29%20%7B%0A%09%09%09%09openUILink%28aURL%2C%20aE%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09setFooter%3A%20function%28%29%20%7B%0A%09%09let%20eng%20%3D%20%24._.pPanelTransEngine%3B%0A%09%09if%20%28eng%20%3E%203%20%7C%7C%20%21%24._.pPanelTransShowFooter%29%0A%09%09%09return%20true%3B%0A%09%09let%20data%20%3D%20%5B%0A%09%09%09%5B%22Bing%22%2C%20%22https%3A//www.bing.com/translator/%22%5D%2C%0A%09%09%09%5B%22Google%22%2C%20%22https%3A//translate.google.com/%22%5D%2C%0A%09%09%09%5B%22Yandex%22%2C%20%22https%3A//translate.yandex.com/%22%5D%2C%0A%09%09%5D%3B%0A%09%09let%20footer%20%3D%20%24.%24%28%24._UID%20+%20%22_translationResultFooter%22%29%3B%0A%09%09try%20%7B%0A%09%09%09footer.setAttribute%28%22tooltiptext%22%2C%20%22Go%20to%20%22%20+%20data%5Beng%20-%201%5D%5B0%5D%20+%20%22%20Translator%20homepage%22%29%3B%0A%09%09%09footer.url%20%3D%20data%5Beng%20-%201%5D%5B1%5D%3B%0A%09%09%09footer.textContent%20%3D%20%22%AB%22%20+%20data%5Beng%20-%201%5D%5B0%5D%20+%20%22%20Translator%BB%22%3B%0A%09%09%7D%20catch%20%28aErr%29%20%7B%7D%0A%09%7D%2C%0A%0A%09show%3A%20function%28aRes%2C%20aIsTranslating%29%20%7B%0A%09%09let%20text%20%3D%20aRes.replace%28/%5Cn/g%2C%20%22%3Chtml%3Abr%20/%3E%22%29%3B%0A%09%09if%20%28%24._.pPanelTransUseTextbox%29%20%7B%0A%09%09%09//%20Insert%20text%20on%20a%20description%20element%20so%20I%20can%20get%20its%20height%0A%09%09%09//%20to%20apply%20it%20then%20to%20the%20stupid%20dumb%20textbox.%20%AC%AC%0A%09%09%09%24.%24%28%24._UID%20+%20%22_translationResultContentDummy%22%29.textContent%20%3D%20%24.escHTML%28aRes%29%3B%0A%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%24.%24%28%24._UID%20+%20%22_translationResultContent%22%29.setAttribute%28%22value%22%2C%20aRes%29%3B%0A%09%09%09%7D%2C%2010%29%3B%0A%09%09%7D%20else%0A%09%09%09%24.%24%28%24._UID%20+%20%22_translationResultContent%22%29.textContent%20%3D%20%24.escHTML%28aRes%29%3B%0A%09%09%24.setFooter%28%29%3B%0A%09%09if%20%28%24._.pPanelTransAnchorToSelection%29%20%7B%0A%09%09%09%24._mm.sendAsyncMessage%28%24._movePopupMsgID%2C%20%7B%0A%09%09%09%09_UID%3A%20%24._UID%2C%0A%09%09%09%09width%3A%20%28fullScreen%20%3F%20screen.width%20%3A%20screen.availWidth%29%2C%0A%09%09%09%09height%3A%20%28fullScreen%20%3F%20screen.height%20%3A%20screen.availHeight%29%2C%0A%09%09%09%7D%29%3B%0A%09%09%7D%20else%0A%09%09%09%24.openTransPop%28%29%3B%0A%09%09clearTimeout%28window%5B%24._UID%5D%5B%22ResizingTimer%22%5D%29%3B%0A%09%09window%5B%24._UID%5D%5B%22ResizingTimer%22%5D%20%3D%20setTimeout%28function%28%29%20%7B%0A%09%09%09%24.sizeChange%28aIsTranslating%29%3B%0A%09%09%7D%2C%2010%29%3B%0A%09%7D%2C%0A%0A%09openTransPop%3A%20function%28%29%20%7B%0A%09%09let%20node%20%3D%20%24.%24%28%22content%22%29%3B%0A%09%09if%20%28%21node%29%0A%09%09%09node%20%3D%20%24.%24%28%22messagepane%22%29%3B%0A%09%09%24._.pPanelTransUseTextbox%20%26%26%20%24.dummyPanel.openPopup%28null%2C%20%22%22%2C%200%2C%200%2C%20false%2C%20null%2C%20null%29%3B%0A%09%09%24.transPanel.openPopup%28node%2C%20%22overlap%22%2C%200%2C%200%2C%20false%2C%20null%2C%20null%29%3B%0A%09%7D%2C%0A%0A%09sizeChange%3A%20function%28aIsTranslating%29%20%7B%0A%09%09let%20panel%20%3D%20%24.transPanel%3B%0A%09%09let%20resBox%20%3D%20%24.%24%28%24._UID%20+%20%22_translationResultBox%22%29%3B%0A%09%09if%20%28aIsTranslating%29%20%7B%0A%09%09%09resBox.style.height%20%3D%20resBox.style.minHeight%20%3D%20resBox.style.maxHeight%20%3D%20%2247px%22%3B%0A%09%09%09return%20true%3B%0A%09%09%7D%0A%09%09if%20%28%24._.pPanelTransUseTextbox%29%20%7B%0A%09%09%09let%20dummyPanel%20%3D%20%24.dummyPanel%3B%0A%09%09%09dummyPanel.sizeTo%28parseInt%28resBox.boxObject.width%2C%2010%29%2C%20%22%22%29%3B%0A%09%09%09resBox.style.height%20%3D%20resBox.style.minHeight%20%3D%20resBox.style.maxHeight%20%3D%0A%09%09%09%09Number%28dummyPanel.firstChild.scrollHeight%29%20+%2030%20+%20%22px%22%3B%0A%09%09%7D%0A%09%09clearTimeout%28window%5B%24._UID%5D%5B%22ResizingTimer%22%5D%29%3B%0A%09%09window%5B%24._UID%5D%5B%22ResizingTimer%22%5D%20%3D%20setTimeout%28function%28%29%20%7B%0A%09%09%09panel.sizeTo%28%24._.pPanelTransMaxWidth%2C%20Math.max%28resBox.boxObject.height%20*%201.0%20+%205%2C%2023%29%29%3B%0A%09%09%7D%2C%2010%29%3B%0A%09%7D%2C%0A%0A%09populateOptionsPopup%3A%20function%28aN%29%20%7B%0A%09%09%24.getEng%28null%2C%20true%29%3B%0A%09%09let%20panelEngContainer%2C%20pageEngContainer%3B%0A%09%09let%20tNode%20%3D%20aN.triggerNode%3B%0A%09%09let%20that%20%3D%20%22document.getElementById%28%27%22%20+%20self.id%20+%20%22%27%29.MultiTranslator.%22%3B%0A%09%09aN.textContent%20%3D%20%22%22%3B%0A%0A%09%09aN.onclick%20%3D%20function%28aE%29%20%7B%0A%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%7D%3B%0A%09%09if%20%28%21tNode%20%7C%7C%20%28tNode%20%26%26%20tNode.id%20%21%3D%3D%20%24._UID%20+%20%22_translationIconOnURLBar%22%29%29%20%7B%0A%09%09%09if%20%28aN.id%29%20%7B%0A%09%09%09%09aN.appendChild%28%24.%24CNS%28%22dialogheader%22%2C%20%7B%0A%09%09%09%09%09title%3A%20%22Engines%20for%20panel%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Choose%20default%20engine%20for%20the%20panel%20translator.%22%2C%0A%09%09%09%09%09style%3A%20%22margin%3A%200%200%207px%200%3Bpadding%3A%202px%200%202px%205px%3Bborder%3Anone%3Bfont-size%3Asmaller%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09panelEngContainer%20%3D%20aN%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09panelEngContainer%20%3D%20aN.appendChild%28%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Engines%20for%20panel%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Choose%20default%20engine%20for%20the%20panel%20translator.%22%2C%0A%09%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09let%20rGPop%20%3D%20panelEngContainer.appendChild%28%24.%24CNS%28%22radiogroup%22%29%29%3B%0A%09%09%09var%20pEngs%20%3D%20%24.PanelEngines%3B%0A%09%09%09for%20%28let%20eng%20in%20pEngs%29%20%7B%0A%09%09%09%09if%20%28pEngs.hasOwnProperty%28eng%29%29%20%7B%0A%09%09%09%09%09rGPop.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09%09label%3A%20pEngs%5Beng%5D.label%2C%0A%09%09%09%09%09%09type%3A%20%22radio%22%2C%0A%09%09%09%09%09%09closemenu%3A%20%22none%22%2C%0A%09%09%09%09%09%09onclick%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%09oncommand%3A%20that%20+%20%22sPref%28%27pPanelTransEngine%27%2C%20%22%20+%20parseInt%28eng%2C%2010%29%20+%0A%09%09%09%09%09%09%09%22%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%09checked%3A%20%28%24._.pPanelTransEngine%20%3D%3D%3D%20parseInt%28eng%2C%2010%29%29%2C%0A%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%09if%20%28%21tNode%20%7C%7C%20%28tNode%20%26%26%20tNode.id%20%26%26%20tNode.id%20%21%3D%3D%20%24._UID%20+%20%22_translationOptionsButton%22%29%29%20%7B%0A%09%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%0A%09%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Translate%20from...%22%2C%0A%09%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09class%3A%20%24._UID%20+%20%22_lang_list%22%2C%0A%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%22data-langlist%22%3A%20%22%7B%27pref%27%3A%27pPanelTransFromLang%27%2C%20%27dir%27%3A%20%27from%27%7D%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Translate%20to...%22%2C%0A%09%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09class%3A%20%24._UID%20+%20%22_lang_list%22%2C%0A%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%22data-langlist%22%3A%20%22%7B%27pref%27%3A%27pPanelTransToLang%27%2C%20%27dir%27%3A%20%27to%27%7D%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09if%20%28%24._.pShowCustomPanelEngines%29%20%7B%0A%09%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%0A%09%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Edit%20custom%20engines%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Edit%20custom%20engines%20for%20the%20panel%20translator%22%2C%0A%09%09%09%09%09oncommand%3A%20that%20+%20%22editCustomEngines%28%27PanelEngines%27%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%09//%20aN.id%20%26%26%20panelEngContainer.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%0A%09%09%7D%0A%0A%09%09if%20%28%22gBrowser%22%20in%20window%20%26%26%20%28%21tNode%20%7C%7C%20%28tNode%20%26%26%20tNode.id%20%21%3D%3D%20%24._UID%20+%20%22_translationOptionsButton%22%29%29%29%20%7B%0A%09%09%09if%20%28aN.id%29%20%7B%0A%09%09%09%09aN.appendChild%28%24.%24CNS%28%22dialogheader%22%2C%20%7B%0A%09%09%09%09%09title%3A%20%22Engines%20for%20page%20translator%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Choose%20default%20engine%20for%20the%20page%20translator.%22%2C%0A%09%09%09%09%09style%3A%20%22margin%3A%200%200%207px%200%3Bpadding%3A%202px%200%202px%205px%3Bborder%3Anone%3Bfont-size%3Asmaller%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09pageEngContainer%20%3D%20aN%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09pageEngContainer%20%3D%20aN.appendChild%28%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Engines%20for%20page%20translator%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Choose%20default%20engine%20for%20the%20page%20translator.%22%2C%0A%09%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%0A%09%09%09let%20rGURL%20%3D%20pageEngContainer.appendChild%28%24.%24CNS%28%22radiogroup%22%29%29%3B%0A%09%09%09let%20URLBEng%20%3D%20%24.URLBarEngines%3B%0A%09%09%09for%20%28var%20book%20in%20URLBEng%29%20%7B%0A%09%09%09%09if%20%28URLBEng.hasOwnProperty%28book%29%29%20%7B%0A%09%09%09%09%09if%20%28%21%21URLBEng%5Bbook%5D.label%20%26%26%20%21%21URLBEng%5Bbook%5D.command%29%20%7B%0A%09%09%09%09%09%09rGURL.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09%09%09label%3A%20URLBEng%5Bbook%5D.label%2C%0A%09%09%09%09%09%09%09type%3A%20%22radio%22%2C%0A%09%09%09%09%09%09%09closemenu%3A%20%22none%22%2C%0A%09%09%09%09%09%09%09tooltiptext%3A%20%21%21URLBEng%5Bbook%5D.tooltip%20%3F%20URLBEng%5Bbook%5D.tooltip%20%3A%20%22%22%2C%0A%09%09%09%09%09%09%09checked%3A%20%28%24._.pPageTransEngine%20%3D%3D%3D%20parseInt%28book%2C%2010%29%29%2C%0A%09%09%09%09%09%09%09oncommand%3A%20that%20+%20%22sPref%28%27pPageTransEngine%27%2C%20%22%20+%20parseInt%28book%2C%2010%29%20+%0A%09%09%09%09%09%09%09%09%22%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09if%20%28%22gBrowser%22%20in%20window%20%26%26%20%28%21tNode%20%7C%7C%20%28tNode%20%26%26%20tNode.id%20%21%3D%3D%20%24._UID%20+%20%22_translationOptionsButton%22%29%29%29%20%7B%0A%09%09%09pageEngContainer.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%0A%09%09%09pageEngContainer.appendChild%28%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09label%3A%20%22Translate%20from...%22%2C%0A%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09class%3A%20%24._UID%20+%20%22_lang_list%22%2C%0A%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%22data-langlist%22%3A%20%22%7B%27pref%27%3A%27pPageTransFromLang%27%2C%20%27dir%27%3A%20%27from%27%7D%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09pageEngContainer.appendChild%28%24.%24CNS%28%22menu%22%2C%20%7B%0A%09%09%09%09label%3A%20%22Translate%20to...%22%2C%0A%09%09%09%7D%29%29.appendChild%28%24.%24CNS%28%22menupopup%22%2C%20%7B%0A%09%09%09%09class%3A%20%24._UID%20+%20%22_lang_list%22%2C%0A%09%09%09%09consumeoutsideclicks%3A%20false%2C%0A%09%09%09%09onpopupshowing%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%22data-langlist%22%3A%20%22%7B%27pref%27%3A%27pPageTransToLang%27%2C%20%27dir%27%3A%20%27to%27%7D%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09if%20%28%24._.pShowCustomURLBarEngines%29%20%7B%0A%09%09%09%09pageEngContainer.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%0A%09%09%09%09pageEngContainer.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09label%3A%20%22Edit%20custom%20engines%22%2C%0A%09%09%09%09%09tooltiptext%3A%20%22Edit%20custom%20engines%20for%20the%20page%20translator%22%2C%0A%09%09%09%09%09oncommand%3A%20that%20+%20%22editCustomEngines%28%27URLBarEngines%27%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09if%20%28%21tNode%20%7C%7C%20%28tNode%20%26%26%20tNode.id%20%21%3D%3D%20%24._UID%20+%20%22_translationIconOnURLBar%22%29%29%20%7B%0A%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%0A%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09image%3A%20%24.images%5B1%5D%2C%0A%09%09%09%09label%3A%20%22Manage%20Bing%20API%20keys%22%2C%0A%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09tooltiptext%3A%20%22Add/Remove/edit%20Bing%20API%20keys.%22%2C%0A%09%09%09%09oncommand%3A%20that%20+%20%22editAPIKeys%28%27pAPIKeysBing%27%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09panelEngContainer.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09image%3A%20%24.images%5B3%5D%2C%0A%09%09%09%09label%3A%20%22Manage%20Yandex%20API%20keys%22%2C%0A%09%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%09%09tooltiptext%3A%20%22Add/Remove/edit%20Yandex%20API%20keys.%22%2C%0A%09%09%09%09oncommand%3A%20that%20+%20%22editAPIKeys%28%27pAPIKeysYandex%27%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%0A%09%09aN.appendChild%28%24.%24CNS%28%22separator%22%29%29%3B%0A%09%09aN.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09label%3A%20%22More%20options%22%2C%0A%09%09%09tooltiptext%3A%20%22Open%20Multi%20Translator%20options%20window.%22%2C%0A%09%09%09oncommand%3A%20that%20+%20%22openOptions%28%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%7D%29%29%3B%0A%09%09%24.populateAllLangLists%28%29%3B%0A%09%7D%2C%0A%0A%09populateAllLangLists%3A%20function%28%29%20%7B%0A%09%09let%20langs%20%3D%20%24.langs%3B%0A%09%09let%20that%20%3D%20%22document.getElementById%28%27%22%20+%20self.id%20+%20%22%27%29.MultiTranslator.%22%3B%0A%09%09Array.prototype.slice.call%28document.getElementsByAttribute%28%22data-langlist%22%2C%20%22*%22%29%29.forEach%28function%28aMpop%29%20%7B%0A%09%09%09let%20mObj%20%3D%20JSON.parse%28aMpop.getAttribute%28%22data-langlist%22%29.replace%28/%5C%27/g%2C%20%22%5C%22%22%29%29%3B%0A%09%09%09aMpop.textContent%20%3D%20%22%22%3B%0A%09%09%09let%20container%20%3D%20aMpop.appendChild%28%24.%24CNS%28%22radiogroup%22%2C%20%7B%0A%09%09%09%09tooltip%3A%20%24._UID%20+%20%22_languageSelectionTooltip%22%2C%0A%09%09%09%09oncommand%3A%20%22event.stopPropagation%28%29%3B%22%2C%0A%09%09%09%09onclick%3A%20that%20+%20%22switchLanguage%28event%2C%20%27%22%20+%20mObj%5B%22pref%22%5D%20+%20%22%27%29%3Bevent.stopPropagation%28%29%3B%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09for%20%28let%20lng%20in%20langs%29%20%7B%0A%09%09%09%09if%20%28langs.hasOwnProperty%28lng%29%29%20%7B%0A%09%09%09%09%09let%20blacklisted%20%3D%20%24.handleLanguagesBlacklist%28lng%2C%20true%29%3B%0A%09%09%09%09%09if%20%28lng%20%3D%3D%3D%20%22%22%20%26%26%20mObj%5B%22dir%22%5D%20%3D%3D%3D%20%22to%22%29%0A%09%09%09%09%09%09continue%3B%0A%09%09%09%09%09if%20%28blacklisted%20%26%26%20%21%24._.pLanguagesShowHidden%29%0A%09%09%09%09%09%09continue%3B%0A%09%09%09%09%09container.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09%09%09%09label%3A%20langs%5Blng%5D%2C%0A%09%09%09%09%09%09type%3A%20%22radio%22%2C%0A%09%09%09%09%09%09closemenu%3A%20%22none%22%2C%0A%09%09%09%09%09%09group%3A%20%24._UID%20+%20mObj%5B%22pref%22%5D%20+%20%22_group%22%2C%0A%09%09%09%09%09%09style%3A%20blacklisted%20%3F%20%22text-decoration%3Aline-through%20%21important%3B%22%20%3A%20%22%22%2C%0A%09%09%09%09%09%09value%3A%20lng%2C%0A%09%09%09%09%09%09seleted%3A%20%28lng%20%3D%3D%3D%20%24._%5BmObj%5B%22pref%22%5D%5D%29%2C%0A%09%09%09%09%09%7D%29%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09switchLanguage%3A%20function%28aE%2C%20aPref%29%20%7B%0A%09%09let%20el%2C%20mPop%3B%0A%09%09el%20%3D%20mPop%20%3D%20aE.target%3B%0A%09%09while%20%28mPop.nodeName.toLowerCase%28%29%20%21%3D%3D%20%22menupopup%22%29%20%7B%0A%09%09%09mPop%20%3D%20mPop.parentNode%3B%0A%09%09%7D%0A%09%09if%20%28aE.button%20%3D%3D%3D%200%29%20%7B%0A%09%09%09%24.sPref%28aPref%2C%20el.value%29%3B%0A%09%09%09%24.setPanelLangListLabel%28%29%3B%0A%09%09%7D%20else%20if%20%28aE.button%20%3D%3D%3D%202%29%20%7B%0A%09%09%09let%20blacklisted%20%3D%20%24.handleLanguagesBlacklist%28el.value%29%3B%0A%09%09%09el.setAttribute%28%22style%22%2C%20blacklisted%20%3F%0A%09%09%09%09%22text-decoration%3A%20line-through%20%21important%3B%22%20%3A%0A%09%09%09%09%22text-decoration%3A%20none%20%21important%3B%22%29%3B%0A%09%09%09%24._.pLanguagesShowHidden%20%7C%7C%20el.setAttribute%28%22hidden%22%2C%20blacklisted%29%3B%0A%09%09%09if%20%28%21window%5B%24._UID%5D%5B%22PopulateLangListsListener%22%5D%29%20%7B%0A%09%09%09%09window%5B%24._UID%5D%5B%22PopulateLangListsListener%22%5D%20%3D%20true%3B%0A%09%09%09%09mPop.addEventListener%28%22popuphiding%22%2C%20function%20_%28aE%29%20%7B%0A%09%09%09%09%09this.removeEventListener%28%22popuphiding%22%2C%20_%2C%20false%29%3B%0A%09%09%09%09%09%24.populateAllLangLists%28%29%3B%0A%09%09%09%09%09delete%20window%5B%24._UID%5D%5B%22PopulateLangListsListener%22%5D%3B%0A%09%09%09%09%7D%2C%20false%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09handleLanguagesBlacklist%3A%20function%28aLng%2C%20aJustCheck%29%20%7B%0A%09%09let%20blackList%20%3D%20%24._.pLanguagesBlacklist.split%28%22%2C%22%29.filter%28function%28aVal%29%20%7B%0A%09%09%09if%20%28aVal%20%3D%3D%3D%20%22en%22%29%0A%09%09%09%09return%20false%3B%0A%09%09%09if%20%28aVal%20%21%3D%3D%20%22%22%29%0A%09%09%09%09return%20true%3B%0A%09%09%7D%29%3B%0A%09%09let%20lng%20%3D%20aLng%3B%0A%09%09let%20exists%3B%0A%09%09if%20%28aJustCheck%29%20%7B%0A%09%09%09exists%20%3D%20%28blackList.indexOf%28lng%29%20%21%3D%3D%20-1%29%3B%0A%09%09%7D%20else%20%7B%0A%09%09%09if%20%28blackList.indexOf%28lng%29%20%21%3D%3D%20-1%29%20%7B%0A%09%09%09%09while%20%28blackList.indexOf%28lng%29%20%21%3D%3D%20-1%29%20%7B%0A%09%09%09%09%09blackList.splice%28blackList.indexOf%28lng%29%2C%201%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%20else%0A%09%09%09%09blackList.push%28lng%29%3B%0A%09%09%09exists%20%3D%20%28blackList.indexOf%28lng%29%20%21%3D%3D%20-1%29%3B%0A%09%09%09%24.sPref%28%22pLanguagesBlacklist%22%2C%20blackList.join%28%22%2C%22%29%29%3B%0A%09%09%7D%0A%09%09return%20exists%3B%0A%09%7D%2C%0A%0A%09editAPIKeys%3A%20function%28aPref%29%20%7B%0A%09%09var%20em%20%3D%20Services.ww.getWindowEnumerator%28%29%3B%0A%09%09var%20winName%20%3D%20%24._UID%20+%20%22_edit_api_keys_window%22%3B%0A%09%09var%20index%20%3D%201%3B%0A%09%09while%20%28em.hasMoreElements%28%29%29%20%7B%0A%09%09%09let%20win%20%3D%20em.getNext%28%29%3B%0A%09%09%09if%20%28win.name%20%3D%3D%3D%20winName%29%20%7B%0A%09%09%09%09win.focus%28%29%3B%0A%09%09%09%09return%3B%0A%09%09%09%7D%0A%09%09%09index++%3B%0A%09%09%7D%0A%09%09let%20storage%20%3D%20%7B%0A%09%09%09button%3A%20self%2C%0A%09%09%09APIKeysObj%3A%20JSON.parse%28%24._%5BaPref%5D%29%2C%0A%09%09%09accel%3A%20%24.accel%2C%0A%09%09%09getHelp%3A%20%24.getHelp%2C%0A%09%09%09openPage%3A%20%24.openPage%2C%0A%09%09%09custombuttons%3A%20custombuttons%2C%0A%09%09%09prefName%3A%20aPref%2C%0A%09%09%7D%3B%0A%09%09let%20xul%20%3D%20%24.getHelp%28%22%25APIKeysWindow%25%22%29%3B%0A%09%09xul%20%3D%20xul.replace%28/%3E%5Cs+%3C/g%2C%20%22%3E%3C%22%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25MAX_HEIGHT%25%22%29.join%28screen.availHeight%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25U_I_D%25%22%29.join%28%24._UID%29%3B%0A%09%09let%20url%20%3D%20%22data%3Aapplication/vnd.mozilla.xul+xml%3Btext/plain%2C%22%20+%20encodeURIComponent%28xul%29%3B%0A%09%09let%20optWin%20%3D%20openDialog%28url%2C%20winName%2C%20%22chrome%2C%20dialog%3Dno%2C%20centerscreen%2C%20close%22%29%3B%0A%09%09optWin._storage%20%3D%20storage%3B%0A%09%7D%2C%0A%0A%09openOptions%3A%20function%28%29%20%7B%0A%09%09var%20em%20%3D%20Services.ww.getWindowEnumerator%28%29%3B%0A%09%09var%20winName%20%3D%20%24._UID%20+%20%22_settings_window%22%3B%0A%09%09var%20index%20%3D%201%3B%0A%09%09while%20%28em.hasMoreElements%28%29%29%20%7B%0A%09%09%09let%20win%20%3D%20em.getNext%28%29%3B%0A%09%09%09if%20%28win.name%20%3D%3D%3D%20winName%29%20%7B%0A%09%09%09%09win.focus%28%29%3B%0A%09%09%09%09return%3B%0A%09%09%09%7D%0A%09%09%09index++%3B%0A%09%09%7D%0A%09%09let%20storage%20%3D%20%7B%0A%09%09%09button%3A%20self%2C%0A%09%09%7D%3B%0A%09%09let%20xul%20%3D%20%24.getHelp%28%22%25OptionsWindow%25%22%29%3B%0A%09%09xul%20%3D%20xul.replace%28/%3E%5Cs+%3C/g%2C%20%22%3E%3C%22%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25U_I_D%25%22%29.join%28%24._UID%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25B_I_N_G_I_M_G%25%22%29.join%28%24.images%5B1%5D%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25Y_A_N_D_E_X_I_M_G%25%22%29.join%28%24.images%5B3%5D%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25A_C_C_E_L%25%22%29.join%28%24.accel%28%29%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25A_P_P_N_A_M_E%25%22%29.join%28Services.appinfo.name%29%3B%0A%09%09xul%20%3D%20xul.split%28%22%25B_R_A_N_C_H%25%22%29.join%28%24.Branch%29%3B%0A%09%09let%20url%20%3D%20%22data%3Aapplication/vnd.mozilla.xul+xml%3Btext/plain%2C%22%20+%20encodeURIComponent%28xul%29%3B%0A%09%09let%20optWin%20%3D%20openDialog%28url%2C%20%22%22%2C%20%22chrome%2C%20dependant%2C%20dialog%2C%20centerscreen%2C%20close%2C%20alwaysRaised%22%29%3B%0A%09%09optWin._storage%20%3D%20storage%3B%0A%09%7D%2C%0A%0A%09editCustomEngines%3A%20function%28aFileName%29%20%7B%0A%09%09let%20storagePath%20%3D%20%24.storagePath%3B%0A%09%09let%20filePath%20%3D%20OS.Path.join%28storagePath%2C%20aFileName%20+%20%22.json%22%29%3B%0A%09%09OS.File.read%28filePath%29.then%28function%20onSuccess%28aReadData%29%20%7B%0A%09%09%09let%20data%20%3D%20new%20TextDecoder%28%29.decode%28aReadData%29%3B%0A%09%09%09var%20em%20%3D%20Services.ww.getWindowEnumerator%28%29%3B%0A%09%09%09var%20winName%20%3D%20%24._UID%20+%20%22_custom_engines_editor%22%3B%0A%09%09%09var%20index%20%3D%201%3B%0A%09%09%09while%20%28em.hasMoreElements%28%29%29%20%7B%0A%09%09%09%09let%20win%20%3D%20em.getNext%28%29%3B%0A%09%09%09%09if%20%28win.name%20%3D%3D%3D%20winName%29%20%7B%0A%09%09%09%09%09win.focus%28%29%3B%0A%09%09%09%09%09return%3B%0A%09%09%09%09%7D%0A%09%09%09%09index++%3B%0A%09%09%09%7D%0A%09%09%09let%20xul%20%3D%20%24.getHelp%28%22%25CustomEnginesEditor%25%22%29%3B%0A%09%09%09let%20storage%20%3D%20%7B%0A%09%09%09%09custombuttons%3A%20custombuttons%2C%0A%09%09%09%09accel%3A%20%24.accel%2C%0A%09%09%09%09fileName%3A%20aFileName%2C%0A%09%09%09%09button%3A%20self%2C%0A%09%09%09%09filePath%3A%20filePath%2C%0A%09%09%09%09storagePath%3A%20storagePath%2C%0A%09%09%09%09data%3A%20data%2C%0A%09%09%09%7D%3B%0A%09%09%09xul%20%3D%20xul.replace%28/%3E%5Cs+%3C/g%2C%20%22%3E%3C%22%29%3B%0A%09%09%09xul%20%3D%20xul.split%28%22%25U_I_D%25%22%29.join%28%24._UID%29%3B%0A%09%09%09xul%20%3D%20xul.split%28%22%25B_T_N_I_D%25%22%29.join%28%24._UID%29%3B%0A%09%09%09xul%20%3D%20xul.split%28%22%25A_C_C_E_L%25%22%29.join%28%24.accel%28%29%29%3B%0A%09%09%09let%20url%20%3D%20%22data%3Aapplication/vnd.mozilla.xul+xml%3Btext/plain%2C%22%20+%20encodeURIComponent%28xul%29%3B%0A%09%09%09let%20win%20%3D%20openDialog%28url%2C%20winName%2C%20%22chrome%2C%20resizable%2C%20dialog%3Dno%2C%20centerscreen%2C%20close%22%29%3B%0A%09%09%09win._storage%20%3D%20storage%3B%0A%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09clickOnTransResult%3A%20function%28aValue%2C%20aEl%29%20%7B%0A%09%09if%20%28%24._.pPanelTransAutoCopyOnClick%29%0A%09%09%09gClipboard.write%28aValue%29%3B%0A%09%09if%20%28%24._.pPanelTransAutoCloseOnClick%29%0A%09%09%09%24.forceHidePanel%28%29%3B%0A%09%7D%2C%0A%0A%09HTMLCSSLoader%3A%20function%28%29%20%7B%0A%09%09let%20css%3B%0A%09%09try%20%7B%0A%09%09%09%24.styleSheet%28window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%2C%20true%29%3B%0A%09%09%09window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%20%3D%20false%3B%0A%09%09%7D%20catch%20%28aErr%29%20%7B%7D%0A%0A%09%09if%20%28%21%24._.pHTMLStyleSheetEnabled%29%0A%09%09%09return%20true%3B%0A%0A%09%09try%20%7B%0A%09%09%09css%20%3D%20%22@namespace%20url%28%22%20+%20xhtmlns%20+%20%22%29%3B%5Cn%22%20+%20decodeURIComponent%28%24._.pHTMLStyleSheet%29%0A%09%09%09%09.replace%28/%25U_I_D%25/g%2C%20%24._UID%29%3B%0A%09%09%7D%20catch%20%28aErr%29%20%7B%0A%09%09%09css%20%3D%20false%3B%0A%09%09%7D%0A%09%09if%20%28%21css%29%0A%09%09%09return%3B%0A%0A%09%09if%20%28%21window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%29%20%7B%0A%09%09%09window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%20%3D%20css%3B%0A%09%09%09%24.styleSheet%28css%29%3B%0A%09%09%7D%20else%20if%20%28window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%20%26%26%20window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%20%21%3D%3D%20css%29%20%7B%0A%09%09%09%24.styleSheet%28window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%2C%20true%29%3B%0A%09%09%09window%5B%24._UID%5D%5B%22HTMLStyleSheet%22%5D%20%3D%20css%3B%0A%09%09%09%24.styleSheet%28css%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09XULCSSLoader%3A%20function%28%29%20%7B%0A%09%09let%20css%3B%0A%09%09try%20%7B%0A%09%09%09%24.styleSheet%28window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%2C%20true%29%3B%0A%09%09%09window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%20%3D%20false%3B%0A%09%09%7D%20catch%20%28aErr%29%20%7B%7D%0A%0A%09%09if%20%28%21%24._.pXULStyleSheetEnabled%29%0A%09%09%09return%20true%3B%0A%0A%09%09try%20%7B%0A%09%09%09css%20%3D%20%22@namespace%20url%28%22%20+%20xulns%20+%20%22%29%3B%5Cn%22%20+%20decodeURIComponent%28%24._.pXULStyleSheet%29%0A%09%09%09%09.replace%28/%25U_I_D%25/g%2C%20%24._UID%29%3B%0A%09%09%7D%20catch%20%28aErr%29%20%7B%0A%09%09%09css%20%3D%20false%3B%0A%09%09%7D%0A%09%09if%20%28%21css%29%0A%09%09%09return%20true%3B%0A%0A%09%09if%20%28%21window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%29%20%7B%0A%09%09%09window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%20%3D%20css%3B%0A%09%09%09%24.styleSheet%28css%29%3B%0A%09%09%7D%20else%20if%20%28window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%20%26%26%20window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%20%21%3D%3D%20css%29%20%7B%0A%09%09%09%24.styleSheet%28window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%2C%20true%29%3B%0A%09%09%09window%5B%24._UID%5D%5B%22XULStyleSheet%22%5D%20%3D%20css%3B%0A%09%09%09%24.styleSheet%28css%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09handlePrefObserver%3A%20function%28aRem%29%20%7B%0A%09%09var%20prefs%20%3D%20%24.DefPrefs%3B%0A%09%09for%20%28let%20key%20in%20prefs%29%20%7B%0A%09%09%09let%20pref%20%3D%20%24.Branch%20+%20key%3B%0A%09%09%09if%20%28prefs.hasOwnProperty%28key%29%29%20%7B%0A%09%09%09%09if%20%28aRem%29%0A%09%09%09%09%09Services.prefs.removeObserver%28pref%2C%20%24.prefObserver%2C%20false%29%3B%0A%09%09%09%09else%0A%09%09%09%09%09Services.prefs.addObserver%28pref%2C%20%24.prefObserver%2C%20false%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09prefObserver%3A%20%7B%0A%09%09observe%3A%20function%28aSubject%2C%20aTopic%2C%20aPStr%29%20%7B%0A%09%09%09if%20%28aTopic%20%3D%3D%3D%20%22nsPref%3Achanged%22%29%20%7B%0A%09%09%09%09let%20prefName%20%3D%20aPStr.slice%28%24.Branch.length%29%3B%0A%09%09%09%09window%5B%24._UID%5D%5B%22Preferences%22%5D%5BprefName%5D%20%3D%20%24.gPref%28prefName%29%3B%0A%09%09%09%09//%20%24%5B%22_%22%20+%20prefName%5D%20%3D%20%24.gPref%28prefName%29%3B%0A%09%09%09%09let%20transPanel%20%3D%20%24.transPanel%3B%0A%09%09%09%09let%20selfPop%20%3D%20%24.%24%28%24._UID%20+%20%22_self_popup%22%29%3B%0A%09%09%09%09switch%20%28prefName%29%20%7B%0A%09%09%09%09%09case%20%22pPanelTransFromLang%22%3A%0A%09%09%09%09%09case%20%22pPanelTransToLang%22%3A%0A%09%09%09%09%09%09if%20%28transPanel%20%26%26%20transPanel.state%20%3D%3D%3D%20%22open%22%29%0A%09%09%09%09%09%09%09%24.translateSelection%28%29%3B%0A%09%09%09%09%09%09break%3B%0A%09%09%09%09%09case%20%22pPanelTransEngine%22%3A%0A%09%09%09%09%09%09if%20%28transPanel%20%26%26%20transPanel.state%20%3D%3D%3D%20%22open%22%29%0A%09%09%09%09%09%09%09%24.translateSelection%28%29%3B%0A%09%09%09%09%09%09transPanel%20%26%26%20%28transPanel.label%20%3D%20%24.getEng%28%22label%22%2C%20true%29%29%3B%0A%09%09%09%09%09%09%24.%24%28%24._UID%20+%20%22_translationOptionsButton%22%29.image%20%3D%20%24.getEng%28%22image%22%2C%20true%29%3B%0A%09%09%09%09%09%09%24.setFooter%28%29%3B%0A%09%09%09%09%09%09%24.assignImages%28selfPop%29%3B%0A%09%09%09%09%09%09break%3B%0A%09%09%09%09%09case%20%22pPageTransEngine%22%3A%0A%09%09%09%09%09%09%24.handleURLBarIcon%28true%29%3B%0A%09%09%09%09%09%09%24.assignImages%28selfPop%29%3B%0A%09%09%09%09%09%09break%3B%0A%09%09%09%09%09case%20%22pTransOnRelease%22%3A%0A%09%09%09%09%09%09try%20%7B%0A%09%09%09%09%09%09%09%24.removeListeners%28true%29%3B%0A%09%09%09%09%09%09%7D%20finally%20%7B%0A%09%09%09%09%09%09%09%24.addListeners%28%29%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09break%3B%0A%09%09%09%09%7D%0A%09%09%09%09%24._%20%3D%20window%5B%24._UID%5D%5B%22Preferences%22%5D%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09selfDestroy%3A%20function%28%29%20%7B%0A%09%09clearTimeout%28window%5B%24._UID%5D%5B%22CleanSlateTimer%22%5D%29%3B%0A%09%09window%5B%24._UID%5D%5B%22CleanSlateTimer%22%5D%20%3D%20setTimeout%28function%28%29%20%7B%0A%09%09%09self.destroy%28%22update%22%29%3B%0A%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09self.init%28%29%3B%0A%09%09%09%7D%2C%20100%29%3B%0A%09%09%7D%2C%20100%29%3B%0A%09%7D%2C%0A%0A%09%24CNS%3A%20function%28aElName%2C%20aAttrs%2C%20aNameSpace%29%20%7B%20//%20Creates%20elements%0A%09%09var%20el%20%3D%20aNameSpace%20%3F%0A%09%09%09document.createElementNS%28aNameSpace%2C%20aElName%29%20%3A%0A%09%09%09document.createElement%28aElName%29%3B%0A%09%09if%20%28aAttrs%29%0A%09%09%09Object.keys%28aAttrs%29.forEach%28function%28n%29%20%7B%0A%09%09%09%09if%20%28aAttrs%5Bn%5D%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09el.setAttribute%28n%2C%20aAttrs%5Bn%5D%29%3B%0A%09%09%09%7D%29%3B%0A%09%09return%20el%3B%0A%09%7D%2C%0A%0A%09notifyme%3A%20function%28aTitle%2C%20aMsg%2C%20aImg%2C%20aCallback%29%20%7B%20//%20Notification%20function%0A%09%09let%20origin%20%3D%20%28Services.prefs.getPrefType%28%22ui.alertNotificationOrigin%22%29%20%21%3D%3D%200%29%20%3F%0A%09%09%09Services.prefs.getIntPref%28%22ui.alertNotificationOrigin%22%29%20%3A%0A%09%09%09null%3B%0A%09%09let%20win%20%3D%20Services.ww.openWindow%28null%2C%20%22chrome%3A//global/content/alerts/alert.xul%22%2C%0A%09%09%09%22_blank%22%2C%20%22chrome%2Ctitlebar%3Dno%2Cpopup%3Dyes%22%2C%20null%29%3B%0A%09%09win.arguments%20%3D%20%5BaImg%2C%0A%09%09%09aTitle%2C%0A%09%09%09aMsg%2C%20%21%21aCallback%2C%0A%09%09%09%22%22%2C%0A%09%09%09origin%2C%0A%09%09%09%22%22%2C%0A%09%09%09%22%22%2C%0A%09%09%09null%2C%0A%09%09%09%28%21%21aCallback%20%3F%20aCallback%20%3A%20null%29%0A%09%09%5D%3B%0A%09%7D%2C%0A%0A%09alertCallback%3A%20%7B%0A%09%09options%3A%20%7B%0A%09%09%09middleScreen%3A%20null%2C%0A%09%09%09openLocation%3A%20null%0A%09%09%7D%2C%0A%09%09observe%3A%20function%28aSubject%2C%20aTopic%2C%20aData%29%20%7B%0A%09%09%09let%20alt%20%3D%20Services.wm.getMostRecentWindow%28%22alert%3Aalert%22%29%3B%0A%09%09%09let%20tBox%20%3D%20alt.document.getElementById%28%22alertTextBox%22%29%3B%0A%09%09%09if%20%28aTopic%20%3D%3D%3D%20%22alertshow%22%29%20%7B%0A%09%09%09%09tBox.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09%09flex%3A%201%2C%0A%09%09%09%09%09value%3A%20%28this.options.openLocation%20%3F%0A%09%09%09%09%09%09%22%uD835%uDDD6%uD835%uDDF9%uD835%uDDF6%uD835%uDDF0%uD835%uDDF8%20%uD835%uDDFA%uD835%uDDF2%20%uD835%uDE01%uD835%uDDFC%20%uD835%uDDFC%uD835%uDDFD%uD835%uDDF2%uD835%uDDFB%20%uD835%uDE00%uD835%uDE01%uD835%uDDFC%uD835%uDDFF%uD835%uDDEE%uD835%uDDF4%uD835%uDDF2%22%20%3A%0A%09%09%09%09%09%09%22%uD835%uDDD6%uD835%uDDF9%uD835%uDDF6%uD835%uDDF0%uD835%uDDF8%20%uD835%uDDFA%uD835%uDDF2%20%uD835%uDE01%uD835%uDDFC%20%uD835%uDDF0%uD835%uDDF9%uD835%uDDFC%uD835%uDE00%uD835%uDDF2%20%uD835%uDDFA%uD835%uDDF2%22%29%2C%0A%09%09%09%09%7D%29%29%3B%0A%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09alt.close%28%29%3B%0A%09%09%09%09%7D%2C%205000%29%3B%0A%09%09%09%7D%0A%09%09%09if%20%28aTopic%20%3D%3D%3D%20%22alertclickcallback%22%29%20%7B%0A%09%09%09%09this.options.openLocation%20%26%26%20%28new%20%24._nsIFile%28%24.storagePath%29.reveal%28%29%29%3B%0A%09%09%09%09alt.close%28%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%0A%09getHelp%3A%20function%28aPlaceholder%29%20%7B%20//%20Get%20specific%20data%2C%20surrounded%20by%20%22placeholders%22%2C%20from%20the%20Help%20tab.%0A%09%09return%20document.getElementById%28self.id%29.getAttribute%28%22Help%22%29.split%28%22%3C%21--%22%20+%20aPlaceholder%20+%20%22--%3E%22%29%5B1%5D%3B%0A%09%7D%2C%0A%0A%09styleSheet%3A%20function%28aCSS%2C%20aRemFlag%29%20%7B%0A%09%09var%20sss%20%3D%20Cc%5B%22@mozilla.org/content/style-sheet-service%3B1%22%5D.getService%28Ci.nsIStyleSheetService%29%3B%0A%09%09var%20uri%20%3D%20Services.io.newURI%28%22data%3Atext/css%2C%22%20+%20encodeURIComponent%28aCSS%29%2C%20null%2C%20null%29%3B%0A%09%09if%20%28sss.sheetRegistered%28uri%2C%20sss.USER_SHEET%29%29%0A%09%09%09sss.unregisterSheet%28uri%2C%20sss.USER_SHEET%29%3B%0A%09%09if%20%28aRemFlag%29%0A%09%09%09return%3B%0A%09%09sss.loadAndRegisterSheet%28uri%2C%20sss.USER_SHEET%29%3B%0A%09%7D%2C%0A%0A%09%24%3A%20function%28aID%2C%20aParent%29%20%7B%0A%09%09if%20%28%21aParent%29%0A%09%09%09return%20document.getElementById%28aID%29%3B%0A%09%09return%20aParent.getElementById%28aID%29%3B%0A%09%7D%2C%0A%0A%09%24%24%3A%20function%28aTagName%2C%20aParent%29%20%7B%0A%09%09if%20%28%21aParent%29%0A%09%09%09return%20document.getElementsByTagName%28aTagName%29%3B%0A%09%09return%20aParent.getElementsByTagName%28aTagName%29%3B%0A%09%7D%2C%0A%0A%09reportError%3A%20function%28aError%29%20%7B%0A%09%09try%20%7B%0A%09%09%09console.error%28aError%29%3B%0A%09%09%7D%20catch%20%28aErr%29%20%7B%0A%09%09%09Cu.reportError%28%5B%22Multi%20Translator%22%20+%20%22%3A%20%22%20+%20self.id%2C%20aError%2C%20aError.stack%5D.join%28%22%5Cn%22%29%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09escHTML%3A%20function%28aStr%2C%20aIsAttr%29%20%7B%0A%09%09aStr%20%3D%20String%28aStr%29%0A%09%09%09.replace%28/%26/g%2C%20%22%26amp%3B%22%29%0A%09%09%09.replace%28/%3C/g%2C%20%22%26lt%3B%22%29%0A%09%09%09.replace%28/%3E/g%2C%20%22%26gt%3B%22%29%0A%09%09%09.replace%28/%22/g%2C%20%22%26quot%3B%22%29%0A%09%09%09.replace%28/%27/g%2C%20%22%26apos%3B%22%29%3B%0A%09%09if%20%28aIsAttr%29%20%7B%0A%09%09%09aStr%20%3D%20aStr%0A%09%09%09%09.replace%28/%5Ct/g%2C%20%22%26%23x9%3B%22%29%0A%09%09%09%09.replace%28/%5Cn/g%2C%20%22%26%23xA%3B%22%29%0A%09%09%09%09.replace%28/%5Cr/g%2C%20%22%26%23xD%3B%22%29%3B%0A%09%09%7D%0A%09%09return%20aStr%3B%0A%09%7D%2C%0A%0A%09mergeObj%3A%20function%28aTgt%2C%20aSrc%29%20%7B%0A%09%09/*%20Merges%20two%20%28or%20more%29%20objects%2C%0A%09%09%20%20%20giving%20the%20last%20one%20precedence%20*/%0A%09%09if%20%28typeof%20aTgt%20%21%3D%3D%20%22object%22%29%0A%09%09%09aTgt%20%3D%20%7B%7D%3B%0A%0A%09%09for%20%28var%20prop%20in%20aSrc%29%20%7B%0A%09%09%09if%20%28aSrc.hasOwnProperty%28prop%29%29%20%7B%0A%09%09%09%09var%20sourceProperty%20%3D%20aSrc%5Bprop%5D%3B%0A%09%09%09%09if%20%28typeof%20sourceProperty%20%3D%3D%3D%20%22object%22%29%20%7B%0A%09%09%09%09%09aTgt%5Bprop%5D%20%3D%20%24.mergeObj%28aTgt%5Bprop%5D%2C%20sourceProperty%29%3B%0A%09%09%09%09%09continue%3B%0A%09%09%09%09%7D%0A%09%09%09%09aTgt%5Bprop%5D%20%3D%20sourceProperty%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09for%20%28var%20a%20%3D%202%2C%20l%20%3D%20arguments.length%3B%20a%20%3C%20l%3B%20a++%29%20%7B%0A%09%09%09%24.mergeObj%28aTgt%2C%20arguments%5Ba%5D%29%3B%0A%09%09%7D%0A%0A%09%09return%20aTgt%3B%0A%09%7D%2C%0A%0A%09escapeHash%3A%20%7B%0A%09%09_%3A%20function%28input%29%20%7B%0A%09%09%09var%20ret%20%3D%20%24.escapeHash%5Binput%5D%3B%0A%09%09%09if%20%28%21ret%29%20%7B%0A%09%09%09%09if%20%28input.length%20-%201%29%20%7B%0A%09%09%09%09%09ret%20%3D%20String.fromCharCode%28parseInt%28input.substring%28input.length%20-%203%20%3F%202%20%3A%201%29%2C%2016%29%29%3B%0A%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09var%20code%20%3D%20input.charCodeAt%280%29%3B%0A%09%09%09%09%09ret%20%3D%20code%20%3C%20256%20%3F%20%22%25%22%20+%20%280%20+%20code.toString%2816%29%29.slice%28-2%29.toUpperCase%28%29%20%3A%20%22%25u%22%20+%20%28%22000%22%20+%20code.toString%2816%29%29.slice%28-4%29.toUpperCase%28%29%3B%0A%09%09%09%09%7D%0A%09%09%09%09%24.escapeHash%5Bret%5D%20%3D%20input%3B%0A%09%09%09%09%24.escapeHash%5Binput%5D%20%3D%20ret%3B%0A%09%09%09%7D%0A%09%09%09return%20ret%3B%0A%09%09%7D%0A%09%7D%2C%0A%0A%09%24escape%3A%20function%28aStr%29%20%7B%0A%09%09return%20aStr.toString%28%29.replace%28/%5B%5E%5Cw%20@%5C*%5C-%5C+%5C.%5C/%5D/g%2C%20function%28aChar%29%20%7B%20//%20Per%20Liedman%0A%09%09%09return%20%24.escapeHash._%28aChar%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09%24unescape%3A%20function%28aStr%29%20%7B%0A%09%09return%20aStr.toString%28%29.replace%28/%25%28u%5B%5Cda-f%5D%7B4%7D%7C%5B%5Cda-f%5D%7B2%7D%29/gi%2C%20function%28aSeq%29%20%7B%20//%20Per%20Liedman%0A%09%09%09return%20%24.escapeHash._%28aSeq%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%0A%09prefHandling%3A%20%7B%0A%09%09_msg%3A%20%22This%20process%20is%20immediate%20and%20irreversible.%5Ct%5Cn%22%20+%0A%09%09%09%22It%20is%20advisable%20to%20make%20a%20backup%20of%20the%20preferences%20before%20proceeding.%5Ct%5Cn%5Cn%22%20+%0A%09%09%09%22Do%20you%20want%20to%20continue%3F%5Cn%22%2C%0A%0A%09%09resetP%3A%20function%28%29%20%7B%0A%09%09%09let%20msg%20%3D%20%22You%27re%20about%20to%20reset%20%22%20+%20self.name%20+%0A%09%09%09%09%22%20preferences%20to%20their%20default%20values%u200B%u200B.%5Ct%5Ct%5Cn%22%20+%20this._msg%3B%0A%09%09%09let%20cBox%20%3D%20custombuttons.confirmBox%28self.name%2C%20msg%2C%20%22Yes%22%2C%20%22Cancel%22%29%3B%0A%09%09%09if%20%28cBox%29%20%7B%0A%09%09%09%09%28Services.prefs.getBranch%28%24.Branch%29%29.deleteBranch%28%22%22%29%3B%0A%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09%24.selfDestroy%28%29%3B%0A%09%09%09%09%7D%2C%20100%29%3B%0A%09%09%09%7D%20else%0A%09%09%09%09return%3B%0A%09%09%7D%2C%0A%0A%09%09exportP%3A%20function%28%29%20%7B%0A%09%09%09var%20out%20%3D%20%5B%5D%3B%0A%09%09%09var%20value%2C%0A%09%09%09%09prefList%20%3D%20%28Services.prefs.getBranch%28%24.Branch%29%29.getChildList%28%22%22%2C%20%7B%7D%29%3B%0A%09%09%09for%20%28let%20pref%20in%20prefList%29%20%7B%0A%09%09%09%09if%20%28%21/%5EOptionsForButtonID/.test%28prefList%5Bpref%5D%29%29%20%7B%0A%09%09%09%09%09switch%20%28Services.prefs.getPrefType%28%24.Branch%20+%20prefList%5Bpref%5D%29%29%20%7B%0A%09%09%09%09%09%09case%200%3A%0A%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09case%2032%3A%0A%09%09%09%09%09%09%09value%20%3D%20%24.gPref%28prefList%5Bpref%5D%29%3B%0A%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09case%2064%3A%0A%09%09%09%09%09%09%09value%20%3D%20%24.gPref%28prefList%5Bpref%5D%29%3B%0A%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09case%20128%3A%0A%09%09%09%09%09%09%09value%20%3D%20%24.gPref%28prefList%5Bpref%5D%29%20%3F%20%22true%22%20%3A%20%22false%22%3B%0A%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09out.push%28prefList%5Bpref%5D%20+%20%22%7C%22%20+%20value%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%09var%20file%20%3D%20new%20%24._nsIFile%28%24.storagePath%29%3B%0A%09%09%09file.append%28%22MultiTranslator%22%20+%20self.id.slice%2820%29%20+%20%22-Prefs.js%22%29%3B%0A%09%09%09file.createUnique%28Ci.nsIFile.NORMAL_FILE_TYPE%2C%200x1B6%29%3B%0A%09%09%09let%20data%20%3D%20out.join%28%22%5Cn%22%29%3B%0A%09%09%09OS.File.writeAtomic%28file.path%2C%20data%2C%20%7B%0A%09%09%09%09tmpPath%3A%20file.path%20+%20%22.tmp%22%2C%0A%09%09%09%09encoding%3A%20%22utf-8%22%0A%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%24.alertCallback.options%20%3D%20%7B%0A%09%09%09%09%09openLocation%3A%20true%2C%0A%09%09%09%09%09middleScreen%3A%20false%2C%0A%09%09%09%09%7D%3B%0A%09%09%09%09%24.notifyme%28%22Multi%20Translator%20Preferences%22%2C%20%22Successfully%20exported%20to%20Multi%20Translator%20storage.%22%2C%0A%09%09%09%09%09%24.getHelp%28%22%25AlertImg%25%22%29%2C%0A%09%09%09%09%09%24.alertCallback%29%3B%0A%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%09%7D%29%3B%0A%09%09%7D%2C%0A%0A%09%09importP%3A%20function%28%29%20%7B%0A%09%09%09let%20msg%20%3D%20%22You%27re%20about%20to%20import%20new%20preferences%20to%20%22%20+%20self.name%20+%20%22.%5Ct%5Ct%5Cn%22%20+%20this._msg%3B%0A%09%09%09let%20cBox%20%3D%20custombuttons.confirmBox%28self.name%2C%20msg%2C%20%22Yes%22%2C%20%22Cancel%22%29%3B%0A%09%09%09if%20%28cBox%29%20%7B%0A%09%09%09%09var%20localDir%20%3D%20new%20%24._nsIFile%28%24.storagePath%29%3B%0A%09%09%09%09var%20fp%20%3D%20Cc%5B%22@mozilla.org/filepicker%3B1%22%5D.createInstance%28Ci.nsIFilePicker%29%3B%0A%09%09%09%09fp.init%28window%2C%20%22Import%20Multi%20Translator%20Preferences%22%2C%20Ci.nsIFilePicker.modeOpen%29%3B%0A%09%09%09%09fp.appendFilter%28%22%22%2C%20%22MultiMenuID%22%20+%20self.id.slice%2820%29%20+%20%22*.js%22%29%3B%0A%09%09%09%09fp.appendFilter%28%22%22%2C%20%22*.*%22%29%3B%0A%09%09%09%09fp.displayDirectory%20%3D%20localDir%3B%0A%09%09%09%09if%20%28fp.show%28%29%20%3D%3D%3D%20Ci.nsIFilePicker.returnOK%29%20%7B%0A%09%09%09%09%09if%20%28fp.file%20%26%26%20fp.file.exists%28%29%29%0A%09%09%09%09%09%09localDir%20%3D%20fp.file.parent.QueryInterface%28Ci.nsIFile%29%3B%0A%09%09%09%09%7D%20else%0A%09%09%09%09%09return%3B%0A%09%09%09%09OS.File.read%28fp.file.path%29.then%28function%20onSuccess%28aReadData%29%20%7B%0A%09%09%09%09%09let%20prefFile%20%3D%20new%20TextDecoder%28%29.decode%28aReadData%29%3B%0A%09%09%09%09%09prefFile%20%3D%20prefFile.replace%28/%5Cr%5Cn/g%2C%20%22%5Cn%22%29.split%28%22%5Cn%22%29%3B%0A%09%09%09%09%09for%20%28let%20p%20in%20prefFile%29%20%7B%0A%09%09%09%09%09%09var%20prefName%20%3D%20%24.Branch%20+%20prefFile%5Bp%5D.split%28%22%7C%22%29%5B0%5D%2C%0A%09%09%09%09%09%09%09prefValue%20%3D%20prefFile%5Bp%5D.split%28%22%7C%22%29%5B1%5D%3B%0A%09%09%09%09%09%09if%20%28Services.prefs.getPrefType%28prefName%29%29%20%7B%0A%09%09%09%09%09%09%09switch%20%28Services.prefs.getPrefType%28prefName%29%29%20%7B%0A%09%09%09%09%09%09%09%09case%200%3A%0A%09%09%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09%09%09case%2032%3A%0A%09%09%09%09%09%09%09%09%09let%20str%20%3D%20Cc%5B%22@mozilla.org/supports-string%3B1%22%5D%0A%09%09%09%09%09%09%09%09%09%09.createInstance%28Ci.nsISupportsString%29%3B%0A%09%09%09%09%09%09%09%09%09str.data%20%3D%20prefValue%3B%0A%09%09%09%09%09%09%09%09%09Services.prefs.setComplexValue%28%28prefName%29%2C%20Ci.nsISupportsString%2C%20str%29%3B%0A%09%09%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09%09%09case%2064%3A%0A%09%09%09%09%09%09%09%09%09Services.prefs.setIntPref%28prefName%2C%20prefValue%29%3B%0A%09%09%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09%09%09case%20128%3A%0A%09%09%09%09%09%09%09%09%09Services.prefs.setBoolPref%28prefName%2C%20%28%28prefValue%20%3D%3D%3D%20%22true%22%29%20%3F%20%22true%22%20%3A%20%22%22%29%29%3B%0A%09%09%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%7D%0A%09%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09%09%24.selfDestroy%28%29%3B%0A%09%09%09%09%09%7D%2C%20500%29%3B%0A%09%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%09%09%7D%29%3B%0A%09%09%09%7D%20else%0A%09%09%09%09return%3B%0A%09%09%7D%2C%0A%09%7D%2C%0A%0A%09images%3A%20%7B%0A%09%09//%20%22Generic%22%20image.%0A%09%090%3A%20%22data%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABJ0lEQVQ4ja3Rv0r%22%20+%0A%09%09%09%22DQAAG8Jt9AZ+k7aKDD5BmCD6Bi5gEMthFaKByq+BqbHFwchAESxyVuJWSwUEkIllyh01tcpk0BfmcEmP/puo%22%20+%0A%09%09%09%22H33R3Pz44Qv4jnHMs6eNKgCRJU8hSwHEcUEpBKUWj0YCmaaCUIgiCcgDnHIwxGIYBzjkURVltQVZd12HbNiz%22%20+%0A%09%09%09%22L+h2gqirq9ToOji6x0Yrz1kzxXmzFFO4PwPM8yLIM3/fBOccWjVEzxcJOLVDbo3zJJBC8hvMBxtj97ukoP5g%22%20+%0A%09%09%09%22Eto8jsEGIh5fhbCDL+s4zKk1xQgghVVPE2cVEhNg8jJGIcDGgdd5E8yLpdd20ddVPP4tA1v3zaD5w3cda1x0%22%20+%0A%09%09%09%22j69ndB3pPQ+x1vh8VVyz82vZtOi79C7NSbUY3fwLK5gsYfdN865v7KwAAAABJRU5ErkJggg%3D%3D%22%2C%0A%09%09//%20Bing%20translator%20image.%0A%09%091%3A%20%22data%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUklEQVQ4jZVRsUr%22%20+%0A%09%09%09%22EQBCdU2trC7kixLtswCpovMskOQT/QLGyFgWL45Kcml30J/wJy5PIJRYW/oEgB5aCtWgrZyzcDZtNAufAg0x%22%20+%0A%09%09%09%2248/a9GYAFy2Ruro2t9qL8ogjDTAgQhjcmc3MAWCqRcJRaTQKdC8sgFF9N5uZ6ZK/XkgZRlmM0PRpEWS7DD+9%22%20+%0A%09%09%09%22P5AiE4iN3UBWQAQCtEuEaVniElz8h95lQ/KkV6A2n2/KsETsBofjGHXzpZ/oqAIAZ40SPnJ1aB/JOhGXCcC6%22%20+%0A%09%09%09%22/qoX2Rie2kbd5qwrugOFMCMn5a3cBB7fL6i+T4YxQvCsEae+YMJyXSF6QXpW3n71X1f9R/BJFdWl/X0VlyA+%22%20+%0A%09%09%09%22mT36YfvphOlEFxBllVF70goe4yQEAQPe8v1sr4IXpoTqg9kbsXDY68IbJpjzgj5I90Wtjq60Mfos45fxh9iE%22%20+%0A%09%09%09%22usHWarNVFUHciPn8Byc7T4MbektIAAAAASUVORK5CYII%3D%22%2C%0A%09%09//%20Google%20translator%20image.%0A%09%092%3A%20%22data%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACbElEQVQ4jYXO3Wv%22%20+%0A%09%09%09%22TUBzG8dx77V+kdC/t0pdVEJwM3YV6oSgIouCFDmnTJE1hbKMykTknDjdR221VcBsiG1sdHe1Mk6bNmqVJQXR%22%20+%0A%09%09%09%22mPTk3gjxeZN0Lwnrgufx+focJC3sz0RRBVCLolwgiEkE4SRASCfzcz0Gm04umCKIpiv4URSRFEZEoQkmKYJK%22%20+%0A%09%09%09%22C5X696Qj0S+REHD4OCOSP7/LHM6cCEYkgIv0fB0UKVnDBv65tVav1edM0s6bZyJimmanXjaxhGJlabecOE04%22%20+%0A%09%09%09%22ShCWKaxMuNlQHuvUba7KDiOSCFSluTfxAaVuBbdtoNpuwbRu2bcOyLJim+ZcJJQlCSYq86uDRLEEwSTEw6sV%22%20+%0A%09%09%09%229AgUrulj+WoSiqLAs6zA+AMAERS8ymw6CIsXIYguK4eD7joOAQBHgKdLvayiVZAw95A7jI0AgCIoUG4r3A1a%22%20+%0A%09%09%09%22keDxLsFLcR4Cn8PMUFxMqYuNTEJ+9AjfxEvekpxiZnsPu7i4YViDoEyiG0i7WFQc7loO86uBq2oX/AGAFgtH%22%20+%0A%09%09%09%22JDFbXv2HybRbZz1/QaDQ8IMAT76vt8fTwcm/CRW/CRU/CBTdVwAMxjeGx59A0DbquwzCMA4A/GbbjnvY4F9d%22%20+%0A%09%09%09%22H67gbH8OT8UkoioparQZd18H4E+REdPxqD+etm3PRHdvDp+U83uWWEEu/gFqpoFqtgvEN7013xVtozxdvwRd%22%20+%0A%09%09%09%22rbx/dcYKuuAtf3MVUrgpZLmNldf0IOO3dvL9w9vyFLM5F5xEezGFppYByWYGqqtA0rTPAMAwTvrK4GhjI4cN%22%20+%0A%09%09%09%22CHsXiNmS5DFVVUalUoGlaZ+DSjYXbM3Nr2NzcQqm0DVmWUS57SKFQmvkHfIB8SS9Bg30AAAAASUVORK5CYII%3D%22%2C%0A%09%09//%20Yandex%20image.%0A%09%093%3A%20%22data%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABgklEQVQ4jYWSu05%22%20+%0A%09%09%09%22CQRCGp6EzUcMTUCsWnuzudBBiwmmJVBoKciwpqCAxVpLoOxhaGp4ACioNJSR0SrxQ8AIUnMbksxHYoyiTTLL%22%20+%0A%09%09%09%22Zmf+by67IDjPG3KgqK3fOvWSz2cNdOhERUdVYVcnlcvgQVcUYc/mv2Dn3HoYh1WoVgEajQbfbZbFYMBwOUVX%22%20+%0A%09%09%09%22+7CQIgpSqEoYhrVYLgFqtRqFQIJ/P++M8bwVYa6/8dqfTKe12m8lkAoC1dh1LCBFJIRL10+lBdHSEU6VSqaw%22%20+%0A%09%09%09%227KJfL9Ho9ZrPZbwAiH4jw0z/7fZxzjMdjAIwxAEkAIvFatL8PT08JyP3ZGQClUolischoNEJVsdZeCyI3iaq%22%20+%0A%09%09%09%22PjxDHvzo5DQKazSbGGIwxqOpyVT2ZDHB+Dg8Pifvo+Njf/qs/+yaxXoe7uw3Ii/XT6YG1NgqCIPVz88nqvoW%22%20+%0A%09%09%09%22hD4m2vjkiz4hAJgPz+UawtwfLpQ9I/QU4RARub+HkJLmPTmd1ftsq9iAX2/7At8f/ij3IwXqcjV/v0n0BaMZ%22%20+%0A%09%09%09%224bK7uRiAAAAAASUVORK5CYII%3D%22%2C%0A%09%7D%2C%0A%09_UID%3A%20%22__multi_translator_%22%20+%20self.id.slice%2820%29%2C%0A%09URLBarEngines%3A%20null%2C%0A%09PanelEngines%3A%20null%2C%0A%09globalMM%3A%20Cc%5B%22@mozilla.org/globalmessagemanager%3B1%22%5D.getService%28Ci.nsIMessageListenerManager%29%2C%0A%09TIMEOUT%3A%2010000%2C%0A%09_globalMM%3A%20Cc%5B%22@mozilla.org/globalmessagemanager%3B1%22%5D.getService%28Ci.nsIMessageListenerManager%29%2C%0A%09_nsIFile%3A%20Components.Constructor%28%22@mozilla.org/file/local%3B1%22%2C%20%22nsIFile%22%2C%20%22initWithPath%22%29%2C%0A%09_randomID%3A%20null%2C%0A%09_frameScript%3A%20null%2C%0A%09isOKToCreateElements%3A%20null%2C%0A%09isOSX%3A%20Services.appinfo.OS.toLowerCase%28%29.startsWith%28%22darwin%22%29%2C%0A%09accel%3A%20function%28aE%29%20%7B%0A%09%09if%20%28aE%29%0A%09%09%09return%20%24.isOSX%20%3F%20aE.metaKey%20%3A%20aE.ctrlKey%3B%0A%09%09return%20%24.isOSX%20%3F%20%22Command%22%20%3A%20%22Control%22%3B%0A%09%7D%2C%0A%09get%20transPanel%28%29%20%7B%0A%09%09return%20document.getElementById%28%24._UID%20+%20%22_translationPanel%22%29%3B%0A%09%7D%2C%0A%09get%20urlBarIcon%28%29%20%7B%0A%09%09return%20document.getElementById%28%24._UID%20+%20%22_translationIconOnURLBar%22%29%3B%0A%09%7D%2C%0A%09get%20dummyPanel%28%29%20%7B%0A%09%09return%20document.getElementById%28%24._UID%20+%20%22_translationPanelDummy%22%29%3B%0A%09%7D%2C%0A%09get%20_responseMsgID%28%29%20%7B%0A%09%09return%20%22CB%3AMultiTranslator%3AResponse%3A%22%20+%20self.id.slice%2814%29%20+%20%22-%22%20+%20%24._randomID%3B%0A%09%7D%2C%0A%09get%20_onReleaseIconMsgID%28%29%20%7B%0A%09%09return%20%22CB%3AMultiTranslator%3ATranslateOnReleaseIcon%3A%22%20+%20self.id.slice%2814%29%20+%20%22-%22%20+%20%24._randomID%3B%0A%09%7D%2C%0A%09get%20_cleanupMsgID%28%29%20%7B%0A%09%09return%20%22CB%3AMultiTranslator%3ACleanup%3A%22%20+%20self.id.slice%2814%29%20+%20%22-%22%20+%20%24._randomID%3B%0A%09%7D%2C%0A%09get%20_translateSelMsgID%28%29%20%7B%0A%09%09return%20%22CB%3AMultiTranslator%3ATranslateSelection%3A%22%20+%20self.id.slice%2814%29%20+%20%22-%22%20+%20%24._randomID%3B%0A%09%7D%2C%0A%09get%20_movePopupMsgID%28%29%20%7B%0A%09%09return%20%22CB%3AMultiTranslator%3AMovePopup%3A%22%20+%20self.id.slice%2814%29%20+%20%22-%22%20+%20%24._randomID%3B%0A%09%7D%2C%0A%09get%20_isMultiProcess%28%29%20%7B%0A%09%09let%20a%20%3D%20%22gMultiProcessBrowser%22%20in%20window%3B%0A%09%09return%20a%20%3F%20gMultiProcessBrowser%20%3A%20false%3B%0A%09%7D%2C%0A%09get%20storagePath%28%29%20%7B%0A%09%09let%20d%20%3D%20OS.Path.join%28OS.Constants.Path.profileDir%2C%20%22custombuttons%22%2C%20%22MultiTranslator%22%29%3B%0A%09%09OS.File.makeDir%28d%2C%20%7B%0A%09%09%09ignoreExisting%3A%20true%0A%09%09%7D%29%3B%0A%09%09return%20d%3B%0A%09%7D%2C%0A%09get%20_mm%28%29%20%7B%0A%09%09let%20mm%20%3D%20null%3B%0A%09%09try%20%7B%0A%09%09%09mm%20%3D%20typeof%20gBrowser%20%3D%3D%3D%20%22object%22%20%3F%0A%09%09%09%09gBrowser.selectedTab.linkedBrowser.messageManager%20%3A%20//%20Everything%20else.%0A%09%09%09%09getBrowser%28%29.messageManager%3B%20//%20Thunderbird.%20%25%24/%26%24%25%20you%21%21%21%21%0A%09%09%7D%20catch%20%28aErr%29%20%7B%7D%0A%09%09return%20mm%3B%0A%09%7D%2C%0A%7D%3B%0A%0Athis.MultiTranslator.Branch%20%3D%20%22CB.MultiTranslator.Id%22%20+%20self.id.slice%2820%29%20+%20%22.%22%3B%0A%0Athis.MultiTranslator.gPref%20%3D%20function%28aKey%29%20%7B%0A%09let%20branch%20%3D%20Services.prefs.getBranch%28%24.Branch%29%3B%0A%09switch%20%28typeof%20%24.DefPrefs%5BaKey%5D%29%20%7B%0A%09%09case%20%22boolean%22%3A%0A%09%09%09return%20branch.getBoolPref%28aKey%29%3B%0A%09%09case%20%22number%22%3A%0A%09%09%09return%20branch.getIntPref%28aKey%29%3B%0A%09%09case%20%22string%22%3A%0A%09%09%09return%20branch.getComplexValue%28aKey%2C%20Ci.nsISupportsString%29.data%3B%0A%09%7D%0A%09return%20null%3B%0A%7D%3B%0A%0Athis.MultiTranslator.sPref%20%3D%20function%28aKey%2C%20aVal%29%20%7B%0A%09let%20branch%20%3D%20Services.prefs.getBranch%28%24.Branch%29%3B%0A%09switch%20%28typeof%20aVal%29%20%7B%0A%09%09case%20%22boolean%22%3A%0A%09%09%09branch.setBoolPref%28aKey%2C%20aVal%29%3B%0A%09%09%09break%3B%0A%09%09case%20%22number%22%3A%0A%09%09%09branch.setIntPref%28aKey%2C%20aVal%29%3B%0A%09%09%09break%3B%0A%09%09case%20%22string%22%3A%0A%09%09%09let%20str%20%3D%20Cc%5B%22@mozilla.org/supports-string%3B1%22%5D.createInstance%28Ci.nsISupportsString%29%3B%0A%09%09%09str.data%20%3D%20aVal%3B%0A%09%09%09branch.setComplexValue%28%28aKey%29%2C%20Ci.nsISupportsString%2C%20str%29%3B%0A%09%09%09break%3B%0A%09%7D%0A%7D%3B%0A%0Athis.MultiTranslator.initPrefs%20%3D%20function%28%29%20%7B%0A%09let%20branch%20%3D%20Services.prefs.getDefaultBranch%28%24.Branch%29%2C%0A%09%09defaults%20%3D%20%24.DefPrefs%3B%0A%09for%20%28let%20key%20in%20defaults%29%20%7B%0A%09%09if%20%28defaults.hasOwnProperty%28key%29%29%20%7B%0A%09%09%09let%20val%20%3D%20defaults%5Bkey%5D%3B%0A%09%09%09switch%20%28typeof%20val%29%20%7B%0A%09%09%09%09case%20%22boolean%22%3A%0A%09%09%09%09%09branch.setBoolPref%28key%2C%20val%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%20%22number%22%3A%0A%09%09%09%09%09branch.setIntPref%28key%2C%20val%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%20%22string%22%3A%0A%09%09%09%09%09let%20str%20%3D%20Cc%5B%22@mozilla.org/supports-string%3B1%22%5D.createInstance%28Ci.nsISupportsString%29%3B%0A%09%09%09%09%09str.data%20%3D%20val%3B%0A%09%09%09%09%09branch.setComplexValue%28%28key%29%2C%20Ci.nsISupportsString%2C%20str%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%0A%7D%3B%0A%0Athis.MultiTranslator.langs%20%3D%20%7B%0A%09%22%22%3A%20%22Auto%22%2C%0A%09%22af%22%3A%20%22Afrikaans%20%28G%29%28Y%29%22%2C%0A%09%22sq%22%3A%20%22Albanian%20%28G%29%28Y%29%22%2C%0A%09%22am%22%3A%20%22Amharic%20%28G%29%22%2C%0A%09%22ar%22%3A%20%22Arabic%22%2C%0A%09%22hy%22%3A%20%22Armenian%20%28G%29%28Y%29%22%2C%0A%09%22az%22%3A%20%22Azerbaijani%20%28G%29%28Y%29%22%2C%0A%09%22eu%22%3A%20%22Basque%20%28G%29%22%2C%0A%09%22ba%22%3A%20%22Bashkir%20%28Y%29%22%2C%0A%09%22be%22%3A%20%22Belarusian%20%28G%29%28Y%29%22%2C%0A%09%22bn%22%3A%20%22Bengali%20%28G%29%28Y%29%22%2C%0A%09%22bs%22%3A%20%22Bosnian%20%28Y%29%22%2C%0A%09%22bs-Latn%22%3A%20%22Bosnian%20%28Latin%29%20%28B%29%22%2C%0A%09%22bg%22%3A%20%22Bulgarian%22%2C%0A%09%22ca%22%3A%20%22Catalan%22%2C%0A%09%22ceb%22%3A%20%22Cebuano%20%28G%29%22%2C%0A%09%22ny%22%3A%20%22Chichewa%20%28G%29%22%2C%0A%09%22zh%22%3A%20%22Chinese%20%28Y%29%22%2C%0A%09%22zh-CHS%22%3A%20%22Chinese%20Simplified%20%28B%29%22%2C%0A%09%22zh-CN%22%3A%20%22Chinese%20%28G%29%22%2C%0A%09%22zh-CHT%22%3A%20%22Chinese%20Traditional%20%28B%29%22%2C%0A%09%22co%22%3A%20%22Corsican%20%28G%29%22%2C%0A%09%22hr%22%3A%20%22Croatian%22%2C%0A%09%22cs%22%3A%20%22Czech%22%2C%0A%09%22da%22%3A%20%22Danish%22%2C%0A%09%22nl%22%3A%20%22Dutch%22%2C%0A%09%22en%22%3A%20%22English%22%2C%0A%09%22eo%22%3A%20%22Esperanto%20%28G%29%22%2C%0A%09%22et%22%3A%20%22Estonian%22%2C%0A%09%22tl%22%3A%20%22Filipino%20%28G%29%28Y%29%22%2C%0A%09%22fi%22%3A%20%22Finnish%22%2C%0A%09%22fr%22%3A%20%22French%22%2C%0A%09%22fy%22%3A%20%22Frisian%20%28G%29%22%2C%0A%09%22gl%22%3A%20%22Galician%20%28G%29%28Y%29%22%2C%0A%09%22ka%22%3A%20%22Georgian%20%28G%29%28Y%29%22%2C%0A%09%22de%22%3A%20%22German%22%2C%0A%09%22el%22%3A%20%22Greek%22%2C%0A%09%22gu%22%3A%20%22Gujarati%20%28G%29%28Y%29%22%2C%0A%09%22ht%22%3A%20%22Haitian%20Creole%22%2C%0A%09%22ha%22%3A%20%22Hausa%20%28G%29%22%2C%0A%09%22haw%22%3A%20%22Hawaiian%20%28G%29%22%2C%0A%09%22he%22%3A%20%22Hebrew%20%28B%29%28Y%29%22%2C%0A%09%22iw%22%3A%20%22Hebrew%20%28G%29%22%2C%0A%09%22hi%22%3A%20%22Hindi%22%2C%0A%09%22hmn%22%3A%20%22Hmong%20%28G%29%22%2C%0A%09%22mww%22%3A%20%22Hmong%20Daw%20%28B%29%22%2C%0A%09%22hu%22%3A%20%22Hungarian%22%2C%0A%09%22is%22%3A%20%22Icelandic%20%28G%29%28Y%29%22%2C%0A%09%22ig%22%3A%20%22Igbo%20%28G%29%22%2C%0A%09%22id%22%3A%20%22Indonesian%22%2C%0A%09%22ga%22%3A%20%22Irish%20%28G%29%28Y%29%22%2C%0A%09%22it%22%3A%20%22Italian%22%2C%0A%09%22ja%22%3A%20%22Japanese%22%2C%0A%09%22jw%22%3A%20%22Javanese%20%28G%29%22%2C%0A%09%22kn%22%3A%20%22Kannada%20%28G%29%28Y%29%22%2C%0A%09%22kk%22%3A%20%22Kazakh%20%28G%29%28Y%29%22%2C%0A%09%22km%22%3A%20%22Khmer%20%28G%29%22%2C%0A%09%22ky%22%3A%20%22Kirghiz%20%28Y%29%20or%20Kyrgyz%20%28G%29%22%2C%0A%09%22tlh%22%3A%20%22Klingon%20%28B%29%22%2C%0A%09%22tlh-Qaak%22%3A%20%22Klingon%20%28pIqaD%29%20%28B%29%22%2C%0A%09%22ko%22%3A%20%22Korean%22%2C%0A%09%22ku%22%3A%20%22Kurdish%20%28Kurmanji%29%20%28G%29%22%2C%0A%09%22lo%22%3A%20%22Lao%20%28G%29%22%2C%0A%09%22la%22%3A%20%22Latin%20%28G%29%28Y%29%22%2C%0A%09%22lv%22%3A%20%22Latvian%22%2C%0A%09%22lt%22%3A%20%22Lithuanian%22%2C%0A%09%22lb%22%3A%20%22Luxembourgish%20%28G%29%22%2C%0A%09%22mk%22%3A%20%22Macedonian%20%28G%29%28Y%29%22%2C%0A%09%22mg%22%3A%20%22Malagasy%20%28G%29%28Y%29%22%2C%0A%09%22ms%22%3A%20%22Malay%22%2C%0A%09%22ml%22%3A%20%22Malayalam%20%28G%29%22%2C%0A%09%22mt%22%3A%20%22Maltese%22%2C%0A%09%22mi%22%3A%20%22Maori%20%28G%29%22%2C%0A%09%22mr%22%3A%20%22Marathi%20%28G%29%22%2C%0A%09%22mn%22%3A%20%22Mongolian%22%2C%0A%09%22my%22%3A%20%22Myanmar%20%28Burmese%29%20%28G%29%22%2C%0A%09%22ne%22%3A%20%22Nepali%20%28G%29%22%2C%0A%09%22no%22%3A%20%22Norwegian%22%2C%0A%09%22ps%22%3A%20%22Pashto%20%28G%29%22%2C%0A%09%22fa%22%3A%20%22Persian%22%2C%0A%09%22pl%22%3A%20%22Polish%22%2C%0A%09%22pt%22%3A%20%22Portuguese%22%2C%0A%09%22pa%22%3A%20%22Punjabi%20%28G%29%28Y%29%22%2C%0A%09%22otq%22%3A%20%22Quer%E9taro%20Otomi%20%28B%29%22%2C%0A%09%22ro%22%3A%20%22Romanian%22%2C%0A%09%22ru%22%3A%20%22Russian%22%2C%0A%09%22sm%22%3A%20%22Samoan%20%28G%29%22%2C%0A%09%22gd%22%3A%20%22Scots%20Gaelic%20%28G%29%22%2C%0A%09%22sr-Cyrl%22%3A%20%22Serbian%20%28Cyrillic%29%20%28B%29%22%2C%0A%09%22sr-Latn%22%3A%20%22Serbian%20%28Latin%29%20%28B%29%22%2C%0A%09%22sr%22%3A%20%22Serbian%20%28G%29%28Y%29%22%2C%0A%09%22st%22%3A%20%22Sesotho%20%28G%29%22%2C%0A%09%22sn%22%3A%20%22Shona%20%28G%29%22%2C%0A%09%22sd%22%3A%20%22Sindhi%20%28G%29%22%2C%0A%09%22si%22%3A%20%22Sinhalese%20%28Y%29%20or%20Sinhala%20%28G%29%22%2C%0A%09%22sk%22%3A%20%22Slovak%22%2C%0A%09%22sl%22%3A%20%22Slovenian%22%2C%0A%09%22so%22%3A%20%22Somali%20%28G%29%22%2C%0A%09%22es%22%3A%20%22Spanish%22%2C%0A%09%22su%22%3A%20%22Sundanese%20%28G%29%22%2C%0A%09%22sw%22%3A%20%22Swahili%20or%20Kiswahili%22%2C%0A%09%22sv%22%3A%20%22Swedish%22%2C%0A%09%22tg%22%3A%20%22Tajik%20%28G%29%28Y%29%22%2C%0A%09%22ta%22%3A%20%22Tamil%20%28G%29%28Y%29%22%2C%0A%09%22tt%22%3A%20%22Tatar%20%28Y%29%22%2C%0A%09%22te%22%3A%20%22Telugu%20%28G%29%22%2C%0A%09%22th%22%3A%20%22Thai%22%2C%0A%09%22tr%22%3A%20%22Turkish%22%2C%0A%09%22udm%22%3A%20%22Udmurt%22%2C%0A%09%22uk%22%3A%20%22Ukrainian%22%2C%0A%09%22ur%22%3A%20%22Urdu%22%2C%0A%09%22uz%22%3A%20%22Uzbek%22%2C%0A%09%22vi%22%3A%20%22Vietnamese%22%2C%0A%09%22cy%22%3A%20%22Welsh%22%2C%0A%09%22xh%22%3A%20%22Xhosa%20%28G%29%22%2C%0A%09%22yi%22%3A%20%22Yiddish%20%28G%29%22%2C%0A%09%22yo%22%3A%20%22Yoruba%20%28G%29%22%2C%0A%09%22yua%22%3A%20%22Yucatec%20Maya%20%28B%29%22%2C%0A%09%22zu%22%3A%20%22Zulu%20%28G%29%22%2C%0A%7D%3B%0A%0Athis.MultiTranslator.DefPrefs%20%3D%20%7B%0A%09pAPIKeysBing%3A%20JSON.stringify%28%5B%0A%09%09%5B%22TradutorInstantaneo%22%2C%20%22D36qcBNDopLmUz2cYpAgPZ0ZPezQEs79QeTp88gZ4hc%3D%22%5D%2C%0A%09%09%5B%22ngochuong-bing-translator%22%2C%20%22vIOFDe2FdSy4c0BTdYoPvHhwWIPoRFBo5ryuhOjxo84%3D%22%5D%2C%0A%09%09%5B%22webtranslator8601%22%2C%20%2238tnkL0LkSI5DjHq3mhFU0f7DKsm1/rizwEmMylZxtc%3D%22%5D%2C%0A%09%09%5B%22SublimeBingTranslator%22%2C%20%220fjvxMgcSZreEk9xPN8Vse+KDz3XlI+W11XJxC8peEA%3D%22%5D%2C%0A%09%09%5B%22bing_translator_test_xuemind%22%2C%20%22taiwTXXvLKe/UzpXXK6X6gxkpac5GpOdKOb69gYWMgk%3D%22%5D%2C%0A%09%09%5B%22Subtitles%22%2C%20%22Xv2Oae6Vki4CnYcSF1SxSSBtO1x4rX47zhLUE/OqVds%3D%22%5D%2C%0A%09%09%5B%223a7a26d9254FFC08%22%2C%20%22SuNwPHKH6UbvhyZ34FlqOWJ9z2zN6KS8djzHpf8NvOI%3D%22%5D%2C%0A%09%5D%29%2C%0A%09pAPIKeysYandex%3A%20JSON.stringify%28%5B%0A%09%09%22trnsl.1.1.20130818T214524Z.9983e6055ae94787.74d98f42e84f8abac4a19cb1333dfecb7427165d%22%2C%0A%09%09%22trnsl.1.1.20130806T140102Z.d80a7ce00b1a3c38.30de98386f6f6d594993fa93c0907aac5996aab9%22%2C%0A%09%09%22trnsl.1.1.20140602T085017Z.ea6ecac642816084.4df3b3711b35ed773720c92acdcebb11e793b8ab%22%2C%0A%09%09%22trnsl.1.1.20140911T223045Z.34ca44edca3e6ebd.f6807b1158e50190a2ae10c40d8a31a426647e98%22%2C%0A%09%09%22trnsl.1.1.20140731T144606Z.639639bc480e82b7.7cb97a33d3b2e88fa363e789fe03e2426478c53a%22%2C%0A%09%09%22trnsl.1.1.20141206T164332Z.8497d97d7ca05dc2.411e9116711b1860da655ffba56840469a3b2af1%22%2C%0A%09%09%22trnsl.1.1.20140218T130206Z.7923fc89a1c1bd16.aba4c3d98792c68c157c59f5a385339a03f0d736%22%2C%0A%09%09%22trnsl.1.1.20140213T084832Z.2e599cd43e74002d.d935bc98da1909103ec212bc9ce71adeaac9de4a%22%2C%0A%09%5D%29%2C%0A%09pHotkeyTransPage%3A%20%22Ctrl+Alt+p%22%2C%0A%09pHotkeyTransSel%3A%20%22Ctrl+Alt+t%22%2C%0A%09pHotkeyTransClip%3A%20%22Ctrl+Alt+v%22%2C%0A%09pPanelMaxStringLength%3A%201024%2C%0A%09pPanelTransMaxWidth%3A%20450%2C%0A%09pPanelTransShowFooter%3A%20true%2C%0A%09pTransOnReleaseIconOffsetX%3A%2010%2C%0A%09pTransOnReleaseIconOffsetY%3A%2010%2C%0A%09pLanguagesShowHidden%3A%20true%2C%0A%09pLanguagesBlacklist%3A%20%22%22%2C%0A%09pButtonClickActionLeft%3A%201%2C%0A%09pButtonClickActionMiddle%3A%202%2C%0A%09pButtonClickActionLeftCtrl%3A%203%2C%0A%09pButtonClickActionLeftShift%3A%204%2C%0A%09pButtonClickActionLeftCtrlShift%3A%205%2C%0A%09pPageTransURLBarIconLeftClick%3A%202%2C%0A%09pPageTransURLBarIconMiddleClick%3A%201%2C%0A%09pPageTransURLBarIconMenuMode%3A%20true%2C%0A%09pPageTransURLBarIconShow%3A%20true%2C%0A%09pPageTransEngine%3A%202%2C%0A%09pPageTransFromLang%3A%20%22%22%2C%0A%09pPageTransToLang%3A%20%22en%22%2C%0A%09pPanelTransKeepItOpen%3A%20false%2C%0A%09pPanelTransAutoCloseOnClick%3A%20false%2C%0A%09pPanelTransAutoCopyOnClick%3A%20false%2C%0A%09pPanelTransAnchorToSelection%3A%20true%2C%0A%09pPanelTransShowTitleBar%3A%20true%2C%0A%09pPanelTransFailSafe%3A%20false%2C%0A%09pPanelTransFailSafeOpenURLWhere%3A%201%2C%0A%09pPanelTransEngine%3A%202%2C%0A%09pPanelTransFromLang%3A%20%22%22%2C%0A%09pPanelTransToLang%3A%20%22en%22%2C%0A%09pPanelTransUseTextbox%3A%20true%2C%0A%09pPanelTransShowOptionsBox%3A%20true%2C%0A%09pShowTransSelCtx%3A%20true%2C%0A%09pShowTransClipCtx%3A%20true%2C%0A%09pShowTransPageCtx%3A%20true%2C%0A%09pShowTransPageCtxMenuMode%3A%20true%2C%0A%09pTransOnRelease%3A%20true%2C%0A%09pTransOnReleaseAltKey%3A%20false%2C%0A%09pTransOnReleaseControlKey%3A%20false%2C%0A%09pTransOnReleaseShiftKey%3A%20false%2C%0A%09pTransOnReleaseShowIcon%3A%20true%2C%0A%09pHotkeyTransPageEnabled%3A%20false%2C%0A%09pHotkeyTransSelEnabled%3A%20false%2C%0A%09pHotkeyTransClipEnabled%3A%20false%2C%0A%09pShowCustomPanelEngines%3A%20false%2C%0A%09pShowCustomURLBarEngines%3A%20false%2C%0A%09pXULStyleSheetEnabled%3A%20true%2C%0A%09pHTMLStyleSheetEnabled%3A%20true%2C%0A%09pXULStyleSheet%3A%20%22%252F*%2520Translation%2520panel%2520tweaks%2520*%252F%250A%252F*%2520Image%2520for%2520the%2520close%2520panel%2520button%2520*%252F%250A%2523%2525U_I_D%2525_translationClosePanelButton%2520%257B%250A%2509list-style-image%253A%2520url%28%2522data%253Aimage%252Fpng%253Bbase64%252CiVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs%252B9AAAAiklEQVQYlW3Pxw1CQQxF0bNChBbIsCP2XwQ5CBBQAKEFWDCDLPheeew71n18aoKm%252F2phmB9TPLFCOUBVbHHPcAsbvLBEB70wW6CRf1fC4oRL6uco%252Ffp0cU7AC3u0C7z1cQ3goQisYRcuHYPfN2A7QLMUroN1CNiAMR4JiuLlFPCGQR6OUC%252FwbmboDUj8J0R5GOzSAAAAAElFTkSuQmCC%2522%29%2520%21important%253B%250A%2509-moz-image-region%253A%2520auto%2520%21important%253B%250A%257D%250A%252F*%2520Panel%2520main%2520box%2520*%252F%250A%2523%2525U_I_D%2525_translationPanelMainBox%2520%257B%250A%2509padding%253A%25208px%25200%25208px%25200%2520%21important%253B%250A%257D%250A%252F*%2520Result%2520box%252C%2520footer%2520box%2520and%2520options%2520box%2520*%252F%250A%2523%2525U_I_D%2525_translationResultBox%252C%250A%252F*%2523%2525U_I_D%2525_translationResultFooterBox%252C*%252F%250A%2523%2525U_I_D%2525_translationOptionsBox%2520%257B%250A%2509%252F*padding%253A%25208px%25200%25208px%25200%2520%21important%253B*%252F%250A%257D%250A%252F*%2520Panel%2520resizers%2520*%252F%250A%2523%2525U_I_D%2525_translationPanel%2520resizer%2520%257B%250A%2509-moz-appearance%253A%2520none%2520%21important%253B%250A%2509background-image%253A%2520none%2520%21important%253B%250A%257D%250A%252F*%2520Translation%2520result%2520content%2520*%252F%250A%2523%2525U_I_D%2525_translationResultContent%2520%257B%250A%2509font-weight%253A%2520600%2520%21important%253B%250A%257D%250A%252F*%2520Translation%2520result%2520content%2520as%2520textbox%2520*%252F%250A%2523%2525U_I_D%2525_translationResultContent.as_textbox%2520%257B%250A%2509%252F*padding%253A%25202px%2520%21important%253B*%252F%250A%257D%250A%252F*%2520Translation%2520result%2520content%2520NOT%2520as%2520textbox%2520*%252F%250A%2523%2525U_I_D%2525_translationResultContent.not_as_textbox%2520%257B%250A%2509%252F*padding%253A%25205px%2520%21important%253B*%252F%250A%257D%250A%252F*%2520Buttons%2520inside%2520the%2520panel%2520*%252F%250A%2523%2525U_I_D%2525_languageSelectionButtonFrom%252C%250A%2523%2525U_I_D%2525_languageSelectionButtonTo%252C%250A%2523%2525U_I_D%2525_translationOptionsButton%2520%257B%250A%2509%252F*-moz-appearance%253A%2520none%2520%21important%253B*%252F%250A%257D%250A%252F*%2520Force%2520options%2520button%2520image%2520to%252016%2520pixels%2520*%252F%250A%2523%2525U_I_D%2525_translationOptionsButton%2520.toolbarbutton-icon%2520%257B%250A%2509max-height%253A%252016px%2520%21important%253B%250A%2509max-width%253A%2520100%2525%2520%21important%253B%250A%257D%250A%252F*%2520Hide%2520arrowscrolls%2520and%2520show%2520toolbars%2520on%2520language%2520selection%2520menus%2520*%252F%250Amenupopup.%2525U_I_D%2525_lang_list%2520scrollbox%2520%257B%250A%2509overflow-y%253A%2520auto%2520%21important%250A%257D%250Amenupopup.%2525U_I_D%2525_lang_list%2520.autorepeatbutton-up%252C%250Amenupopup.%2525U_I_D%2525_lang_list%2520.autorepeatbutton-down%2520%257B%250A%2509display%253A%2520none%2520%21important%253B%250A%257D%250A%252F*%2520Basic%2520panel%2520appearance%2520for%2520the%2520page%2520translator%2520menu%2520and%2520Multi%2520Translator%2520main%2520menu%2520*%252F%250A%252F*%2520Compatible%2520with%2520all%2520Gecko%2520applications%2520*%252F%250A%2523%2525U_I_D%2525_self_popup%252C%250A%2523%2525U_I_D%2525_translationIconOnURLBarMenu%2520%257B%250A%2509-moz-appearance%253A%2520none%2520%21important%253B%250A%2509-moz-binding%253A%2520url%28%2522chrome%253A%252F%252Fglobal%252Fcontent%252Fbindings%252Fpopup.xml%2523arrowpanel%2522%29%2520%21important%253B%250A%2509background%253A%2520transparent%2520%21important%253B%250A%2509border%253A%2520none%2520%21important%253B%250A%2509-moz-image-region%253A%2520auto%2520%21important%253B%250A%257D%22%2C%0A%09pHTMLStyleSheet%3A%20%22%252F*%2520Tweaks%2520for%2520Google%2520Translator%2520pages%2520*%252F%250A%2540-moz-document%2520regexp%28%2522%255Ehttps%253F%253A%252F%252Ftranslate.google..*%2522%29%2520%257B%250A%2509%252F*%2520Remove%2520the%2520offer%2520to%2520install%2520that%2520aberration%2520called%2520Chrome%21%21%21%2520*%252F%250A%2509%2523gb%2520.gb_9c.gb_ec.gb_g%2520%257B%250A%2509%2509display%253A%2520none%2520%21important%253B%250A%2509%257D%250A%257D%250A%252F*%2520Removes%2520tooltips%2520showing%2520original%2520text%2520*%252F%250A%2540-moz-document%2520domain%28%2522translate.googleusercontent.com%2522%29%2520%257B%250A%2509span%255Bonmouseout%255D%255Bonmouseover%255D%255Bstyle%255D%2520%257B%250A%2509%2509background-color%253A%2520transparent%2520%21important%253B%250A%2509%257D%250A%2509.gmnoprint%2520%257B%250A%2509%2509display%253A%2520none%2520%21important%253B%250A%2509%257D%250A%257D%250A%250A%252F*%2520Tweaks%2520for%2520Microsoft%2520translator%2520pages%2520*%252F%250A%252F*%2520Remove%2520tooltips%2520showing%2520original%2520text%2520*%252F%250ADIV%255Btranslate%253D%2522no%2522%255D%2520%257B%250A%2509display%253A%2520none%2520%21important%253B%250A%257D%22%2C%0A%7D%3B%0A%0Athis.MultiTranslator.init%28%29%3B%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5B/*CODE*/%5D%5D%3E%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%uD835%uDDDC%uD835%uDDFA%uD835%uDDFD%uD835%uDDFC%uD835%uDDFF%uD835%uDE01%uD835%uDDEE%uD835%uDDFB%uD835%uDE01%20%uD835%uDDFB%uD835%uDDFC%uD835%uDE01%uD835%uDDF2%uD835%uDE00%0A%u26AB%20%uD835%uDDD7%uD835%uDDE2%20%uD835%uDDE1%uD835%uDDE2%uD835%uDDE7%20%uD835%uDDF6%uD835%uDDFB%uD835%uDE00%uD835%uDE01%uD835%uDDEE%uD835%uDDF9%uD835%uDDF9%20%uD835%uDDFA%uD835%uDDFC%uD835%uDDFF%uD835%uDDF2%20%uD835%uDE01%uD835%uDDF5%uD835%uDDEE%uD835%uDDFB%20%uD835%uDDFC%uD835%uDDFB%uD835%uDDF2%20%uD835%uDE03%uD835%uDDF2%uD835%uDDFF%uD835%uDE00%uD835%uDDF6%uD835%uDDFC%uD835%uDDFB%20%uD835%uDDFC%uD835%uDDF3%20%uD835%uDE01%uD835%uDDF5%uD835%uDDF6%uD835%uDE00%20%uD835%uDDEF%uD835%uDE02%uD835%uDE01%uD835%uDE01%uD835%uDDFC%uD835%uDDFB%20%uD835%uDDEE%uD835%uDE01%20%uD835%uDE01%uD835%uDDF5%uD835%uDDF2%20%uD835%uDE00%uD835%uDDEE%uD835%uDDFA%uD835%uDDF2%20%uD835%uDE01%uD835%uDDF6%uD835%uDDFA%uD835%uDDF2%u2757%u2757%u2757%0A%u26AB%20%uD835%uDDD7%uD835%uDDE2%20%uD835%uDDE1%uD835%uDDE2%uD835%uDDE7%20%uD835%uDDF0%uD835%uDDF9%uD835%uDDFC%uD835%uDDFB%uD835%uDDF2%20%uD835%uDE01%uD835%uDDF5%uD835%uDDF6%uD835%uDE00%20%uD835%uDDEF%uD835%uDE02%uD835%uDE01%uD835%uDE01%uD835%uDDFC%uD835%uDDFB%u2757%u2757%u2757%0A%u26AB%20If%20you%20did%20any%20of%20the%20previous%20actions%2C%20delete%20all%20extra%20buttons%20leaving%20only%20one%20version%20of%20%uD835%uDDE0%uD835%uDE02%uD835%uDDF9%uD835%uDE01%uD835%uDDF6%20%uD835%uDDE7%uD835%uDDFF%uD835%uDDEE%uD835%uDDFB%uD835%uDE00%uD835%uDDF9%uD835%uDDEE%uD835%uDE01%uD835%uDDFC%uD835%uDDFF%20and%20restart%20your%20application.%0A%0A%5B%2C%5D%0A%0A/**%0A%20*%20%uD835%uDDD9%uD835%uDDE5%uD835%uDDE2%uD835%uDDE0%20%uD835%uDDDB%uD835%uDDD8%uD835%uDDE5%uD835%uDDD8%20%uD835%uDDD7%uD835%uDDE2%uD835%uDDEA%uD835%uDDE1%20%uD835%uDDD7%uD835%uDDE2%20%uD835%uDDE1%uD835%uDDE2%uD835%uDDE7%20%uD835%uDDE7%uD835%uDDE2%uD835%uDDE8%uD835%uDDD6%uD835%uDDDB%20%uD835%uDDD4%uD835%uDDE1%uD835%uDDEC%uD835%uDDE7%uD835%uDDDB%uD835%uDDDC%uD835%uDDE1%uD835%uDDDA%0A%20*/%0A%0A%26lt%3B%21--%25FrameScript%25--%26gt%3B%0A%28function%28aContext%29%20%7B%0A%09var%20Ci%20%3D%20Components.interfaces%3B%0A%09var%20Cu%20%3D%20Components.utils%3B%0A%0A%09let%20MultiTranslator%20%3D%20%7B%0A%09%09init%3A%20function%28%29%20%7B%0A%09%09%09aContext.addMessageListener%28%22%25Translate_Sel_ID%25%22%2C%20this%29%3B%0A%09%09%09aContext.addMessageListener%28%22%25On_Release_Icon_ID%25%22%2C%20this%29%3B%0A%09%09%09aContext.addMessageListener%28%22%25Move_Popup_ID%25%22%2C%20this%29%3B%0A%09%09%09aContext.addMessageListener%28%22%25Cleanup_ID%25%22%2C%20this%29%3B%0A%09%09%7D%2C%0A%0A%09%09unInit%3A%20function%28%29%20%7B%0A%09%09%09aContext.removeMessageListener%28%22%25Translate_Sel_ID%25%22%2C%20this%29%3B%0A%09%09%09aContext.removeMessageListener%28%22%25On_Release_Icon_ID%25%22%2C%20this%29%3B%0A%09%09%09aContext.removeMessageListener%28%22%25Move_Popup_ID%25%22%2C%20this%29%3B%0A%09%09%09aContext.removeMessageListener%28%22%25Cleanup_ID%25%22%2C%20this%29%3B%0A%09%09%7D%2C%0A%0A%09%09receiveMessage%3A%20function%28aMsg%29%20%7B%0A%09%09%09switch%20%28aMsg.name%29%20%7B%0A%09%09%09%09case%20%22%25Translate_Sel_ID%25%22%3A%0A%09%09%09%09%09this._getSelection%28true%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%20%22%25On_Release_Icon_ID%25%22%3A%0A%09%09%09%09%09if%20%28%21aMsg.data%29%0A%09%09%09%09%09%09return%3B%0A%09%09%09%09%09this._onReleaseIcon%28aMsg.data%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%20%22%25Move_Popup_ID%25%22%3A%0A%09%09%09%09%09if%20%28%21aMsg.data%29%0A%09%09%09%09%09%09return%3B%0A%09%09%09%09%09this._movePopup%28aMsg.data%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%20%22%25Cleanup_ID%25%22%3A%0A%09%09%09%09%09this.unInit%28%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%7D%2C%0A%0A%09%09_getSelection%3A%20function%28aDirectTrans%29%20%7B%0A%09%09%09let%20fWin%20%3D%20%7B%7D%3B%0A%09%09%09let%20fEl%20%3D%20Services.focus.getFocusedElementForWindow%28content.window%2C%20true%2C%20fWin%29%3B%0A%09%09%09fWin%20%3D%20fWin.value%3B%0A%09%09%09let%20selStr%20%3D%20fWin.getSelection%28%29.toString%28%29%3B%0A%09%09%09if%20%28%21selStr%20%26amp%3B%26amp%3B%20fEl%20instanceof%20Ci.nsIDOMNSEditableElement%29%20%7B%0A%09%09%09%09if%20%28fEl%20instanceof%20Ci.nsIDOMHTMLTextAreaElement%20%7C%7C%0A%09%09%09%09%09%28fEl%20instanceof%20Ci.nsIDOMHTMLInputElement%20%26amp%3B%26amp%3B%0A%09%09%09%09%09%09fEl.mozIsTextField%28true%29%29%29%20%7B%0A%09%09%09%09%09selStr%20%3D%20fEl.editor.selection.toString%28%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%09if%20%28aDirectTrans%29%20%7B%0A%09%09%09%09if%20%28selStr%20%21%3D%3D%20%22%22%29%20%7B%0A%09%09%09%09%09sendAsyncMessage%28%22%25Response_ID%25%22%2C%20%7B%0A%09%09%09%09%09%09id%3A%201%2C%0A%09%09%09%09%09%09sel%3A%20selStr%2C%0A%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%20else%0A%09%09%09%09return%20selStr%3B%0A%09%09%7D%2C%0A%0A%09%09_onReleaseIcon%3A%20function%28aData%29%20%7B%0A%09%09%09var%20doc%20%3D%20content.document%3B%0A%09%09%09var%20sel%20%3D%20this._getSelection%28%29%3B%0A%09%09%09if%20%28%21sel%20%7C%7C%20sel%20%3D%3D%3D%20%22%22%29%0A%09%09%09%09return%20true%3B%0A%0A%09%09%09if%20%28doc%20instanceof%20Ci.nsIDOMXULDocument%29%20%7B%0A%09%09%09%09sendAsyncMessage%28%22%25Response_ID%25%22%2C%20%7B%0A%09%09%09%09%09id%3A%202%2C%20//%20ID%202%20is%20the%20%22mouseover%22%20event%20to%20trigger%20the%20popup%20from%20the%20%22on%20realese%22%20icon.%0A%09%09%09%09%09sel%3A%20sel%2C%0A%09%09%09%09%7D%29%3B%0A%09%09%09%09return%20true%3B%0A%09%09%09%7D%0A%09%09%09var%20body%20%3D%20this.%24%24%28%22body%22%2C%20doc%29%5B0%5D%3B%0A%09%09%09if%20%28%21body%29%0A%09%09%09%09return%20true%3B%0A%0A%09%09%09var%20div%20%3D%20this.%24%28aData._UID%20+%20%22onReleaseDiv%22%2C%20doc%29%3B%0A%09%09%09if%20%28div%29%0A%09%09%09%09div.parentNode.removeChild%28div%29%3B%0A%0A%09%09%09var%20imgLookup%20%3D%20this.%24C%28%22img%22%2C%20%7B%0A%09%09%09%09border%3A%200%2C%0A%09%09%09%09src%3A%20aData.image%2C%0A%09%09%09%7D%2C%20doc%29%3B%0A%09%09%09div%20%3D%20this.%24C%28%22div%22%2C%20%7B%0A%09%09%09%09id%3A%20aData._UID%20+%20%22onReleaseDiv%22%2C%0A%09%09%09%09style%3A%20%22background-color%3Atransparent%3B%20color%3A%23000000%3B%20position%3Aabsolute%3B%20top%3A%22%20+%0A%09%09%09%09%09%28aData.clientY%20+%20content.window.pageYOffset%20+%20aData.iconOffsetY%29%20+%20%22px%3B%20left%3A%22%20+%0A%09%09%09%09%09%28aData.clientX%20+%20content.window.pageXOffset%20+%20aData.iconOffsetX%29%20+%0A%09%09%09%09%09%22px%3B%20padding%3A0px%3B%20z-index%3A10000%3B%20border-radius%3A2px%3B%22%2C%0A%09%09%09%7D%2C%20doc%29%3B%0A%09%09%09div.appendChild%28imgLookup.cloneNode%28false%29%29%3B%0A%09%09%09let%20mOListener%20%3D%20function%28aE%29%20%7B%0A%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%09sendAsyncMessage%28%22%25Response_ID%25%22%2C%20%7B%0A%09%09%09%09%09id%3A%202%2C%20//%20ID%202%20is%20the%20%22mouseover%22%20event%20to%20trigger%20the%20popup%20from%20the%20%22on%20realese%22%20icon.%0A%09%09%09%09%09sel%3A%20sel%2C%0A%09%09%09%09%7D%29%3B%0A%09%09%09%09if%20%28div%29%0A%09%09%09%09%09div.parentNode.removeChild%28div%29%3B%0A%09%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%09%7D%3B%0A%09%09%09let%20mDListener%20%3D%20function%20_%28aE%29%20%7B%0A%09%09%09%09this.removeEventListener%28%22mousedown%22%2C%20mDListener%2C%20false%29%3B%0A%09%09%09%09if%20%28div%20%26amp%3B%26amp%3B%20div.parentNode%29%0A%09%09%09%09%09div.parentNode.removeChild%28div%29%3B%0A%09%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%09%7D%3B%0A%09%09%09div.addEventListener%28%22mouseover%22%2C%20mOListener%2C%20false%29%3B%0A%09%09%09doc.addEventListener%28%22mousedown%22%2C%20mDListener%2C%20false%29%3B%0A%09%09%09body.appendChild%28div%29%3B%0A%09%09%7D%2C%0A%0A%09%09_movePopup%3A%20function%28aData%29%20%7B%0A%09%09%09let%20fWin%20%3D%20content.window%3B%0A%09%09%09fWin.focus%28%29%3B%0A%09%09%09let%20rect%3B%0A%09%09%09try%20%7B%0A%09%09%09%09rect%20%3D%20fWin.getSelection%28%29.getRangeAt%280%29.getBoundingClientRect%28%29%3B%0A%09%09%09%7D%20catch%20%28aErr%29%20%7B%0A%09%09%09%09rect%20%3D%20false%3B%0A%09%09%09%7D%0A%09%09%09let%20posX%20%3D%20fWin.mozInnerScreenX%20+%20%28rect%20%3F%20rect.left%20%3A%20fWin.innerWidth%20/%202%29%3B%0A%09%09%09let%20posY%20%3D%20fWin.mozInnerScreenY%20+%20%28rect%20%3F%20rect.bottom%20%3A%20fWin.innerHeight%20/%202%29%20+%203%3B%0A%09%09%09let%20deltaX%20%3D%20posX%20-%20aData.width%3B%0A%09%09%09if%20%28deltaX%20%26gt%3B%200%29%0A%09%09%09%09posX%20-%3D%20deltaX%3B%0A%09%09%09let%20deltaY%20%3D%20posY%20-%20aData.height%3B%0A%09%09%09if%20%28deltaY%20%26gt%3B%200%29%0A%09%09%09%09posY%20-%3D%20deltaY%3B%0A%09%09%09let%20div%20%3D%20this.%24%28aData._UID%20+%20%22onReleaseDiv%22%2C%20content.document%29%3B%0A%09%09%09try%20%7B%0A%09%09%09%09sendAsyncMessage%28%22%25Response_ID%25%22%2C%20%7B%0A%09%09%09%09%09id%3A%203%2C%20//%20ID%203%20is%20the%20popup%20positioning%20coordinates.%0A%09%09%09%09%09posX%3A%20posX%2C%0A%09%09%09%09%09posY%3A%20posY%2C%0A%09%09%09%09%7D%29%3B%0A%09%09%09%7D%20finally%20%7B%0A%09%09%09%09div%20%26amp%3B%26amp%3B%20div.parentNode.removeChild%28div%29%3B%0A%09%09%09%7D%0A%09%09%7D%2C%0A%0A%09%09%24C%3A%20function%28aElName%2C%20aAttrs%2C%20aParent%29%20%7B%0A%09%09%09var%20doc%20%3D%20aParent%20%3F%20aParent%20%3A%20document%3B%0A%09%09%09var%20el%20%3D%20doc.createElement%28aElName%29%3B%0A%09%09%09if%20%28aAttrs%29%0A%09%09%09%09Object.keys%28aAttrs%29.forEach%28function%28n%29%20%7B%0A%09%09%09%09%09if%20%28aAttrs%5Bn%5D%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09%09el.setAttribute%28n%2C%20aAttrs%5Bn%5D%29%0A%09%09%09%09%7D%29%3B%0A%09%09%09return%20el%3B%0A%09%09%7D%2C%0A%0A%09%09%24%3A%20function%28aID%2C%20aParent%29%20%7B%0A%09%09%09if%20%28%21aParent%29%0A%09%09%09%09return%20document.getElementById%28aID%29%3B%0A%09%09%09return%20aParent.getElementById%28aID%29%3B%0A%09%09%7D%2C%0A%0A%09%09%24%24%3A%20function%28aTagName%2C%20aParent%29%20%7B%0A%09%09%09if%20%28%21aParent%29%0A%09%09%09%09return%20document.getElementsByTagName%28aTagName%29%3B%0A%09%09%09return%20aParent.getElementsByTagName%28aTagName%29%3B%0A%09%09%7D%2C%0A%09%7D%3B%0A%09MultiTranslator.init%28%29%3B%0A%7D%29%28this%29%3B%0A%26lt%3B%21--%25FrameScript%25--%26gt%3B%0A%0A%0A%26lt%3B%21--%25OptionsWindow%25--%26gt%3B%26lt%3B%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%26gt%3B%0A%26lt%3B%3Fxml-stylesheet%20href%3D%22chrome%3A//global/skin/%22%20%3F%26gt%3B%0A%26lt%3B%3Fxml-stylesheet%20href%3D%22data%3Atext/css%3Bcharset%3Dutf-8%2C%0Aprefwindow%20*%20%7B%0A%09font-family%3A%20%26amp%3Bquot%3BOpen%20Sans%26amp%3Bquot%3B%2C%20Helvetica%2C%20Arial%2C%20sans-serif%20%21important%3B%0A%7D%0Abutton%20%7B%0A%09min-width%3A%200%20%20%21important%3B%0A%7D%0Acaption%20.caption-text%2C%0A.bold_text%20%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%7D%0A/*%20Force%20groupboxes%20on%20Linux%20to%20have%20the%20same%20appearance%20than%20in%20Windows%20*/%0A/*%20Just%20because%20it%20makes%20effing%20sence%21%21%21%21%20*/%0A/*%20Why%20have%20elements%20grouped%20inside%20a%20groupbox%20and%20not%20visually%20delimited%3F%21%3F%21%3F%21%20*/%0Agroupbox%20%7B%0A%09-moz-appearance%3A%20groupbox%20%21important%3B%0A%09border%3A%202px%20groove%20ThreeDFace%20%21important%3B%0A%09border-radius%3A%203px%20%21important%3B%0A%09margin%3A%203px%20%21important%3B%0A%09padding%3A%203px%203px%206px%20%21important%3B%0A%7D%0A.groupbox-body%20%7B%0A%09padding%3A%20inherit%20%21important%3B%0A%7D%0Acaption%20%7B%0A%09margin%3A%200%206px%20%21important%3B%0A%09background-color%3A%20-moz-Dialog%20%21important%3B%0A%7D%0Atabpanels%20caption%20%7B%0A%09-moz-appearance%3A%20tabpanel%20%21important%3B%0A%7D%0A/*%20%21important%20is%20needed%20to%20override%20label%20in%20global.css%20*/%0A.caption-text%20%7B%0A%09margin%3A%200%202px%20%21important%3B%0A%7D%0Adialogheader%20%7B%0A%09font-size%3A%20x-small%20%21important%3B%0A%09font-weight%3A%20600%20%21important%3B%0A%09margin%3A%200%200%207px%200%20%21important%3B%0A%09padding%3A%202px%200%202px%205px%20%21important%3B%0A%09border%3A%20none%20%21important%3B%0A%7D%0Atab%5Bselected%3D%26amp%3Bquot%3Btrue%26amp%3Bquot%3B%5D%20%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%7D%0A%22%20type%3D%22text/css%22%20%3F%26gt%3B%0A%26lt%3Bprefwindow%20id%3D%22%25U_I_D%25_settings_window%22%0A%09%09%09%20xmlns%3Ahtml%3D%22http%3A//www.w3.org/1999/xhtml%22%0A%09%09%09%20xmlns%3D%22http%3A//www.mozilla.org/keymaster/gatekeeper/there.is.only.xul%22%0A%09%09%09%20onload%3D%22%24.onLoad%28%29%3B%22%0A%09%09%09%20onunload%3D%22%24.onUnload%28%29%3B%22%0A%09%09%09%20buttons%3D%22accept%2Ccancel%2Cextra1%2Cextra2%22%0A%09%09%09%20buttonlabelextra1%3D%22Apply%22%0A%09%09%09%20buttonlabeldisclosure%3D%22%22%0A%09%09%09%20ondialogextra1%3D%22%24.onApply%28%29%3B%22%0A%09%09%09%20buttonlabelextra2%3D%22Settings%22%0A%09%09%09%20ondialogdisclosure%3D%22close%28%29%3B%24.openHelpPage%28event%29%3B%22%0A%09%09%09%20title%3D%22Multi%20Translator%20settings%22%26gt%3B%0A%09%09%09%09%26lt%3Bscript%26gt%3B%0A%09%09%26lt%3B%21%5BCDATA%5B%0Avar%20Cc%20%3D%20Components.classes%3B%0Avar%20Ci%20%3D%20Components.interfaces%3B%0Avar%20Cu%20%3D%20Components.utils%3B%0ACu.import%28%22resource%3A//gre/modules/Services.jsm%22%29%3B%0Avar%20storage%20%3D%20window._storage%3B%0Avar%20cb_btn%20%3D%20storage.button%3B%0A%0Afunction%20%24id%28aId%29%20%7B%0A%09return%20document.getElementById%28aId%29%3B%0A%7D%0A%0Avar%20%24%20%3D%20%7B%0A%09_initialized%3A%20false%2C%0A%09onLoad%3A%20function%28%29%20%7B%0A%09%09%24._initialized%20%3D%20true%3B%0A%09%09var%20docElt%20%3D%20document.documentElement%3B%0A%09%09%24.instantApply%20%3D%20docElt.instantApply%3B%0A%09%09window.addEventListener%28%22change%22%2C%20%24%2C%20false%29%3B%0A%09%09docElt.getButton%28%22extra1%22%29.setAttribute%28%22icon%22%2C%20%22apply%22%29%3B%0A%09%09docElt.getButton%28%22extra2%22%29.setAttribute%28%22popup%22%2C%20%22multi-translator-preferences%22%29%3B%0A%09%09docElt.setAttribute%28%22cancelbuttonlabel%22%2C%20docElt.mStrBundle.GetStringFromName%28%22button-cancel%22%29%29%3B%0A%09%09%24.setHotKey%28%29%3B%0A%09%09%24.initMenulists%28%29%3B%0A%09%09%24.dealWithStyleSheets%28false%29%3B%0A%09%09%24.setButtons%28true%29%3B%0A%09%7D%2C%0A%09handleEvent%3A%20function%28aE%29%20%7B%0A%09%09switch%20%28aE.type%29%20%7B%0A%09%09%09case%20%22change%22%3A%0A%09%09%09%09if%20%28aE.target.localName%20%21%3D%20%22preference%22%29%0A%09%09%09%09%09return%3B%0A%09%09%09%09if%20%28%21%24.instantApply%29%0A%09%09%09%09%09%24.updateApplyButton%28aE%29%3B%0A%09%09%09%09break%3B%0A%09%09%7D%0A%09%7D%2C%0A%09changes%3A%20%5B%5D%2C%0A%09updateApplyButton%3A%20function%28aE%29%20%7B%0A%09%09var%20item%20%3D%20aE.target%3B%0A%09%09if%20%28item.localName%20%21%3D%20%22preference%22%29%0A%09%09%09return%3B%0A%09%09var%20valueChanged%20%3D%20item.value%20%21%3D%20item.valueFromPreferences%3B%0A%09%09var%20index%20%3D%20%24.changes.indexOf%28item%29%3B%0A%09%09if%20%28valueChanged%20%26amp%3B%26amp%3B%20index%20%3D%3D%20-1%29%0A%09%09%09%24.changes.push%28item%29%3B%0A%09%09else%20if%20%28%21valueChanged%20%26amp%3B%26amp%3B%20index%20%26gt%3B%20-1%29%0A%09%09%09%24.changes.splice%28index%2C%201%29%3B%0A%09%09%24.setButtons%28%21%24.changes.length%29%3B%0A%09%7D%2C%0A%09onApply%3A%20function%28%29%20%7B%0A%09%09%24.dealWithStyleSheets%28true%29%3B%0A%09%09%24.setButtons%28true%29%3B%0A%09%09while%20%28%24.changes.length%29%20%7B%0A%09%09%09var%20preference%20%3D%20%24.changes.shift%28%29%3B%0A%09%09%09preference.batching%20%3D%20true%3B%0A%09%09%09preference.valueFromPreferences%20%3D%20preference.value%3B%0A%09%09%09preference.batching%20%3D%20false%3B%0A%09%09%7D%0A%09%09cb_btn.MultiTranslator.selfDestroy%28%29%3B%0A%09%7D%2C%0A%09setButtons%3A%20function%28aDisable%29%20%7B%0A%09%09var%20docElt%20%3D%20document.documentElement%3B%0A%09%09//%20when%20in%20instantApply%20mode%20apply%20and%20accept%20buttons%20are%20hidden%20except%20when%20user%0A%09%09//%20change%20min/max%20width%20value%0A%09%09var%20applyButton%20%3D%20docElt.getButton%28%22extra1%22%29%3B%0A%09%09applyButton.disabled%20%3D%20aDisable%3B%0A%09%09applyButton.hidden%20%3D%20%24.instantApply%20%26amp%3B%26amp%3B%20aDisable%3B%0A%09%09docElt.getButton%28%22accept%22%29.hidden%20%3D%20aDisable%3B%0A%0A%09%09var%20action%20%3D%20aDisable%20%3F%20%22close%22%20%3A%20%22cancel%22%3B%0A%09%09var%20cancelButton%20%3D%20docElt.getButton%28%22cancel%22%29%3B%0A%09%09cancelButton.label%20%3D%20docElt.getAttribute%28action%20+%20%22buttonlabel%22%29%3B%0A%09%09cancelButton.setAttribute%28%22icon%22%2C%20action%29%3B%0A%09%7D%2C%0A%09setDisabled%3A%20function%28aItemOrId%2C%20aVal%29%20%7B%0A%09%09var%20item%20%3D%20typeof%28aItemOrId%29%20%3D%3D%20%22string%22%20%3F%20%24id%28aItemOrId%29%20%3A%20aItemOrId%3B%0A%09%09if%20%28%21item%29%0A%09%09%09return%3B%0A%09%09if%20%28item.hasAttribute%28%22inverseDependency%22%29%29%0A%09%09%09aVal%20%3D%20%21aVal%3B%0A%09%09//%20remove%20disabled%20when%20the%20value%20is%20false%0A%09%09%24.setItem%28item%2C%20%22disabled%22%2C%20aVal%20%7C%7C%20null%29%3B%0A%09%7D%2C%0A%09setItem%3A%20function%28aItemOrId%2C%20aAttr%2C%20aVal%29%20%7B%0A%09%09var%20el%20%3D%20typeof%28aItemOrId%29%20%3D%3D%20%22string%22%20%3F%20document.getElementById%28aItemOrId%29%20%3A%20aItemOrId%3B%0A%09%09if%20%28el%29%20%7B%0A%09%09%09if%20%28aVal%20%3D%3D%3D%20null%20%7C%7C%20aVal%20%3D%3D%3D%20undefined%29%20%7B%0A%09%09%09%09el.removeAttribute%28aAttr%29%3B%0A%09%09%09%09return%3B%0A%09%09%09%7D%0A%09%09%09if%20%28typeof%28aVal%29%20%3D%3D%20%22boolean%22%29%0A%09%09%09%09aVal%20%3D%20aVal%20%3F%20%22true%22%20%3A%20%22false%22%3B%0A%0A%09%09%09if%20%28%21el.hasAttribute%28aAttr%29%20%7C%7C%20el.getAttribute%28aAttr%29%20%21%3D%20aVal%29%0A%09%09%09%09el.setAttribute%28aAttr%2C%20aVal%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09onUnload%3A%20function%28%29%20%7B%0A%09%09window.removeEventListener%28%22change%22%2C%20%24%2C%20false%29%3B%0A%09%09cb_btn.MultiTranslator.selfDestroy%28%29%3B%0A%09%09%24.dealWithStyleSheets%28true%29%3B%0A%09%7D%2C%0A%09dealWithStyleSheets%3A%20function%28aSave%29%20%7B%0A%09%09%5B%22textbox_pXULStyleSheet%22%2C%20%22textbox_pHTMLStyleSheet%22%5D.forEach%28function%28aID%29%20%7B%0A%09%09%09if%20%28aSave%29%0A%09%09%09%09cb_btn.MultiTranslator.sPref%28aID.slice%288%29%2C%20encodeURIComponent%28%24id%28aID%29.value%29%29%3B%0A%09%09%09else%0A%09%09%09%09%24id%28aID%29.setAttribute%28%22value%22%2C%20decodeURIComponent%28cb_btn.MultiTranslator.gPref%28aID.slice%288%29%29%29%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%09initMenulists%3A%20function%28%29%20%7B%0A%09%09var%20actionMPop%20%3D%20%24id%28%22click-on-button-action-primary-menulist%22%29.firstChild%2C%0A%09%09%09whereTOPPMPop%20%3D%20%20%24id%28%22where-to-open-page-primary-menulist%22%29.firstChild%3B%0A%09%09var%20actionSMLists%20%3D%20document.getElementsByClassName%28%22click-on-button-action-secondary-menulist%22%29%2C%0A%09%09%09whereTOPSMList%20%3D%20document.getElementsByClassName%28%22where-to-open-page-secondary-menulist%22%29%3B%0A%09%09for%20%28var%20a%20%3D%20actionSMLists.length%20-%201%3B%20a%20%26gt%3B%3D%200%3B%20a--%29%20%7B%0A%09%09%09actionSMLists%5Ba%5D.appendChild%28actionMPop.cloneNode%28true%29%29%3B%0A%09%09%09%24.setMenulistsCheckedState%28actionSMLists%5Ba%5D%29%3B%0A%09%09%7D%0A%09%09for%20%28var%20b%20%3D%20whereTOPSMList.length%20-%201%3B%20b%20%26gt%3B%3D%200%3B%20b--%29%20%7B%0A%09%09%09whereTOPSMList%5Bb%5D.appendChild%28whereTOPPMPop.cloneNode%28true%29%29%3B%0A%09%09%09%24.setMenulistsCheckedState%28whereTOPSMList%5Bb%5D%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09setMenulistsCheckedState%3A%20function%28aMList%29%20%7B%0A%09%09let%20prefID%20%3D%20aMList.getAttribute%28%22preference%22%29%3B%0A%09%09let%20val%20%3D%20%24id%28prefID%29.value%3B%0A%09%09if%20%28val%20%21%3D%3D%20-1%29%0A%09%09%09aMList.selectedIndex%20%3D%20val%3B%0A%09%7D%2C%0A%09setHotKey%3A%20function%28aE%29%20%7B%20//%20Taken%20from%20Custom%20Buttons%20add-on.%20I%20%u2665%20CB%21%21%21%0A%09%09let%20hki%20%3D%20document.getElementsByClassName%28%22hotkey_capturer%22%29%3B%0A%09%09let%20onInput%20%3D%20function%28aE%29%20%7B%0A%09%09%09this.value%20%3D%20%22%22%3B%0A%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%7D%3B%0A%09%09let%20onKeypress%20%3D%20function%28aE%29%20%7B%0A%09%09%09var%20that%20%3D%20this%3B%0A%09%09%09var%20cbd%20%3D%20Cc%5B%22@xsms.nm.ru/custombuttons/cbkeymap%3B1%22%5D.getService%28Ci.cbIKeyMapService%29%3B%0A%09%09%09var%20key%20%3D%20cbd.getKey%28aE%29%3B%0A%09%09%09if%20%28key%20%3D%3D%20%22ESCAPE%22%29%20%7B%0A%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%09if%20%28this.value%20%21%3D%3D%20%22%22%29%20%7B%0A%09%09%09%09%09this.bExtendedMode%20%3D%20false%3B%0A%09%09%09%09%09this.value%20%3D%20%22%22%3B%0A%09%09%09%09%09return%3B%0A%09%09%09%09%7D%0A%09%09%09%09if%20%28%21this.bExtendedMode%29%20%7B%0A%09%09%09%09%09this.bExtendedMode%20%3D%20true%3B%0A%09%09%09%09%09return%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%09if%20%28key%20%3D%3D%20%22TAB%22%29%20%7B%0A%09%09%09%09if%20%28%21this.bExtendedMode%29%0A%09%09%09%09%09return%3B%0A%09%09%09%09this.bExtendedMode%20%3D%20false%3B%0A%09%09%09%09if%20%28this.value%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09return%3B%0A%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%7D%0A%09%09%09this.bExtendedMode%20%3D%20false%3B%0A%09%09%09var%20prefix%20%3D%20cbd.getKeyPrefix%28aE%29%3B%0A%09%09%09this.value%20%3D%20%22%22%3B%0A%09%09%09let%20tBH%20%3D%20%24id%28this.getAttribute%28%22hotkey_box%22%29%20+%20%22_hotkey_box%22%29%3B%0A%09%09%09tBH.value%20%3D%20prefix%20+%20key%3B%0A%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%09//%20The%20next%20crap%20is%20for%20the%20stupid%20window%20to%20register%20the%20preference%20change.%20%AC%AC%0A%09%09%09tBH.focus%28%29%3B%0A%09%09%09var%20wU%20%3D%20window.QueryInterface%28Ci.nsIInterfaceRequestor%29%0A%09%09%09%09.getInterface%28Ci.nsIDOMWindowUtils%29%3B%0A%09%09%09wU.sendKeyEvent%28%22keypress%22%2C%2035%2C%200%2C%20null%2C%20null%29%3B%0A%09%09%09wU.sendKeyEvent%28%22keyup%22%2C%2035%2C%200%2C%20null%2C%20null%29%3B%0A%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09//%20Send%20Spacebar%20key.%20%AC%AC%0A%09%09%09%09//%20keydown%20does%20not%20always%20work.%20%AC%AC%0A%09%09%09%09wU.sendKeyEvent%28%22keypress%22%2C%200%2C%2032%2C%20null%2C%20null%29%3B%0A%09%09%09%09wU.sendKeyEvent%28%22keyup%22%2C%200%2C%2032%2C%20null%2C%20null%29%3B%0A%09%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09%09that.focus%28%29%3B%0A%09%09%09%09%7D%2C%20100%29%3B%0A%09%09%09%7D%2C%20100%29%3B%0A%09%09%7D%3B%0A%09%09Array.prototype.slice.call%28hki%29.forEach%28function%28aEl%29%20%7B%0A%09%09%09aEl.addEventListener%28%22input%22%2C%20onInput%2C%20false%29%3B%0A%09%09%09aEl.addEventListener%28%22keypress%22%2C%20onKeypress%2C%20false%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%09editAPIKeys%3A%20function%20%20%28aPref%29%20%7B%0A%09%09window.close%28%29%3B%0A%09%09cb_btn.MultiTranslator.editAPIKeys%28aPref%29%3B%0A%09%7D%0A%7D%3B%0A%5D%5D%26gt%3B%26lt%3B/script%26gt%3B%0A%09%26lt%3Bprefpane%20id%3D%22%25U_I_D%25_PrefPane%22%20flex%3D%221%22%26gt%3B%0A%09%09%26lt%3Bpreferences%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pShowTransSelCtx%22%20name%3D%22%25B_R_A_N_C_H%25pShowTransSelCtx%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pShowTransClipCtx%22%20name%3D%22%25B_R_A_N_C_H%25pShowTransClipCtx%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pShowTransPageCtx%22%20name%3D%22%25B_R_A_N_C_H%25pShowTransPageCtx%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pShowTransPageCtxMenuMode%22%20name%3D%22%25B_R_A_N_C_H%25pShowTransPageCtxMenuMode%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHotkeyTransPageEnabled%22%20name%3D%22%25B_R_A_N_C_H%25pHotkeyTransPageEnabled%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHotkeyTransSelEnabled%22%20name%3D%22%25B_R_A_N_C_H%25pHotkeyTransSelEnabled%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHotkeyTransClipEnabled%22%20name%3D%22%25B_R_A_N_C_H%25pHotkeyTransClipEnabled%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHotkeyTransPage%22%20name%3D%22%25B_R_A_N_C_H%25pHotkeyTransPage%22%20type%3D%22string%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHotkeyTransSel%22%20name%3D%22%25B_R_A_N_C_H%25pHotkeyTransSel%22%20type%3D%22string%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHotkeyTransClip%22%20name%3D%22%25B_R_A_N_C_H%25pHotkeyTransClip%22%20type%3D%22string%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pButtonClickActionLeft%22%20name%3D%22%25B_R_A_N_C_H%25pButtonClickActionLeft%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pButtonClickActionMiddle%22%20name%3D%22%25B_R_A_N_C_H%25pButtonClickActionMiddle%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pButtonClickActionLeftCtrl%22%20name%3D%22%25B_R_A_N_C_H%25pButtonClickActionLeftCtrl%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pButtonClickActionLeftShift%22%20name%3D%22%25B_R_A_N_C_H%25pButtonClickActionLeftShift%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pButtonClickActionLeftCtrlShift%22%20name%3D%22%25B_R_A_N_C_H%25pButtonClickActionLeftCtrlShift%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransAnchorToSelection%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransAnchorToSelection%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransAutoCloseOnClick%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransAutoCloseOnClick%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransAutoCopyOnClick%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransAutoCopyOnClick%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransFailSafe%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransFailSafe%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransKeepItOpen%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransKeepItOpen%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransShowTitleBar%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransShowTitleBar%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pTransOnRelease%22%20name%3D%22%25B_R_A_N_C_H%25pTransOnRelease%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pTransOnReleaseControlKey%22%20name%3D%22%25B_R_A_N_C_H%25pTransOnReleaseControlKey%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pTransOnReleaseShiftKey%22%20name%3D%22%25B_R_A_N_C_H%25pTransOnReleaseShiftKey%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pTransOnReleaseAltKey%22%20name%3D%22%25B_R_A_N_C_H%25pTransOnReleaseAltKey%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pTransOnReleaseShowIcon%22%20name%3D%22%25B_R_A_N_C_H%25pTransOnReleaseShowIcon%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPageTransURLBarIconShow%22%20name%3D%22%25B_R_A_N_C_H%25pPageTransURLBarIconShow%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPageTransURLBarIconMenuMode%22%20name%3D%22%25B_R_A_N_C_H%25pPageTransURLBarIconMenuMode%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPageTransURLBarIconLeftClick%22%20name%3D%22%25B_R_A_N_C_H%25pPageTransURLBarIconLeftClick%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPageTransURLBarIconMiddleClick%22%20name%3D%22%25B_R_A_N_C_H%25pPageTransURLBarIconMiddleClick%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransShowFooter%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransShowFooter%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransShowOptionsBox%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransShowOptionsBox%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransFailSafeOpenURLWhere%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransFailSafeOpenURLWhere%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelMaxStringLength%22%20name%3D%22%25B_R_A_N_C_H%25pPanelMaxStringLength%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransMaxWidth%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransMaxWidth%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pTransOnReleaseIconOffsetX%22%20name%3D%22%25B_R_A_N_C_H%25pTransOnReleaseIconOffsetX%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pTransOnReleaseIconOffsetY%22%20name%3D%22%25B_R_A_N_C_H%25pTransOnReleaseIconOffsetY%22%20type%3D%22int%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pLanguagesShowHidden%22%20name%3D%22%25B_R_A_N_C_H%25pLanguagesShowHidden%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pShowCustomPanelEngines%22%20name%3D%22%25B_R_A_N_C_H%25pShowCustomPanelEngines%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pShowCustomURLBarEngines%22%20name%3D%22%25B_R_A_N_C_H%25pShowCustomURLBarEngines%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pPanelTransUseTextbox%22%20name%3D%22%25B_R_A_N_C_H%25pPanelTransUseTextbox%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pXULStyleSheetEnabled%22%20name%3D%22%25B_R_A_N_C_H%25pXULStyleSheetEnabled%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pXULStyleSheet%22%20name%3D%22%25B_R_A_N_C_H%25pXULStyleSheet%22%20type%3D%22string%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHTMLStyleSheetEnabled%22%20name%3D%22%25B_R_A_N_C_H%25pHTMLStyleSheetEnabled%22%20type%3D%22bool%22/%26gt%3B%0A%09%09%09%26lt%3Bpreference%20id%3D%22pHTMLStyleSheet%22%20name%3D%22%25B_R_A_N_C_H%25pHTMLStyleSheet%22%20type%3D%22string%22/%26gt%3B%0A%09%09%26lt%3B/preferences%26gt%3B%0A%09%09%26lt%3Btabbox%20persist%3D%22selectedIndex%22%20id%3D%22main_tabbox%22%20flex%3D%221%22%26gt%3B%0A%09%09%09%26lt%3Btabs%26gt%3B%0A%09%09%09%09%26lt%3Btab%20label%3D%22%20General%20%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Btab%20label%3D%22%20Panel%20Translator%20%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Btab%20label%3D%22%20Page%20Translator%20%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Btab%20label%3D%22%20XUL%20style%20sheet%20%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Btab%20label%3D%22%20HTML%20style%20sheet%20%22%20/%26gt%3B%0A%09%09%09%26lt%3B/tabs%26gt%3B%0A%09%09%09%26lt%3Btabpanels%20flex%3D%221%22%26gt%3B%0A%26lt%3Btabpanel%20flex%3D%221%22%26gt%3B%0A%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%26lt%3Bhbox%20flex%3D%221%22%26gt%3B%0A%09%09%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20hidden%20languages%22%20tooltip%3D%22tt_1%22%20preference%3D%22pLanguagesShowHidden%22/%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%20tooltip%3D%22tt_2%22%20%26gt%3B%0A%09%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20Page%20hotkey%22%20preference%3D%22pHotkeyTransPageEnabled%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20id%3D%22translate_page_hotkey_box%22%20flex%3D%221%22%20maxwidth%3D%22100%22%20preference%3D%22pHotkeyTransPage%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20tooltip%3D%22tt_2_bis%22%20hotkey_box%3D%22translate_page%22%20maxwidth%3D%2220%22%20flex%3D%220%22%20class%3D%22hotkey_capturer%22%20/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%20tooltip%3D%22tt_2%22%20%26gt%3B%0A%09%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20Sel.%20hotkey%22%20preference%3D%22pHotkeyTransSelEnabled%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20id%3D%22translate_selection_hotkey_box%22%20flex%3D%221%22%20maxwidth%3D%22100%22%20preference%3D%22pHotkeyTransSel%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20tooltip%3D%22tt_2_bis%22%20hotkey_box%3D%22translate_selection%22%20maxwidth%3D%2220%22%20flex%3D%220%22%20class%3D%22hotkey_capturer%22%20/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%20tooltip%3D%22tt_2%22%20%26gt%3B%0A%09%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20Clip.%20hotkey%22%20preference%3D%22pHotkeyTransClipEnabled%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20id%3D%22translate_clipboard_hotkey_box%22%20flex%3D%221%22%20maxwidth%3D%22100%22%20preference%3D%22pHotkeyTransClip%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20tooltip%3D%22tt_2_bis%22%20hotkey_box%3D%22translate_clipboard%22%20maxwidth%3D%2220%22%20flex%3D%220%22%20class%3D%22hotkey_capturer%22%20/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%26lt%3Bgroupbox%20orient%3D%22vertical%22%20flex%3D%221%22%20%26gt%3B%0A%09%09%09%09%26lt%3Bcaption%20label%3D%22Context%20menu%20items%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20trans.%20selection%22%20tooltip%3D%22tt_3%22%20preference%3D%22pShowTransSelCtx%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20trans.%20clip.%20content%22%20tooltip%3D%22tt_4%22%20preference%3D%22pShowTransClipCtx%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20trans.%20page%22%20tooltip%3D%22tt_5%22%20preference%3D%22pShowTransPageCtx%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20page%20menu%20mode%22%20tooltip%3D%22tt_6%22%20preference%3D%22pShowTransPageCtxMenuMode%22/%26gt%3B%0A%09%09%09%26lt%3B/groupbox%26gt%3B%0A%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3Bgroupbox%20orient%3D%22vertical%22%20tooltip%3D%22tt_7%22%20%26gt%3B%0A%09%09%09%26lt%3Bcaption%20label%3D%22Clicks%20action%20on%20Multi%20Translator%20button%22%20/%26gt%3B%0A%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%26lt%3Blabel%20value%3D%22Left%20click%3A%22%20class%3D%22bold_text%22/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bmenulist%20id%3D%22click-on-button-action-primary-menulist%22%20sizetopopup%3D%22always%22%20preference%3D%22pButtonClickActionLeft%22%26gt%3B%0A%09%09%09%09%09%26lt%3Bmenupopup%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Disabled.%22%20value%3D%220%22%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Open%20main%20menu.%22%20value%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Translate%20selection.%22%20value%3D%222%22%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Translate%20current%20page.%22%20value%3D%223%22%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Translate%20clipboard%20content.%22%20value%3D%224%22%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Open%20page%20translation%20menu.%22%20value%3D%225%22%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Open%20options%20window.%22%20value%3D%226%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3B/menupopup%26gt%3B%0A%09%09%09%09%26lt%3B/menulist%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%26lt%3Blabel%20value%3D%22Middle%20click%3A%22%20class%3D%22bold_text%22/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bmenulist%20class%3D%22click-on-button-action-secondary-menulist%22%20sizetopopup%3D%22always%22%20preference%3D%22pButtonClickActionMiddle%22%20/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%26lt%3Blabel%20value%3D%22%25A_C_C_E_L%25%20+%20Left%20click%3A%22%20class%3D%22bold_text%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bmenulist%20class%3D%22click-on-button-action-secondary-menulist%22%20sizetopopup%3D%22always%22%20preference%3D%22pButtonClickActionLeftCtrl%22%20/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%26lt%3Blabel%20value%3D%22Shift%20+%20Left%20click%3A%22%20class%3D%22bold_text%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bmenulist%20class%3D%22click-on-button-action-secondary-menulist%22%20sizetopopup%3D%22always%22%20preference%3D%22pButtonClickActionLeftShift%22%20/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%26lt%3Blabel%20value%3D%22%25A_C_C_E_L%25%20+%20Shift%20+%20Left%20click%3A%22%20class%3D%22bold_text%22%20%20/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bmenulist%20class%3D%22click-on-button-action-secondary-menulist%22%20sizetopopup%3D%22always%22%20preference%3D%22pButtonClickActionLeftCtrlShift%22%20/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3B/groupbox%26gt%3B%0A%09%26lt%3B/vbox%26gt%3B%0A%26lt%3B/tabpanel%26gt%3B%0A%26lt%3Btabpanel%20flex%3D%221%22%26gt%3B%0A%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Anchor%20panel%20to%20selection%22%20tooltip%3D%22tt_8%22%20preference%3D%22pPanelTransAnchorToSelection%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Auto%20close%20panel%20on%20click%22%20tooltip%3D%22tt_9%22%20preference%3D%22pPanelTransAutoCloseOnClick%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Auto%20copy%20on%20click%22%20tooltip%3D%22tt_10%22%20preference%3D%22pPanelTransAutoCopyOnClick%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Enable%20custom%20engines%22%20tooltip%3D%22tt_28%22%20preference%3D%22pShowCustomPanelEngines%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Keep%20panel%20open%22%20tooltip%3D%22tt_12%22%20preference%3D%22pPanelTransKeepItOpen%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20footer%20inside%20panel%22%20tooltip%3D%22tt_13%22%20preference%3D%22pPanelTransShowFooter%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20options%20box%22%20tooltip%3D%22tt_13%22%20preference%3D%22pPanelTransShowOptionsBox%22/%26gt%3B%0A%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20titlebar%22%20tooltip%3D%22tt_17%22%20preference%3D%22pPanelTransShowTitleBar%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Translate%20on%20release%22%20tooltip%3D%22tt_18%22%20preference%3D%22pTransOnRelease%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20on%20rel.%20-%20Req.%20%25A_C_C_E_L%25%22%20tooltip%3D%22tt_19%22%20preference%3D%22pTransOnReleaseControlKey%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20on%20rel.%20-%20Req.%20Shift%22%20tooltip%3D%22tt_35%22%20preference%3D%22pTransOnReleaseShiftKey%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20on%20rel.%20-%20Req.%20Alt%22%20tooltip%3D%22tt_20%22%20preference%3D%22pTransOnReleaseAltKey%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20on%20rel.%20-%20Show%20icon%22%20tooltip%3D%22tt_21%22%20preference%3D%22pTransOnReleaseShowIcon%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Trans.%20result%20as%20textbox%22%20tooltip%3D%22tt_31%22%20preference%3D%22pPanelTransUseTextbox%22/%26gt%3B%0A%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%26lt%3Bvbox%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%09%26lt%3Blabel%20value%3D%22Panel%20max.%20string%20length%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20maxwidth%3D%2250%22%20flex%3D%220%22%20tooltip%3D%22tt_14%22%20preference%3D%22pPanelMaxStringLength%22/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%09%26lt%3Blabel%20value%3D%22Panel%20max.%20width%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20maxwidth%3D%2250%22%20flex%3D%220%22%20tooltip%3D%22tt_15%22%20preference%3D%22pPanelTransMaxWidth%22/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%26lt%3Bvbox%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%09%26lt%3Blabel%20value%3D%22Trans.%20on%20rel.%20-%20Icon%20offset%20X%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20maxwidth%3D%2235%22%20flex%3D%220%22%20tooltip%3D%22tt_22%22%20preference%3D%22pTransOnReleaseIconOffsetX%22/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%09%26lt%3Blabel%20value%3D%22Trans.%20on%20rel.%20-%20Icon%20offset%20Y%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Btextbox%20maxwidth%3D%2235%22%20flex%3D%220%22%20tooltip%3D%22tt_23%22%20preference%3D%22pTransOnReleaseIconOffsetY%22/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%26lt%3Bcheckbox%20label%3D%22Fail%20safe%20translation%22%20tooltip%3D%22tt_11%22%20preference%3D%22pPanelTransFailSafe%22/%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%26lt%3Bmenulist%20id%3D%22where-to-open-page-primary-menulist%22%20sizetopopup%3D%22always%22%20tooltip%3D%22tt_24%22%20preference%3D%22pPanelTransFailSafeOpenURLWhere%22%26gt%3B%0A%09%09%09%09%26lt%3Bmenupopup%26gt%3B%0A%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Open%20in%20current%20tab.%22%20value%3D%220%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Open%20in%20new%20tab%20next%20to%20current%20one.%22%20value%3D%221%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Open%20in%20new%20tab%20in%20background.%22%20value%3D%222%22%20/%26gt%3B%0A%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22Open%20in%20new%20tab%20in%20foreground.%22%20value%3D%223%22%20/%26gt%3B%0A%09%09%09%09%26lt%3B/menupopup%26gt%3B%0A%09%09%09%26lt%3B/menulist%26gt%3B%0A%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3Bgroupbox%20orient%3D%22horizontal%22%20tooltip%3D%22tt_30%22%26gt%3B%0A%09%09%09%26lt%3Bcaption%20label%3D%22Manage%20API%20keys%22%20/%26gt%3B%0A%09%09%09%26lt%3Bbutton%20label%3D%22Manage%20Bing%20API%20keys%22%20image%3D%22%25B_I_N_G_I_M_G%25%22%20oncommand%3D%22%24.editAPIKeys%28%27pAPIKeysBing%27%29%3B%22/%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%26lt%3Bbutton%20label%3D%22Manage%20Yandex%20API%20keys%22%20image%3D%22%25Y_A_N_D_E_X_I_M_G%25%22%20oncommand%3D%22%24.editAPIKeys%28%27pAPIKeysYandex%27%29%3B%22/%26gt%3B%0A%09%09%26lt%3B/groupbox%26gt%3B%0A%09%26lt%3B/vbox%26gt%3B%0A%26lt%3B/tabpanel%26gt%3B%0A%26lt%3Btabpanel%20flex%3D%221%22%26gt%3B%0A%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%26lt%3Bvbox%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Enable%20custom%20engines%22%20tooltip%3D%22tt_29%22%20preference%3D%22pShowCustomURLBarEngines%22/%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Enable%20%26amp%3Bquot%3BMenu%20mode%26amp%3Bquot%3B%22%20tooltip%3D%22tt_25%22%20preference%3D%22pPageTransURLBarIconMenuMode%22/%26gt%3B%0A%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%26lt%3Bvbox%26gt%3B%0A%09%09%09%09%26lt%3Bcheckbox%20label%3D%22Show%20icon%20inside%20URL%20bar%22%20tooltip%3D%22tt_26%22%20preference%3D%22pPageTransURLBarIconShow%22/%26gt%3B%0A%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3Bgroupbox%20tooltip%3D%22tt_27%22%20orient%3D%22vertical%22%26gt%3B%0A%09%09%09%26lt%3Bcaption%20label%3D%22Clicks%20action%20on%20URL%20bar%20icon%22/%26gt%3B%0A%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%26lt%3Blabel%20value%3D%22Left%20click%3A%22%20class%3D%22bold_text%22/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bmenulist%20class%3D%22where-to-open-page-secondary-menulist%22%20sizetopopup%3D%22always%22%20preference%3D%22pPageTransURLBarIconLeftClick%22%20/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%26lt%3Blabel%20value%3D%22Middle%20click%3A%22%20class%3D%22bold_text%22/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%09%26lt%3Bmenulist%20class%3D%22where-to-open-page-secondary-menulist%22%20sizetopopup%3D%22always%22%20preference%3D%22pPageTransURLBarIconMiddleClick%22%20/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3B/groupbox%26gt%3B%0A%09%26lt%3B/vbox%26gt%3B%0A%26lt%3B/tabpanel%26gt%3B%0A%26lt%3Btabpanel%20flex%3D%221%22%26gt%3B%0A%09%26lt%3Bgroupbox%20flex%3D%221000%22%26gt%3B%0A%09%09%26lt%3Bcaption%26gt%3B%0A%09%09%09%26lt%3Bcheckbox%20label%3D%22Enable%20XUL%20style%20sheet%22%20tooltip%3D%22tt_32%22%20preference%3D%22pXULStyleSheetEnabled%22/%26gt%3B%0A%09%09%26lt%3B/caption%26gt%3B%0A%09%09%26lt%3Btextbox%20multiline%3D%22true%22%20wrap%3D%22off%22%20tooltip%3D%22tt_34%22%20newlines%3D%22pasteintact%22%20flex%3D%221000%22%20id%3D%22textbox_pXULStyleSheet%22%20/%26gt%3B%0A%09%26lt%3B/groupbox%26gt%3B%0A%26lt%3B/tabpanel%26gt%3B%0A%26lt%3Btabpanel%20flex%3D%221%22%26gt%3B%0A%09%26lt%3Bgroupbox%20flex%3D%221000%22%26gt%3B%0A%09%09%26lt%3Bcaption%26gt%3B%0A%09%09%09%26lt%3Bcheckbox%20label%3D%22Enable%20HTML%20style%20sheet%22%20tooltip%3D%22tt_33%22%20preference%3D%22pHTMLStyleSheetEnabled%22/%26gt%3B%0A%09%09%26lt%3B/caption%26gt%3B%0A%09%09%26lt%3Btextbox%20multiline%3D%22true%22%20wrap%3D%22off%22%20tooltip%3D%22tt_34%22%20newlines%3D%22pasteintact%22%20flex%3D%221000%22%20id%3D%22textbox_pHTMLStyleSheet%22%20/%26gt%3B%0A%09%26lt%3B/groupbox%26gt%3B%0A%26lt%3B/tabpanel%26gt%3B%0A%09%09%09%26lt%3B/tabpanels%26gt%3B%0A%09%09%26lt%3B/tabbox%26gt%3B%0A%09%26lt%3B/prefpane%26gt%3B%0A%09%26lt%3Bpopupset%26gt%3B%0A%09%09%26lt%3Bmenupopup%20id%3D%22multi-translator-preferences%22%20position%3D%22before_start%22%26gt%3B%0A%09%09%09%26lt%3Bdialogheader%20title%3D%22Preferences%22%20/%26gt%3B%0A%09%09%09%26lt%3Bmenuitem%20label%3D%22Restore%20Defaults%22%20oncommand%3D%22cb_btn.MultiTranslator.prefHandling.resetP%28%29%3B%22/%26gt%3B%0A%09%09%09%26lt%3Bmenuitem%20label%3D%22Import%20Multi%20Menu%20Preferences%22%20oncommand%3D%22cb_btn.MultiTranslator.prefHandling.importP%28%29%3B%22/%26gt%3B%0A%09%09%09%26lt%3Bmenuitem%20label%3D%22Export%20Multi%20Menu%20Preferences%22%20oncommand%3D%22cb_btn.MultiTranslator.prefHandling.exportP%28%29%3B%22/%26gt%3B%0A%09%09%26lt%3B/menupopup%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_1%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BDisplay%20hidden%20languages%20on%20the%20language%20selection%20menus.%20Hidden%20languages%20will%20appear%20striked%20out.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_2%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BEnable/Disable%20the%20use%20of%20a%20hotkey%20to%20perform%20this%20action.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_2_bis%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BCapture%20hotkey.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3B%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3B%26lt%3Bhtml%3Ab%26gt%3BInstructions%26lt%3B/html%3Ab%26gt%3B%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BJust%20place%20the%20mouse%20cursor%20inside%20this%20textbox%20and%20press%20the%20desired%20keyboard%20key%20combination.%20A%20valid%20hotkey%20will%20be%20created/generated%20inside%20the%20textbox%20to%20the%20left.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_3%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BShow%20%26lt%3Bhtml%3Aem%26gt%3BTranslate%20selection%26lt%3B/html%3Aem%26gt%3B%20item%20on%20the%20page%20context%20menu.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_4%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BShow%20%26lt%3Bhtml%3Aem%26gt%3BTranslate%20clipboard%20content%26lt%3B/html%3Aem%26gt%3B%20item%20on%20the%20page%20context%20menu.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_5%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BShow%20%26lt%3Bhtml%3Aem%26gt%3BTranslate%20page%26lt%3B/html%3Aem%26gt%3B%20item%20on%20the%20page%20context%20menu.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_6%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BShow%20%26lt%3Bhtml%3Aem%26gt%3BTranslate%20page%26lt%3B/html%3Aem%26gt%3B%20on%20the%20page%20context%20menu%20as%20a%20menu%20with%20all%20available%20translate%20engines.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_7%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BConfigure%20Multi%20Translator%20button%20click%20actions.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_8%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20panel%20with%20the%20translation%20will%20be%20displayed%20anchored%20to%20the%20selected%20text.%20If%20%26lt%3Bhtml%3Ab%26gt%3Bdisabled/unchecked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20popup%20will%20be%20displayed%20anchored%20to%20the%20top-left%20corner%20of%20the%20page%20content.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_9%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20panel%20will%20be%20closed%20when%20the%20translation%20result%20is%20clicked.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_10%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20translation%20result%20inside%20the%20panel%20will%20be%20copied%20to%20the%20clipboard%20when%20the%20text%20is%20clicked.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_11%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20and%20the%20selected%20text%20exceeds%20the%20max.%20length%20of%20characters%20allowed%20for%20the%20current%20translation%20engine%2C%20instead%20of%20showing%20the%20popup%20with%20the%20cut%20down%20text%20translated%2C%20it%20will%20translate%20the%20full%20length%20of%20the%20selection%20on%20a%20new%20tab.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_12%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20panel%20with%20the%20translation%20will%20only%20be%20closed%20when%20%26lt%3Bhtml%3Ab%26gt%3BAuto%20close%20panel%20on%20click%26lt%3B/html%3Ab%26gt%3B%20is%20enabled%20or%20when%20clicking%20the%20close%20button%20on%20the%20titlebar%20%28if%20%26lt%3Bhtml%3Ab%26gt%3BShow%20titlebar%26lt%3B/html%3Ab%26gt%3B%20is%20enabled%29.%20If%20%26lt%3Bhtml%3Ab%26gt%3Bdisabled/unchecked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20popup%20will%20close%20every%20time%20you%20click%20outside%20of%20it.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_13%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BShow%20%26lt%3Bhtml%3Ab%26gt%3BService%20provided%20by...%26lt%3B/html%3Ab%26gt%3B%20footer%20inside%20the%20popup%20translation.%20Clicking%20on%20it%20will%20open%20the%20translation%20service%20provider%20page.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_14%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BMaximum%20amount%20of%20characters%20to%20translate%20from%20the%20selected%20text%20%28Default%201024%20characters%29.%20Bing%20translator%20is%20cut%20down%20automatically%20to%20150%20characters%20and%20Yandex%20translator%20is%20cut%20down%20automatically%20to%20500%20characters.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_15%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BMax.%20width%20for%20the%20translation%20panel.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_17%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20panel%20with%20the%20translation%20will%20dispay%20a%20titlebar.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_18%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20panel%20with%20the%20translation%20will%20show%20up%20when%20you%20finish%20to%20select%20text%20and%20the%20mouse%20button%20is%20released.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_19%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BRequire%20the%20%26lt%3Bhtml%3Ab%26gt%3B%25A_C_C_E_L%25%26lt%3B/html%3Ab%26gt%3B%20key%20for%20triggering%20the%20translate%20on%20release%20action.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_20%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BRequire%20the%20%26lt%3Bhtml%3Ab%26gt%3BAlt%26lt%3B/html%3Ab%26gt%3B%20key%20for%20triggering%20the%20translate%20on%20release%20action.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_21%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20and%20%26lt%3Bhtml%3Ab%26gt%3BTranslate%20on%20release%26lt%3B/html%3Ab%26gt%3B%20is%20enabled%2C%20instead%20of%20directly%20displaying%20the%20panel%20with%20the%20translation%20%26lt%3Bhtml%3Aem%26gt%3Bon%20release%26lt%3B/html%3Aem%26gt%3B%2C%20it%20will%20show%20an%20icon.%20The%20panel%20with%20the%20translation%20will%20show%20up%20only%20when%20hovering%20over%20this%20icon.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_22%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BHorizontal%20offset%20with%20respect%20to%20the%20cursor%20in%20which%20the%20%26lt%3Bhtml%3Ab%26gt%3BTranslate%20on%20release%26lt%3B/html%3Ab%26gt%3B%20icon%20should%20appear.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_23%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BVertical%20offset%20with%20respect%20to%20the%20cursor%20in%20which%20the%20%26lt%3Bhtml%3Ab%26gt%3BTranslate%20on%20release%26lt%3B/html%3Ab%26gt%3B%20icon%20should%20appear.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_24%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BWhere%20to%20open%20the%20page%20if%20the%20option%20%26lt%3Bhtml%3Ab%26gt%3BFail%20safe%20translation%26lt%3B/html%3Ab%26gt%3B%20is%20enabled.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_25%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BWith%20this%20mode%20enabled%2C%20a%20left%20click%20on%20the%20URL%20bar%20icon%20will%20display%20a%20menu%20with%20all%20avaiable%20engines.%20Clicking%20on%20any%20menu%20item%20will%20directly%20translate%20the%20current%20page%20without%20the%20need%20to%20change%20the%20default%20engine.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BThe%20translated%20page%20will%20be%20opened%20obeying%20the%20preference%20%26lt%3Bhtml%3Ab%26gt%3BLeft%20click%26lt%3B/html%3Ab%26gt%3B%20of%20the%20%26lt%3Bhtml%3Ab%26gt%3BClicks%20action%20on%20URL%20bar%20icon%26lt%3B/html%3Ab%26gt%3B%20section.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_26%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BShow%20%26lt%3Bhtml%3Ab%26gt%3BPage%20translator%26lt%3B/html%3Ab%26gt%3B%20icon%20inside%20the%20URL%20bar.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_27%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BWhere%20to%20open%20the%20translated%20page.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_28%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BEnable%20custom%20engines%20for%20the%20translation%20panel.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_29%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BEnable%20custom%20engines%20for%20the%20page%20translator.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_30%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BAdd/Edit/Remove%20API%20keys.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_31%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20%26lt%3Bhtml%3Ab%26gt%3Benabled/checked%26lt%3B/html%3Ab%26gt%3B%2C%20the%20translation%20result%20will%20be%20displayed%20inside%20a%20textbox%20element.%20This%20allows%20to%20select%20just%20the%20desired%20text%20to%20be%20copied.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_32%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3B%26lt%3Bhtml%3Ab%26gt%3BEnable/Disable%26lt%3B/html%3Ab%26gt%3B%20the%20use%20of%20an%20style%20sheet%20that%20affects%20elements%20of%20the%20application.%20I%20added%20it%20mainly%20to%20style%20the%20panel%20translator.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_33%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3B%26lt%3Bhtml%3Ab%26gt%3BEnable/Disable%26lt%3B/html%3Ab%26gt%3B%20the%20use%20of%20an%20style%20sheet%20that%20affects%20elements%20of%20web%20pages.%20I%20added%20it%20mainly%20to%20remove%20annoyances%20from%20the%20translator%27s%20pages.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_34%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%20class%3D%22warning%22%26gt%3B%26lt%3Bhtml%3Ab%26gt%3BThis%20field%20is%20saved%20into%20a%20preference%2C%20so%20try%20not%20to%20use%20to%20much%20data%20here%20%28like%20big%20images%20in%20Base64%20format%29.%26lt%3B/html%3Ab%26gt%3B%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_35%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BRequire%20the%20%26lt%3Bhtml%3Ab%26gt%3BShift%26lt%3B/html%3Ab%26gt%3B%20key%20for%20triggering%20the%20translate%20on%20release%20action.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%26lt%3B/popupset%26gt%3B%0A%26lt%3B/prefwindow%26gt%3B%26lt%3B%21--%25OptionsWindow%25--%26gt%3B%0A%0A%0A%0A%26lt%3B%21--%25CustomEnginesEditor%25--%26gt%3B%26lt%3B%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%20%3F%26gt%3B%0A%26lt%3B%3Fxml-stylesheet%20href%3D%22chrome%3A//global/skin/%22%20%3F%26gt%3B%0A%26lt%3B%3Fxml-stylesheet%20href%3D%22data%3Atext/css%3Bcharset%3Dutf-8%2C%0Awindow%20*%20%7B%0A%09font-family%3A%20%26amp%3Bquot%3BOpen%20Sans%26amp%3Bquot%3B%2C%20Helvetica%2C%20Arial%2C%20sans-serif%20%21important%3B%0A%7D%0A.convert-to-panel%20%7B%0A%09-moz-appearance%3A%20none%20%21important%3B%0A%09-moz-binding%3A%20url%28%26amp%3Bquot%3Bchrome%3A//global/content/bindings/popup.xml%2523arrowpanel%26amp%3Bquot%3B%29%20%21important%3B%0A%09background%3A%20transparent%20%21important%3B%0A%09border%3A%20none%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0Acaption%20.caption-text%2C%0A.bold_text%20%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%7D%0A.warning%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%09color%3A%20red%20%21important%3B%0A%7D%0Abutton%20.button-text%20%7B%0A%09display%3A%20inline-block%20%21important%3B%0A%09text-align%3A%20left%20%21important%3B%0A%7D%0Abutton%20%7B%0A%09min-width%3A%200%20%21important%3B%0A%7D%0A.optional%20%7B%0A%09outline%3A%202px%20solid%20green%20%21important%3B%0A%7D%0A.required%20%7B%0A%09outline%3A%202px%20solid%20orange%20%21important%3B%0A%7D%0A.experimental%20%7B%0A%09outline%3A%202px%20solid%20red%20%21important%3B%0A%7D%0A.optional%2C%0A.required%2C%0A.experimental%20%7B%0A%09margin-top%3A%205px%20%21important%3B%0A%09margin-bottom%3A%205px%20%21important%3B%0A%7D%0Atab%5Bselected%3D%26amp%3Bquot%3Btrue%26amp%3Bquot%3B%5D%20%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%7D%0Agroupbox%20%7B%0A%09-moz-appearance%3A%20groupbox%20%21important%3B%0A%09border%3A%202px%20groove%20ThreeDFace%20%21important%3B%0A%09border-radius%3A%203px%20%21important%3B%0A%09margin%3A%203px%20%21important%3B%0A%09padding%3A%203px%203px%206px%20%21important%3B%0A%7D%0A.groupbox-body%20%7B%0A%09padding%3A%20inherit%20%21important%3B%0A%7D%0Acaption%20%7B%0A%09margin%3A%200%206px%20%21important%3B%0A%09background-color%3A%20-moz-Dialog%20%21important%3B%0A%7D%0Atabpanels%20caption%20%7B%0A%09-moz-appearance%3A%20tabpanel%20%21important%3B%0A%7D%0Atabpanel%20%7B%0A%09overflow-x%3A%20auto%20%21important%3B%0A%7D%0A/*%20%21important%20is%20needed%20to%20override%20label%20in%20global.css%20*/%0A.caption-text%20%7B%0A%09margin%3A%200%202px%20%21important%3B%0A%7D%0A.edit-custom-engine%20%7B%0A%09list-style-image%3A%20url%28%26amp%3Bquot%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABbklEQVQokX2QP0sCcRzGv+kZiC7+/PNT8w/INeh2kzl0bg4SUZESDSHkWwgMMsgGIdPBMDRvUQKXIpcgiTh0EITruPfgvY+n5YYG9YEPz/SBh4fICoDtWq0mtdvtCIAt2hQATlmWDwVB+Pb5fI1OpxNdKwGwZzKZA0EQVCL6JSKNMdYEEFgpAbCXSqU8Y+ydiKYWGmPsod/vr54HwKMoSiEWiw2I6MviJxgM3m2SXOPx+DQej78Q0YfFp9frvd80zzUcDk/C4XCHiF4dDsfA7Xa/BQKBW1VVfetO8IxGo2NRFB9FUax3u90LzvlTNpvdB2BfJ7kmk8lRKpVqcs7buVzuJplMXs7ncycBsCmKEq9Wq5Ku6/5KpSLpuu5vNBrp2Wx2Vi6Xr6LR6HMoFLqu1+sJAiDIslzknLd6vV76f+fz+XMACdM091qtVnE6ne4SAJthGJKmaYXlcrmzWCwKpmlGNE0rGIYhAbBZOAEIf/lbwByZlq46AAAAAElFTkSuQmCC%26amp%3Bquot%3B%29%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0A.delete-custom-engine%20%7B%0A%09list-style-image%3A%20url%28%26amp%3Bquot%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABVklEQVQokWNgoAT8//+f+////9xofB5cigXmGemnz9LRyX97+zbf29u3+Wbp6OTPN9TP+P//vwCGyavsrdLm8HH+XCDA/X6Fo33aSif71AUC3O/n8HH+XGFnmY5i0////7n3piTVH1aVfXFAVuT/aknB96skBd8fkBX5f0RV9sXelJQGZKdCNH3+LPaot7P2vL7yi1MaUv9PaUj9P6+v/OJxT0fd/8+fxTD9cPs23/6YoPSTJipvrxsr/L9urPD/pInK2/2xgRn/b9/mw/DDDh+7/AMGcu/vWKv9f+is++Khs+6LO9Zq/w8ayL3f4W1bgOKk////89yb0F763FPv22tfkxcfF0yo+7xwYu1rX5MXzz31vj2Y0F6KEbz///+X/r16Tsn3ma21/7+8FP//+bPY95mttT9WzS79//+/NK64EPv//7/E////GaFY4v///+JYFRMLAKUewtoAYB96AAAAAElFTkSuQmCC%26amp%3Bquot%3B%29%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0A.save_changes%20%7B%0A%09list-style-image%3A%20url%28%26amp%3Bquot%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACdElEQVQ4jWNgIBGE/mdgZvjPwEiqPgYGBgaGpCOGUhX3XFO630Zapp0xZiVJc/QSFb78aw4dXe/C3k/8lnCj73OkfcN/BiaiNEfsUpfKPGfV0fDE/33jc///PR8i/nW9iz5Rez/QnoGBgYHBYT4Dh/cGNdugHZqS6Jq9l8oJppyw6ml8FvCx6Lbz/7iThv8zL1n9r37k+6fgusdGBoYGBqbQvXpOmeecbqecsu33XKUiCtNsPJOBNXiHfm/NQ78veTcd/wcf0vofsF/9f+BBjX/RR40fxBwx8WNIOWinWHnPd3/di8B/1Q/93yYcse6yWSonqDddXCxgi/bkyge+XzOu2f332qv632238n+P3Sr//XZr3wnaoRvlOUmFnaHgivu2kocevz32qf5PvGT1r+Ke/2fvDdqz3NapL25+Efol8ZLVf8edCv9tt8n+t9sm999lu9oZv42adtqrtNkYGBgYGKy2yW212S73w2Sz5D+LrTL/k6/a/C+74/u/7I7P/9gLFv9NNknC8F+LdbIX7NcqO6IEkvpyLimdNcKLtdaK/tBaK/LfYKPE//Bzpv+DThn9198g/l9rrch/7TWif3SXS14wWSLvaTyTATP+pZYLycqvFFijuJL/p+JKgf9KqwT/K60U+K+4UuC/4gqBvyoLRS6oTRW1wZsCBRdxykks5loovoT7k/gS7v/iS7j/iy/i+S81i/eCTL+gJwMDEcmXdy6DOt88toW8C9h+8s1l+88/keOMSCuPI0MaFmfjAIwM/QwKbNMY1rJ0Mp5kKGOwIFYjDLAyCDAI8ITyaHH7cOszSDMIMzAQbzuqS4jxMwMDAwDtNu92OyP2UwAAAABJRU5ErkJggg%3D%3D%26amp%3Bquot%3B%29%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0A.cancel_changes%20%7B%0A%09list-style-image%3A%20url%28%26amp%3Bquot%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADdklEQVQ4jXVTb0yUBRx+3n+8977vve/BcXhIBzg5CMZRCAvGSIZQMCXpRFhkagRjTkjStdr6M9bW1/rCt1tZ0vDUU1E4QMHrAMk7F4zDY4qYRBdkyzJK0eMC9+sLOGnr+fo8z2+/Pc8eYBVtgHZSH2NzqqoJ/4Muk0l1WSxZLovFuI4oAKTjVXu2Tbd++tmNhsbac9HR0f81d8CoTVZUVk01t3x+vGJ3+U5AXuOi7BbL9q79jRf/cp5duvNRa9Cfld3YqaqxawIXNOPlrOy6UPORwJ9tX0Z69tV7X0vc9CoAHarzi2u/2P3GlZm6g0sP322lB4c/WAlVVk+NbEpp+QZQHIDcn7y5aXa7/fr95vdWHh75mGbr3444il4e3ZWZ+ybeyi89PdBwKLywrYLu5hfTvXI7LVbtodmcvJ/G8l9850p2dtN0uu3H+6U76Peicrr7wlb6e2sZ9ReWRRqyCvtRkbblpQMZz53tS9z8IGTaQLfNCfSb7XlaTH2W7lVW/fpHUfH8gmkD3TEn0A8xsRSKNpInLv7RgbiN/fbEDDsACGmCkNek6DvcmmFxVBRpWBDopiDQgiWJfjbF0QTL0iDDkJ/jyC1EhQ/xUefTgWIAurWcuAIgvUXQdZxStMcXeIHOAdQHhroB6gSoh2HIyfGPDzPc+RIgBwC/rqYagHsfyOvOsA0PWJLoGMfRUYCOAvQVw5A72kiuBEvwQ6C8BuDWmdsA8YQk5Z9R9Kd6FH3YxfPUDpCTYegEy1I7QCd5ntx6/cppWd/ZLkkFn6y97wAEF8+XXFDUbo8kh3tZjnoA8jAMjcYYadwcT98yDPUC1Mdy5JHkcK+i9BwTxTIHIOD7fXU7v0uxDg6K4pKXZWkEoHGWpRuSRBMJlvlgivX2TVmmwCrnZVkaEnVLg0bTiDstw47x6tquyS05ER/H0RhA0yxLIVlevqaqtwZEsXlA0e29ZjAEQ6r6z61VjY/jacK8cdmfneuFL7egxm8yXbouSY/mFIV+0bTlSU0LDIniwUuAwQHIHp1ubzDG4JtX1chcVBRNSfLSVVX1X7Va6/E1oBvmUTKT+Ez3fGFheNJqDfgEYb8HeLKFPkAbkaRd43GxvrlUa2TGbPaOcNwr/YDyJEh3UlLpZZvtzFRm5utjTy3tqSNiID5+x1BqivNicnJFGyACwL8fh1x5BGHtQgAAAABJRU5ErkJggg%3D%3D%26amp%3Bquot%3B%29%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0A%22%20type%3D%22text/css%22%20%3F%26gt%3B%0A%26lt%3Bwindow%20id%3D%22%25U_I_D%25_custom_engines_editor%22%0A%09%20%20%20%20onload%3D%22%24.onLoad%28%29%3B%22%0A%09%20%20%20%20onunload%3D%22%24.onUnLoad%28%29%3B%22%0A%09%20%20%20%20xmlns%3Ahtml%3D%22http%3A//www.w3.org/1999/xhtml%22%0A%09%20%20%20%20xmlns%3D%22http%3A//www.mozilla.org/keymaster/gatekeeper/there.is.only.xul%22%26gt%3B%0A%26lt%3Bscript%26gt%3B%26lt%3B%21%5BCDATA%5B%0Avar%20Cc%20%3D%20Components.classes%3B%0Avar%20Ci%20%3D%20Components.interfaces%3B%0Avar%20Cu%20%3D%20Components.utils%3B%0ACu.import%28%22resource%3A//gre/modules/Services.jsm%22%29%3B%0ACu.import%28%22resource%3A//gre/modules/osfile.jsm%22%29%3B%0Avar%20stg%20%3D%20window._storage%3B%0Avar%20cb_btn%20%3D%20stg.button%3B%0A%0Afunction%20%24id%28aID%2C%20aParent%29%20%7B%0A%09if%20%28%21aParent%29%0A%09%09return%20document.getElementById%28aID%29%3B%0A%09return%20aParent.getElementById%28aID%29%3B%0A%7D%0Avar%20%24%20%3D%20%7B%0A%09onLoad%3A%20function%28%29%20%7B%0A%09%09window.editPanelTarget%20%3D%20null%3B%0A%09%09%24.populateBox%28%29%3B%0A%09%09window.addEventListener%28%22focus%22%2C%20%24%20%2C%20false%29%3B%0A%09%09window.addEventListener%28%22blur%22%2C%20%24%20%2C%20false%29%3B%0A%09%09%24.highlightButton%28cb_btn%2C%201%29%3B%0A%09%7D%2C%0A%09handleEvent%3A%20function%28aE%29%20%7B%0A%09%09switch%20%28aE.type%29%20%7B%0A%09%09%09case%20%22focus%22%3A%0A%09%09%09%09%24.highlightButton%28cb_btn%2C%201%29%3B%0A%09%09%09%09break%3B%0A%09%09%09case%20%22blur%22%3A%0A%09%09%09%09%24.highlightButton%28cb_btn%2C%202%29%3B%0A%09%09%09%09break%3B%0A%09%09%7D%0A%09%7D%2C%0A%09onUnLoad%3A%20function%28%29%20%7B%0A%09%09%24.highlightButton%28cb_btn%29%3B%0A%09%7D%2C%0A%09populateBox%3A%20function%28%29%20%7B%0A%09%09let%20enginesArray%20%3D%20JSON.parse%28stg.data%29%3B%0A%09%09let%20caption%20%3D%20%24id%28%22container-caption%22%29%3B%0A%09%09caption.label%20%3D%20%22Custom%20engines%20for%20the%20%22%20+%20%28stg.fileName%20%3D%3D%3D%20%22PanelEngines%22%20%3F%0A%09%09%09%22panel%20translator%22%20%3A%0A%09%09%09%22page%20translator%22%29%3B%0A%09%09let%20o%20%3D%200%2C%0A%09%09%09oLen%20%3D%20enginesArray.length%3B%0A%09%09for%20%28%3B%20o%20%26lt%3B%20oLen%3B%20o++%29%20%7B%0A%09%09%09let%20obj%20%3D%20enginesArray%5Bo%5D%3B%0A%09%09%09let%20lbl%20%3D%20obj%5B%22label%22%5D%20%7C%7C%20%22%22%3B%0A%09%09%09%24.createItems%28lbl%2C%20obj%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09highlightButtonTimer%3A%20null%2C%0A%09highlightButton%3A%20function%28aEl%2C%20aStyle%29%20%7B%0A%09%09aEl.style.removeProperty%28%22border-color%22%29%3B%0A%09%09aEl.style.removeProperty%28%22box-shadow%22%29%3B%0A%09%09aEl.style.removeProperty%28%22outline%22%29%3B%0A%09%09aEl.style.removeProperty%28%22outline-offset%22%29%3B%0A%09%09aEl.style.removeProperty%28%22transition-duration%22%29%3B%0A%09%09if%20%28%21aStyle%29%0A%09%09%09return%20true%3B%0A%09%09clearTimeout%28%24.highlightButtonTimer%29%3B%0A%09%09%24.highlightButtonTimer%20%3D%20setTimeout%28function%28%29%20%7B%0A%09%09%09switch%20%28aStyle%29%20%7B%0A%09%09%09%09case%201%3A%0A%09%09%09%09%09aEl.style.setProperty%28%22border-color%22%2C%20%22rgba%280%2C200%2C0%2C1%29%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22box-shadow%22%2C%20%220%200%201px%201px%20rgba%280%2C200%2C0%2C1%29%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22outline%22%2C%20%222px%20solid%20rgba%280%2C200%2C0%2C1%29%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22outline-offset%22%2C%20%22-2px%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22transition-duration%22%2C%20%2210ms%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%202%3A%0A%09%09%09%09%09aEl.style.setProperty%28%22border-color%22%2C%20%22rgba%280%2C200%2C0%2C.2%29%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22box-shadow%22%2C%20%220%200%201px%201px%20rgba%280%2C200%2C0%2C.2%29%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22outline%22%2C%20%222px%20dotted%20rgba%280%2C200%2C0%2C.2%29%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22outline-offset%22%2C%20%22-2px%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09aEl.style.setProperty%28%22transition-duration%22%2C%20%2210ms%22%2C%20%22important%22%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%7D%2C%2010%29%3B%0A%09%7D%2C%0A%09highlightElement%3A%20function%28aEl%2C%20aRem%29%20%7B%0A%09%09aEl.style.removeProperty%28%22background%22%29%3B%0A%09%09aEl.style.removeProperty%28%22border-color%22%29%3B%0A%09%09aEl.style.removeProperty%28%22box-shadow%22%29%3B%0A%09%09aEl.style.removeProperty%28%22outline%22%29%3B%0A%09%09aEl.style.removeProperty%28%22outline-offset%22%29%3B%0A%09%09if%20%28aRem%29%0A%09%09%09return%20true%3B%0A%09%09aEl.style.setProperty%28%22background%22%2C%20%22rgba%280%2C255%2C0%2C.25%29%22%2C%20%22important%22%29%3B%0A%09%09aEl.style.setProperty%28%22border-color%22%2C%20%22rgba%280%2C200%2C0%2C1%29%22%2C%20%22important%22%29%3B%0A%09%09aEl.style.setProperty%28%22box-shadow%22%2C%20%220%200%201px%201px%20rgba%280%2C200%2C0%2C.5%29%22%2C%20%22important%22%29%3B%0A%09%09aEl.style.setProperty%28%22outline%22%2C%20%222px%20solid%20rgba%280%2C200%2C0%2C1%29%22%2C%20%22important%22%29%3B%0A%09%09aEl.style.setProperty%28%22outline-offset%22%2C%20%22-2px%22%2C%20%22important%22%29%3B%0A%09%7D%2C%0A%09onAccept%3A%20function%28%29%20%7B%0A%09%09let%20enginesArray%20%3D%20%5B%5D%3B%0A%09%09try%20%7B%0A%09%09%09let%20box%20%3D%20%24id%28%22container-box%22%29%3B%0A%09%09%09%09Array.prototype.slice.call%28box.getElementsByTagName%28%22menuitem%22%29%29.forEach%28function%28aMI%29%20%7B%0A%09%09%09%09%09enginesArray.push%28aMI._data%29%3B%0A%09%09%09%09%7D%29%3B%0A%09%09%7D%20finally%20%7B%0A%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09let%20JSONData%20%3D%20JSON.stringify%28enginesArray%2C%20null%2C%20%22%5Ct%22%29%3B%0A%09%09%09%09let%20fPath%20%3D%20stg.filePath%3B%0A%09%09%09%09let%20fName%20%3D%20stg.fileName%20+%20%22.json%22%3B%0A%09%09%09%09OS.File.copy%28fPath%2C%20%24.getBakDir%28fName%20+%20%22.bak1%22%29%2C%20%7B%0A%09%09%09%09%09noOverwrite%3A%20true%0A%09%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%09%24.saveJSONData%28fPath%2C%20JSONData%29%3B%0A%09%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%09OS.File.copy%28fPath%2C%20%24.getBakDir%28fName%20+%20%22.bak2%22%29%2C%20%7B%0A%09%09%09%09%09%09noOverwrite%3A%20true%0A%09%09%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%09%09%24.saveJSONData%28fPath%2C%20JSONData%29%3B%0A%09%09%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%09%09OS.File.copy%28fPath%2C%20%24.getBakDir%28fName%20+%20%22.bak3%22%29%2C%20%7B%0A%09%09%09%09%09%09%09noOverwrite%3A%20true%0A%09%09%09%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%09%09%09%24.saveJSONData%28fPath%2C%20JSONData%29%3B%0A%09%09%09%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%09%09%09OS.File.move%28%24.getBakDir%28fName%20+%20%22.bak2%22%29%2C%20%24.getBakDir%28fName%20+%20%22.bak1%22%29%2C%20%7B%0A%09%09%09%09%09%09%09%09noOverwrite%3A%20false%0A%09%09%09%09%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%09%09%09%09OS.File.move%28%24.getBakDir%28fName%20+%20%22.bak3%22%29%2C%20%24.getBakDir%28fName%20+%20%22.bak2%22%29%2C%20%7B%0A%09%09%09%09%09%09%09%09%09noOverwrite%3A%20false%0A%09%09%09%09%09%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%09%09%09%09%09OS.File.copy%28fPath%2C%20%24.getBakDir%28fName%20+%20%22.bak3%22%29%2C%20%7B%0A%09%09%09%09%09%09%09%09%09%09noOverwrite%3A%20true%0A%09%09%09%09%09%09%09%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09%09%09%09%09%09%09%09%24.saveJSONData%28fPath%2C%20JSONData%29%3B%0A%09%09%09%09%09%09%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%09%09%09%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%09%09%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%09%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%09%09%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%09%09%09%09%09%09%7D%29%3B%3B%0A%09%09%09%09%09%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%09%09%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%09%7D%29%3B%0A%09%09%09%09%7D%29%3B%0A%09%09%09%7D%2C%20100%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09getBakDir%3A%20function%28aAppend%29%20%7B%0A%09%09let%20d%20%3D%20OS.Path.join%28stg.storagePath%2C%20%22Backups%22%29%3B%0A%09%09OS.File.makeDir%28d%2C%20%7B%0A%09%09%09ignoreExisting%3A%20true%0A%09%09%7D%29%3B%0A%09%09return%20OS.Path.join%28d%2C%20aAppend%29%0A%09%7D%2C%0A%09saveJSONData%3A%20function%28aPath%2C%20aData%29%20%7B%0A%09%09OS.File.writeAtomic%28aPath%2C%20aData%2C%20%7B%0A%09%09%09tmpPath%3A%20aPath%20+%20%22.tmp%22%2C%0A%09%09%09encoding%3A%20%22utf-8%22%0A%09%09%7D%29.then%28function%20onSuccess%28%29%20%7B%0A%09%09%09cb_btn.MultiTranslator.selfDestroy%28%29%3B%0A%09%09%7D%2C%20function%20onFailure%28aRejectReason%29%20%7B%0A%09%09%09%24.reportError%28aRejectReason%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%09reportError%3A%20function%28aRejectReason%29%20%7B%0A%09%09try%20%7B%0A%09%09%09console.error%28aRejectReason%29%3B%0A%09%09%7D%20catch%20%28aErr%29%20%7B%0A%09%09%09Cu.reportError%28%5Bcb_btn.name%20+%20%22%3A%20%22%20+%20cb_btn.id%2C%20aRejectReason%2C%20aRejectReason.stack%5D.join%28%22%5Cn%22%29%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09dummyItems%3A%20function%28%29%20%7B%0A%09%09switch%20%28stg.fileName%29%20%7B%0A%09%09%09case%20%22URLBarEngines%22%3A%0A%09%09%09%09return%20%7B%0A%09%09%09%09%09%22label%22%3A%20%22Label%22%2C%0A%09%09%09%09%09%22command%22%3A%20%22Bookmarklet%22%2C%0A%09%09%09%09%09%22image%22%3A%200%2C%0A%09%09%09%09%09%22tooltip%22%3A%200%0A%09%09%09%09%7D%3B%0A%09%09%09case%20%22PanelEngines%22%3A%0A%09%09%09%09return%20%7B%0A%09%09%09%09%09%22label%22%3A%20%22Label%22%2C%0A%09%09%09%09%09%22image%22%3A%200%2C%0A%09%09%09%09%09%22method%22%3A%20%22%22%2C%0A%09%09%09%09%09%22referer%22%3A%20%22%22%2C%0A%09%09%09%09%09%22action%22%3A%20%22%22%2C%0A%09%09%09%09%09%22post%22%3A%20%22%22%2C%0A%09%09%09%09%09%22code%22%3A%20%22UTF-8%22%2C%0A%09%09%09%09%09%22xpath%22%3A%20%22%22%2C%0A%09%09%09%09%09%22start%22%3A%20%22%22%2C%0A%09%09%09%09%09%22end%22%3A%20%22%22%0A%09%09%09%09%7D%3B%0A%09%09%7D%0A%09%7D%2C%0A%09createItems%3A%20function%28aLabel%2C%20aData%29%20%7B%0A%09%09if%20%28%21aLabel%20%26amp%3B%26amp%3B%20%21aData%29%20%7B%0A%09%09%09aLabel%20%3D%20%22label%22%3B%0A%09%09%09aData%20%3D%20%24.dummyItems%28%29%3B%0A%09%09%7D%0A%09%09let%20box%20%3D%20%24id%28%22container-box%22%29%3B%0A%09%09let%20getImg%20%3D%20function%28%29%20%7B%0A%09%09%09if%20%28aData.hasOwnProperty%28%22image%22%29%29%20%7B%0A%09%09%09%09switch%20%28aData%5B%22image%22%5D%29%20%7B%0A%09%09%09%09%09case%20%220%22%3A%0A%09%09%09%09%09case%200%3A%0A%09%09%09%09%09case%20%221%22%3A%0A%09%09%09%09%09case%201%3A%0A%09%09%09%09%09case%20%222%22%3A%0A%09%09%09%09%09case%202%3A%0A%09%09%09%09%09case%20%223%22%3A%0A%09%09%09%09%09case%203%3A%0A%09%09%09%09%09%09return%20cb_btn.MultiTranslator.images%5BparseInt%28aData%5B%22image%22%5D%2C%2010%29%5D%3B%0A%09%09%09%09%09default%3A%0A%09%09%09%09%09%09return%20aData%5B%22image%22%5D%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%09return%20%22%22%3B%0A%09%09%7D%3B%0A%09%09let%20hbox%20%3D%20box.appendChild%28%24.%24CNS%28%22hbox%22%2C%20%7B%0A%09%09%09align%3A%20%22center%22%0A%09%09%7D%29%29%3B%0A%09%09let%20mI%20%3D%20hbox.appendChild%28%24.%24CNS%28%22menuitem%22%2C%20%7B%0A%09%09%09label%3A%20aLabel%2C%0A%09%09%09flex%3A%20%221%22%2C%0A%09%09%09image%3A%20getImg%28%29%2C%0A%09%09%09class%3A%20%22menuitem-iconic%22%2C%0A%09%09%7D%29%29%3B%0A%09%09mI._data%20%3D%20aData%3B%0A%09%09hbox.appendChild%28%24.%24CNS%28%22button%22%2C%20%7B%0A%09%09%09tooltiptext%3A%20%22Delete%20custom%20engine%22%2C%0A%09%09%09mousethrough%3A%20%22never%22%2C%0A%09%09%09class%3A%20%22delete-custom-engine%22%2C%0A%09%09%09oncommand%3A%20%22%24.removeCustomEngine%28event%2C%20this%29%3B%22%0A%09%09%7D%29%29%3B%0A%09%09hbox.appendChild%28%24.%24CNS%28%22button%22%2C%20%7B%0A%09%09%09%09tooltiptext%3A%20%22Edit%20custom%20engine%22%2C%0A%09%09%09%09mousethrough%3A%20%22never%22%2C%0A%09%09%09%09class%3A%20%22edit-custom-engine%22%2C%0A%09%09%09%09oncommand%3A%20%22%24.editCustomEngine%28event%2C%20this.parentNode.firstChild.getAttribute%28%27_type_%27%29%29%3B%22%0A%09%09%09%7D%29%29%3B%0A%09%7D%2C%0A%09removeCustomEngine%3A%20function%28aE%2C%20aNode%29%20%7B%0A%09%09if%20%28stg.accel%28aE%29%29%20%7B%0A%09%09%09aNode.parentNode.parentNode.removeChild%28aNode.parentNode%29%3B%0A%09%09%09return%20true%3B%0A%09%09%7D%0A%09%09let%20cBox%20%3D%20stg.custombuttons.confirmBox%28%22Multi%20Translator%22%2C%20%22Delete%20custom%20engine%3F%5Cn%5Cn%22%20+%0A%09%09%09%22Keep%20the%20%22%20+%20stg.accel%28%29%20+%20%22%20key%20pressed%20to%20delete%20items%20without%20confirmation.%22%2C%20%22Yes%22%2C%20%22Cancel%22%29%3B%0A%09%09if%20%28cBox%29%20%7B%0A%09%09%09aNode.parentNode.parentNode.removeChild%28aNode.parentNode%29%3B%0A%09%09%7D%20else%0A%09%09%09return%20false%3B%0A%09%7D%2C%0A%09populateEditPanel%3A%20function%28aFakeMI%2C%20aNode%2C%20aTarget%29%20%7B%0A%09%09window.editPanelTarget%20%3D%20aTarget.parentNode%3B%0A%09%09%24.highlightElement%28window.editPanelTarget%29%3B%0A%09%09let%20dataObj%20%3D%20aFakeMI._data%3B%0A%09%09let%20vbox%20%3D%20%24id%28stg.fileName%20+%20%22_box%22%29%3B%0A%09%09let%20tempBox%3B%0A%09%09try%20%7B%0A%09%09%09try%20%7B%0A%09%09%09%09let%20id%20%3D%20vbox.getAttribute%28%22id%22%29%3B%0A%09%09%09%09tempBox%20%3D%20vbox.cloneNode%28true%29%3B%0A%09%09%09%09tempBox.setAttribute%28%22id%22%2C%20id%20+%20%22-cloned%22%29%3B%0A%09%09%09%7D%20finally%20%7B%0A%09%09%09%09aNode.appendChild%28tempBox%29%3B%0A%09%09%09%7D%0A%09%09%7D%20finally%20%7B%0A%09%09%09Array.prototype.slice.call%28tempBox.getElementsByAttribute%28%22data-attr%22%2C%20%22*%22%29%29.forEach%28function%28aEl%29%20%7B%0A%09%09%09%09let%20attrName%20%3D%20aEl.getAttribute%28%22data-attr%22%29%3B%0A%09%09%09%09let%20attrVal%20%3D%20dataObj%5BattrName%5D%3B%0A%09%09%09%09//%20This%20crap%20doesn%27t%20work%20on%20normal%20textboxes%2C%20but%20it%20does%20on%20number%20textboxes.%0A%09%09%09%09aEl%20%26amp%3B%26amp%3B%20%28aEl.value%20%3D%20attrVal%29%3B%0A%09%09%09%09//%20And%20this%20crap%20doesn%27t%20work%20on%20number%20textboxes%2C%20but%20it%20does%20on%20normal%20textboxes.%20WTF%21%3F%21%3F%21%3F%21%0A%09%09%09%09aEl%20%26amp%3B%26amp%3B%20aEl.setAttribute%28%22value%22%2C%20attrVal%29%3B%0A%09%09%09%7D%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09editCustomEngine%3A%20function%28aE%2C%20aType%29%20%7B%0A%09%09let%20panel%20%3D%20%24.panel%3B%0A%09%09if%20%28panel%20%26amp%3B%26amp%3B%20%28panel.state%20%3D%3D%3D%20%22open%22%20%7C%7C%20panel.state%20%3D%3D%3D%20%22opening%22%29%29%0A%09%09%09return%20false%3B%0A%09%09let%20fakeMI%20%3D%20aE.target.parentNode.firstChild%3B%0A%09%09%24.populateEditPanel%28fakeMI%2C%20panel.firstChild%2C%20aE.target%29%3B%0A%09%09panel.openPopup%28aE.target%2C%20%22%22%2C%200%2C%200%2C%20false%2C%20null%2C%20null%29%3B%0A%09%7D%2C%0A%09onEditPanelAccept%3A%20function%28%29%20%7B%0A%09%09let%20panel%20%3D%20%24.panel%3B%0A%09%09let%20item%20%3D%20window.editPanelTarget.firstChild%3B%0A%09%09try%20%7B%0A%09%09%09Array.prototype.slice.call%28panel.getElementsByAttribute%28%22data-attr%22%2C%20%22*%22%29%29.forEach%28function%28aEl%29%20%7B%0A%09%09%09%09let%20attrName%20%3D%20aEl.getAttribute%28%22data-attr%22%29%3B%0A%09%09%09%09item._data%5BattrName%5D%20%3D%20aEl.value%20%7C%7C%20%22%22%3B%0A%09%09%09%7D%29%3B%0A%09%09%7D%20finally%20%7B%0A%09%09%09%24.updateCustomEngine%28item%29%3B%0A%09%09%09%24.onEditPanelCancel%28%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09updateCustomEngine%3A%20function%28aItem%29%20%7B%0A%09%09let%20getImg%20%3D%20function%28%29%20%7B%0A%09%09%09if%20%28aItem._data.hasOwnProperty%28%22image%22%29%29%20%7B%0A%09%09%09%09switch%20%28aItem._data%5B%22image%22%5D%29%20%7B%0A%09%09%09%09%09case%20%220%22%3A%0A%09%09%09%09%09case%200%3A%0A%09%09%09%09%09case%20%221%22%3A%0A%09%09%09%09%09case%201%3A%0A%09%09%09%09%09case%20%222%22%3A%0A%09%09%09%09%09case%202%3A%0A%09%09%09%09%09case%20%223%22%3A%0A%09%09%09%09%09case%203%3A%0A%09%09%09%09%09%09return%20cb_btn.MultiTranslator.images%5BparseInt%28aItem._data%5B%22image%22%5D%2C%2010%29%5D%3B%0A%09%09%09%09%09default%3A%0A%09%09%09%09%09%09return%20aItem._data%5B%22image%22%5D%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%09return%20%22%22%3B%0A%09%09%7D%3B%0A%09%09aItem.setAttribute%28%22image%22%2C%20getImg%28%29%29%3B%0A%09%09aItem.setAttribute%28%22label%22%2C%20aItem._data%5B%22label%22%5D%20%7C%7C%20%22%22%29%3B%0A%09%7D%2C%0A%09onEditPanelCancel%3A%20function%28%29%20%7B%0A%09%09let%20panel%20%3D%20%24.panel%3B%0A%09%09panel%20%26amp%3B%26amp%3B%20panel.hidePopup%28%29%3B%0A%09%09if%20%28window.editPanelTarget%29%20%7B%0A%09%09%09%24.highlightElement%28window.editPanelTarget%2C%20true%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09onEditPanelHidden%3A%20function%28aE%2C%20aN%29%20%7B%0A%09%09if%20%28aE.target%20%21%3D%3D%20aN%29%0A%09%09%09return%20false%3B%0A%09%09aE.stopPropagation%28%29%3B%0A%09%7D%2C%0A%09onEditPanelHiding%3A%20function%28aE%2C%20aN%29%20%7B%0A%09%09if%20%28aE.target%20%21%3D%3D%20aN%29%0A%09%09%09return%20false%3B%0A%09%09aN.firstChild.textContent%20%3D%20%22%22%3B%0A%09%09%24.highlightElement%28window.editPanelTarget%2C%20true%29%0A%09%09window.editPanelTarget%20%3D%20null%3B%0A%09%09aE.stopPropagation%28%29%3B%0A%09%7D%2C%0A%09%24CNS%3A%20function%28aElName%2C%20aAttrs%29%20%7B%20//%20Creates%20elements%0A%09%09var%20el%20%3D%20document.createElement%28aElName%29%3B%0A%09%09if%20%28aAttrs%29%0A%09%09%09Object.keys%28aAttrs%29.forEach%28function%28n%29%20%7B%0A%09%09%09%09if%20%28aAttrs%5Bn%5D%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09el.setAttribute%28n%2C%20aAttrs%5Bn%5D%29%0A%09%09%09%7D%29%3B%0A%09%09return%20el%3B%0A%09%7D%2C%0A%09draggedElement%3A%20null%2C%0A%09DragAndDropHandler%3A%20%7B%0A%09%09handleEvent%3A%20function%28aE%29%20%7B%0A%09%09%09switch%20%28aE.type%29%20%7B%0A%09%09%09%09case%20%22dragstart%22%3A%0A%09%09%09%09%09if%20%28%21stg.accel%28aE%29%20%7C%7C%20%21%21window.editPanelTarget%29%0A%09%09%09%09%09%09return%20false%3B%0A%09%09%09%09%09let%20target%20%3D%20aE.target%3B%0A%09%09%09%09%09if%20%28target.nodeName%20%21%3D%3D%20%22hbox%22%29%0A%09%09%09%09%09%09%24.draggedElement%20%3D%20target.parentNode%3B%0A%09%09%09%09%09if%20%28%24.draggedElement.nodeName%20%21%3D%3D%20%22hbox%22%29%0A%09%09%09%09%09%09%24.draggedElement%20%3D%20null%3B%0A%09%09%09%09%09if%20%28getComputedStyle%28%24.draggedElement%29.outlineStyle%20%21%3D%3D%20%22none%22%29%20%7B%0A%09%09%09%09%09%09%24.draggedElement%20%3D%20null%3B%0A%09%09%09%09%09%09return%20false%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09aE.dataTransfer.setData%28%22text/plain%22%2C%20%22dummy%22%29%3B%20//%20Stupid%20piece%20of%20SHEET%21%21%21%21%21%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%20%22dragover%22%3A%0A%09%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09case%20%22drop%22%3A%0A%09%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%09%09let%20insPoint%20%3D%20aE.target.parentNode%3B%0A%09%09%09%09%09if%20%28insPoint%20%26amp%3B%26amp%3B%20insPoint.nodeName%20%3D%3D%3D%20%22hbox%22%29%20%7B%0A%09%09%09%09%09%09insPoint.parentNode.insertBefore%28%24.draggedElement%2C%20insPoint%29%3B%0A%09%09%09%09%09%7D%20else%20if%20%28aE.target.nodeName%20%3D%3D%3D%20%22groupbox%22%29%20%7B%0A%09%09%09%09%09%09aE.target.appendChild%28%24.draggedElement%29%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09setTextboxValue%3A%20function%28aE%2C%20aDataAttr%29%20%7B%0A%09%09let%20el%20%3D%20%24.panel.getElementsByAttribute%28%22data-attr%22%2C%20aDataAttr%29%5B0%5D%3B%0A%09%09el%20%26amp%3B%26amp%3B%20%28el.value%20%3D%20aE.target.value%29%3B%0A%09%7D%2C%0A%09get%20panel%28%29%20%7B%0A%09%09return%20%24id%28%22edit-engines-panel%22%29%3B%0A%09%7D%2C%0A%7D%3B%0A%5D%5D%26gt%3B%26lt%3B/script%26gt%3B%0A%09%26lt%3Bkeyset%26gt%3B%0A%09%09%26lt%3Bkey%20keycode%3D%22VK_ESCAPE%22%20oncommand%3D%22return%20false%3B%22/%26gt%3B%0A%09%26lt%3B/keyset%26gt%3B%0A%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%26lt%3Bgroupbox%20id%3D%22container-box%22%0A%09%09%09%09%20%20minheight%3D%2250%22%0A%09%09%09%09%20%20orient%3D%22vertical%22%0A%09%09%09%09%20%20context%3D%22pseudo-item-context%22%0A%09%09%09%09%20%20ondragstart%3D%22%24.DragAndDropHandler.handleEvent%28event%29%3B%22%0A%09%09%09%09%20%20ondragover%3D%22%24.DragAndDropHandler.handleEvent%28event%29%3B%22%0A%09%09%09%09%20%20ondrop%3D%22%24.DragAndDropHandler.handleEvent%28event%29%3B%22%26gt%3B%0A%09%09%09%26lt%3Bcaption%20id%3D%22container-caption%22%20label%3D%22Main%20menu%22/%26gt%3B%0A%09%09%26lt%3B/groupbox%26gt%3B%0A%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%26lt%3Bbutton%20label%3D%22Add%20custom%20engine%22%20oncommand%3D%22%24.createItems%28null%2C%20null%29%3B%22/%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3Bseparator/%26gt%3B%0A%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%26lt%3Bbutton%20label%3D%22Save%20changes%22%20class%3D%22save_changes%22%20oncommand%3D%22%24.onAccept%28%29%3B%22/%26gt%3B%0A%09%09%09%26lt%3Bbutton%20label%3D%22Cancel%22%20class%3D%22cancel_changes%22%20oncommand%3D%22close%28%29%3B%22/%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3Bvbox%20collapsed%3D%22true%22%26gt%3B%0A%09%09%09%26lt%3Bgroupbox%20id%3D%22PanelEngines_box%22%20orient%3D%22vertical%22%20flex%3D%221%22%26gt%3B%0A%09%09%09%09%26lt%3Bcaption%20label%3D%22Edit%20custom%20engine%22/%26gt%3B%0A%09%09%09%09%26lt%3Bgrid%26gt%3B%0A%09%09%09%09%09%26lt%3Bcolumns%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bcolumn%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bcolumn%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%09%26lt%3B/columns%26gt%3B%0A%09%09%09%09%09%26lt%3Brows%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_2%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Label%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20data-attr%3D%22label%22%20class%3D%22required%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_1%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Image%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Btextbox%20data-attr%3D%22image%22%20flex%3D%221%22%20class%3D%22required%22/%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Bbutton%20label%3D%22...%22%20oncommand%3D%22%24.selectLocalImage%28this%29%3B%22/%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Bbutton%20label%3D%22B64%22%20oncommand%3D%22%24.img_to_b64%28this%29%3B%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_3%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Method%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Btextbox%20data-attr%3D%22method%22%20flex%3D%221%22%20class%3D%22required%22/%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Bbutton%20label%3D%22Set%20method%22%20type%3D%22menu%22%26gt%3B%0A%09%09%09%09%09%09%09%09%09%26lt%3Bmenupopup%20onpopuphiding%3D%22event.stopPropagation%28%29%3B%22%0A%09%09%09%09%09%09%09%09%09%09%09%20%20%20oncommand%3D%22%24.setTextboxValue%28event%2C%20%27method%27%29%3Bevent.stopPropagation%28%29%3B%22%26gt%3B%0A%09%09%09%09%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22GET%22%20value%3D%22GET%22%20/%26gt%3B%0A%09%09%09%09%09%09%09%09%09%09%26lt%3Bmenuitem%20label%3D%22POST%22%20value%3D%22POST%22%20/%26gt%3B%0A%09%09%09%09%09%09%09%09%09%26lt%3B/menupopup%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3B/button%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_4%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Referer%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22referer%22%20class%3D%22optional%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_5%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22URL%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22action%22%20class%3D%22optional%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_6%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Post%20data%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22post%22%20class%3D%22optional%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_7%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Encoding%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22code%22%20class%3D%22optional%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_8%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22XPath%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22xpath%22%20class%3D%22optional%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_9%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22RegEx%20start%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22start%22%20class%3D%22optional%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_10%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22RegEx%20end%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22end%22%20class%3D%22optional%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%26lt%3B/rows%26gt%3B%0A%09%09%09%09%26lt%3B/grid%26gt%3B%0A%09%09%09%26lt%3B/groupbox%26gt%3B%0A%09%09%09%26lt%3Bgroupbox%20id%3D%22URLBarEngines_box%22%20orient%3D%22vertical%22%20flex%3D%221%22%26gt%3B%0A%09%09%09%09%26lt%3Bcaption%20label%3D%22Edit%20custom%20engine%22/%26gt%3B%0A%09%09%09%09%26lt%3Bgrid%26gt%3B%0A%09%09%09%09%09%26lt%3Bcolumns%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bcolumn%20/%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bcolumn%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%09%26lt%3B/columns%26gt%3B%0A%09%09%09%09%09%26lt%3Brows%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_2%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Label%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20data-attr%3D%22label%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_12%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Tooltip%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20data-attr%3D%22tooltip%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_1%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Image%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Bhbox%20align%3D%22center%22%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Btextbox%20data-attr%3D%22image%22%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Bbutton%20label%3D%22...%22%20oncommand%3D%22%24.selectLocalImage%28this%29%3B%22/%26gt%3B%0A%09%09%09%09%09%09%09%09%26lt%3Bbutton%20label%3D%22B64%22%20oncommand%3D%22%24.img_to_b64%28this%29%3B%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%09%26lt%3Brow%20align%3D%22center%22%20tooltip%3D%22tt_11%22%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Blabel%20value%3D%22Command%22/%26gt%3B%0A%09%09%09%09%09%09%09%26lt%3Btextbox%20flex%3D%221%22%20data-attr%3D%22command%22/%26gt%3B%0A%09%09%09%09%09%09%26lt%3B/row%26gt%3B%0A%09%09%09%09%09%26lt%3B/rows%26gt%3B%0A%09%09%09%09%26lt%3B/grid%26gt%3B%0A%09%09%09%26lt%3B/groupbox%26gt%3B%0A%09%09%26lt%3B/vbox%26gt%3B%0A%09%26lt%3B/vbox%26gt%3B%0A%09%26lt%3Bseparator/%26gt%3B%0A%09%26lt%3Bpopupset%26gt%3B%0A%09%09%26lt%3Bpanel%20id%3D%22edit-engines-panel%22%0A%09%09%09%20%20%20consumeoutsideclicks%3D%22false%22%0A%09%09%09%20%20%20noautohide%3D%22true%22%0A%09%09%09%20%20%20backdrag%3D%22true%22%0A%09%09%09%20%20%20minwidth%3D%22400%22%0A%09%09%09%20%20%20flip%3D%22slide%22%0A%09%09%09%20%20%20flex%3D%221%22%0A%09%09%09%20%20%20class%3D%22convert-to-panel%22%0A%09%09%09%20%20%20position%3D%22end_before%22%0A%09%09%09%20%20%20onpopuphidden%3D%22%24.onEditPanelHidden%28event%2C%20this%29%3B%22%0A%09%09%09%20%20%20onpopuphiding%3D%22%24.onEditPanelHiding%28event%2C%20this%29%3B%22%0A%09%09%09%20%20%20orient%3D%22vertical%22%26gt%3B%0A%09%09%09%26lt%3Bvbox%20flex%3D%221%22%20/%26gt%3B%0A%09%09%09%26lt%3Bspacer%20flex%3D%220%22/%26gt%3B%0A%09%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%26lt%3Bbutton%20label%3D%22Save%22%20class%3D%22save_changes%22%20oncommand%3D%22%24.onEditPanelAccept%28%29%3Bevent.stopPropagation%28%29%3B%22/%26gt%3B%0A%09%09%09%09%26lt%3Bbutton%20label%3D%22Cancel%22%20class%3D%22cancel_changes%22%20oncommand%3D%22%24.onEditPanelCancel%28%29%3Bevent.stopPropagation%28%29%3B%22/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%09%26lt%3Bresizer%20type%3D%22window%22%20dir%3D%22bottomleft%22%20left%3D%220%22%20bottom%3D%220%22%20width%3D%2210%22%20height%3D%2210%22/%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%26lt%3Bresizer%20type%3D%22window%22%20dir%3D%22bottomright%22%20right%3D%220%22%20bottom%3D%220%22%20width%3D%2210%22%20height%3D%2210%22/%26gt%3B%0A%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%26lt%3B/panel%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_1%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BImage%20for%20the%20engine.%20It%20can%20be%20an%20URL%20to%20an%20image%2C%20a%20data%3A%20image%20or%20a%20number%20between%200%20to%203.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bhtml%3Aul%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B0%3A%26lt%3B/html%3Ab%26gt%3B%20Generic%20image.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B1%3A%26lt%3B/html%3Ab%26gt%3B%20Bing%20translator%20image.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B2%3A%26lt%3B/html%3Ab%26gt%3B%20Google%20translator%20image.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B3%3A%26lt%3B/html%3Ab%26gt%3B%20Yandex%20translator%20image.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%26lt%3B/html%3Aul%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_2%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BA%20label%20for%20the%20engine.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_3%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BThe%20HTTP%20method%20to%20use%20%28%26lt%3Bhtml%3Ab%26gt%3BPOST%26lt%3B/html%3Ab%26gt%3B%20or%20%26lt%3Bhtml%3Ab%26gt%3BGET%26lt%3B/html%3Ab%26gt%3B%29.%20If%20ignored%2C%20defaults%20to%20%26lt%3Bhtml%3Ab%26gt%3BGET%26lt%3B/html%3Ab%26gt%3B.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_4%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BReferer%20for%20the%20HTTP%20request%20header.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_5%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BHTTP%20request%20URL.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BSome%20placeholders%20can%20be%20used%20here%3A%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bhtml%3Aul%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B%25%25TEXT%25%25%26lt%3B/html%3Ab%26gt%3B%20%28%26lt%3Bhtml%3Ab%26gt%3BRequired%26lt%3B/html%3Ab%26gt%3B%29%3A%20Used%20to%20%26lt%3Bhtml%3Aem%26gt%3Binject%26lt%3B/html%3Aem%26gt%3B%20the%20current%20selected%20text%20into%20the%20%26lt%3Bhtml%3Ab%26gt%3BURL%26lt%3B/html%3Ab%26gt%3B%20and/or%20%26lt%3Bhtml%3Ab%26gt%3BPost%20data%26lt%3B/html%3Ab%26gt%3B%20sections.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B%25%25LNGTO%25%25%26lt%3B/html%3Ab%26gt%3B%20and/or%20%26lt%3Bhtml%3Ab%26gt%3B%25%25LNGFROM%25%25%26lt%3B/html%3Ab%26gt%3B%20%28Optionals%29%3A%20Used%20to%20%26lt%3Bhtml%3Aem%26gt%3Binject%26lt%3B/html%3Aem%26gt%3B%20the%20language%20code%20to%20translate%20to/from.%20These%20language%20codes%20are%20configured%20from%20the%20language%20selection%20lists%20of%20the%20panel%20translator%20options%20menu.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%26lt%3B/html%3Aul%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_6%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BFor%20%26lt%3Bhtml%3Ab%26gt%3BPOST%26lt%3B/html%3Ab%26gt%3B%20requests%20only.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BSome%20placeholders%20can%20be%20used%20here%3A%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bhtml%3Aul%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B%25%25TEXT%25%25%26lt%3B/html%3Ab%26gt%3B%20%28%26lt%3Bhtml%3Ab%26gt%3BRequired%26lt%3B/html%3Ab%26gt%3B%29%3A%20Used%20to%20%26lt%3Bhtml%3Aem%26gt%3Binject%26lt%3B/html%3Aem%26gt%3B%20the%20current%20selected%20text%20into%20the%20%26lt%3Bhtml%3Ab%26gt%3BURL%26lt%3B/html%3Ab%26gt%3B%20and/or%20%26lt%3Bhtml%3Ab%26gt%3BPost%20data%26lt%3B/html%3Ab%26gt%3B%20sections.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B%25%25LNGTO%25%25%26lt%3B/html%3Ab%26gt%3B%20and/or%20%26lt%3Bhtml%3Ab%26gt%3B%25%25LNGFROM%25%25%26lt%3B/html%3Ab%26gt%3B%20%28Optionals%29%3A%20Used%20to%20%26lt%3Bhtml%3Aem%26gt%3Binject%26lt%3B/html%3Aem%26gt%3B%20the%20language%20code%20to%20translate%20to/from.%20These%20language%20codes%20are%20configured%20from%20the%20language%20selection%20lists%20of%20the%20panel%20translator%20options%20menu.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%26lt%3B/html%3Aul%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_7%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BEncoding%20method.%20If%20ignored%2C%20defaults%20to%20%26lt%3Bhtml%3Ab%26gt%3BUTF-8%26lt%3B/html%3Ab%26gt%3B.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_8%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BXPath%20expression%20entered%20to%20get%20HTML%20elements%20with%20the%20translation%20results.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BChoose%20this%20or%20a%20regular%20expression.%20Not%20both.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_9%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20you%20do%20not%20want%20to%20use%20an%20xpath%20expression%2C%20a%20string%20of%20HTML%20document%20that%20immediately%20precedes%20the%20translation%20results%20%28regular%20expression%29.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BChoose%20this%20or%20an%20XPath%20expression.%20Not%20both.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_10%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BIf%20you%20do%20not%20want%20to%20use%20an%20XPath%20expression%2C%20a%20string%20of%20HTML%20document%20that%20is%20immediately%20after%20the%20translation%20results%20%28regular%20expression%29.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BChoose%20this%20or%20an%20XPath%20expression.%20Not%20both.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_11%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BThe%20bookmarklet/code%20to%20be%20executed%20when%20performing%20a%20page%20translation%20and/or%20clicking%20the%20icon%20inside%20the%20URL%20bar.%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3B%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BSome%20%28optionals%29%20placeholders%20can%20be%20used%20here%3A%26lt%3B/description%26gt%3B%0A%09%09%09%26lt%3Bhtml%3Aul%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B%25%25URL%25%25%3A%26lt%3B/html%3Ab%26gt%3B%20Used%20to%20%26lt%3Bhtml%3Aem%26gt%3Binject%26lt%3B/html%3Aem%26gt%3B%20the%20current%20page%20URL%20into%20the%20bookmarklet/code.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%09%26lt%3Bhtml%3Ali%26gt%3B%26lt%3Bhtml%3Ab%26gt%3B%25%25LNGTO%25%25%3A%26lt%3B/html%3Ab%26gt%3B%20and/or%20%26lt%3Bhtml%3Ab%26gt%3B%25%25LNGFROM%25%25%3A%26lt%3B/html%3Ab%26gt%3B%20Used%20to%20%26lt%3Bhtml%3Aem%26gt%3Binject%26lt%3B/html%3Aem%26gt%3B%20the%20language%20code%20to%20translate%20to/from.%20These%20language%20codes%20are%20configured%20from%20the%20language%20selection%20lists%20on%20the%20page%20translation%20options%20menu.%26lt%3B/html%3Ali%26gt%3B%0A%09%09%09%26lt%3B/html%3Aul%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%09%26lt%3Btooltip%20id%3D%22tt_12%22%26gt%3B%0A%09%09%09%26lt%3Bdescription%26gt%3BTooltip%20for%20the%20engine.%26lt%3B/description%26gt%3B%0A%09%09%26lt%3B/tooltip%26gt%3B%0A%09%26lt%3B/popupset%26gt%3B%0A%26lt%3B/window%26gt%3B%26lt%3B%21--%25CustomEnginesEditor%25--%26gt%3B%0A%0A%0A%26lt%3B%21--%25APIKeysWindow%25--%26gt%3B%26lt%3B%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%20%3F%26gt%3B%0A%26lt%3B%3Fxml-stylesheet%20href%3D%22chrome%3A//global/skin/%22%20%3F%26gt%3B%0A%26lt%3B%3Fxml-stylesheet%20href%3D%22data%3Atext/css%3Bcharset%3Dutf-8%2C%0Awindow%20*%20%7B%0A%09font-family%3A%20%26amp%3Bquot%3BOpen%20Sans%26amp%3Bquot%3B%2C%20Helvetica%2C%20Arial%2C%20sans-serif%20%21important%3B%0A%7D%0Acaption%20.caption-text%2C%0A.bold_text%20%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%7D%0Abutton%20%7B%0A%09min-width%3A%200%20%21important%3B%0A%7D%0Abutton%20.button-text%20%7B%0A%09display%3A%20inline-block%20%21important%3B%0A%09text-align%3A%20left%20%21important%3B%0A%7D%0Agroupbox%20%7B%0A%09-moz-appearance%3A%20groupbox%20%21important%3B%0A%09border%3A%202px%20groove%20ThreeDFace%20%21important%3B%0A%09border-radius%3A%203px%20%21important%3B%0A%09margin%3A%203px%20%21important%3B%0A%09padding%3A%203px%203px%206px%20%21important%3B%0A%7D%0A.groupbox-body%20%7B%0A%09padding%3A%20inherit%20%21important%3B%0A%7D%0Acaption%20%7B%0A%09margin%3A%200%206px%20%21important%3B%0A%09background-color%3A%20-moz-Dialog%20%21important%3B%0A%7D%0Atabpanels%20caption%20%7B%0A%09-moz-appearance%3A%20tabpanel%20%21important%3B%0A%7D%0Atab%5Bselected%3D%26amp%3Bquot%3Btrue%26amp%3Bquot%3B%5D%20%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%7D%0Atabpanel%20%7B%0A%09overflow-x%3A%20auto%20%21important%3B%0A%7D%0A.caption-text%20%7B%0A%09margin%3A%200%202px%20%21important%3B%0A%7D%0A.delete-api-key%20%7B%0A%09list-style-image%3A%20url%28%26amp%3Bquot%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABVklEQVQokWNgoAT8//+f+////9xofB5cigXmGemnz9LRyX97+zbf29u3+Wbp6OTPN9TP+P//vwCGyavsrdLm8HH+XCDA/X6Fo33aSif71AUC3O/n8HH+XGFnmY5i0////7n3piTVH1aVfXFAVuT/aknB96skBd8fkBX5f0RV9sXelJQGZKdCNH3+LPaot7P2vL7yi1MaUv9PaUj9P6+v/OJxT0fd/8+fxTD9cPs23/6YoPSTJipvrxsr/L9urPD/pInK2/2xgRn/b9/mw/DDDh+7/AMGcu/vWKv9f+is++Khs+6LO9Zq/w8ayL3f4W1bgOKk////89yb0F763FPv22tfkxcfF0yo+7xwYu1rX5MXzz31vj2Y0F6KEbz///+X/r16Tsn3ma21/7+8FP//+bPY95mttT9WzS79//+/NK64EPv//7/E////GaFY4v///+JYFRMLAKUewtoAYB96AAAAAElFTkSuQmCC%26amp%3Bquot%3B%29%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0A.save_changes%20%7B%0A%09list-style-image%3A%20url%28%26amp%3Bquot%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACdElEQVQ4jWNgIBGE/mdgZvjPwEiqPgYGBgaGpCOGUhX3XFO630Zapp0xZiVJc/QSFb78aw4dXe/C3k/8lnCj73OkfcN/BiaiNEfsUpfKPGfV0fDE/33jc///PR8i/nW9iz5Rez/QnoGBgYHBYT4Dh/cGNdugHZqS6Jq9l8oJppyw6ml8FvCx6Lbz/7iThv8zL1n9r37k+6fgusdGBoYGBqbQvXpOmeecbqecsu33XKUiCtNsPJOBNXiHfm/NQ78veTcd/wcf0vofsF/9f+BBjX/RR40fxBwx8WNIOWinWHnPd3/di8B/1Q/93yYcse6yWSonqDddXCxgi/bkyge+XzOu2f332qv632238n+P3Sr//XZr3wnaoRvlOUmFnaHgivu2kocevz32qf5PvGT1r+Ke/2fvDdqz3NapL25+Efol8ZLVf8edCv9tt8n+t9sm999lu9oZv42adtqrtNkYGBgYGKy2yW212S73w2Sz5D+LrTL/k6/a/C+74/u/7I7P/9gLFv9NNknC8F+LdbIX7NcqO6IEkvpyLimdNcKLtdaK/tBaK/LfYKPE//Bzpv+DThn9198g/l9rrch/7TWif3SXS14wWSLvaTyTATP+pZYLycqvFFijuJL/p+JKgf9KqwT/K60U+K+4UuC/4gqBvyoLRS6oTRW1wZsCBRdxykks5loovoT7k/gS7v/iS7j/iy/i+S81i/eCTL+gJwMDEcmXdy6DOt88toW8C9h+8s1l+88/keOMSCuPI0MaFmfjAIwM/QwKbNMY1rJ0Mp5kKGOwIFYjDLAyCDAI8ITyaHH7cOszSDMIMzAQbzuqS4jxMwMDAwDtNu92OyP2UwAAAABJRU5ErkJggg%3D%3D%26amp%3Bquot%3B%29%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0A.cancel_changes%20%7B%0A%09list-style-image%3A%20url%28%26amp%3Bquot%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADdklEQVQ4jXVTb0yUBRx+3n+8977vve/BcXhIBzg5CMZRCAvGSIZQMCXpRFhkagRjTkjStdr6M9bW1/rCt1tZ0vDUU1E4QMHrAMk7F4zDY4qYRBdkyzJK0eMC9+sLOGnr+fo8z2+/Pc8eYBVtgHZSH2NzqqoJ/4Muk0l1WSxZLovFuI4oAKTjVXu2Tbd++tmNhsbac9HR0f81d8CoTVZUVk01t3x+vGJ3+U5AXuOi7BbL9q79jRf/cp5duvNRa9Cfld3YqaqxawIXNOPlrOy6UPORwJ9tX0Z69tV7X0vc9CoAHarzi2u/2P3GlZm6g0sP322lB4c/WAlVVk+NbEpp+QZQHIDcn7y5aXa7/fr95vdWHh75mGbr3444il4e3ZWZ+ybeyi89PdBwKLywrYLu5hfTvXI7LVbtodmcvJ/G8l9850p2dtN0uu3H+6U76Peicrr7wlb6e2sZ9ReWRRqyCvtRkbblpQMZz53tS9z8IGTaQLfNCfSb7XlaTH2W7lVW/fpHUfH8gmkD3TEn0A8xsRSKNpInLv7RgbiN/fbEDDsACGmCkNek6DvcmmFxVBRpWBDopiDQgiWJfjbF0QTL0iDDkJ/jyC1EhQ/xUefTgWIAurWcuAIgvUXQdZxStMcXeIHOAdQHhroB6gSoh2HIyfGPDzPc+RIgBwC/rqYagHsfyOvOsA0PWJLoGMfRUYCOAvQVw5A72kiuBEvwQ6C8BuDWmdsA8YQk5Z9R9Kd6FH3YxfPUDpCTYegEy1I7QCd5ntx6/cppWd/ZLkkFn6y97wAEF8+XXFDUbo8kh3tZjnoA8jAMjcYYadwcT98yDPUC1Mdy5JHkcK+i9BwTxTIHIOD7fXU7v0uxDg6K4pKXZWkEoHGWpRuSRBMJlvlgivX2TVmmwCrnZVkaEnVLg0bTiDstw47x6tquyS05ER/H0RhA0yxLIVlevqaqtwZEsXlA0e29ZjAEQ6r6z61VjY/jacK8cdmfneuFL7egxm8yXbouSY/mFIV+0bTlSU0LDIniwUuAwQHIHp1ubzDG4JtX1chcVBRNSfLSVVX1X7Va6/E1oBvmUTKT+Ez3fGFheNJqDfgEYb8HeLKFPkAbkaRd43GxvrlUa2TGbPaOcNwr/YDyJEh3UlLpZZvtzFRm5utjTy3tqSNiID5+x1BqivNicnJFGyACwL8fh1x5BGHtQgAAAABJRU5ErkJggg%3D%3D%26amp%3Bquot%3B%29%20%21important%3B%0A%09-moz-image-region%3A%20auto%20%21important%3B%0A%7D%0A.warning%7B%0A%09font-weight%3A%20bold%20%21important%3B%0A%09color%3A%20red%20%21important%3B%0A%7D%0A%22%20type%3D%22text/css%22%20%3F%26gt%3B%0A%26lt%3Bwindow%20id%3D%22%25U_I_D%25_edit_api_keys_window%22%0A%09%20%20%20%20onload%3D%22%24.onLoad%28%29%3B%22%0A%09%20%20%20%20minwidth%3D%22600%22%0A%09%20%20%20%20title%3D%22Add/Remove%20API%20keys%22%0A%09%20%20%20%20xmlns%3D%22http%3A//www.mozilla.org/keymaster/gatekeeper/there.is.only.xul%22%26gt%3B%0A%26lt%3Bscript%26gt%3B%26lt%3B%21%5BCDATA%5B%0Avar%20stg%20%3D%20window._storage%3B%0Avar%20APIKeysObj%20%3D%20stg.APIKeysObj%3B%0Avar%20cb_btn%20%3D%20stg.button%3B%0A%0Afunction%20%24id%28aID%2C%20aParent%29%20%7B%0A%09if%20%28%21aParent%29%0A%09%09return%20document.getElementById%28aID%29%3B%0A%09return%20aParent.getElementById%28aID%29%3B%0A%7D%0Avar%20%24%20%3D%20%7B%0A%09onLoad%3A%20function%28%29%20%7B%0A%09%09let%20browser%20%3D%20%24id%28%22%25U_I_D%25-browser%22%29%3B%0A%09%09let%20source%20%3D%20stg.getHelp%28%22%25APIHelpPage%25%22%29.split%28%22%5C%25HIDDEN_CLASS%5C%25%22%29.join%28stg.prefName%29%3B%0A%09%09let%20helpPage%20%3D%20%22data%3Atext/html%2C%22%20+%20encodeURIComponent%28source%29%3B%0A%09%09browser.setAttribute%28%22src%22%2C%20helpPage%29%3B%0A%09%09%24.populateAPIKeysBox%28%29%3B%0A%0A%09%09let%20timer%20%3D%20null%3B%0A%09%09%28function%20retry%28%29%20%7B%0A%09%09%09clearTimeout%28timer%29%3B%0A%09%09%09timer%20%3D%20setTimeout%28function%28%29%20%7B%0A%09%09%09%09let%20body%20%3D%20browser.contentDocument.body%3B%0A%09%09%09%09if%20%28%21body%29%20%7B%0A%09%09%09%09%09retry%28%29%3B%0A%09%09%09%09%09return%20true%3B%0A%09%09%09%09%7D%0A%09%09%09%09Array.prototype.slice.call%28body.getElementsByTagName%28%22a%22%29%29.forEach%28function%28aAnchor%29%20%7B%0A%09%09%09%09%09aAnchor.onclick%20%3D%20function%28aE%29%20%7B%0A%09%09%09%09%09%09aE.preventDefault%28%29%3B%0A%09%09%09%09%09%09stg.openPage%28aAnchor.getAttribute%28%22href%22%29%2C%20aE%29%3B%0A%09%09%09%09%09%09aE.stopPropagation%28%29%3B%0A%09%09%09%09%09%7D%3B%0A%09%09%09%09%7D%29%3B%0A%09%09%09%09body.hidden%20%3D%20false%3B%0A%09%09%09%7D%2C%20200%29%3B%0A%09%09%7D%29%28%29%3B%0A%09%7D%2C%0A%09populateAPIKeysBox%3A%20function%28%29%20%7B%0A%09%09let%20box%20%3D%20%24id%28%22api-keys-box%22%29%3B%0A%09%09%24id%28%22api-keys-box-caption%22%29.label%20%3D%20%28stg.prefName%20%3D%3D%3D%20%22pAPIKeysBing%22%20%3F%20%22Bing%22%20%3A%20%22Yandex%22%29%20+%20%22%20Translator%20API%20keys%22%3B%0A%09%09Array.prototype.slice.call%28APIKeysObj%29.forEach%28function%28aAPIKey%29%20%7B%0A%09%09%09%24.addNewRow%28aAPIKey%2C%20box%29%3B%0A%09%09%7D%29%3B%0A%09%7D%2C%0A%09addNewRow%3A%20function%28aAPIKey%2C%20aBox%29%20%7B%0A%09%09let%20hBox%20%3D%20aBox.appendChild%28%24.%24CNS%28%22hbox%22%2C%20%7B%0A%09%09%09align%3A%20%22center%22%0A%09%09%7D%29%29%3B%0A%09%09if%20%28stg.prefName%20%3D%3D%3D%20%22pAPIKeysBing%22%29%20%7B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09value%3A%20%22Client%20ID%22%2C%0A%09%09%09%09class%3A%20%22bold_text%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22textbox%22%2C%20%7B%0A%09%09%09%09value%3A%20aAPIKey%5B0%5D%2C%0A%09%09%09%09%22data-id%22%3A%20%22client-id%22%2C%0A%09%09%09%09flex%3A%201%0A%09%09%09%7D%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09value%3A%20%22Client%20Secret%22%2C%0A%09%09%09%09class%3A%20%22bold_text%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22textbox%22%2C%20%7B%0A%09%09%09%09value%3A%20aAPIKey%5B1%5D%2C%0A%09%09%09%09%22data-secret%22%3A%20%22client-secret%22%2C%0A%09%09%09%09flex%3A%203%0A%09%09%09%7D%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22spacer%22%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22button%22%2C%20%7B%0A%09%09%09%09class%3A%20%22delete-api-key%22%2C%0A%09%09%09%09oncommand%3A%20%22%24.removeAPI%28event%2C%20this%29%3B%22%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%20else%20%7B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22label%22%2C%20%7B%0A%09%09%09%09value%3A%20%22API%20key%22%2C%0A%09%09%09%09class%3A%20%22bold_text%22%2C%0A%09%09%09%7D%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22textbox%22%2C%20%7B%0A%09%09%09%09value%3A%20aAPIKey%2C%0A%09%09%09%09flex%3A%201%0A%09%09%09%7D%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22spacer%22%29%29%3B%0A%09%09%09hBox.appendChild%28%24.%24CNS%28%22button%22%2C%20%7B%0A%09%09%09%09class%3A%20%22delete-api-key%22%2C%0A%09%09%09%09oncommand%3A%20%22%24.removeAPI%28event%2C%20this%29%3B%22%0A%09%09%09%7D%29%29%3B%0A%09%09%7D%0A%09%7D%2C%0A%09addNewAPI%3A%20function%28%29%20%7B%0A%09%09let%20box%20%3D%20%24id%28%22api-keys-box%22%29%3B%0A%09%09if%20%28stg.prefName%20%3D%3D%3D%20%22pAPIKeysBing%22%29%20%7B%0A%09%09%09%24.addNewRow%28%5B%22%22%2C%22%22%5D%2C%20box%29%3B%0A%09%09%7D%20else%20%7B%0A%09%09%09%24.addNewRow%28%22%22%2C%20box%29%3B%0A%09%09%7D%0A%0A%09%7D%2C%0A%09onAccept%3A%20function%28%29%20%7B%0A%09%09let%20box%20%3D%20%24id%28%22api-keys-box%22%29%3B%0A%09%09let%20newAPIKeys%20%3D%20%5B%5D%3B%0A%09%09try%20%7B%0A%09%09%09if%20%28stg.prefName%20%3D%3D%3D%20%22pAPIKeysBing%22%29%20%7B%0A%09%09%09%09Array.prototype.slice.call%28box.getElementsByTagName%28%22hbox%22%29%29.forEach%28function%28aHBox%29%20%7B%0A%09%09%09%09%09newAPIKeys.push%28%5BaHBox.getElementsByAttribute%28%22data-id%22%2C%20%22client-id%22%29%5B0%5D.value%2C%0A%09%09%09%09%09%09aHBox.getElementsByAttribute%28%22data-secret%22%2C%20%22client-secret%22%29%5B0%5D.value%0A%09%09%09%09%09%5D%29%3B%0A%09%09%09%09%7D%29%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09Array.prototype.slice.call%28box.getElementsByTagName%28%22textbox%22%29%29.forEach%28function%28aTBox%29%20%7B%0A%09%09%09%09%09newAPIKeys.push%28aTBox.value%29%3B%0A%09%09%09%09%7D%29%3B%0A%09%09%09%7D%0A%09%09%7D%20finally%20%7B%0A%09%09%09newAPIKeys.filter%28function%28aVal%29%20%7B%0A%09%09%09%09if%20%28aVal%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09return%20true%3B%0A%09%09%09%7D%29%3B%0A%09%09%09try%20%7B%0A%09%09%09%09let%20prefVal%20%3D%20JSON.stringify%28newAPIKeys%29%3B%0A%09%09%09%09cb_btn.MultiTranslator.sPref%28stg.prefName%2C%20prefVal%29%3B%0A%09%09%09%7D%20finally%20%7B%0A%09%09%09%09window.close%28%29%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%2C%0A%09removeAPI%3A%20function%28aE%2C%20aNode%29%20%7B%0A%09%09if%20%28stg.accel%28aE%29%29%20%7B%0A%09%09%09aNode.parentNode.parentNode.removeChild%28aNode.parentNode%29%3B%0A%09%09%09return%20true%3B%0A%09%09%7D%0A%09%09let%20cBox%20%3D%20stg.custombuttons.confirmBox%28%22Multi%20Translator%22%2C%20%22Delete%20API%20key%3F%5Cn%5Cn%22%20+%0A%09%09%09%22Keep%20the%20%22%20+%20stg.accel%28%29%20+%20%22%20key%20pressed%20to%20delete%20items%20without%20confirmation.%22%2C%20%22Yes%22%2C%20%22Cancel%22%29%3B%0A%09%09if%20%28cBox%29%20%7B%0A%09%09%09aNode.parentNode.parentNode.removeChild%28aNode.parentNode%29%3B%0A%09%09%7D%20else%0A%09%09%09return%20false%3B%0A%09%7D%2C%0A%09%24CNS%3A%20function%28aElName%2C%20aAttrs%2C%20aNameSpace%29%20%7B%20//%20Creates%20elements%0A%09%09var%20el%20%3D%20aNameSpace%20%3F%0A%09%09%09document.createElementNS%28aNameSpace%2C%20aElName%29%20%3A%0A%09%09%09document.createElement%28aElName%29%3B%0A%09%09if%20%28aAttrs%29%0A%09%09%09Object.keys%28aAttrs%29.forEach%28function%28n%29%20%7B%0A%09%09%09%09if%20%28aAttrs%5Bn%5D%20%21%3D%3D%20%22%22%29%0A%09%09%09%09%09el.setAttribute%28n%2C%20aAttrs%5Bn%5D%29%3B%0A%09%09%09%7D%29%3B%0A%09%09return%20el%3B%0A%09%7D%2C%0A%0A%7D%3B%0A%5D%5D%26gt%3B%26lt%3B/script%26gt%3B%0A%09%26lt%3Btabbox%20persist%3D%22selectedIndex%22%20id%3D%22main_tabbox%22%20flex%3D%221%22%26gt%3B%0A%09%09%26lt%3Btabs%26gt%3B%0A%09%09%09%26lt%3Btab%20label%3D%22%20API%20keys%20%22%20/%26gt%3B%0A%09%09%09%26lt%3Btab%20class%3D%22warning%22%20label%3D%22%20Readme%20%22%20/%26gt%3B%0A%09%09%26lt%3B/tabs%26gt%3B%0A%09%09%26lt%3Btabpanels%20flex%3D%221%22%26gt%3B%0A%09%09%09%26lt%3Btabpanel%20flex%3D%221%22%20orient%3D%22vertical%22%26gt%3B%0A%09%09%09%09%26lt%3Bvbox%20flex%3D%221%22%26gt%3B%0A%09%09%09%09%09%26lt%3Bgroupbox%20id%3D%22api-keys-box%22%20orient%3D%22vertical%22%20%26gt%3B%0A%09%09%09%09%09%09%26lt%3Bcaption%20id%3D%22api-keys-box-caption%22/%26gt%3B%0A%09%09%09%09%09%26lt%3B/groupbox%26gt%3B%0A%09%09%09%09%26lt%3B/vbox%26gt%3B%0A%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%26lt%3Bhbox%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Bbutton%20label%3D%22Add%20new%20API%22%20oncommand%3D%22%24.addNewAPI%28%29%3B%22/%26gt%3B%0A%09%09%09%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%09%09%26lt%3B/hbox%26gt%3B%0A%09%09%09%26lt%3B/tabpanel%26gt%3B%0A%09%09%09%26lt%3Btabpanel%20flex%3D%221%22%20orient%3D%22horizontal%22%26gt%3B%0A%09%09%09%09%26lt%3Bbrowser%20id%3D%22%25U_I_D%25-browser%22%0A%09%09%09%09%09%09%20type%3D%22content%22%0A%09%09%09%09%09%09%20disablehistory%3D%22true%22%0A%09%09%09%09%09%09%20autocompleteenabled%3D%22false%22%0A%09%09%09%09%09%09%20autoscroll%3D%22false%22%0A%09%09%09%09%09%09%20flex%3D%221%22/%26gt%3B%0A%09%09%09%26lt%3B/tabpanel%26gt%3B%0A%09%09%26lt%3B/tabpanels%26gt%3B%0A%09%26lt%3B/tabbox%26gt%3B%0A%09%26lt%3Bseparator/%26gt%3B%0A%09%26lt%3Bhbox%26gt%3B%0A%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%09%26lt%3Bbutton%20label%3D%22Save%20changes%22%20class%3D%22save_changes%22%20oncommand%3D%22%24.onAccept%28%29%3B%22/%26gt%3B%0A%09%09%26lt%3Bbutton%20label%3D%22Cancel%22%20class%3D%22cancel_changes%22%20oncommand%3D%22close%28%29%3B%22/%26gt%3B%0A%09%09%26lt%3Bspacer%20flex%3D%221%22/%26gt%3B%0A%09%26lt%3B/hbox%26gt%3B%0A%09%26lt%3Bseparator/%26gt%3B%0A%26lt%3B/window%26gt%3B%26lt%3B%21--%25APIKeysWindow%25--%26gt%3B%0A%0A%26lt%3B%21--%25APIHelpPage%25--%26gt%3B%26lt%3B%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%26gt%3B%0A%26lt%3B%21DOCTYPE%20HTML%26gt%3B%0A%26lt%3Bhtml%26gt%3B%0A%09%26lt%3Bhead%26gt%3B%0A%09%09%26lt%3Bmeta%20http-equiv%3D%22content-type%22%20content%3D%22text/html%3Bcharset%3Dutf-8%22%20/%26gt%3B%0A%09%09%26lt%3Blink%20rel%3D%22stylesheet%22%20href%3D%22chrome%3A//global/skin/xul.css%22%20type%3D%22text/css%22/%26gt%3B%0A%09%09%26lt%3Bstyle%20type%3D%22text/css%22%26gt%3B%0A%09%09html%20%7B%0A%09%09%09background%3A%20-moz-dialog%20%21important%3B%0A%09%09%09font%3A%20message-box%20%21important%3B%0A%09%09%7D%0A%09%09body%20*%20%7B%0A%09%09%09font-family%3A%20%22Open%20Sans%22%2C%20Helvetica%2C%20Arial%2C%20sans-serif%20%21important%3B%0A%09%09%7D%0A%09%09body%20%7B%0A%09%09%09color%3A%20-moz-FieldText%3B%0A%09%09%09position%3A%20relative%3B%0A%09%09%09border%3A%201px%20solid%3B%0A%09%09%09border-radius%3A%203px%3B%0A%09%09%09padding%3A%201em%3B%0A%09%09%09background%3A%20-moz-Field%3B%0A%09%09%7D%0A%0A%09%09ul%20%7B%0A%09%09%09margin%3A%200%3B%0A%09%09%09-moz-margin-start%3A%201.5em%3B%0A%09%09%09padding%3A%200%3B%0A%09%09%09list-style%3A%20square%3B%0A%09%09%7D%0A%09%09ul%20%26gt%3B%20li%20%7B%0A%09%09%09margin-top%3A%20.5em%3B%0A%09%09%7D%0A%09%09.important-notes%20%7B%0A%09%09%09border%3A%201px%20solid%20darkred%3B%0A%09%09%09border-radius%3A%203px%3B%0A%09%09%09background-color%3A%20rgba%28255%2C%200%2C%200%2C%200.25%29%20%21important%3B%0A%09%09%09padding%3A%20.5em%3B%0A%09%09%7D%0A%09%09.%25HIDDEN_CLASS%25%20%7B%0A%09%09%09display%3A%20inline%20%21important%3B%0A%09%09%7D%0A%09%09%26lt%3B/style%26gt%3B%0A%09%26lt%3B/head%26gt%3B%0A%26lt%3Bbody%20hidden%3D%22true%22%26gt%3B%0A%26lt%3Bspan%20class%3D%22pAPIKeysBing%22%20style%3D%22display%3A%20none%3B%22%26gt%3B%0A%09%26lt%3Bh2%26gt%3BHow%20to%20get%20Bing%20translator%20API%20keys%26lt%3B/h2%26gt%3B%0A%09%26lt%3Bp%26gt%3BTo%20get%20more%20Bing%20API%20keys%2C%20follow%20%26lt%3Ba%20href%3D%22http%3A//blogs.msdn.com/b/translation/p/gettingstarted1.aspx%22%26gt%3Bthis%20instructions%26lt%3B/a%26gt%3B%26lt%3B/p%26gt%3B%0A%09%26lt%3Bh3%26gt%3BIn%20a%20nutshell%26lt%3B/h3%26gt%3B%0A%09%26lt%3Bol%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BRegister%20for%20an%20account%20on%20%26lt%3Ba%20href%3D%22https%3A//datamarket.azure.com/home/%22%26gt%3BWindows%20Azure%20Marketplace%26lt%3B/a%26gt%3B%20with%20a%20Microsoft%20account.%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3B%26lt%3Ba%20href%3D%22https%3A//datamarket.azure.com/dataset/bing/microsofttranslator%22%26gt%3BSign%20up%20for%20the%20Microsoft%20Translator%20API%26lt%3B/a%26gt%3B%20%20using%20your%20registered%20account.%20Sign%20up%20for%20the%20free%20one%20%28%240.00%29.%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BRegister%20your%20application%20on%20%26lt%3Ba%20href%3D%22https%3A//datamarket.azure.com/developer/applications/register%22%26gt%3BWindows%20Azure%20Marketplace.%26lt%3B/a%26gt%3B%20This%20step%20can%20be%20repeated%20several%20times%20to%20get%20several%20%26lt%3Bb%26gt%3BClient%20IDs%26lt%3B/b%26gt%3B%20and%20%26lt%3Bb%26gt%3BClient%20Secrets%26lt%3B/b%26gt%3B.%20%26lt%3Bb%26gt%3BDO%20NOT%20ABUSE%21%21%21%26lt%3B/b%26gt%3B%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BGet%20the%20%26lt%3Bb%26gt%3BClient%20ID%26lt%3B/b%26gt%3B%20and%20%26lt%3Bb%26gt%3BClient%20Secret%26lt%3B/b%26gt%3B%20for%20your%20registered%20application.%0A%09%09%09%26lt%3Bol%26gt%3B%0A%09%09%09%09%26lt%3Bli%26gt%3BFill%20out%20the%20%26lt%3Bb%26gt%3BClient%20ID%26lt%3B/b%26gt%3B%2C%20and%20%26lt%3Bb%26gt%3BName%26lt%3B/b%26gt%3B%20fields.%26lt%3B/li%26gt%3B%0A%09%09%09%09%26lt%3Bli%26gt%3BThe%20%26lt%3Bb%26gt%3BClient%20Secret%26lt%3B/b%26gt%3B%20field%20is%20already%20completed%20for%20you.%20%26lt%3Bb%26gt%3BDO%20NOT%20CHANGE%20IT.%26lt%3B/b%26gt%3B%26lt%3B/li%26gt%3B%0A%09%09%09%09%26lt%3Bli%26gt%3BFill%20out%20the%20%26lt%3Bem%26gt%3B%26lt%3Bb%26gt%3BRedirect%20URI%26lt%3B/b%26gt%3B%26lt%3B/em%26gt%3B%20field%20with%20any%20valid%20URL%20that%20uses%20https%2C%20for%20example%20%26lt%3Bem%26gt%3Bhttps%3A//microsoft.com%26lt%3B/em%26gt%3B.%20This%20field%20is%20not%20used%20by%20the%20Microsoft%20Translator%20API.%26lt%3B/li%26gt%3B%0A%09%09%09%09%26lt%3Bli%26gt%3BYou%20can%20also%20leave%20the%20%26lt%3Bem%26gt%3B%26lt%3Bb%26gt%3BEnable%20subdomain%20access%26lt%3B/b%26gt%3B%26lt%3B/em%26gt%3B%20checkbox%20unchecked%2C%20as%20Translator%20doesn%u2019t%20use%20it.%26lt%3B/li%26gt%3B%0A%09%09%09%26lt%3B/ol%26gt%3B%0A%09%09%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BThe%20%26lt%3Bb%26gt%3BClient%20ID%26lt%3B/b%26gt%3B%20and%20%26lt%3Bb%26gt%3BClient%20Secret%26lt%3B/b%26gt%3B%20fields%20are%20the%20API%20keys%20used%20by%20Multi%20Translator%20button.%26lt%3B/li%26gt%3B%0A%09%26lt%3B/ol%26gt%3B%0A%26lt%3B/span%26gt%3B%0A%26lt%3Bspan%20class%3D%22pAPIKeysYandex%22%20style%3D%22display%3A%20none%3B%22%26gt%3B%0A%09%26lt%3Bh2%26gt%3BHow%20to%20get%20Yandex%20translator%20API%20keys%26lt%3B/h2%26gt%3B%0A%09%26lt%3Bp%26gt%3BGet%20more%20Yandex%20API%20keys%20%26lt%3Ba%20href%3D%22https%3A//tech.yandex.com/key/form.xml%3Fservice%3Dtrnsl%22%26gt%3Bhere%20%28English%29%26lt%3B/a%26gt%3B%20or%20%26lt%3Ba%20href%3D%22https%3A//tech.yandex.ru/key/form.xml%3Fservice%3Dtrnsl%22%26gt%3Bhere%20%28Russian%29%26lt%3B/a%26gt%3B%26lt%3B/a%26gt%3B%26lt%3B/p%26gt%3B%0A%09%26lt%3Bh3%26gt%3BIn%20a%20nutshell%26lt%3B/h3%26gt%3B%0A%09%26lt%3Bol%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BVisit%20the%20provided%20link%20and%20register%20a%20Yandex%20account%20%28or%20use%20one%20of%20the%20available%20social%20services%29.%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BOnce%20you%20successfully%20finish%20creating%20the%20Yandex%20account%2C%20you%20can%20visit%20the%20link%20provided%20at%20the%20beginning%20several%20times%20to%20create%20several%20API%20keys.%20%26lt%3Bb%26gt%3BDO%20NOT%20ABUSE%21%21%21%26lt%3B/b%26gt%3B%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BOnce%20you%20have%20several%20API%20keys%2C%20you%20can%20use%20them%20to%20replace%20the%20ones%20that%20come%20with%20%26lt%3Bb%26gt%3BMulti%20Translator%26lt%3B/b%26gt%3B%20button%20by%20default.%20%26lt%3Bb%26gt%3B%26lt%3B/b%26gt%3B%26lt%3B/li%26gt%3B%0A%09%26lt%3B/ol%26gt%3B%0A%26lt%3B/span%26gt%3B%0A%26lt%3Bdiv%20class%3D%22important-notes%22%26gt%3B%0A%09%26lt%3Bh3%26gt%3BImportant%20notes%26lt%3B/h3%26gt%3B%0A%09%26lt%3Bul%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BAPI%20keys%20are%20only%20used%20by%20the%20translator%20panel.%20The%20page%20translator%20uses%20a%20totally%20different%20translation%20method.%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3BThe%20API%20keys%20are%20stored%20into%20a%20preference.%20Keep%20your%20API%20keys%20backed%20up%20outside%20the%20application%20in%20case%20you%20reset%20%26lt%3Bb%26gt%3BMulti%20Translator%27s%26lt%3B/b%26gt%3B%20preferences.%26lt%3B/li%26gt%3B%0A%09%09%26lt%3Bli%26gt%3B%26lt%3Bb%26gt%3BNEVER%26lt%3B/b%26gt%3B%20make%20your%20API%20keys%20public%21%21%21%20The%20whole%20purpose%20of%20going%20to%20the%20trouble%20of%20getting%20your%20own%20API%20keys%20is%20that%20the%20only%20one%20%26lt%3Bem%26gt%3Bconsuming%26lt%3B/em%26gt%3B%20their%20limits%20is%20you%20and%20nobody%20else.%26lt%3B/li%26gt%3B%0A%09%26lt%3B/ul%26gt%3B%0A%26lt%3B/div%26gt%3B%0A%26lt%3B/body%26gt%3B%0A%26lt%3B/html%26gt%3B%26lt%3B%21--%25APIHelpPage%25--%26gt%3B%0A%0A%26lt%3B%21--%25AlertImg%25--%26gt%3Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAIGUlEQVRoge2Z7VNTVx7H+Rfa16BbNOgkhbqJMIIBxMYtwrCttdgd1IgDiqTGB1IQCIwNbcDE2zgRiCUgLY9bgaAYwppC2JIhdEhQuyRYFoGW2UtnEMZdx0zbGV5890V67yYX7iWJjusL78z3Bcw5v9/nc865DzOJiHh1vbqe72UcPoE78yo4Hn3+UuXOvArG4RPghCd6pRhYPIuOH99F88zbIeWrOUlICbV+x4/vYmDxLIheKbtEl/tMyIVfdLrcZ9gFen/Kh3E69f8OyRbjdCp6f8rn2IF5KYzTqcFL/DN9TYxT+ziz3pxg4Y3Tqeia5zpC81I0PEilE9CYBbrJkwHj1D7UuiSodUmgs++F1pYGzVAKqq3JqLYmQzOUAq0tDTr7XnqccWofmjwZrDL+vf2ZOAU6Hx5G/WTyugLM1WvyZKDWJYHeIYHWlobmv8vx7fedmCM9WFpexL+fLMPr9cLr9WJlZQUL5CwmZx0YGG/AtcF8aG1p0Dt8MkwRZl+Kp34yGZ0PD28sQIVZqMmTQYPr7HtxeSALY24LvF4vVldXaeBgsrS8iIHxBlweyKJ3hqrP7OvPxCnQNv0hqwBVWO+QoKpfgnszQ1hdXQ0ZnJknTx/DOtGMqn7fbvr3Wk+gbfpDdoGWHz4IGGyYTKOL1Lp8R6Vp6ByePH28BpySCTdzpAdXzEegtaXR94hxah8Mk2kBTC0/fMAu8OXU+2sEDJO+gpqhFNwYqQkZbIGchc3ZjZWVlQ3Her1eGPpPQzOUglqXhO7vz/Tl1PvcAvp7u6G/t5sWqHVJUG1NRu+YLmR4u6sfxz+LxSndH5GnFoF89HDDOb/+9gsM/adRbU2mJeonk2kuToEmTwZ0rkR6sP7ebmiGUkD0SsM6FtVf5aKyTwytLQ2lHYnoGroa1Dyv1wvVXzOhGUoJYNG5EtHkyeAWIJwJtIR2VIxyUzxW/vNzWAI2ZzeqLEnQ2fdCaUrEHOkJeu7krAPlpnhoR8U0POFM4BZouJ9JC+hciaiyJOH22LVnujln/nUX1onmoI4PM3U35b4F+J2HcCag4X4mu4DhbjotUDOyCyXdwpBW7Xln3D2Ikm4hakZ20QKGu+nsArUuCQhnAjRjCVDZhKhoeyesxk+ePsbkrAPj7sFnesT++tsvKGpIgsomhGYsAYQzAbUuCbeAZiwBarsISrMQTeaKkMG1bTIcvfgWjlW/ieOX4nD04luwjLaGLfFZ62EozUKo7SJoxoIQUNtFUNtFKDfFo8WiDqnZz48WsEDOYo70oKLtHVRZkqA0JeL056lh70RdjwLlpniai1NAOyqG2i6CyiaEokeA9r9dDumzwL/xFzcvoMqShGprMvL1fCwtL4b1qdFiUUPRI4DK5tsF7ag4OIGizlho22Rhf+MU12Wi3BSPKksSFF+8HXYdXcc5FHXGhi6g6BGguC4zrKZLy4s4fikOlX2+90iTuSJsgcrG7OB3oGZkF1TDcbTAseo3w2r6zXfdKKz3CSg6hLA5u8Oqs7Kygjy1iBZQDcehZmQXu4DaLqIFyiyxyCViMDx+K6xtV3QIoTQLUVgfB5IkWQG5YnN2I5eIQZkllhZQ20XsAtQg1XAcyiyxkLfycV63f8NGzBRoklBuiofSLERlY3bI86moGqSQNfJ9Ar9zqWxCboFKaywdRY8AR9Q8DI/fCrrpAjmLI2oelGYhSrqF0LbJwoK3u/rxl4tboOgRBDBxCvgPrLTGoswSC1kjH3kqMWbmHgTVeGl5EaevJkJpFkLRIUSBJgnj7kFMTDqCrrFAziJPLaJXn8kVtECldQcUPQLk6/n4SPMnLJCzQQFYRlshb+WjqNN3H2VXRKP4yoGgBEiSROnVQ8glYtas/oYCZRbfqv/PeodvJXsEkBI8lF49BJIkNwSgdmLMbcG4ezBAnCRJ1iyQsyi+cgBH1DwUdVIcO+jTQCUoAX8Rpdn3YpMSPOSpxHBMDHKCrCe50XjHxCBOVO1hwK/l4RT4uC8GJbf5KLnND5igNAvpncjX83GgZAv07aUbQgWT+fk5GL6+iAMlW5BLxNDwSrMwgIHi+rgvhlsgGAlZIx8X6g4+E/g/plzQt5ciu1iA7IpoyBr5UPQI6D5s8EEJ+EswRSiB4fFba6Bm5h7g5mALbA4z/dSZn5/DfbcTdlc/THeaob1+Dieq9iDr3B+QXRGNfD0f8lYfPPOo+DP4s3EKnO/lrStBRd7Kx1nDHnr7qdx3O5GnEuO9C5uRVRSFrKIo7JdHYr88kv77vQubceiTNyAleCgwbqfBmfDMnhQPxcYqcL6XB/9QElQTeSsfMsNOzJGeAIG2W3pkF/teeoXXt6Hw+jacbNyKfAMP+QYeTjZuReH1bZC38gOgFT2CdReJCc/k4hSQd0VD3hVND5Z3RUPWHo18Aw+d3xBYWl4ESZL47q4dDTeqkacSI6soClKCtwaOLeuBMscwof25WAWoQf6RtUdDqt+EY5/Eo6LuKD66lIHsYgH2yyPx59JI5BBRONm4FbJ2X/FgBNjCBs0Mp4Ds681rBHKvbUYOERUQ6mjI2n1j2Jo9z1BsGwr4h5IoaHmDzouGZvKwCuQQUTjVuWlNmAVeFPB6LDlEFLvAzoOvQ9YejVOdm1DQEYmCjsh1i7zI+HPI2qOx8+DrnL8VQ5T1GnKIKJy5sT3wydEtpFNuiofSlIjKPnFAqvolAfnUko5PLelr/s+cpzQlotwUH9DDv/eZG9uRQ0RBlPUaIiIiuH/spkRe0ry6Xrrrvy2LglVqukRoAAAAAElFTkSuQmCC%26lt%3B%21--%25AlertImg%25--%26gt%3B%0A%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E" rel="nofollow" title="Install Multi Translator">
				<![CDATA[Install this button]]>
			</html:a>
		</html:div>
		<html:a id="about" href="https://addons.mozilla.org/addon/custom-buttons/">
			<![CDATA[About CustomButtons]]>
		</html:a>
		<html:div id="credits">
			<html:a href="http://custombuttons.sourceforge.net/forum/viewtopic.php?t=3599">
				<![CDATA[XML created with]]>
				<html:br/>
				<![CDATA[CB Context Menu Extended]]>
			</html:a>
		</html:div>
	</html:div>
</html:body>
  <name>Multi Translator</name>
  <image><![CDATA[data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEElEQVQ4jaXSSUtDUQyG4afWCbFQwRERkW5EBX+AFUHQlbgQRV2oG1EodtWFOOA82x/t4qTQSWnxg8CFc5O8ST4alcEKXvxDRVS7SRhHCeWI6yhQrovzvwpM4Qb3TfGNDzzgshsi6MM7TuK7Yx1iD+tBsNFt52IkViX88W6Sh7GEpyhQwYwOR5jHGR5xi9MocoUjZJHHdlC2aBVf2MUkeqJoCW/oxWKM9YyB30iGMBEFmnUsLfg+GrZoMHArmGt6G5W8UIgxLqJZgzKBfyAtLl/3ti85dANb0q4W2lHkJPPMSteYxRg+g6Bm7TvsaHOhfqxJRnrFMjYlb0zX/VcMopF2FDUVpPPlJEPVL3YgyLI/5FwmASoiChQAAAAASUVORK5CYII=]]></image>
  <mode>0</mode>
  <initcode><![CDATA[if (self.parentNode && /^wrapper-/.test(self.parentNode.id))
	return;

var $ = this.MultiTranslator = {
	init: function() {
		if (!("Services" in window))
			Cu.import("resource://gre/modules/Services.jsm");
		if (!("OS" in window))
			Cu.import("resource://gre/modules/osfile.jsm");

		$.initPrefs();

		if (!($._UID in window)) {
			window[$._UID] = {
				CustomizableUI: false,
				Listeners: false,
				CleanSlateTimer: null,
				ElementCreationTimer: null,
				ResizingTimer: null,
				XULStyleSheet: false,
				HTMLStyleSheet: false,
				RandomID: false,
				FrameScriptLoaded: false,
				Preferences: {},
			};
		}

		self.tooltipText = "";
		self.setAttribute("tooltip", $._UID + "_self_tooltip");
		self.onclick = function(aE) {
			switch (aE.button) {
				case 0:
					aE.preventDefault();
					if ($._.pButtonClickActionLeft !== 0 && !aE.shiftKey && !$.accel(aE) && !aE.altKey)
						$._buttonClickActions($._.pButtonClickActionLeft, aE);
					else if ($._.pButtonClickActionLeftCtrl !== 0 && !aE.shiftKey && $.accel(aE) && !aE.altKey)
						$._buttonClickActions($._.pButtonClickActionLeftCtrl, aE);
					else if ($._.pButtonClickActionLeftShift !== 0 && aE.shiftKey && !$.accel(aE) && !aE.altKey)
						$._buttonClickActions($._.pButtonClickActionLeftShift, aE);
					else if ($._.pButtonClickActionLeftCtrlShift !== 0 && aE.shiftKey && $.accel(aE) && !aE.altKey)
						$._buttonClickActions($._.pButtonClickActionLeftCtrlShift, aE);
					break;
				case 1:
					aE.preventDefault();
					if ($._.pButtonClickActionMiddle !== 0 && !aE.shiftKey && !$.accel(aE) && !aE.altKey)
						$._buttonClickActions($._.pButtonClickActionMiddle, aE);
					break;
			}
			aE.stopPropagation();
		};

		if (!window[$._UID]["RandomID"]) {
			window[$._UID]["RandomID"] = parseInt(Math.random() * 10000, 10);
		}
		$._randomID = window[$._UID]["RandomID"];

		if (!window[$._UID]["FrameScriptLoaded"]) {
			window[$._UID]["FrameScriptLoaded"] = true;
			$._frameScript = "data:application/javascript," + encodeURIComponent($.getHelp("%FrameScript%")
				.replace(/%Translate_Sel_ID%/g, $._translateSelMsgID)
				.replace(/%On_Release_Icon_ID%/g, $._onReleaseIconMsgID)
				.replace(/%Move_Popup_ID%/g, $._movePopupMsgID)
				.replace(/%Cleanup_ID%/g, $._cleanupMsgID)
				.replace(/%Response_ID%/g, $._responseMsgID));
			$._globalMM.loadFrameScript($._frameScript, true);
			$._globalMM.addMessageListener($._responseMsgID, $._messageResponse);
		}

		for (let p in $.DefPrefs) {
			if ($.DefPrefs.hasOwnProperty(p))
				window[$._UID]["Preferences"][p] = $.gPref(p);
		}

		$._ = window[$._UID]["Preferences"];

		$.handleEngines();
		$.XULCSSLoader();
		$.HTMLCSSLoader();
		$.handlePrefObserver();
		$.addListeners();

		if ("CustomizableUI" in window) {
			if (!window[$._UID]["CustomizableUI"]) {
				window[$._UID]["CustomizableUI"] = true;
				CustomizableUI.addListener({
					onCustomizeEnd: function(aWindow) {
						var thisBtn = aWindow.document.getElementById(self.id);
						setTimeout(function() {
							aWindow[$._UID]["CustomizableUI"] && thisBtn.MultiTranslator.selfDestroy();
						}, Math.floor(Math.random() * (1 + 2000 - 200)) + 200);
					}
				});
			}
		}

		addDestructor(function(aReason) {
			if (aReason === "delete" || aReason === "update") {
				$.unInit();
			}
			if (aReason === "delete" || aReason === "destructor") {
				$._mm.sendAsyncMessage($._cleanUpMsgID);
				$._globalMM.removeDelayedFrameScript($._frameScript);
				$._globalMM.removeMessageListener($._responseMsgID, $._messageResponse);
			}
			if (aReason === "delete") {
				(Services.prefs.getBranch($.Branch)).deleteBranch("");
				Services.prefs.savePrefFile(null);
				delete window[$._UID];
			}
		});
	},

	loadItemsFile: function(aPath, aObjName) {
		OS.File.read(aPath).then(function onSuccess(aReadData) {
			let data = new TextDecoder().decode(aReadData);
			let count = aObjName === "PanelEngines" ? 3 : 2;
			data = JSON.parse(data);
			if (!data || data.length <= 0)
				return;
			let customEnginesObj = {};
			try {
				Array.prototype.slice.call(data).forEach(function(aObj) {
					customEnginesObj[++count] = aObj;
				});
			} finally {
				$[aObjName] = $.mergeObj(customEnginesObj, $[aObjName]);
				$.isOKToCreateElements = true;
			}
		}, function onFailure(aRejectReason) {
			OS.File.writeAtomic(aPath, JSON.stringify($.customEngines[aObjName], null, "\t"), {
				tmpPath: aPath + ".tmp",
				noOverwrite: true,
				encoding: "utf-8"
			}).then(function onSuccess() {
				$.loadItemsFile(aPath, aObjName);
			}, function onFailure(aRejectReason) {
				$.reportError(aRejectReason);
			});
		});
	},

	handleEngines: function() {
		$.URLBarEngines = $.defaultEngines.URLBarEngines;
		$.PanelEngines = $.defaultEngines.PanelEngines;

		let anyCustomEnabled = $._.pShowCustomURLBarEngines || $._.pShowCustomPanelEngines;
		let storagePath = $.storagePath;
		if (anyCustomEnabled) {
			$.isOKToCreateElements = false;
			let URLBarEnginesPath = OS.Path.join(storagePath, "URLBarEngines.json");
			let PanelEnginesPath = OS.Path.join(storagePath, "PanelEngines.json");
			$._.pShowCustomURLBarEngines && $.loadItemsFile(URLBarEnginesPath, "URLBarEngines");
			setTimeout(function() {
				$._.pShowCustomPanelEngines && $.loadItemsFile(PanelEnginesPath, "PanelEngines");
			}, 200);
		} else
			$.isOKToCreateElements = true;
		(function retry() {
			clearTimeout(window[$._UID]["ElementCreationTimer"]);
			window[$._UID]["ElementCreationTimer"] = setTimeout(function() {
				if ($.isOKToCreateElements)
					$.createElements(true);
				else
					retry();
			}, parseInt((anyCustomEnabled ? 200 : 10), 10));
		})();
	},

	customEngines: {
		"URLBarEngines": [{
			"label": "Bing Translator Auto To English",
			"command": "javascript:(function(){var%20s%20=%20document.createElement('scr'+'ipt');" +
				"%20s.type%20=%20'text/javascript';%20s.src%20=%20'http://labs.microsofttranslato" +
				"r.com/bookmarklet/default.aspx?f=js&to=en';%20document.body.insertBefore(s,%20do" +
				"cument.body.firstChild);})()",
			"image": 1,
			"tooltip": ""
		}, {
			"label": "Google Translator Auto To English",
			"command": "https://translate.google.com/translate?u=%%URL%%&hl=auto&langpair=auto|en" +
				"&tbb=1&ie=UTF-8",
			"image": 2,
			"tooltip": ""
		}],
		"PanelEngines": [{
			"label": "Google En To Ru",
			"image": 2,
			"method": "POST",
			"referer": "https://translate.google.com/?tab=yT#en",
			"action": "https://translate.google.com/",
			"post": "client=t&hl=en&sl=en&tl=ru&multires=1&prev=btn&ssel=0&tsel=0&sc=1&text=%%TEXT%%",
			"code": "UTF-8",
			"xpath": ".//span[@id=\"result_box\"]|.//div[@id=\"result_box\"]",
			"start": "",
			"end": ""
		}, {
			"label": "Google Ru To En",
			"image": 2,
			"method": "POST",
			"referer": "https://translate.google.com/?tab=yT#ru",
			"action": "https://translate.google.com/",
			"post": "client=t&hl=ru&sl=ru&tl=en&multires=1&prev=btn&ssel=0&tsel=0&sc=1&text=%%TEXT%%",
			"code": "UTF-8",
			"xpath": ".//span[@id=\"result_box\"]|.//div[@id=\"result_box\"]",
			"start": "",
			"end": ""
		}, {
			"label": "Weblio Translation English-Japanese",
			"image": "http://www.westatic.com/img/favicon/ejje.ico",
			"method": "POST",
			"referer": "http://translate.weblio.jp/",
			"action": "http://translate.weblio.jp/",
			"post": "lp=EJ&lpf=&rt=&translatedText=&tlt=english&prtRt=&originalText=%%TEXT%%&sentenceStyle=spoken",
			"code": "UTF-8",
			"xpath": "id(\"translatedText\")",
			"start": "",
			"end": ""
		}, {
			"label": "Weblio Translation Japanese-English",
			"image": "http://www.westatic.com/img/favicon/ejje.ico",
			"method": "POST",
			"referer": "http://translate.weblio.jp/",
			"action": "http://translate.weblio.jp/",
			"post": "lp=JE&lpf=&rt=&translatedText=&tlt=english&prtRt=&originalText=%%TEXT%%&sentenceStyle=spoken",
			"code": "UTF-8",
			"xpath": "id(\"translatedText\")",
			"start": "",
			"end": ""
		}]
	},

	defaultEngines: {
		"URLBarEngines": {
			"1": {
				"label": "Bing Translator",
				"command": "javascript:(function(){var%20s%20=%20document.createElement('scr'+'ipt');%20s.type%20=%20'text/javascript';%20s.src%20=%20'http://labs.microsofttranslator.com/bookmarklet/default.aspx?f=js&to=%%LNGTO%%';%20document.body.insertBefore(s,%20document.body.firstChild);})()",
				"image": 1,
				"tooltip": "Translate page with Bing Translator.\n\nThe source language is auto detected. The destination language is set from the Page translator options menu."
			},
			"2": {
				"label": "Google Translator",
				"command": "https://translate.google.com/translate?u=%%URL%%&hl=%%LNGTO%%&langpair=%%LNGFROM%%|%%LNGTO%%&tbb=1&ie=UTF-8",
				"image": 2,
				"tooltip": "Translate page with Google Translator.\n\nThe source/destination languages are set from the Page translator options menu."
			}
		},
		"PanelEngines": {
			"1": {
				"label": "Bing Translator",
				"image": 1,
				"method": "GET",
				"referer": "http://www.microsofttranslator.com/",
				"action": "http://api.microsofttranslator.com/V2/Ajax.svc/Translate?from=%22%%LNGFROM%%%22&to=%22%%LNGTO%%%22&loc=en&ctr=&text=%%TEXT%%",
				"post": "",
				"code": "UTF-8",
				"xpath": "",
				"start": "",
				"end": ""
			},
			"2": {
				"label": "Google Translator",
				"image": 2,
				"method": "POST",
				"referer": "https://translate.google.com/",
				"action": "https://translate.google.com/",
				"post": "client=t&hl=auto&sl=%%LNGFROM%%&tl=%%LNGTO%%&multires=1&prev=btn&ssel=0&tsel=0&sc=1&text=%%TEXT%%",
				"code": "UTF-8",
				"xpath": ".//span[@id=\"result_box\"]|.//div[@id=\"result_box\"]",
				"start": "",
				"end": ""
			},
			"3": {
				"label": "Yandex Translator",
				"image": 3,
				"method": "GET",
				"referer": "https://translate.yandex.net/",
				"action": "https://translate.yandex.net/api/v1.5/tr.json/translate?key=%%API_KEY%%&lang=%%LNGTO%%&text=%%TEXT%%&options=1",
				"post": "",
				"code": "UTF-8",
				"xpath": "",
				"start": "",
				"end": ""
			}
		}
	},

	populateSelfTooltip: function(aN) {
		aN.textContent = "";

		var grid = aN.appendChild($.$CNS("grid"));
		var cols = grid.appendChild($.$CNS("columns"));
		cols.appendChild($.$CNS("column", {
			flex: 2
		}));
		cols.appendChild($.$CNS("column", {
			flex: 3
		}));
		cols.appendChild($.$CNS("column", {
			flex: 1
		}));
		var rows = grid.appendChild($.$CNS("rows"));
		// Append Row
		let AR = function(aRowsNode, aLabel1, aLabel2, aLabel3, aEmpty) {
			let row = $.$CNS("row");
			if (aEmpty) {
				row.appendChild($.$CNS("label", {
					value: " ",
					width: 0,
				}));
			} else {
				row.appendChild($.$CNS("label", {
					value: aLabel1,
					style: "font-weight: bold;",
				}));
				row.appendChild($.$CNS("label", {
					value: aLabel2,
					style: "font-weight: bold;",
				}));
				let desc = $.$CNS("description", {
					width: 250,
				});
				desc.textContent = aLabel3; // Use of "textContent" to achieve word wrap. ¬¬
				row.appendChild(desc);
			}
			aRowsNode.appendChild(row);
		};
		let clickAction = function(aAction) {
			switch (aAction) {
				case 1:
					return "Open main menu";
				case 2:
					return "Translate selection";
				case 3:
					return "Translate current page";
				case 4:
					return "Translate clipboard content";
				case 5:
					return "Open page translation menu";
				case 6:
					return "Open options window";
			}
		};
		AR(rows, self.name, "→", "ID = " + self.id.slice(20));
		AR(rows, null, null, null, true);
		if ($._.pButtonClickActionLeft !== 0)
			AR(rows, "Left click", "→", clickAction($._.pButtonClickActionLeft));
		if ($._.pButtonClickActionMiddle !== 0)
			AR(rows, "Middle click", "→", clickAction($._.pButtonClickActionMiddle));
		if ($._.pButtonClickActionLeftCtrl !== 0)
			AR(rows, "Ctrl + Left click", "→", clickAction($._.pButtonClickActionLeftCtrl));
		if ($._.pButtonClickActionLeftShift !== 0)
			AR(rows, "Shift + Left click", "→", clickAction($._.pButtonClickActionLeftShift));
		if ($._.pButtonClickActionLeftCtrlShift !== 0)
			AR(rows, "Ctrl + Shift + Left click", "→", clickAction($._.pButtonClickActionLeftCtrlShift));
		AR(rows, null, null, null, true);
		if ($._.pTransOnRelease) {
			AR(rows, "Trans. selection trigger", "→", "Automatic after release");
			if ($._.pTransOnReleaseControlKey && $._.pTransOnRelease)
				AR(rows, "", "", $.accel() + " key is required");
			if ($._.pTransOnReleaseShiftKey && $._.pTransOnRelease)
				AR(rows, "", "", "Shift key is required");
			if ($._.pTransOnReleaseAltKey && $._.pTransOnRelease)
				AR(rows, "", "", "Alt key is required");
		}
		aN.appendChild($.$CNS("separator")); // Empty space
		let desc = $.$CNS("description", {
			style: "font-weight:bold;",
		});
		// Use of "textContent" to achieve word wrap. ¬¬
		desc.textContent = "Read this button help for very important usage notes.\n" +
			"Right click on button, \"Button Help\" item.";
		aN.appendChild(desc);
	},

	_buttonClickActions: function(aAction, aE) {
		switch (aAction) {
			case 1: // Open Main Menu
				let p = $.$($._UID + "_self_popup");
				p && p.openPopup(self, "after_start", 0, 0, false, null, null);
				break;
			case 2: // Translate selection
				$.translateSelection();
				break;
			case 3: // Translate current page
				$.translatePage(aE, gBrowser.selectedTab.linkedBrowser.currentURI, false);
				break;
			case 4: // Translate clipboard content
				$.translateClipboardContent();
				break;
			case 5: // Open Page translation menu
				let m = $.$($._UID + "_translationIconOnURLBarMenu");
				m && m.openPopup(self, "after_start", 0, 0, false, null, null);
				break;
			case 6: // Open options window
				$.openOptions();
				break;
		}
	},

	_messageResponse: {
		receiveMessage: function(aMsg) {
			if (aMsg.name !== $._responseMsgID)
				return;
			switch (aMsg.data.id) {
				case 1: // Translate selection directly
				case 2: // Translate selection from mouseover icon
					$.doTranslation(aMsg.data.sel);
					break;
				case 3: // Move the popup to selection
					if ($._.pPanelTransUseTextbox) {
						let d = $.dummyPanel;
						d && d.openPopup(null, "", 0, 0, false, null, null);
					}
					let p = $.transPanel;
					if (p.state === "open")
						p.moveTo(aMsg.data.posX, aMsg.data.posY);
					else
						p.openPopupAtScreen(aMsg.data.posX, aMsg.data.posY, false);
					clearTimeout(window[$._UID]["ResizingTimer"]);
					window[$._UID]["ResizingTimer"] = setTimeout(function() {
						$.sizeChange();
					}, 10);
					break;
			}
		},
	},

	unInit: function() {
		let selfEls = document.getElementsByAttribute("cb_id", $._UID);
		Array.prototype.slice.call(selfEls).forEach(function(aEl) { // Delete all elements created by this button.
			aEl && aEl.parentNode.removeChild(aEl);
		});
		clearTimeout(window[$._UID]["ElementCreationTimer"]);
		clearTimeout(window[$._UID]["ResizingTimer"]);
		clearTimeout(window[$._UID]["CleanSlateTimer"]);
		$.handlePrefObserver(true);
		$.removeListeners();
	},

	addListeners: function() {
		if (!window[$._UID]["Listeners"]) {
			window[$._UID]["Listeners"] = true;
			["click", "mousedown", "mouseup"].forEach(function(aLi) {
				if ("gBrowser" in window) {
					gBrowser.addEventListener(aLi, $.onReleaseListener, true);
				} else if ($.$("tabpanelcontainer")) { // Thunderbird main window
					$.$("tabpanelcontainer").addEventListener(aLi, $.onReleaseListener, true);
				} else if ($.$("messagepane")) { // Message window
					$.$("messagepanebox").addEventListener(aLi, $.onReleaseListener, true);
				}
			});
		}
	},

	// aInverse argument is for when removeListeners is called from prefObserver (After the pTransOnRelease pref. is changed.).
	removeListeners: function(aInverse) {
		["click", "mousedown", "mouseup"].forEach(function(aLi) {
			if ("gBrowser" in window) {
				gBrowser.removeEventListener(aLi, $.onReleaseListener, true);
			} else if ($.$("tabpanelcontainer")) { // Thunderbird main window
				$.$("tabpanelcontainer").removeEventListener(aLi, $.onReleaseListener, true);
			} else if ($.$("messagepane")) { // Message window
				$.$("messagepanebox").removeEventListener(aLi, $.onReleaseListener, true);
			}
		});
		let ctxM = $.$("contentAreaContextMenu") || $.$("mailContext");
		ctxM.removeEventListener("popupshowing", $.contextMenuListener, false);
		window[$._UID]["Listeners"] = false;
	},

	assignImages: function(aN) {
		Array.prototype.slice.call(aN.getElementsByAttribute("data-panel-engine", "*")).forEach(function(aMI) {
			aMI && aMI.setAttribute("image", $.getEng("image",
				Boolean(Number(aMI.getAttribute("data-panel-engine")))));
		});
	},

	createElements: function(aInit) {
		var popSet = $.$("mainPopupSet");
		let selfPop = $.$($._UID + "_self_popup");
		let that = "document.getElementById('" + self.id + "').MultiTranslator.";
		if (popSet && !selfPop) {
			selfPop = popSet.appendChild($.$CNS("menupopup", {
				id: $._UID + "_self_popup",
				cb_id: $._UID,
				consumeoutsideclicks: false,
				orient: "vertical",
				onpopupshowing: that + "assignImages(this);event.stopPropagation();",
				onpopuphidden: "event.stopPropagation();",
				oncommand: "event.stopPropagation();",
				onclick: "event.stopPropagation();",
			}));
			selfPop.appendChild($.$CNS("menuitem", {
				label: "Translate selection",
				class: "menuitem-iconic",
				"data-panel-engine": 1,
				key: $._.pHotkeyTransSelEnabled ? "key" + $._UID + "_translate_selection" : "",
				onclick: that + "translateSelection();event.stopPropagation();",
			}));
			if ("gBrowser" in window) {
				selfPop.appendChild($.$CNS("menuitem", {
					label: "Translate current page",
					class: "menuitem-iconic",
					"data-panel-engine": 0,
					key: $._.pHotkeyTransPageEnabled ? "key" + $._UID + "_translate_page" : "",
					onclick: that + "translatePage(event, gBrowser.selectedTab.linkedBrowser.currentURI, true);event.stopPropagation();",
				}));
			}
			selfPop.appendChild($.$CNS("menuitem", {
				label: "Translate clipboard content",
				class: "menuitem-iconic",
				"data-panel-engine": 1,
				key: $._.pHotkeyTransClipEnabled ? "key" + $._UID + "_translate_clipboard" : "",
				onclick: that + "translateClipboardContent();event.stopPropagation();",
			}));
			selfPop.appendChild($.$CNS("menuseparator"));
			selfPop.appendChild($.$CNS("menu", {
				label: "Options",
			})).appendChild($.$CNS("menupopup", {
				consumeoutsideclicks: false,
				onpopupshowing: that + "populateOptionsPopup(this);event.stopPropagation();",
			}));
		}

		let keyset = $.$($._UID + "_keyset");
		if (popSet && !keyset) { // Using "my own" keyset seems to minimize hotkeys erratic behaivor.
			popSet.parentNode.appendChild($.$CNS("keyset", {
				id: $._UID + "_keyset",
				cb_id: $._UID,
			}));
		}

		let selfTT = $.$($._UID + "_self_tooltip");
		if (popSet && !selfTT) {
			popSet.appendChild($.$CNS("tooltip", {
				id: $._UID + "_self_tooltip",
				cb_id: $._UID,
				orient: "vertical",
				onpopupshowing: that + "populateSelfTooltip(this);event.stopPropagation();",
				onpopuphidden: "event.stopPropagation();",
			}));
		}

		let ctxM = $.$("mailContext") || $.$("contentAreaContextMenu");
		let ctxTSelMI = $.$($._UID + "_translate_selection_context");
		let ctxTPageMI = $.$($._UID + "_translate_page_context");
		let ctxTPageM = $.$($._UID + "_translate_page_menu_context");
		let ctxTClipMI = $.$($._UID + "_translate_clipboard_context");
		let insertPoint = $.$("mailContext-spell-suggestions-separator") || $.$("spell-suggestions-separator");

		if (ctxM && !ctxTSelMI && $._.pShowTransSelCtx) {
			ctxTSelMI = $.$CNS("menuitem", {
				label: "Translate selection",
				cb_id: $._UID,
				id: $._UID + "_translate_selection_context",
				class: "menuitem-iconic",
				image: $.getEng("image", true),
				key: $._.pHotkeyTransSelEnabled ? "key" + $._UID + "_translate_selection" : "",
				onclick: that + "translateSelection();event.stopPropagation();",
			});
			ctxM.insertBefore(ctxTSelMI, insertPoint.nextSibling);
			ctxM.addEventListener("popupshowing", $.contextMenuListener, false);
		}

		if ($._.pShowTransPageCtx && "gBrowser" in window) {
			if (!$._.pShowTransPageCtxMenuMode && ctxM && !ctxTPageMI) {
				ctxTPageMI = $.$CNS("menuitem", {
					label: "Translate current page",
					cb_id: $._UID,
					id: $._UID + "_translate_page_context",
					class: "menuitem-iconic",
					image: $.getEng("image", false),
					key: $._.pHotkeyTransPageEnabled ? "key" + $._UID + "_translate_page" : "",
					onclick: that + "translatePage(event, gBrowser.selectedTab.linkedBrowser.currentURI, true);event.stopPropagation();",
				});
				ctxM.insertBefore(ctxTPageMI, insertPoint.nextSibling);
			} else if ($._.pShowTransPageCtxMenuMode && ctxM && !ctxTPageM) {
				ctxTPageM = $.$CNS("menu", {
					label: "Translate current page",
					cb_id: $._UID,
					id: $._UID + "_translate_page_menu_context",
					class: "menu-iconic",
					image: $.images[0],
				});
				ctxTPageM.appendChild($.$CNS("menupopup", {
					consumeoutsideclicks: false,
					onpopupshowing: that + "populateTranslatePageMenu(this);event.stopPropagation();",
					oncommand: "event.stopPropagation();",
					onclick: that + "translatePage(event, gBrowser.selectedTab.linkedBrowser.currentURI, null, true);event.stopPropagation();",
				}));
				ctxM.insertBefore(ctxTPageM, insertPoint.nextSibling);
			}
		}

		if (ctxM && !ctxTClipMI && $._.pShowTransClipCtx) {
			ctxTClipMI = $.$CNS("menuitem", {
				label: "Translate clipboard content",
				cb_id: $._UID,
				id: $._UID + "_translate_clipboard_context",
				class: "menuitem-iconic",
				image: $.getEng("image", true),
				key: $._.pHotkeyTransClipEnabled ? "key" + $._UID + "_translate_clipboard" : "",
				onclick: that + "translateClipboardContent();event.stopPropagation();",
			});
			ctxM.insertBefore(ctxTClipMI, insertPoint.nextSibling);
		}

		let transPanel = $.transPanel;
		if (!transPanel) {
			transPanel = popSet.appendChild($.$CNS("panel", {
				id: $._UID + "_translationPanel",
				label: $.getEng("label", true),
				cb_id: $._UID,
				orient: "horizontal",
				consumeoutsideclicks: false,
				close: $._.pPanelTransShowTitleBar,
				titlebar: $._.pPanelTransShowTitleBar ? "normal" : "",
				level: "top",
				backdrag: true,
				noautohide: true,
				width: $._.pPanelTransMaxWidth,
				maxwidth: screen.availWidth,
				maxheight: screen.availHeight,
				flex: 0,
				onpopupshown: that + "setPanelLangListLabel(this);",
			}));
			let resizerBoxLeft = transPanel.appendChild($.$CNS("vbox", {
				id: $._UID + "_resizerBoxLeft",
			}));
			if ($._.pPanelTransShowTitleBar) {
				resizerBoxLeft.appendChild($.$CNS("resizer", {
					"data-corner": true,
					element: $._UID + "_translationPanel",
					type: "window",
					dir: "topleft",
					left: "0",
					top: "0",
					width: "6",
					height: "10",
				}));
				resizerBoxLeft.appendChild($.$CNS("resizer", {
					element: $._UID + "_translationPanel",
					type: "window",
					flex: 1,
					dir: "left",
					width: "6",
				}));
			} else {
				resizerBoxLeft.appendChild($.$CNS("spacer", {
					flex: 1
				}));
			}
			resizerBoxLeft.appendChild($.$CNS("resizer", {
				"data-corner": true,
				element: $._UID + "_translationPanel",
				type: "window",
				dir: "bottomleft",
				left: "0",
				bottom: "0",
				width: "6",
				height: "10",
			}));
			let transPanelVBox = transPanel.appendChild($.$CNS("vbox", {
				id: $._UID + "_translationPanelMainBox",
				flex: 1
			}));
			if ($._.pPanelTransShowOptionsBox) {
				let optBox = transPanelVBox.appendChild($.$CNS("hbox", {
					id: $._UID + "_translationOptionsBox",
					flex: 1,
					align: "baseline"
				}));
				optBox.appendChild($.$CNS("toolbarbutton", {
					id: $._UID + "_translationOptionsButton",
					tooltiptext: "Options",
					image: $.getEng("image", true),
					type: "menu",
					popup: $._UID + "_translation_options",
				}));
				optBox.appendChild($.$CNS("label", {
					value: "From: ",
					style: "font-weight:bold;"
				}));
				optBox.appendChild($.$CNS("toolbarbutton", {
					id: $._UID + "_languageSelectionButtonFrom",
					type: "menu",
					tooltiptext: "Select source language",
					_pref: "pPanelTransFromLang",
				})).appendChild($.$CNS("menupopup", {
					class: $._UID + "_lang_list",
					consumeoutsideclicks: false,
					onpopupshowing: "event.stopPropagation();",
					"data-langlist": "{'pref':'pPanelTransFromLang', 'dir': 'from'}",
				}));
				optBox.appendChild($.$CNS("label", {
					value: "To: ",
					style: "font-weight:bold;"
				}));
				optBox.appendChild($.$CNS("toolbarbutton", {
					id: $._UID + "_languageSelectionButtonTo",
					type: "menu",
					tooltiptext: "Select destination language",
					_pref: "pPanelTransToLang",
				})).appendChild($.$CNS("menupopup", {
					class: $._UID + "_lang_list",
					consumeoutsideclicks: false,
					onpopupshowing: "event.stopPropagation();",
					"data-langlist": "{'pref':'pPanelTransToLang', 'dir': 'to'}",
				}));
				optBox.appendChild($.$CNS("spacer", {
					flex: 1
				}));
				transPanelVBox.appendChild($.$CNS("separator", {
					class: "thin"
				}));
			}
			let vBox1 = transPanelVBox.appendChild($.$CNS("vbox", {
				id: $._UID + "_translationResultBox",
				flex: 100000,
				onclick: that + "clickOnTransResult(this.firstChild.value || this.firstChild.textContent, this);event.stopPropagation();",
			}));
			if ($._.pPanelTransUseTextbox) {
				let dummyPanel = $.dummyPanel;
				if (!dummyPanel) {
					dummyPanel = popSet.appendChild($.$CNS("panel", {
						id: $._UID + "_translationPanelDummy",
						cb_id: $._UID,
						orient: "vertical",
						consumeoutsideclicks: "false",
						onpopupshown: "this.onpopupshown(event);",
						style: "opacity:0 !important;",
						flex: 1,
					}));
					dummyPanel.onpopupshown = function(aE) {
						setTimeout(function() {
							aE.target.hidePopup();
						}, 100);
						aE.stopPropagation();
					};
					dummyPanel.appendChild($.$CNS("description", {
						id: $._UID + "_translationResultContentDummy",
						flex: 1,
					}));
				}
				vBox1.appendChild($.$CNS("textbox", {
					id: $._UID + "_translationResultContent",
					class: "as_textbox",
					flex: 100000,
					readonly: true,
					focused: true,
					multiline: true,
					newlines: "pasteintact"
				}));
			} else {
				vBox1.appendChild($.$CNS("description", {
					id: $._UID + "_translationResultContent",
					class: "not_as_textbox"
				}));
			}
			if ($._.pPanelTransShowFooter) {
				transPanelVBox.appendChild($.$CNS("separator", {
					class: "thin",
					"data-opt": "footer",
				}));
				let footerBox = transPanelVBox.appendChild($.$CNS("hbox", {
					id: $._UID + "_translationResultFooterBox",
					"data-opt": "footer",
					align: "baseline",
					flex: 0,
				}));
				footerBox.appendChild($.$CNS("spacer", {
					flex: 1
				}));
				footerBox.appendChild($.$CNS("description", {
					value: "Service provided by ",
					mousethrough: "always",
					style: "margin-right:0;",
				}));
				footerBox.appendChild($.$CNS("description", {
					id: $._UID + "_translationResultFooter",
					mousethrough: "never",
					onclick: that + "openPage(this.url, event);event.stopPropagation();",
					style: "margin-left:0;font-weight:bold;cursor:pointer;",
				}));
			}
			let resizerBoxRight = transPanel.appendChild($.$CNS("vbox", {
				id: $._UID + "_resizerBoxRight",
			}));
			if (!$._.pPanelTransShowTitleBar) {
				resizerBoxRight.appendChild($.$CNS("toolbarbutton", {
					id: $._UID + "_translationClosePanelButton",
					tooltiptext: "Close panel",
					oncommand: "event.stopPropagation();",
					onclick: that + "forceHidePanel();event.stopPropagation();",

				}));
			} else {
				resizerBoxRight.appendChild($.$CNS("resizer", {
					"data-corner": true,
					element: $._UID + "_translationPanel",
					type: "window",
					dir: "topright",
					right: "0",
					top: "0",
					width: "6",
					height: "10",
				}));
			}
			resizerBoxRight.appendChild($.$CNS("resizer", {
				element: $._UID + "_translationPanel",
				type: "window",
				flex: 1,
				dir: "right",
				width: "6",
			}));
			resizerBoxRight.appendChild($.$CNS("resizer", {
				"data-corner": true,
				element: $._UID + "_translationPanel",
				type: "window",
				dir: "bottomright",
				right: "0",
				bottom: "0",
				width: "6",
				height: "10",
			}));
			// Save panel width
			resizerBoxRight.onmouseup = function(aE) {
				$.sPref("pPanelTransMaxWidth", Number(transPanel.width));
				aE.stopPropagation();
			};
			// Remove all heights to allow resizing.
			resizerBoxRight.onmousedown = resizerBoxLeft.onmousedown = function(aE) {
				if (aE.target.hasAttribute("data-corner")) {
					let resBox = $.$($._UID + "_translationResultBox");
					resBox.style.height = resBox.style.minHeight = resBox.style.maxHeight = "";
				}
				aE.stopPropagation();
			};
		}

		if (!$.$($._UID + "_languageSelectionTooltip")) {
			let tt = popSet.appendChild($.$CNS("tooltip", {
				id: $._UID + "_languageSelectionTooltip",
				cb_id: $._UID,
				onpopupshowing: "event.stopPropagation();",
			}));
			tt.appendChild($.$CNS("description", {
				value: "𝗟𝗲𝗳𝘁 𝗰𝗹𝗶𝗰𝗸: Set language"
			}));
			tt.appendChild($.$CNS("description", {
				value: "𝗥𝗶𝗴𝗵𝘁 𝗰𝗹𝗶𝗰𝗸: Hide/Show language from list"
			}));
		}

		let m = $.$($._UID + "_translation_options");
		if (popSet && !m) {
			popSet.appendChild($.$CNS("menupopup", {
				id: $._UID + "_translation_options",
				consumeoutsideclicks: false,
				cb_id: $._UID,
				onpopupshowing: that + "populateOptionsPopup(this);event.stopPropagation();",
				position: "after_start",
			}));
		}

		$.handleURLBarIcon();

		if (aInit) {
			$.createHotkeys();
			$.populateAllLangLists();
		}
	},

	handleURLBarIcon: function(aRem) {
		var popSet = $.$("mainPopupSet");
		let icn = $.urlBarIcon;
		let that = "document.getElementById('" + self.id + "').MultiTranslator.";
		if (aRem)
			icn && icn.parentNode.removeChild(icn);
		if ($._.pPageTransURLBarIconShow) {
			let URLBar = $.$("urlbar-icons");
			if (URLBar && !$.urlBarIcon) {
				URLBar.appendChild($.$CNS("image", {
					id: $._UID + "_translationIconOnURLBar",
					tooltip: $._UID + "_translationIconOnURLBarTooltip",
					cb_id: $._UID,
					class: "urlbar-icon",
					context: $._UID + "_translation_options",
					src: $.getEng("image"),
					oncommand: "event.stopPropagation();",
					onclick: ($._.pPageTransURLBarIconMenuMode ?
							"if (event.button === 0) document.getElementById('" + $._UID +
							"_translationIconOnURLBarMenu').openPopup(this, '', 0, 0, false, null, null);" :
							that + "translatePage(event, gBrowser.selectedTab.linkedBrowser.currentURI);") +
						"event.stopPropagation();",
				}));
				if (!$.$($._UID + "_translationIconOnURLBarTooltip")) {
					popSet.appendChild($.$CNS("tooltip", {
						id: $._UID + "_translationIconOnURLBarTooltip",
						cb_id: $._UID,
						onpopupshowing: that + "updateIconOnURLBarTooltip(this);event.stopPropagation();",
					}));
				}
			}

			if ($._.pPageTransURLBarIconMenuMode) {
				if (popSet && !$.$($._UID + "_translationIconOnURLBarMenu")) {
					let urlMenu = popSet.appendChild($.$CNS("menupopup", {
						id: $._UID + "_translationIconOnURLBarMenu",
						orient: "vertical",
						cb_id: $._UID,
						position: "after_start",
						consumeoutsideclicks: false,
						onpopupshowing: that + "populateTranslatePageMenu(this);event.stopPropagation();",
						oncommand: "event.stopPropagation();",
						onclick: that + "translatePage(event, gBrowser.selectedTab.linkedBrowser.currentURI, null, true);event.stopPropagation();",
					}));
				}
			}
		}
	},

	createHotkeys: function() {
		let that = "document.getElementById('" + self.id + "').MultiTranslator.";
		let hotKeys = [{
			id: "key" + $._UID + "_translate_selection",
			combo: $._.pHotkeyTransSel,
			enabled: $._.pHotkeyTransSelEnabled,
			cmd: that + "translateSelection();event.stopPropagation();",
		}, {
			id: "key" + $._UID + "_translate_page",
			combo: $._.pHotkeyTransPage,
			enabled: $._.pHotkeyTransPageEnabled,
			cmd: that + "translatePage(event, gBrowser.selectedTab.linkedBrowser.currentURI, true);event.stopPropagation();",
		}, {
			id: "key" + $._UID + "_translate_clipboard",
			combo: $._.pHotkeyTransClip,
			enabled: $._.pHotkeyTransClipEnabled,
			cmd: that + "translateClipboardContent();event.stopPropagation();",
		}];
		var keyset = $.$($._UID + "_keyset");
		Array.prototype.slice.call(hotKeys).forEach(function(aHK, aIndex) {
			let combo = $.getCombo(aHK["combo"].trim());
			let key = combo.substring(combo.lastIndexOf("-") + 1, combo.length);
			let modifiers = combo.slice(0, -(key.length + 1)).split("-").join(",");
			if (key && modifiers && keyset) {
				let attr = key.length === 1 ? "key" : "keycode";
				let hk = keyset.appendChild($.$CNS("key", {
					id: aHK["id"],
					modifiers: modifiers,
					disabled: !aHK["enabled"],
					oncommand: aHK["cmd"],
				}));
				hk.setAttribute(attr, key.length === 1 ? key : "VK_" + key); // Set "keycode" or "key" attribute.
			}
		});
	},

	getCombo: function(aHKStr) {
		var prefix = "";
		if (aHKStr.search("Alt+") !== -1)
			prefix += "alt-";
		if (aHKStr.search("Ctrl+") !== -1)
			prefix += "control-";
		if (aHKStr.search("Shift+") !== -1)
			prefix += "shift-";
		if (aHKStr.search("Meta+") !== -1)
			prefix += "meta-";
		return prefix + aHKStr.substring(aHKStr.lastIndexOf("+") + 1, aHKStr.length);
	},

	contextMenuListener: function() {
		let sCtx = $.$($._UID + "_translate_selection_context");
		let pCtx = $.$($._UID + "_translate_page_context");
		let cCtx = $.$($._UID + "_translate_clipboard_context");
		sCtx.hidden = !(gContextMenu.isTextSelected || gContextMenu.isContentSelected);
		sCtx.image = $.getEng("image", true);
		$._.pPageTransURLBarIconMenuMode || (pCtx && (pCtx.image = $.getEng("image", false)));
		pCtx && (pCtx.image = $.getEng("image", true));
	},

	populateTranslatePageMenu: function(aN) {
		aN.textContent = "";

		let URLBEng = $.URLBarEngines;
		let img = function(aObj, aKey) {
			if (typeof aObj[aKey].image === "number")
				return $.images[aObj[aKey].image];
			return aObj[aKey].image;
		};
		for (let book in URLBEng) {
			if (URLBEng.hasOwnProperty(book)) {
				if (!!URLBEng[book].label && !!URLBEng[book].command) {
					aN.appendChild($.$CNS("menuitem", {
						label: URLBEng[book].label,
						class: "menuitem-iconic",
						tooltiptext: !!URLBEng[book].tooltip ? URLBEng[book].tooltip : "",
						image: img(URLBEng, parseInt(book, 10)) || "",
						value: parseInt(book, 10),
					}));
				}
			}
		}
	},

	/**
	 * [translatePage description]
	 * @param  {Object} aE                    Event that triggered this function.
	 * @param  {Object} aURIOfSiteToTranslate URi of the site that will be translated.
	 * @param  {Boolen} aHotKey               If the function is triggered by a hotkey.
	 * @param  {Integer} aEngFromMenu          If the function is triggered by the page translator menu,
	 *                                        get the engine from it.
	 */
	translatePage: function(aE, aURIOfSiteToTranslate, aHotKey, aEngFromMenu) {
		aE.preventDefault();
		if (!aURIOfSiteToTranslate.schemeIs("http") &&
			!aURIOfSiteToTranslate.schemeIs("https") && !("gBrowser" in window))
			return false;

		let btn = aE.button;
		if (btn === 2)
			return;
		if (btn === 0 || aHotKey) // Left click and Hotkey triggers the same action.
			$.openURLIn($._.pPageTransURLBarIconLeftClick, aURIOfSiteToTranslate.spec, aE.target.value);
		else if (btn === 1)
			$.openURLIn($._.pPageTransURLBarIconMiddleClick, aURIOfSiteToTranslate.spec, aEngFromMenu);
		aE.stopPropagation();
	},

	openURLIn: function(aWhere, aSiteToTranslate, aEngFromMenu) {
		var engine = aEngFromMenu ? aEngFromMenu : $._.pPageTransEngine;
		var urlForNewTab = (/^javascript:/.test($.URLBarEngines[engine].command) ?
			aSiteToTranslate :
			"about:blank");
		try {
			if (aWhere === 1) {
				window.addEventListener("DOMContentLoaded", function _(aE) {
					window.removeEventListener("DOMContentLoaded", _, true);
					setTimeout(function() {
						$.doPageTranslation(engine, aSiteToTranslate, "current", {
							inBackground: false
						});
					}, 100);
				}, true);
			}
		} finally {
			switch (aWhere) {
				case 0: // Current
					$.doPageTranslation(engine, aSiteToTranslate, "current", {
						inBackground: false
					});
					break;
				case 1: // Next to current
					let pos = gBrowser.selectedTab._tPos || gBrowser.tabContainer.selectedIndex; // Firefox || SeaMonkey
					gBrowser.moveTabTo(gBrowser.selectedTab = gBrowser.addTab(urlForNewTab), pos + 1);
					break;
				case 2: // New tab in background
					$.doPageTranslation(engine, urlForNewTab, "tab", {
						inBackground: true
					});
					break;
				case 3: // New tab in foreground
					$.doPageTranslation(engine, urlForNewTab, "tab", {
						inBackground: false
					});
					break;
			}
		}
	},

	doPageTranslation: function(aEngine, aSiteToTranslate, aWhere, aParams) {
		var lFrom = $._.pPageTransFromLang,
			lTo = $._.pPageTransToLang;
		var bookCmd = $.URLBarEngines[aEngine].command;
		bookCmd = bookCmd.replace(/%%LNGTO%%/g, lTo.toString())
			.replace(/%%LNGFROM%%/g, ((lFrom === "" && aEngine === 2) ? "auto" : lFrom.toString()))
			.replace(/%%URL%%/g, encodeURIComponent(aSiteToTranslate));
		setTimeout(function() {
			window.openUILinkIn(bookCmd, aWhere, aParams);
		}, 100);
	},

	updateIconOnURLBarTooltip: function(aN) {
		aN.textContent = "";

		var eng = $._.pPageTransEngine,
			lC = $._.pPageTransURLBarIconLeftClick,
			mC = $._.pPageTransURLBarIconMiddleClick;
		let rows = aN.appendChild($.$CNS("grid")).appendChild($.$CNS("rows"));
		let getWhere = function(aWhere) {
			switch (aWhere) {
				case 0:
					return "in current tab.";
				case 1:
					return "in new tab next to current one.";
				case 2:
					return "in a new tab in the background.";
				case 3:
					return "in a new tab in the foreground.";
			}
		};
		let appendRow = function(aLbl1, aLbl2) {
			let lbl1 = rows.appendChild($.$CNS("row"));
			lbl1.appendChild($.$CNS("label", {
				value: aLbl1,
				style: "font-weight: bold;",
			}));
			lbl1.appendChild($.$CNS("label", {
				value: aLbl2,
			}));
		};
		appendRow("Current engine : ", $.URLBarEngines[eng].label);
		rows.appendChild($.$CNS("row")).appendChild($.$CNS("label", {
			value: " ",
		}));
		appendRow("Left click : ", ($._.pPageTransURLBarIconMenuMode ?
			"Open menu - Translate page " :
			"Translate page ") + getWhere(lC));
		appendRow("Middle click : ", "Translate page " + getWhere(mC));
		rows.appendChild($.$CNS("row")).appendChild($.$CNS("label", {
			value: " ",
		}));
		appendRow("Right click : ", "Open options menu.");
	},

	setPanelLangListLabel: function(aPanel) {
		if (!$._.pPanelTransShowOptionsBox)
			return true;
		let mLs = [$._UID + "_languageSelectionButtonTo", $._UID + "_languageSelectionButtonFrom"];
		Array.prototype.slice.call(mLs).forEach(function(aBtnID) {
			let btn = $.$(aBtnID);
			btn.label = $.langs[$._[btn.getAttribute("_pref")]];
		});
	},

	onReleaseListener: function(aE) {
		switch (aE.type) {
			case "mouseup":
				if (aE.button !== 0 || !$.onReleaseModifiers(aE))
					return;
				setTimeout(function() {
					if ($._.pTransOnReleaseShowIcon) {
						if ($.transPanel.state === "open")
							$.translateSelection();
						else
							$.onReleaseIcon(aE);
					} else
						$.translateSelection();
				}, 100);
				break;
			case "click":
			case "mousedown":
				if (aE.button !== 0 && !$.onReleaseModifiers(aE))
					return;

				if (!$._.pPanelTransKeepItOpen)
					$.forceHidePanel();
				break;
		}
	},

	onReleaseModifiers: function(aE) {
		let useCtrlKey = $._.pTransOnReleaseControlKey,
			useShiftKey = $._.pTransOnReleaseShiftKey,
			useAltKey = $._.pTransOnReleaseAltKey;
		if ($.accel(aE) && aE.shiftKey && aE.altKey && (!useCtrlKey || !useShiftKey || !useAltKey))
			return false;
		// XOR http://www.howtocreate.co.uk/xor.html
		if ($.accel(aE) ? !useCtrlKey : useCtrlKey)
			return false;
		if (aE.shiftKey ? !useShiftKey : useShiftKey)
			return false;
		if (aE.altKey ? !useAltKey : useAltKey)
			return false;
		return true;
	},

	forceHidePanel: function() {
		let p = $.transPanel;
		(p && p.state === "open") && p.hidePopup();
	},

	onReleaseIcon: function(aE) {
		$._mm.sendAsyncMessage($._onReleaseIconMsgID, {
			iconOffsetY: $._.pTransOnReleaseIconOffsetY,
			iconOffsetX: $._.pTransOnReleaseIconOffsetX,
			_UID: $._UID,
			clientY: aE.clientY,
			clientX: aE.clientX,
			image: $.getEng("image", true),
		});
	},

	translateSelection: function() {
		$._mm.sendAsyncMessage($._translateSelMsgID);
	},

	translateClipboardContent: function() {
		$.doTranslation(gClipboard.read());
	},

	doTranslation: function(aStr) {
		let engine = $.getEng(null, true);
		engine && $.getTranslateResult(aStr, engine);
	},

	getEng: function(aProperty, aForPanel) {
		var engs = aForPanel ? $.PanelEngines : $.URLBarEngines;
		let selProp = function(aProp, aKey) {
			switch (aProp) {
				case "image":
					if (typeof engs[aKey].image === "number")
						return $.images[engs[aKey].image];
					return engs[aKey].image;
				case "label":
					return engs[aKey].label;
				default:
					return aKey;
			}
		};

		for (var book in engs) {
			if (engs.hasOwnProperty(book)) {
				if (parseInt(book, 10) === parseInt((aForPanel ? $._.pPanelTransEngine : $._.pPageTransEngine), 10))
					return selProp(aProperty, parseInt(book, 10));
			}
		}

		$.sPref(aForPanel ? "pPanelTransEngine" : "pPageTransEngine", 2); // Defaults to Google translator
		return selProp(aProperty, 2);
	},

	openFailSafeURL: function(aURL) {
		if (!("gBrowser" in window)) {
			try {
				openContentTab(aURL);
			} catch (aError) {
				loadURI(aURL);
			}
			return;
		}
		switch ($._.pPanelTransFailSafeOpenURLWhere) {
			case 0: // Current
				loadURI(aURL);
				break;
			case 1: // Next to current
				let pos = gBrowser.selectedTab._tPos || gBrowser.tabContainer.selectedIndex; // Firefox || SeaMonkey
				gBrowser.moveTabTo(gBrowser.selectedTab = gBrowser.addTab(aURL), pos + 1);
				break;
			case 2: // New tab in background
				gBrowser.addTab(aURL);
				break;
			case 3: // New tab in foreground
				gBrowser.selectedTab = gBrowser.addTab(aURL);
				break;
		}
	},

	getTranslateResult: function(aStr, aEngine) {
		var Exp, xpath,
			popEng = $.PanelEngines[aEngine],
			maxLength = parseInt($._.pPanelMaxStringLength, 10);
		var SUC = Cc["@mozilla.org/intl/scriptableunicodeconverter"]
			.createInstance(Ci.nsIScriptableUnicodeConverter);
		SUC.charset = popEng.code;
		var str = SUC.ConvertFromUnicode(aStr),
			lgFrom = $._.pPanelTransFromLang,
			lgTo = $._.pPanelTransToLang;
		var url;
		var data;
		str = str.replace(/\s+/g, " ");
		if ($._.pPanelTransFailSafe && str.length > maxLength && aEngine <= 3) {
			str = $.$escape(str);
			switch (aEngine) {
				case 1:
					$.openFailSafeURL("https://www.bing.com/translator/?from=" + lgFrom + "&to=" +
						lgTo + "&text=" + str);
					return;
				case 2:
					$.openFailSafeURL("https://translate.google.com/?hl=" + lgTo + "&eotf=0&sl=" +
						lgFrom + "&tl=" + lgTo + "&text=" + str);
					return;
				case 3:
					$.openFailSafeURL("https://translate.yandex.com/?from=" + lgFrom + "&to=" +
						lgTo + "&text=" + str);
					return;
			}
		}
		str = str.substring(0, maxLength);

		if (!popEng.method)
			popEng.method = "GET";
		if (popEng.method === "POST") {
			url = popEng.action;
			data = popEng.post.replace(/%%LNGTO%%/g, lgTo).replace(/%%LNGFROM%%/g, lgFrom);
			data = data.replace(/%%TEXT%%/g, $.$escape(str).replace(/\+/g, "%2B"));
		} else {
			url = (aEngine === 3) ?
				popEng.action :
				popEng.action.replace(/%%LNGTO%%/g, lgTo).replace(/%%LNGFROM%%/g, lgFrom);
			url = url.replace(/%%TEXT%%/g, $.$escape(str).replace(/\+/g, "%2B"));
			data = null;
		}
		if (!popEng.xpath || popEng.xpath === "")
			Exp = new RegExp(popEng.start + "((.|\\r|\\n)*)" + popEng.end, "i");
		else
			xpath = popEng.xpath;
		$.show("Translating...", true);
		if (aEngine === 1) {
			$.BingAPI(popEng, url);
		} else if (aEngine === 3) {
			$.YandexAPI(popEng, url);
		} else {
			$.CB_xmlhttpRequest({
				method: popEng.method,
				overrideMimeType: "text/html; charset=" + popEng.code || "UTF-8",
				url: url,
				data: data,
				headers: {
					"Referer": popEng.referer || "",
					"Content-Type": "application/x-www-form-urlencoded"
				},
				onload: function(aRes) {
					gClipboard.write(aRes.responseText);

					var txt = aRes.responseText.toString();
					var res = null;
					try {
						if (!xpath) {
							res = txt.match(new RegExp(Exp.source, "i"));
							res = RegExp.$1;
						} else {
							var hdoc = $.str2dom(txt);
							var result = hdoc.evaluate(xpath, hdoc, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null); //.not(@value = 'auto')
							var node = result.snapshotLength > 0 ? result.snapshotItem(0) : null;
							res = node.innerText || node.textContent || node.value;
							node = hdoc = result = null;
						}
					} catch (e) {
						$.show("Failure to obtain.");
					}
					if (!!res) {
						$.show(res);
					} else {
						$.show("Failure to obtain.");
					}
				},
				onerror: function(aErr) {
					$.show("Error " + aErr.status + " occurred while receiving the document.");
				},
				ontimeout: function() {
					$.show("Timeout. Couldn't obtain translation result.");
				}
			});
		}
	},

	YandexAPI: function(aEngine, aURL) {
		let APIKeys = JSON.parse($._.pAPIKeysYandex);
		if (!APIKeys || APIKeys.length === 0) {
			$.show("There are no valid API keys.");
			return true;
		}
		var random = Math.floor(Math.random() * APIKeys.length - 1) + 1,
			lgFrom = $._.pPanelTransFromLang,
			lgTo = $._.pPanelTransToLang;
		let usedAPIKey = APIKeys[random];
		var url = aURL.replace("%%API_KEY%%", usedAPIKey)
			.replace("%%LNGTO%%", ((lgFrom === "") ? lgTo : lgFrom + "-" + lgTo));
		$.CB_xmlhttpRequest({
			method: aEngine.method,
			overrideMimeType: "text/html; charset=" + aEngine.code,
			url: url,
			data: null,
			headers: {
				"Content-Type": "application/x-www-form-urlencoded"
			},
			onload: function(aRes) {
				if (aRes.readyState === 4 && aRes.status === 200) {
					let txt = JSON.parse(aRes.responseText).text.toString();
					if (txt !== "")
						$.show(txt);
					else
						$.show("Failure to obtain.");
				} else {
					try {
						let res = JSON.parse(aRes.responseText);
						$.show("𝗘𝗿𝗿𝗼𝗿: " + res.code +
							"\n𝗠𝗲𝘀𝘀𝗮𝗴𝗲: " + res.message +
							"\n𝗔𝗣𝗜 𝗸𝗲𝘆: " + usedAPIKey);
					} catch (aErr) {
						$.show("𝗨𝗻𝗸𝗻𝗼𝘄𝗻 𝗲𝗿𝗿𝗼𝗿.");
					}
				}
			},
			onerror: function(aErr) {
				$.show("Error " + aErr.status + " occurred while trying to obtain translation result.");
			},
			ontimeout: function(aErr) {
				$.show("Timeout. Couldn't obtain translation result.\n" + aErr);
			}
		});
	},

	BingAPI: function(aEngine, aURL) {
		let APIKeys = JSON.parse($._.pAPIKeysBing);
		if (!APIKeys || APIKeys.length === 0) {
			$.show("There are no valid API keys.");
			return true;
		}
		var random = Math.floor(Math.random() * APIKeys.length - 1) + 1;
		let usedCLientID = APIKeys[random][0];
		let usedCLientSecret = APIKeys[random][1];
		$.CB_xmlhttpRequest({
			method: "POST",
			overrideMimeType: "text/html; charset=" + aEngine.code,
			url: "https://datamarket.accesscontrol.windows.net/v2/OAuth2-13",
			data: "grant_type=client_credentials" +
				"&client_id=" + encodeURIComponent(usedCLientID) +
				"&client_secret=" + encodeURIComponent(usedCLientSecret) +
				"&scope=http://api.microsofttranslator.com",
			headers: {
				"Content-Type": "application/x-www-form-urlencoded"
			},
			onload: function(aRes) {
				if (aRes.readyState === 4 && aRes.status === 200) {
					$.CB_xmlhttpRequest({
						method: aEngine.method,
						overrideMimeType: "text/html; charset=" + aEngine.code,
						url: aURL,
						data: null,
						headers: {
							"Authorization": "bearer " + JSON.parse(aRes.responseText).access_token,
							"Content-Type": "application/x-www-form-urlencoded"
						},
						onload: function(aRes2) {
							if (aRes2.readyState === 4 && aRes2.status === 200) {
								let txt = aRes2.responseText.toString().replace(/^\"/g, "").replace(/\"$/g, "");
								// txt = txt.replace(/\n/g, "<html:br />");
								if (txt !== "")
									$.show(txt);
								else
									$.show("Failure to obtain.");
							}
						},
						onerror: function(aErr) {
							$.show("Error " + aErr.status + " occurred while trying to obtain translation result.");
						},
						ontimeout: function() {
							$.show("Timeout. Couldn't obtain translation result.");
						}
					});
				} else {
					try {
						let res = JSON.parse(aRes.responseText);
						$.show("𝗘𝗿𝗿𝗼𝗿: " + res.error +
							"\n𝗠𝗲𝘀𝘀𝗮𝗴𝗲: " + res.error_description +
							"\n𝗖𝗹𝗶𝗲𝗻𝘁 𝗜𝗗: " + usedCLientID +
							"\n𝗖𝗹𝗶𝗲𝗻𝘁 𝗦𝗲𝗰𝗿𝗲𝘁: " + usedCLientSecret);
					} catch (aErr) {
						$.show("𝗨𝗻𝗸𝗻𝗼𝘄𝗻 𝗲𝗿𝗿𝗼𝗿.");
					}
				}
			},
			onerror: function(aErr) {
				$.show("Error " + aErr.status + " occurred while trying to obtain Bing API credentials.");
			},
			ontimeout: function() {
				$.show("Timeout. Couldn't obtain Bing API credentials.");
			}
		});
	},

	str2dom: function(aStr) {
		var xsl = (new DOMParser()).parseFromString([
			"<?xml version=\"1.0\"?>",
			"<stylesheet version=\"1.0\" xmlns=\"http://www.w3.org/1999/XSL/Transform\">",
			"<output method=\"html\"/>",
			"</stylesheet>"
		].join("\n"), "text/xml");

		var xsltp = new XSLTProcessor();
		xsltp.importStylesheet(xsl);
		var htmldoc = xsltp.transformToDocument(document.implementation.createDocument("", "", null));

		var range = htmldoc.createRange();
		htmldoc.appendChild(htmldoc.createElement("html"));
		range.selectNodeContents(htmldoc.documentElement);

		htmldoc.documentElement.appendChild(range.createContextualFragment(aStr));
		return htmldoc;
	},

	req: null,
	CB_xmlhttpRequest: function(aObj) {
		if (typeof(aObj) !== "object" || (typeof(aObj.url) !== "string" && !(aObj.url instanceof String)))
			return;
		if (!$.req)
			$.req = new XMLHttpRequest();
		var req = $.req;
		req.abort();
		req.timeout = $.TIMEOUT;

		req.reqestUrl = aObj.url;
		req.open(aObj.method || "GET", aObj.url, true);

		if (typeof(aObj.headers) === "object") {
			for (var i in aObj.headers)
				req.setRequestHeader(i, aObj.headers[i], false);
		}

		["onload", "onerror", "onreadystatechange", "ontimeout"].forEach(function(k) {
			if (aObj[k] && (typeof(aObj[k]) === "function" || aObj[k] instanceof Function))
				req[k] = function() {
					aObj[k]({
						status: (req.readyState === 4) ? req.status : 0,
						statusText: (req.readyState === 4) ? req.statusText : "",
						responseHeaders: (req.readyState === 4) ? req.getAllResponseHeaders() : "",
						responseText: req.responseText,
						readyState: req.readyState,
						finalUrl: (req.readyState === 4) ? req.channel.URI.spec : ""
					});
				};
		});

		if (aObj.overrideMimeType)
			req.overrideMimeType(aObj.overrideMimeType);
		if (typeof aObj.data === "string")
			req.send(aObj.data); // For POST
		else
			req.send(null); // For GET
	},

	openPage: function(aURL, aE) {
		try {
			gBrowser.selectedTab = gBrowser.addTab(aURL);
		} catch (aEr) {
			try {
				openContentTab(aURL);
			} catch (aError) {
				openUILink(aURL, aE);
			}
		}
	},

	setFooter: function() {
		let eng = $._.pPanelTransEngine;
		if (eng > 3 || !$._.pPanelTransShowFooter)
			return true;
		let data = [
			["Bing", "https://www.bing.com/translator/"],
			["Google", "https://translate.google.com/"],
			["Yandex", "https://translate.yandex.com/"],
		];
		let footer = $.$($._UID + "_translationResultFooter");
		try {
			footer.setAttribute("tooltiptext", "Go to " + data[eng - 1][0] + " Translator homepage");
			footer.url = data[eng - 1][1];
			footer.textContent = "«" + data[eng - 1][0] + " Translator»";
		} catch (aErr) {}
	},

	show: function(aRes, aIsTranslating) {
		let text = aRes.replace(/\n/g, "<html:br />");
		if ($._.pPanelTransUseTextbox) {
			// Insert text on a description element so I can get its height
			// to apply it then to the stupid dumb textbox. ¬¬
			$.$($._UID + "_translationResultContentDummy").textContent = $.escHTML(aRes);
			setTimeout(function() {
				$.$($._UID + "_translationResultContent").setAttribute("value", aRes);
			}, 10);
		} else
			$.$($._UID + "_translationResultContent").textContent = $.escHTML(aRes);
		$.setFooter();
		if ($._.pPanelTransAnchorToSelection) {
			$._mm.sendAsyncMessage($._movePopupMsgID, {
				_UID: $._UID,
				width: (fullScreen ? screen.width : screen.availWidth),
				height: (fullScreen ? screen.height : screen.availHeight),
			});
		} else
			$.openTransPop();
		clearTimeout(window[$._UID]["ResizingTimer"]);
		window[$._UID]["ResizingTimer"] = setTimeout(function() {
			$.sizeChange(aIsTranslating);
		}, 10);
	},

	openTransPop: function() {
		let node = $.$("content");
		if (!node)
			node = $.$("messagepane");
		$._.pPanelTransUseTextbox && $.dummyPanel.openPopup(null, "", 0, 0, false, null, null);
		$.transPanel.openPopup(node, "overlap", 0, 0, false, null, null);
	},

	sizeChange: function(aIsTranslating) {
		let panel = $.transPanel;
		let resBox = $.$($._UID + "_translationResultBox");
		if (aIsTranslating) {
			resBox.style.height = resBox.style.minHeight = resBox.style.maxHeight = "47px";
			return true;
		}
		if ($._.pPanelTransUseTextbox) {
			let dummyPanel = $.dummyPanel;
			dummyPanel.sizeTo(parseInt(resBox.boxObject.width, 10), "");
			resBox.style.height = resBox.style.minHeight = resBox.style.maxHeight =
				Number(dummyPanel.firstChild.scrollHeight) + 30 + "px";
		}
		clearTimeout(window[$._UID]["ResizingTimer"]);
		window[$._UID]["ResizingTimer"] = setTimeout(function() {
			panel.sizeTo($._.pPanelTransMaxWidth, Math.max(resBox.boxObject.height * 1.0 + 5, 23));
		}, 10);
	},

	populateOptionsPopup: function(aN) {
		$.getEng(null, true);
		let panelEngContainer, pageEngContainer;
		let tNode = aN.triggerNode;
		let that = "document.getElementById('" + self.id + "').MultiTranslator.";
		aN.textContent = "";

		aN.onclick = function(aE) {
			aE.stopPropagation();
		};
		if (!tNode || (tNode && tNode.id !== $._UID + "_translationIconOnURLBar")) {
			if (aN.id) {
				aN.appendChild($.$CNS("dialogheader", {
					title: "Engines for panel",
					tooltiptext: "Choose default engine for the panel translator.",
					style: "margin: 0 0 7px 0;padding: 2px 0 2px 5px;border:none;font-size:smaller;",
				}));
				panelEngContainer = aN;
			} else {
				panelEngContainer = aN.appendChild($.$CNS("menu", {
					label: "Engines for panel",
					tooltiptext: "Choose default engine for the panel translator.",
				})).appendChild($.$CNS("menupopup", {
					consumeoutsideclicks: false,
					onpopupshowing: "event.stopPropagation();",
				}));
			}
			let rGPop = panelEngContainer.appendChild($.$CNS("radiogroup"));
			var pEngs = $.PanelEngines;
			for (let eng in pEngs) {
				if (pEngs.hasOwnProperty(eng)) {
					rGPop.appendChild($.$CNS("menuitem", {
						label: pEngs[eng].label,
						type: "radio",
						closemenu: "none",
						onclick: "event.stopPropagation();",
						oncommand: that + "sPref('pPanelTransEngine', " + parseInt(eng, 10) +
							");event.stopPropagation();",
						checked: ($._.pPanelTransEngine === parseInt(eng, 10)),
					}));
				}
			}
			if (!tNode || (tNode && tNode.id && tNode.id !== $._UID + "_translationOptionsButton")) {
				panelEngContainer.appendChild($.$CNS("separator"));
				panelEngContainer.appendChild($.$CNS("menu", {
					label: "Translate from...",
				})).appendChild($.$CNS("menupopup", {
					class: $._UID + "_lang_list",
					consumeoutsideclicks: false,
					onpopupshowing: "event.stopPropagation();",
					"data-langlist": "{'pref':'pPanelTransFromLang', 'dir': 'from'}",
				}));
				panelEngContainer.appendChild($.$CNS("menu", {
					label: "Translate to...",
				})).appendChild($.$CNS("menupopup", {
					class: $._UID + "_lang_list",
					consumeoutsideclicks: false,
					onpopupshowing: "event.stopPropagation();",
					"data-langlist": "{'pref':'pPanelTransToLang', 'dir': 'to'}",
				}));
			}
			if ($._.pShowCustomPanelEngines) {
				panelEngContainer.appendChild($.$CNS("separator"));
				panelEngContainer.appendChild($.$CNS("menuitem", {
					label: "Edit custom engines",
					tooltiptext: "Edit custom engines for the panel translator",
					oncommand: that + "editCustomEngines('PanelEngines');event.stopPropagation();",
				}));
			}
			// aN.id && panelEngContainer.appendChild($.$CNS("separator"));
		}

		if ("gBrowser" in window && (!tNode || (tNode && tNode.id !== $._UID + "_translationOptionsButton"))) {
			if (aN.id) {
				aN.appendChild($.$CNS("dialogheader", {
					title: "Engines for page translator",
					tooltiptext: "Choose default engine for the page translator.",
					style: "margin: 0 0 7px 0;padding: 2px 0 2px 5px;border:none;font-size:smaller;",
				}));
				pageEngContainer = aN;
			} else {
				pageEngContainer = aN.appendChild($.$CNS("menu", {
					label: "Engines for page translator",
					tooltiptext: "Choose default engine for the page translator.",
				})).appendChild($.$CNS("menupopup", {
					consumeoutsideclicks: false,
					onpopupshowing: "event.stopPropagation();",
				}));
			}

			let rGURL = pageEngContainer.appendChild($.$CNS("radiogroup"));
			let URLBEng = $.URLBarEngines;
			for (var book in URLBEng) {
				if (URLBEng.hasOwnProperty(book)) {
					if (!!URLBEng[book].label && !!URLBEng[book].command) {
						rGURL.appendChild($.$CNS("menuitem", {
							label: URLBEng[book].label,
							type: "radio",
							closemenu: "none",
							tooltiptext: !!URLBEng[book].tooltip ? URLBEng[book].tooltip : "",
							checked: ($._.pPageTransEngine === parseInt(book, 10)),
							oncommand: that + "sPref('pPageTransEngine', " + parseInt(book, 10) +
								");event.stopPropagation();",
						}));
					}
				}
			}
		}

		if ("gBrowser" in window && (!tNode || (tNode && tNode.id !== $._UID + "_translationOptionsButton"))) {
			pageEngContainer.appendChild($.$CNS("separator"));
			pageEngContainer.appendChild($.$CNS("menu", {
				label: "Translate from...",
			})).appendChild($.$CNS("menupopup", {
				class: $._UID + "_lang_list",
				consumeoutsideclicks: false,
				onpopupshowing: "event.stopPropagation();",
				"data-langlist": "{'pref':'pPageTransFromLang', 'dir': 'from'}",
			}));
			pageEngContainer.appendChild($.$CNS("menu", {
				label: "Translate to...",
			})).appendChild($.$CNS("menupopup", {
				class: $._UID + "_lang_list",
				consumeoutsideclicks: false,
				onpopupshowing: "event.stopPropagation();",
				"data-langlist": "{'pref':'pPageTransToLang', 'dir': 'to'}",
			}));
			if ($._.pShowCustomURLBarEngines) {
				pageEngContainer.appendChild($.$CNS("separator"));
				pageEngContainer.appendChild($.$CNS("menuitem", {
					label: "Edit custom engines",
					tooltiptext: "Edit custom engines for the page translator",
					oncommand: that + "editCustomEngines('URLBarEngines');event.stopPropagation();",
				}));
			}
		}

		if (!tNode || (tNode && tNode.id !== $._UID + "_translationIconOnURLBar")) {
			panelEngContainer.appendChild($.$CNS("separator"));
			panelEngContainer.appendChild($.$CNS("menuitem", {
				image: $.images[1],
				label: "Manage Bing API keys",
				class: "menuitem-iconic",
				tooltiptext: "Add/Remove/edit Bing API keys.",
				oncommand: that + "editAPIKeys('pAPIKeysBing');event.stopPropagation();",
			}));
			panelEngContainer.appendChild($.$CNS("menuitem", {
				image: $.images[3],
				label: "Manage Yandex API keys",
				class: "menuitem-iconic",
				tooltiptext: "Add/Remove/edit Yandex API keys.",
				oncommand: that + "editAPIKeys('pAPIKeysYandex');event.stopPropagation();",
			}));
		}
		aN.appendChild($.$CNS("separator"));
		aN.appendChild($.$CNS("menuitem", {
			label: "More options",
			tooltiptext: "Open Multi Translator options window.",
			oncommand: that + "openOptions();event.stopPropagation();",
		}));
		$.populateAllLangLists();
	},

	populateAllLangLists: function() {
		let langs = $.langs;
		let that = "document.getElementById('" + self.id + "').MultiTranslator.";
		Array.prototype.slice.call(document.getElementsByAttribute("data-langlist", "*")).forEach(function(aMpop) {
			let mObj = JSON.parse(aMpop.getAttribute("data-langlist").replace(/\'/g, "\""));
			aMpop.textContent = "";
			let container = aMpop.appendChild($.$CNS("radiogroup", {
				tooltip: $._UID + "_languageSelectionTooltip",
				oncommand: "event.stopPropagation();",
				onclick: that + "switchLanguage(event, '" + mObj["pref"] + "');event.stopPropagation();",
			}));
			for (let lng in langs) {
				if (langs.hasOwnProperty(lng)) {
					let blacklisted = $.handleLanguagesBlacklist(lng, true);
					if (lng === "" && mObj["dir"] === "to")
						continue;
					if (blacklisted && !$._.pLanguagesShowHidden)
						continue;
					container.appendChild($.$CNS("menuitem", {
						label: langs[lng],
						type: "radio",
						closemenu: "none",
						group: $._UID + mObj["pref"] + "_group",
						style: blacklisted ? "text-decoration:line-through !important;" : "",
						value: lng,
						seleted: (lng === $._[mObj["pref"]]),
					}));
				}
			}
		});
	},

	switchLanguage: function(aE, aPref) {
		let el, mPop;
		el = mPop = aE.target;
		while (mPop.nodeName.toLowerCase() !== "menupopup") {
			mPop = mPop.parentNode;
		}
		if (aE.button === 0) {
			$.sPref(aPref, el.value);
			$.setPanelLangListLabel();
		} else if (aE.button === 2) {
			let blacklisted = $.handleLanguagesBlacklist(el.value);
			el.setAttribute("style", blacklisted ?
				"text-decoration: line-through !important;" :
				"text-decoration: none !important;");
			$._.pLanguagesShowHidden || el.setAttribute("hidden", blacklisted);
			if (!window[$._UID]["PopulateLangListsListener"]) {
				window[$._UID]["PopulateLangListsListener"] = true;
				mPop.addEventListener("popuphiding", function _(aE) {
					this.removeEventListener("popuphiding", _, false);
					$.populateAllLangLists();
					delete window[$._UID]["PopulateLangListsListener"];
				}, false);
			}
		}
	},

	handleLanguagesBlacklist: function(aLng, aJustCheck) {
		let blackList = $._.pLanguagesBlacklist.split(",").filter(function(aVal) {
			if (aVal === "en")
				return false;
			if (aVal !== "")
				return true;
		});
		let lng = aLng;
		let exists;
		if (aJustCheck) {
			exists = (blackList.indexOf(lng) !== -1);
		} else {
			if (blackList.indexOf(lng) !== -1) {
				while (blackList.indexOf(lng) !== -1) {
					blackList.splice(blackList.indexOf(lng), 1);
				}
			} else
				blackList.push(lng);
			exists = (blackList.indexOf(lng) !== -1);
			$.sPref("pLanguagesBlacklist", blackList.join(","));
		}
		return exists;
	},

	editAPIKeys: function(aPref) {
		var em = Services.ww.getWindowEnumerator();
		var winName = $._UID + "_edit_api_keys_window";
		var index = 1;
		while (em.hasMoreElements()) {
			let win = em.getNext();
			if (win.name === winName) {
				win.focus();
				return;
			}
			index++;
		}
		let storage = {
			button: self,
			APIKeysObj: JSON.parse($._[aPref]),
			accel: $.accel,
			getHelp: $.getHelp,
			openPage: $.openPage,
			custombuttons: custombuttons,
			prefName: aPref,
		};
		let xul = $.getHelp("%APIKeysWindow%");
		xul = xul.replace(/>\s+</g, "><");
		xul = xul.split("%MAX_HEIGHT%").join(screen.availHeight);
		xul = xul.split("%U_I_D%").join($._UID);
		let url = "data:application/vnd.mozilla.xul+xml;text/plain," + encodeURIComponent(xul);
		let optWin = openDialog(url, winName, "chrome, dialog=no, centerscreen, close");
		optWin._storage = storage;
	},

	openOptions: function() {
		var em = Services.ww.getWindowEnumerator();
		var winName = $._UID + "_settings_window";
		var index = 1;
		while (em.hasMoreElements()) {
			let win = em.getNext();
			if (win.name === winName) {
				win.focus();
				return;
			}
			index++;
		}
		let storage = {
			button: self,
		};
		let xul = $.getHelp("%OptionsWindow%");
		xul = xul.replace(/>\s+</g, "><");
		xul = xul.split("%U_I_D%").join($._UID);
		xul = xul.split("%B_I_N_G_I_M_G%").join($.images[1]);
		xul = xul.split("%Y_A_N_D_E_X_I_M_G%").join($.images[3]);
		xul = xul.split("%A_C_C_E_L%").join($.accel());
		xul = xul.split("%A_P_P_N_A_M_E%").join(Services.appinfo.name);
		xul = xul.split("%B_R_A_N_C_H%").join($.Branch);
		let url = "data:application/vnd.mozilla.xul+xml;text/plain," + encodeURIComponent(xul);
		let optWin = openDialog(url, "", "chrome, dependant, dialog, centerscreen, close, alwaysRaised");
		optWin._storage = storage;
	},

	editCustomEngines: function(aFileName) {
		let storagePath = $.storagePath;
		let filePath = OS.Path.join(storagePath, aFileName + ".json");
		OS.File.read(filePath).then(function onSuccess(aReadData) {
			let data = new TextDecoder().decode(aReadData);
			var em = Services.ww.getWindowEnumerator();
			var winName = $._UID + "_custom_engines_editor";
			var index = 1;
			while (em.hasMoreElements()) {
				let win = em.getNext();
				if (win.name === winName) {
					win.focus();
					return;
				}
				index++;
			}
			let xul = $.getHelp("%CustomEnginesEditor%");
			let storage = {
				custombuttons: custombuttons,
				accel: $.accel,
				fileName: aFileName,
				button: self,
				filePath: filePath,
				storagePath: storagePath,
				data: data,
			};
			xul = xul.replace(/>\s+</g, "><");
			xul = xul.split("%U_I_D%").join($._UID);
			xul = xul.split("%B_T_N_I_D%").join($._UID);
			xul = xul.split("%A_C_C_E_L%").join($.accel());
			let url = "data:application/vnd.mozilla.xul+xml;text/plain," + encodeURIComponent(xul);
			let win = openDialog(url, winName, "chrome, resizable, dialog=no, centerscreen, close");
			win._storage = storage;
		}, function onFailure(aRejectReason) {
			$.reportError(aRejectReason);
		});
	},

	clickOnTransResult: function(aValue, aEl) {
		if ($._.pPanelTransAutoCopyOnClick)
			gClipboard.write(aValue);
		if ($._.pPanelTransAutoCloseOnClick)
			$.forceHidePanel();
	},

	HTMLCSSLoader: function() {
		let css;
		try {
			$.styleSheet(window[$._UID]["HTMLStyleSheet"], true);
			window[$._UID]["HTMLStyleSheet"] = false;
		} catch (aErr) {}

		if (!$._.pHTMLStyleSheetEnabled)
			return true;

		try {
			css = "@namespace url(" + xhtmlns + ");\n" + decodeURIComponent($._.pHTMLStyleSheet)
				.replace(/%U_I_D%/g, $._UID);
		} catch (aErr) {
			css = false;
		}
		if (!css)
			return;

		if (!window[$._UID]["HTMLStyleSheet"]) {
			window[$._UID]["HTMLStyleSheet"] = css;
			$.styleSheet(css);
		} else if (window[$._UID]["HTMLStyleSheet"] && window[$._UID]["HTMLStyleSheet"] !== css) {
			$.styleSheet(window[$._UID]["HTMLStyleSheet"], true);
			window[$._UID]["HTMLStyleSheet"] = css;
			$.styleSheet(css);
		}
	},

	XULCSSLoader: function() {
		let css;
		try {
			$.styleSheet(window[$._UID]["XULStyleSheet"], true);
			window[$._UID]["XULStyleSheet"] = false;
		} catch (aErr) {}

		if (!$._.pXULStyleSheetEnabled)
			return true;

		try {
			css = "@namespace url(" + xulns + ");\n" + decodeURIComponent($._.pXULStyleSheet)
				.replace(/%U_I_D%/g, $._UID);
		} catch (aErr) {
			css = false;
		}
		if (!css)
			return true;

		if (!window[$._UID]["XULStyleSheet"]) {
			window[$._UID]["XULStyleSheet"] = css;
			$.styleSheet(css);
		} else if (window[$._UID]["XULStyleSheet"] && window[$._UID]["XULStyleSheet"] !== css) {
			$.styleSheet(window[$._UID]["XULStyleSheet"], true);
			window[$._UID]["XULStyleSheet"] = css;
			$.styleSheet(css);
		}
	},

	handlePrefObserver: function(aRem) {
		var prefs = $.DefPrefs;
		for (let key in prefs) {
			let pref = $.Branch + key;
			if (prefs.hasOwnProperty(key)) {
				if (aRem)
					Services.prefs.removeObserver(pref, $.prefObserver, false);
				else
					Services.prefs.addObserver(pref, $.prefObserver, false);
			}
		}
	},

	prefObserver: {
		observe: function(aSubject, aTopic, aPStr) {
			if (aTopic === "nsPref:changed") {
				let prefName = aPStr.slice($.Branch.length);
				window[$._UID]["Preferences"][prefName] = $.gPref(prefName);
				// $["_" + prefName] = $.gPref(prefName);
				let transPanel = $.transPanel;
				let selfPop = $.$($._UID + "_self_popup");
				switch (prefName) {
					case "pPanelTransFromLang":
					case "pPanelTransToLang":
						if (transPanel && transPanel.state === "open")
							$.translateSelection();
						break;
					case "pPanelTransEngine":
						if (transPanel && transPanel.state === "open")
							$.translateSelection();
						transPanel && (transPanel.label = $.getEng("label", true));
						$.$($._UID + "_translationOptionsButton").image = $.getEng("image", true);
						$.setFooter();
						$.assignImages(selfPop);
						break;
					case "pPageTransEngine":
						$.handleURLBarIcon(true);
						$.assignImages(selfPop);
						break;
					case "pTransOnRelease":
						try {
							$.removeListeners(true);
						} finally {
							$.addListeners();
						}
						break;
				}
				$._ = window[$._UID]["Preferences"];
			}
		}
	},

	selfDestroy: function() {
		clearTimeout(window[$._UID]["CleanSlateTimer"]);
		window[$._UID]["CleanSlateTimer"] = setTimeout(function() {
			self.destroy("update");
			setTimeout(function() {
				self.init();
			}, 100);
		}, 100);
	},

	$CNS: function(aElName, aAttrs, aNameSpace) { // Creates elements
		var el = aNameSpace ?
			document.createElementNS(aNameSpace, aElName) :
			document.createElement(aElName);
		if (aAttrs)
			Object.keys(aAttrs).forEach(function(n) {
				if (aAttrs[n] !== "")
					el.setAttribute(n, aAttrs[n]);
			});
		return el;
	},

	notifyme: function(aTitle, aMsg, aImg, aCallback) { // Notification function
		let origin = (Services.prefs.getPrefType("ui.alertNotificationOrigin") !== 0) ?
			Services.prefs.getIntPref("ui.alertNotificationOrigin") :
			null;
		let win = Services.ww.openWindow(null, "chrome://global/content/alerts/alert.xul",
			"_blank", "chrome,titlebar=no,popup=yes", null);
		win.arguments = [aImg,
			aTitle,
			aMsg, !!aCallback,
			"",
			origin,
			"",
			"",
			null,
			(!!aCallback ? aCallback : null)
		];
	},

	alertCallback: {
		options: {
			middleScreen: null,
			openLocation: null
		},
		observe: function(aSubject, aTopic, aData) {
			let alt = Services.wm.getMostRecentWindow("alert:alert");
			let tBox = alt.document.getElementById("alertTextBox");
			if (aTopic === "alertshow") {
				tBox.appendChild($.$CNS("label", {
					flex: 1,
					value: (this.options.openLocation ?
						"𝗖𝗹𝗶𝗰𝗸 𝗺𝗲 𝘁𝗼 𝗼𝗽𝗲𝗻 𝘀𝘁𝗼𝗿𝗮𝗴𝗲" :
						"𝗖𝗹𝗶𝗰𝗸 𝗺𝗲 𝘁𝗼 𝗰𝗹𝗼𝘀𝗲 𝗺𝗲"),
				}));
				setTimeout(function() {
					alt.close();
				}, 5000);
			}
			if (aTopic === "alertclickcallback") {
				this.options.openLocation && (new $._nsIFile($.storagePath).reveal());
				alt.close();
			}
		}
	},

	getHelp: function(aPlaceholder) { // Get specific data, surrounded by "placeholders", from the Help tab.
		return document.getElementById(self.id).getAttribute("Help").split("<!--" + aPlaceholder + "-->")[1];
	},

	styleSheet: function(aCSS, aRemFlag) {
		var sss = Cc["@mozilla.org/content/style-sheet-service;1"].getService(Ci.nsIStyleSheetService);
		var uri = Services.io.newURI("data:text/css," + encodeURIComponent(aCSS), null, null);
		if (sss.sheetRegistered(uri, sss.USER_SHEET))
			sss.unregisterSheet(uri, sss.USER_SHEET);
		if (aRemFlag)
			return;
		sss.loadAndRegisterSheet(uri, sss.USER_SHEET);
	},

	$: function(aID, aParent) {
		if (!aParent)
			return document.getElementById(aID);
		return aParent.getElementById(aID);
	},

	$$: function(aTagName, aParent) {
		if (!aParent)
			return document.getElementsByTagName(aTagName);
		return aParent.getElementsByTagName(aTagName);
	},

	reportError: function(aError) {
		try {
			console.error(aError);
		} catch (aErr) {
			Cu.reportError(["Multi Translator" + ": " + self.id, aError, aError.stack].join("\n"));
		}
	},

	escHTML: function(aStr, aIsAttr) {
		aStr = String(aStr)
			.replace(/&/g, "&amp;")
			.replace(/</g, "&lt;")
			.replace(/>/g, "&gt;")
			.replace(/"/g, "&quot;")
			.replace(/'/g, "&apos;");
		if (aIsAttr) {
			aStr = aStr
				.replace(/\t/g, "&#x9;")
				.replace(/\n/g, "&#xA;")
				.replace(/\r/g, "&#xD;");
		}
		return aStr;
	},

	mergeObj: function(aTgt, aSrc) {
		/* Merges two (or more) objects,
		   giving the last one precedence */
		if (typeof aTgt !== "object")
			aTgt = {};

		for (var prop in aSrc) {
			if (aSrc.hasOwnProperty(prop)) {
				var sourceProperty = aSrc[prop];
				if (typeof sourceProperty === "object") {
					aTgt[prop] = $.mergeObj(aTgt[prop], sourceProperty);
					continue;
				}
				aTgt[prop] = sourceProperty;
			}
		}

		for (var a = 2, l = arguments.length; a < l; a++) {
			$.mergeObj(aTgt, arguments[a]);
		}

		return aTgt;
	},

	escapeHash: {
		_: function(input) {
			var ret = $.escapeHash[input];
			if (!ret) {
				if (input.length - 1) {
					ret = String.fromCharCode(parseInt(input.substring(input.length - 3 ? 2 : 1), 16));
				} else {
					var code = input.charCodeAt(0);
					ret = code < 256 ? "%" + (0 + code.toString(16)).slice(-2).toUpperCase() : "%u" + ("000" + code.toString(16)).slice(-4).toUpperCase();
				}
				$.escapeHash[ret] = input;
				$.escapeHash[input] = ret;
			}
			return ret;
		}
	},

	$escape: function(aStr) {
		return aStr.toString().replace(/[^\w @\*\-\+\.\/]/g, function(aChar) { // Per Liedman
			return $.escapeHash._(aChar);
		});
	},

	$unescape: function(aStr) {
		return aStr.toString().replace(/%(u[\da-f]{4}|[\da-f]{2})/gi, function(aSeq) { // Per Liedman
			return $.escapeHash._(aSeq);
		});
	},

	prefHandling: {
		_msg: "This process is immediate and irreversible.\t\n" +
			"It is advisable to make a backup of the preferences before proceeding.\t\n\n" +
			"Do you want to continue?\n",

		resetP: function() {
			let msg = "You're about to reset " + self.name +
				" preferences to their default values​​.\t\t\n" + this._msg;
			let cBox = custombuttons.confirmBox(self.name, msg, "Yes", "Cancel");
			if (cBox) {
				(Services.prefs.getBranch($.Branch)).deleteBranch("");
				setTimeout(function() {
					$.selfDestroy();
				}, 100);
			} else
				return;
		},

		exportP: function() {
			var out = [];
			var value,
				prefList = (Services.prefs.getBranch($.Branch)).getChildList("", {});
			for (let pref in prefList) {
				if (!/^OptionsForButtonID/.test(prefList[pref])) {
					switch (Services.prefs.getPrefType($.Branch + prefList[pref])) {
						case 0:
							break;
						case 32:
							value = $.gPref(prefList[pref]);
							break;
						case 64:
							value = $.gPref(prefList[pref]);
							break;
						case 128:
							value = $.gPref(prefList[pref]) ? "true" : "false";
							break;
					}
					out.push(prefList[pref] + "|" + value);
				}
			}
			var file = new $._nsIFile($.storagePath);
			file.append("MultiTranslator" + self.id.slice(20) + "-Prefs.js");
			file.createUnique(Ci.nsIFile.NORMAL_FILE_TYPE, 0x1B6);
			let data = out.join("\n");
			OS.File.writeAtomic(file.path, data, {
				tmpPath: file.path + ".tmp",
				encoding: "utf-8"
			}).then(function onSuccess() {
				$.alertCallback.options = {
					openLocation: true,
					middleScreen: false,
				};
				$.notifyme("Multi Translator Preferences", "Successfully exported to Multi Translator storage.",
					$.getHelp("%AlertImg%"),
					$.alertCallback);
			}, function onFailure(aRejectReason) {
				$.reportError(aRejectReason);
			});
		},

		importP: function() {
			let msg = "You're about to import new preferences to " + self.name + ".\t\t\n" + this._msg;
			let cBox = custombuttons.confirmBox(self.name, msg, "Yes", "Cancel");
			if (cBox) {
				var localDir = new $._nsIFile($.storagePath);
				var fp = Cc["@mozilla.org/filepicker;1"].createInstance(Ci.nsIFilePicker);
				fp.init(window, "Import Multi Translator Preferences", Ci.nsIFilePicker.modeOpen);
				fp.appendFilter("", "MultiMenuID" + self.id.slice(20) + "*.js");
				fp.appendFilter("", "*.*");
				fp.displayDirectory = localDir;
				if (fp.show() === Ci.nsIFilePicker.returnOK) {
					if (fp.file && fp.file.exists())
						localDir = fp.file.parent.QueryInterface(Ci.nsIFile);
				} else
					return;
				OS.File.read(fp.file.path).then(function onSuccess(aReadData) {
					let prefFile = new TextDecoder().decode(aReadData);
					prefFile = prefFile.replace(/\r\n/g, "\n").split("\n");
					for (let p in prefFile) {
						var prefName = $.Branch + prefFile[p].split("|")[0],
							prefValue = prefFile[p].split("|")[1];
						if (Services.prefs.getPrefType(prefName)) {
							switch (Services.prefs.getPrefType(prefName)) {
								case 0:
									break;
								case 32:
									let str = Cc["@mozilla.org/supports-string;1"]
										.createInstance(Ci.nsISupportsString);
									str.data = prefValue;
									Services.prefs.setComplexValue((prefName), Ci.nsISupportsString, str);
									break;
								case 64:
									Services.prefs.setIntPref(prefName, prefValue);
									break;
								case 128:
									Services.prefs.setBoolPref(prefName, ((prefValue === "true") ? "true" : ""));
									break;
							}
						}
					}
					setTimeout(function() {
						$.selfDestroy();
					}, 500);
				}, function onFailure(aRejectReason) {
					$.reportError(aRejectReason);
				});
			} else
				return;
		},
	},

	images: {
		// "Generic" image.
		0: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABJ0lEQVQ4ja3Rv0r" +
			"DQAAG8Jt9AZ+k7aKDD5BmCD6Bi5gEMthFaKByq+BqbHFwchAESxyVuJWSwUEkIllyh01tcpk0BfmcEmP/puo" +
			"H33R3Pz44Qv4jnHMs6eNKgCRJU8hSwHEcUEpBKUWj0YCmaaCUIgiCcgDnHIwxGIYBzjkURVltQVZd12HbNiz" +
			"L+h2gqirq9ToOji6x0Yrz1kzxXmzFFO4PwPM8yLIM3/fBOccWjVEzxcJOLVDbo3zJJBC8hvMBxtj97ukoP5g" +
			"Eto8jsEGIh5fhbCDL+s4zKk1xQgghVVPE2cVEhNg8jJGIcDGgdd5E8yLpdd20ddVPP4tA1v3zaD5w3cda1x0" +
			"j69ndB3pPQ+x1vh8VVyz82vZtOi79C7NSbUY3fwLK5gsYfdN865v7KwAAAABJRU5ErkJggg==",
		// Bing translator image.
		1: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUklEQVQ4jZVRsUr" +
			"EQBCdU2trC7kixLtswCpovMskOQT/QLGyFgWL45Kcml30J/wJy5PIJRYW/oEgB5aCtWgrZyzcDZtNAufAg0x" +
			"48/a9GYAFy2Ruro2t9qL8ogjDTAgQhjcmc3MAWCqRcJRaTQKdC8sgFF9N5uZ6ZK/XkgZRlmM0PRpEWS7DD+9" +
			"P5AiE4iN3UBWQAQCtEuEaVniElz8h95lQ/KkV6A2n2/KsETsBofjGHXzpZ/oqAIAZ40SPnJ1aB/JOhGXCcC6" +
			"/qoX2Rie2kbd5qwrugOFMCMn5a3cBB7fL6i+T4YxQvCsEae+YMJyXSF6QXpW3n71X1f9R/BJFdWl/X0VlyA+" +
			"mT36YfvphOlEFxBllVF70goe4yQEAQPe8v1sr4IXpoTqg9kbsXDY68IbJpjzgj5I90Wtjq60Mfos45fxh9iE" +
			"usHWarNVFUHciPn8Byc7T4MbektIAAAAASUVORK5CYII=",
		// Google translator image.
		2: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACbElEQVQ4jYXO3Wv" +
			"TUBzG8dx77V+kdC/t0pdVEJwM3YV6oSgIouCFDmnTJE1hbKMykTknDjdR221VcBsiG1sdHe1Mk6bNmqVJQXR" +
			"mPTk3gjxeZN0Lwnrgufx+focJC3sz0RRBVCLolwgiEkE4SRASCfzcz0Gm04umCKIpiv4URSRFEZEoQkmKYJK" +
			"C5X696Qj0S+REHD4OCOSP7/LHM6cCEYkgIv0fB0UKVnDBv65tVav1edM0s6bZyJimmanXjaxhGJlabecOE04" +
			"ShCWKaxMuNlQHuvUba7KDiOSCFSluTfxAaVuBbdtoNpuwbRu2bcOyLJim+ZcJJQlCSYq86uDRLEEwSTEw6sV" +
			"9AgUrulj+WoSiqLAs6zA+AMAERS8ymw6CIsXIYguK4eD7joOAQBHgKdLvayiVZAw95A7jI0AgCIoUG4r3A1a" +
			"keDxLsFLcR4Cn8PMUFxMqYuNTEJ+9AjfxEvekpxiZnsPu7i4YViDoEyiG0i7WFQc7loO86uBq2oX/AGAFgtH" +
			"JDFbXv2HybRbZz1/QaDQ8IMAT76vt8fTwcm/CRW/CRU/CBTdVwAMxjeGx59A0DbquwzCMA4A/GbbjnvY4F9d" +
			"H67gbH8OT8UkoioparQZd18H4E+REdPxqD+etm3PRHdvDp+U83uWWEEu/gFqpoFqtgvEN7013xVtozxdvwRd" +
			"rbx/dcYKuuAtf3MVUrgpZLmNldf0IOO3dvL9w9vyFLM5F5xEezGFppYByWYGqqtA0rTPAMAwTvrK4GhjI4cN" +
			"CHsXiNmS5DFVVUalUoGlaZ+DSjYXbM3Nr2NzcQqm0DVmWUS57SKFQmvkHfIB8SS9Bg30AAAAASUVORK5CYII=",
		// Yandex image.
		3: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABgklEQVQ4jYWSu05" +
			"CQRCGp6EzUcMTUCsWnuzudBBiwmmJVBoKciwpqCAxVpLoOxhaGp4ACioNJSR0SrxQ8AIUnMbksxHYoyiTTLL" +
			"Zmf+by67IDjPG3KgqK3fOvWSz2cNdOhERUdVYVcnlcvgQVcUYc/mv2Dn3HoYh1WoVgEajQbfbZbFYMBwOUVX" +
			"+7CQIgpSqEoYhrVYLgFqtRqFQIJ/P++M8bwVYa6/8dqfTKe12m8lkAoC1dh1LCBFJIRL10+lBdHSEU6VSqaw" +
			"7KJfL9Ho9ZrPZbwAiH4jw0z/7fZxzjMdjAIwxAEkAIvFatL8PT08JyP3ZGQClUolischoNEJVsdZeCyI3iaq" +
			"PjxDHvzo5DQKazSbGGIwxqOpyVT2ZDHB+Dg8Pifvo+Njf/qs/+yaxXoe7uw3Ii/XT6YG1NgqCIPVz88nqvoW" +
			"hD4m2vjkiz4hAJgPz+UawtwfLpQ9I/QU4RARub+HkJLmPTmd1ftsq9iAX2/7At8f/ij3IwXqcjV/v0n0BaMZ" +
			"4bK7uRiAAAAAASUVORK5CYII=",
	},
	_UID: "__multi_translator_" + self.id.slice(20),
	URLBarEngines: null,
	PanelEngines: null,
	globalMM: Cc["@mozilla.org/globalmessagemanager;1"].getService(Ci.nsIMessageListenerManager),
	TIMEOUT: 10000,
	_globalMM: Cc["@mozilla.org/globalmessagemanager;1"].getService(Ci.nsIMessageListenerManager),
	_nsIFile: Components.Constructor("@mozilla.org/file/local;1", "nsIFile", "initWithPath"),
	_randomID: null,
	_frameScript: null,
	isOKToCreateElements: null,
	isOSX: Services.appinfo.OS.toLowerCase().startsWith("darwin"),
	accel: function(aE) {
		if (aE)
			return $.isOSX ? aE.metaKey : aE.ctrlKey;
		return $.isOSX ? "Command" : "Control";
	},
	get transPanel() {
		return document.getElementById($._UID + "_translationPanel");
	},
	get urlBarIcon() {
		return document.getElementById($._UID + "_translationIconOnURLBar");
	},
	get dummyPanel() {
		return document.getElementById($._UID + "_translationPanelDummy");
	},
	get _responseMsgID() {
		return "CB:MultiTranslator:Response:" + self.id.slice(14) + "-" + $._randomID;
	},
	get _onReleaseIconMsgID() {
		return "CB:MultiTranslator:TranslateOnReleaseIcon:" + self.id.slice(14) + "-" + $._randomID;
	},
	get _cleanupMsgID() {
		return "CB:MultiTranslator:Cleanup:" + self.id.slice(14) + "-" + $._randomID;
	},
	get _translateSelMsgID() {
		return "CB:MultiTranslator:TranslateSelection:" + self.id.slice(14) + "-" + $._randomID;
	},
	get _movePopupMsgID() {
		return "CB:MultiTranslator:MovePopup:" + self.id.slice(14) + "-" + $._randomID;
	},
	get _isMultiProcess() {
		let a = "gMultiProcessBrowser" in window;
		return a ? gMultiProcessBrowser : false;
	},
	get storagePath() {
		let d = OS.Path.join(OS.Constants.Path.profileDir, "custombuttons", "MultiTranslator");
		OS.File.makeDir(d, {
			ignoreExisting: true
		});
		return d;
	},
	get _mm() {
		let mm = null;
		try {
			mm = typeof gBrowser === "object" ?
				gBrowser.selectedTab.linkedBrowser.messageManager : // Everything else.
				getBrowser().messageManager; // Thunderbird. %$/&$% you!!!!
		} catch (aErr) {}
		return mm;
	},
};

this.MultiTranslator.Branch = "CB.MultiTranslator.Id" + self.id.slice(20) + ".";

this.MultiTranslator.gPref = function(aKey) {
	let branch = Services.prefs.getBranch($.Branch);
	switch (typeof $.DefPrefs[aKey]) {
		case "boolean":
			return branch.getBoolPref(aKey);
		case "number":
			return branch.getIntPref(aKey);
		case "string":
			return branch.getComplexValue(aKey, Ci.nsISupportsString).data;
	}
	return null;
};

this.MultiTranslator.sPref = function(aKey, aVal) {
	let branch = Services.prefs.getBranch($.Branch);
	switch (typeof aVal) {
		case "boolean":
			branch.setBoolPref(aKey, aVal);
			break;
		case "number":
			branch.setIntPref(aKey, aVal);
			break;
		case "string":
			let str = Cc["@mozilla.org/supports-string;1"].createInstance(Ci.nsISupportsString);
			str.data = aVal;
			branch.setComplexValue((aKey), Ci.nsISupportsString, str);
			break;
	}
};

this.MultiTranslator.initPrefs = function() {
	let branch = Services.prefs.getDefaultBranch($.Branch),
		defaults = $.DefPrefs;
	for (let key in defaults) {
		if (defaults.hasOwnProperty(key)) {
			let val = defaults[key];
			switch (typeof val) {
				case "boolean":
					branch.setBoolPref(key, val);
					break;
				case "number":
					branch.setIntPref(key, val);
					break;
				case "string":
					let str = Cc["@mozilla.org/supports-string;1"].createInstance(Ci.nsISupportsString);
					str.data = val;
					branch.setComplexValue((key), Ci.nsISupportsString, str);
					break;
			}
		}
	}
};

this.MultiTranslator.langs = {
	"": "Auto",
	"af": "Afrikaans (G)(Y)",
	"sq": "Albanian (G)(Y)",
	"am": "Amharic (G)",
	"ar": "Arabic",
	"hy": "Armenian (G)(Y)",
	"az": "Azerbaijani (G)(Y)",
	"eu": "Basque (G)",
	"ba": "Bashkir (Y)",
	"be": "Belarusian (G)(Y)",
	"bn": "Bengali (G)(Y)",
	"bs": "Bosnian (Y)",
	"bs-Latn": "Bosnian (Latin) (B)",
	"bg": "Bulgarian",
	"ca": "Catalan",
	"ceb": "Cebuano (G)",
	"ny": "Chichewa (G)",
	"zh": "Chinese (Y)",
	"zh-CHS": "Chinese Simplified (B)",
	"zh-CN": "Chinese (G)",
	"zh-CHT": "Chinese Traditional (B)",
	"co": "Corsican (G)",
	"hr": "Croatian",
	"cs": "Czech",
	"da": "Danish",
	"nl": "Dutch",
	"en": "English",
	"eo": "Esperanto (G)",
	"et": "Estonian",
	"tl": "Filipino (G)(Y)",
	"fi": "Finnish",
	"fr": "French",
	"fy": "Frisian (G)",
	"gl": "Galician (G)(Y)",
	"ka": "Georgian (G)(Y)",
	"de": "German",
	"el": "Greek",
	"gu": "Gujarati (G)(Y)",
	"ht": "Haitian Creole",
	"ha": "Hausa (G)",
	"haw": "Hawaiian (G)",
	"he": "Hebrew (B)(Y)",
	"iw": "Hebrew (G)",
	"hi": "Hindi",
	"hmn": "Hmong (G)",
	"mww": "Hmong Daw (B)",
	"hu": "Hungarian",
	"is": "Icelandic (G)(Y)",
	"ig": "Igbo (G)",
	"id": "Indonesian",
	"ga": "Irish (G)(Y)",
	"it": "Italian",
	"ja": "Japanese",
	"jw": "Javanese (G)",
	"kn": "Kannada (G)(Y)",
	"kk": "Kazakh (G)(Y)",
	"km": "Khmer (G)",
	"ky": "Kirghiz (Y) or Kyrgyz (G)",
	"tlh": "Klingon (B)",
	"tlh-Qaak": "Klingon (pIqaD) (B)",
	"ko": "Korean",
	"ku": "Kurdish (Kurmanji) (G)",
	"lo": "Lao (G)",
	"la": "Latin (G)(Y)",
	"lv": "Latvian",
	"lt": "Lithuanian",
	"lb": "Luxembourgish (G)",
	"mk": "Macedonian (G)(Y)",
	"mg": "Malagasy (G)(Y)",
	"ms": "Malay",
	"ml": "Malayalam (G)",
	"mt": "Maltese",
	"mi": "Maori (G)",
	"mr": "Marathi (G)",
	"mn": "Mongolian",
	"my": "Myanmar (Burmese) (G)",
	"ne": "Nepali (G)",
	"no": "Norwegian",
	"ps": "Pashto (G)",
	"fa": "Persian",
	"pl": "Polish",
	"pt": "Portuguese",
	"pa": "Punjabi (G)(Y)",
	"otq": "Querétaro Otomi (B)",
	"ro": "Romanian",
	"ru": "Russian",
	"sm": "Samoan (G)",
	"gd": "Scots Gaelic (G)",
	"sr-Cyrl": "Serbian (Cyrillic) (B)",
	"sr-Latn": "Serbian (Latin) (B)",
	"sr": "Serbian (G)(Y)",
	"st": "Sesotho (G)",
	"sn": "Shona (G)",
	"sd": "Sindhi (G)",
	"si": "Sinhalese (Y) or Sinhala (G)",
	"sk": "Slovak",
	"sl": "Slovenian",
	"so": "Somali (G)",
	"es": "Spanish",
	"su": "Sundanese (G)",
	"sw": "Swahili or Kiswahili",
	"sv": "Swedish",
	"tg": "Tajik (G)(Y)",
	"ta": "Tamil (G)(Y)",
	"tt": "Tatar (Y)",
	"te": "Telugu (G)",
	"th": "Thai",
	"tr": "Turkish",
	"udm": "Udmurt",
	"uk": "Ukrainian",
	"ur": "Urdu",
	"uz": "Uzbek",
	"vi": "Vietnamese",
	"cy": "Welsh",
	"xh": "Xhosa (G)",
	"yi": "Yiddish (G)",
	"yo": "Yoruba (G)",
	"yua": "Yucatec Maya (B)",
	"zu": "Zulu (G)",
};

this.MultiTranslator.DefPrefs = {
	pAPIKeysBing: JSON.stringify([
		["TradutorInstantaneo", "D36qcBNDopLmUz2cYpAgPZ0ZPezQEs79QeTp88gZ4hc="],
		["ngochuong-bing-translator", "vIOFDe2FdSy4c0BTdYoPvHhwWIPoRFBo5ryuhOjxo84="],
		["webtranslator8601", "38tnkL0LkSI5DjHq3mhFU0f7DKsm1/rizwEmMylZxtc="],
		["SublimeBingTranslator", "0fjvxMgcSZreEk9xPN8Vse+KDz3XlI+W11XJxC8peEA="],
		["bing_translator_test_xuemind", "taiwTXXvLKe/UzpXXK6X6gxkpac5GpOdKOb69gYWMgk="],
		["Subtitles", "Xv2Oae6Vki4CnYcSF1SxSSBtO1x4rX47zhLUE/OqVds="],
		["3a7a26d9254FFC08", "SuNwPHKH6UbvhyZ34FlqOWJ9z2zN6KS8djzHpf8NvOI="],
	]),
	pAPIKeysYandex: JSON.stringify([
		"trnsl.1.1.20130818T214524Z.9983e6055ae94787.74d98f42e84f8abac4a19cb1333dfecb7427165d",
		"trnsl.1.1.20130806T140102Z.d80a7ce00b1a3c38.30de98386f6f6d594993fa93c0907aac5996aab9",
		"trnsl.1.1.20140602T085017Z.ea6ecac642816084.4df3b3711b35ed773720c92acdcebb11e793b8ab",
		"trnsl.1.1.20140911T223045Z.34ca44edca3e6ebd.f6807b1158e50190a2ae10c40d8a31a426647e98",
		"trnsl.1.1.20140731T144606Z.639639bc480e82b7.7cb97a33d3b2e88fa363e789fe03e2426478c53a",
		"trnsl.1.1.20141206T164332Z.8497d97d7ca05dc2.411e9116711b1860da655ffba56840469a3b2af1",
		"trnsl.1.1.20140218T130206Z.7923fc89a1c1bd16.aba4c3d98792c68c157c59f5a385339a03f0d736",
		"trnsl.1.1.20140213T084832Z.2e599cd43e74002d.d935bc98da1909103ec212bc9ce71adeaac9de4a",
	]),
	pHotkeyTransPage: "Ctrl+Alt+p",
	pHotkeyTransSel: "Ctrl+Alt+t",
	pHotkeyTransClip: "Ctrl+Alt+v",
	pPanelMaxStringLength: 1024,
	pPanelTransMaxWidth: 450,
	pPanelTransShowFooter: true,
	pTransOnReleaseIconOffsetX: 10,
	pTransOnReleaseIconOffsetY: 10,
	pLanguagesShowHidden: true,
	pLanguagesBlacklist: "",
	pButtonClickActionLeft: 1,
	pButtonClickActionMiddle: 2,
	pButtonClickActionLeftCtrl: 3,
	pButtonClickActionLeftShift: 4,
	pButtonClickActionLeftCtrlShift: 5,
	pPageTransURLBarIconLeftClick: 2,
	pPageTransURLBarIconMiddleClick: 1,
	pPageTransURLBarIconMenuMode: true,
	pPageTransURLBarIconShow: true,
	pPageTransEngine: 2,
	pPageTransFromLang: "",
	pPageTransToLang: "en",
	pPanelTransKeepItOpen: false,
	pPanelTransAutoCloseOnClick: false,
	pPanelTransAutoCopyOnClick: false,
	pPanelTransAnchorToSelection: true,
	pPanelTransShowTitleBar: true,
	pPanelTransFailSafe: false,
	pPanelTransFailSafeOpenURLWhere: 1,
	pPanelTransEngine: 2,
	pPanelTransFromLang: "",
	pPanelTransToLang: "en",
	pPanelTransUseTextbox: true,
	pPanelTransShowOptionsBox: true,
	pShowTransSelCtx: true,
	pShowTransClipCtx: true,
	pShowTransPageCtx: true,
	pShowTransPageCtxMenuMode: true,
	pTransOnRelease: true,
	pTransOnReleaseAltKey: false,
	pTransOnReleaseControlKey: false,
	pTransOnReleaseShiftKey: false,
	pTransOnReleaseShowIcon: true,
	pHotkeyTransPageEnabled: false,
	pHotkeyTransSelEnabled: false,
	pHotkeyTransClipEnabled: false,
	pShowCustomPanelEngines: false,
	pShowCustomURLBarEngines: false,
	pXULStyleSheetEnabled: true,
	pHTMLStyleSheetEnabled: true,
	pXULStyleSheet: "%2F*%20Translation%20panel%20tweaks%20*%2F%0A%2F*%20Image%20for%20the%20close%20panel%20button%20*%2F%0A%23%25U_I_D%25_translationClosePanelButton%20%7B%0A%09list-style-image%3A%20url(%22data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs%2B9AAAAiklEQVQYlW3Pxw1CQQxF0bNChBbIsCP2XwQ5CBBQAKEFWDCDLPheeew71n18aoKm%2F2phmB9TPLFCOUBVbHHPcAsbvLBEB70wW6CRf1fC4oRL6uco%2Ffp0cU7AC3u0C7z1cQ3goQisYRcuHYPfN2A7QLMUroN1CNiAMR4JiuLlFPCGQR6OUC%2FwbmboDUj8J0R5GOzSAAAAAElFTkSuQmCC%22)%20!important%3B%0A%09-moz-image-region%3A%20auto%20!important%3B%0A%7D%0A%2F*%20Panel%20main%20box%20*%2F%0A%23%25U_I_D%25_translationPanelMainBox%20%7B%0A%09padding%3A%208px%200%208px%200%20!important%3B%0A%7D%0A%2F*%20Result%20box%2C%20footer%20box%20and%20options%20box%20*%2F%0A%23%25U_I_D%25_translationResultBox%2C%0A%2F*%23%25U_I_D%25_translationResultFooterBox%2C*%2F%0A%23%25U_I_D%25_translationOptionsBox%20%7B%0A%09%2F*padding%3A%208px%200%208px%200%20!important%3B*%2F%0A%7D%0A%2F*%20Panel%20resizers%20*%2F%0A%23%25U_I_D%25_translationPanel%20resizer%20%7B%0A%09-moz-appearance%3A%20none%20!important%3B%0A%09background-image%3A%20none%20!important%3B%0A%7D%0A%2F*%20Translation%20result%20content%20*%2F%0A%23%25U_I_D%25_translationResultContent%20%7B%0A%09font-weight%3A%20600%20!important%3B%0A%7D%0A%2F*%20Translation%20result%20content%20as%20textbox%20*%2F%0A%23%25U_I_D%25_translationResultContent.as_textbox%20%7B%0A%09%2F*padding%3A%202px%20!important%3B*%2F%0A%7D%0A%2F*%20Translation%20result%20content%20NOT%20as%20textbox%20*%2F%0A%23%25U_I_D%25_translationResultContent.not_as_textbox%20%7B%0A%09%2F*padding%3A%205px%20!important%3B*%2F%0A%7D%0A%2F*%20Buttons%20inside%20the%20panel%20*%2F%0A%23%25U_I_D%25_languageSelectionButtonFrom%2C%0A%23%25U_I_D%25_languageSelectionButtonTo%2C%0A%23%25U_I_D%25_translationOptionsButton%20%7B%0A%09%2F*-moz-appearance%3A%20none%20!important%3B*%2F%0A%7D%0A%2F*%20Force%20options%20button%20image%20to%2016%20pixels%20*%2F%0A%23%25U_I_D%25_translationOptionsButton%20.toolbarbutton-icon%20%7B%0A%09max-height%3A%2016px%20!important%3B%0A%09max-width%3A%20100%25%20!important%3B%0A%7D%0A%2F*%20Hide%20arrowscrolls%20and%20show%20toolbars%20on%20language%20selection%20menus%20*%2F%0Amenupopup.%25U_I_D%25_lang_list%20scrollbox%20%7B%0A%09overflow-y%3A%20auto%20!important%0A%7D%0Amenupopup.%25U_I_D%25_lang_list%20.autorepeatbutton-up%2C%0Amenupopup.%25U_I_D%25_lang_list%20.autorepeatbutton-down%20%7B%0A%09display%3A%20none%20!important%3B%0A%7D%0A%2F*%20Basic%20panel%20appearance%20for%20the%20page%20translator%20menu%20and%20Multi%20Translator%20main%20menu%20*%2F%0A%2F*%20Compatible%20with%20all%20Gecko%20applications%20*%2F%0A%23%25U_I_D%25_self_popup%2C%0A%23%25U_I_D%25_translationIconOnURLBarMenu%20%7B%0A%09-moz-appearance%3A%20none%20!important%3B%0A%09-moz-binding%3A%20url(%22chrome%3A%2F%2Fglobal%2Fcontent%2Fbindings%2Fpopup.xml%23arrowpanel%22)%20!important%3B%0A%09background%3A%20transparent%20!important%3B%0A%09border%3A%20none%20!important%3B%0A%09-moz-image-region%3A%20auto%20!important%3B%0A%7D",
	pHTMLStyleSheet: "%2F*%20Tweaks%20for%20Google%20Translator%20pages%20*%2F%0A%40-moz-document%20regexp(%22%5Ehttps%3F%3A%2F%2Ftranslate.google..*%22)%20%7B%0A%09%2F*%20Remove%20the%20offer%20to%20install%20that%20aberration%20called%20Chrome!!!%20*%2F%0A%09%23gb%20.gb_9c.gb_ec.gb_g%20%7B%0A%09%09display%3A%20none%20!important%3B%0A%09%7D%0A%7D%0A%2F*%20Removes%20tooltips%20showing%20original%20text%20*%2F%0A%40-moz-document%20domain(%22translate.googleusercontent.com%22)%20%7B%0A%09span%5Bonmouseout%5D%5Bonmouseover%5D%5Bstyle%5D%20%7B%0A%09%09background-color%3A%20transparent%20!important%3B%0A%09%7D%0A%09.gmnoprint%20%7B%0A%09%09display%3A%20none%20!important%3B%0A%09%7D%0A%7D%0A%0A%2F*%20Tweaks%20for%20Microsoft%20translator%20pages%20*%2F%0A%2F*%20Remove%20tooltips%20showing%20original%20text%20*%2F%0ADIV%5Btranslate%3D%22no%22%5D%20%7B%0A%09display%3A%20none%20!important%3B%0A%7D",
};

this.MultiTranslator.init();]]></initcode>
  <code><![CDATA[/*CODE*/]]></code>
  <accelkey><![CDATA[]]></accelkey>
  <help>𝗜𝗺𝗽𝗼𝗿𝘁𝗮𝗻𝘁 𝗻𝗼𝘁𝗲𝘀
⚫ 𝗗𝗢 𝗡𝗢𝗧 𝗶𝗻𝘀𝘁𝗮𝗹𝗹 𝗺𝗼𝗿𝗲 𝘁𝗵𝗮𝗻 𝗼𝗻𝗲 𝘃𝗲𝗿𝘀𝗶𝗼𝗻 𝗼𝗳 𝘁𝗵𝗶𝘀 𝗯𝘂𝘁𝘁𝗼𝗻 𝗮𝘁 𝘁𝗵𝗲 𝘀𝗮𝗺𝗲 𝘁𝗶𝗺𝗲❗❗❗
⚫ 𝗗𝗢 𝗡𝗢𝗧 𝗰𝗹𝗼𝗻𝗲 𝘁𝗵𝗶𝘀 𝗯𝘂𝘁𝘁𝗼𝗻❗❗❗
⚫ If you did any of the previous actions, delete all extra buttons leaving only one version of 𝗠𝘂𝗹𝘁𝗶 𝗧𝗿𝗮𝗻𝘀𝗹𝗮𝘁𝗼𝗿 and restart your application.

[,]

/**
 * 𝗙𝗥𝗢𝗠 𝗛𝗘𝗥𝗘 𝗗𝗢𝗪𝗡 𝗗𝗢 𝗡𝗢𝗧 𝗧𝗢𝗨𝗖𝗛 𝗔𝗡𝗬𝗧𝗛𝗜𝗡𝗚
 */

&lt;!--%FrameScript%--&gt;
(function(aContext) {
	var Ci = Components.interfaces;
	var Cu = Components.utils;

	let MultiTranslator = {
		init: function() {
			aContext.addMessageListener("%Translate_Sel_ID%", this);
			aContext.addMessageListener("%On_Release_Icon_ID%", this);
			aContext.addMessageListener("%Move_Popup_ID%", this);
			aContext.addMessageListener("%Cleanup_ID%", this);
		},

		unInit: function() {
			aContext.removeMessageListener("%Translate_Sel_ID%", this);
			aContext.removeMessageListener("%On_Release_Icon_ID%", this);
			aContext.removeMessageListener("%Move_Popup_ID%", this);
			aContext.removeMessageListener("%Cleanup_ID%", this);
		},

		receiveMessage: function(aMsg) {
			switch (aMsg.name) {
				case "%Translate_Sel_ID%":
					this._getSelection(true);
					break;
				case "%On_Release_Icon_ID%":
					if (!aMsg.data)
						return;
					this._onReleaseIcon(aMsg.data);
					break;
				case "%Move_Popup_ID%":
					if (!aMsg.data)
						return;
					this._movePopup(aMsg.data);
					break;
				case "%Cleanup_ID%":
					this.unInit();
					break;
			}
		},

		_getSelection: function(aDirectTrans) {
			let fWin = {};
			let fEl = Services.focus.getFocusedElementForWindow(content.window, true, fWin);
			fWin = fWin.value;
			let selStr = fWin.getSelection().toString();
			if (!selStr &amp;&amp; fEl instanceof Ci.nsIDOMNSEditableElement) {
				if (fEl instanceof Ci.nsIDOMHTMLTextAreaElement ||
					(fEl instanceof Ci.nsIDOMHTMLInputElement &amp;&amp;
						fEl.mozIsTextField(true))) {
					selStr = fEl.editor.selection.toString();
				}
			}
			if (aDirectTrans) {
				if (selStr !== "") {
					sendAsyncMessage("%Response_ID%", {
						id: 1,
						sel: selStr,
					});
				}
			} else
				return selStr;
		},

		_onReleaseIcon: function(aData) {
			var doc = content.document;
			var sel = this._getSelection();
			if (!sel || sel === "")
				return true;

			if (doc instanceof Ci.nsIDOMXULDocument) {
				sendAsyncMessage("%Response_ID%", {
					id: 2, // ID 2 is the "mouseover" event to trigger the popup from the "on realese" icon.
					sel: sel,
				});
				return true;
			}
			var body = this.$$("body", doc)[0];
			if (!body)
				return true;

			var div = this.$(aData._UID + "onReleaseDiv", doc);
			if (div)
				div.parentNode.removeChild(div);

			var imgLookup = this.$C("img", {
				border: 0,
				src: aData.image,
			}, doc);
			div = this.$C("div", {
				id: aData._UID + "onReleaseDiv",
				style: "background-color:transparent; color:#000000; position:absolute; top:" +
					(aData.clientY + content.window.pageYOffset + aData.iconOffsetY) + "px; left:" +
					(aData.clientX + content.window.pageXOffset + aData.iconOffsetX) +
					"px; padding:0px; z-index:10000; border-radius:2px;",
			}, doc);
			div.appendChild(imgLookup.cloneNode(false));
			let mOListener = function(aE) {
				aE.preventDefault();
				sendAsyncMessage("%Response_ID%", {
					id: 2, // ID 2 is the "mouseover" event to trigger the popup from the "on realese" icon.
					sel: sel,
				});
				if (div)
					div.parentNode.removeChild(div);
				aE.stopPropagation();
			};
			let mDListener = function _(aE) {
				this.removeEventListener("mousedown", mDListener, false);
				if (div &amp;&amp; div.parentNode)
					div.parentNode.removeChild(div);
				aE.stopPropagation();
			};
			div.addEventListener("mouseover", mOListener, false);
			doc.addEventListener("mousedown", mDListener, false);
			body.appendChild(div);
		},

		_movePopup: function(aData) {
			let fWin = content.window;
			fWin.focus();
			let rect;
			try {
				rect = fWin.getSelection().getRangeAt(0).getBoundingClientRect();
			} catch (aErr) {
				rect = false;
			}
			let posX = fWin.mozInnerScreenX + (rect ? rect.left : fWin.innerWidth / 2);
			let posY = fWin.mozInnerScreenY + (rect ? rect.bottom : fWin.innerHeight / 2) + 3;
			let deltaX = posX - aData.width;
			if (deltaX &gt; 0)
				posX -= deltaX;
			let deltaY = posY - aData.height;
			if (deltaY &gt; 0)
				posY -= deltaY;
			let div = this.$(aData._UID + "onReleaseDiv", content.document);
			try {
				sendAsyncMessage("%Response_ID%", {
					id: 3, // ID 3 is the popup positioning coordinates.
					posX: posX,
					posY: posY,
				});
			} finally {
				div &amp;&amp; div.parentNode.removeChild(div);
			}
		},

		$C: function(aElName, aAttrs, aParent) {
			var doc = aParent ? aParent : document;
			var el = doc.createElement(aElName);
			if (aAttrs)
				Object.keys(aAttrs).forEach(function(n) {
					if (aAttrs[n] !== "")
						el.setAttribute(n, aAttrs[n])
				});
			return el;
		},

		$: function(aID, aParent) {
			if (!aParent)
				return document.getElementById(aID);
			return aParent.getElementById(aID);
		},

		$$: function(aTagName, aParent) {
			if (!aParent)
				return document.getElementsByTagName(aTagName);
			return aParent.getElementsByTagName(aTagName);
		},
	};
	MultiTranslator.init();
})(this);
&lt;!--%FrameScript%--&gt;


&lt;!--%OptionsWindow%--&gt;&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;?xml-stylesheet href="chrome://global/skin/" ?&gt;
&lt;?xml-stylesheet href="data:text/css;charset=utf-8,
prefwindow * {
	font-family: &amp;quot;Open Sans&amp;quot;, Helvetica, Arial, sans-serif !important;
}
button {
	min-width: 0  !important;
}
caption .caption-text,
.bold_text {
	font-weight: bold !important;
}
/* Force groupboxes on Linux to have the same appearance than in Windows */
/* Just because it makes effing sence!!!! */
/* Why have elements grouped inside a groupbox and not visually delimited?!?!?! */
groupbox {
	-moz-appearance: groupbox !important;
	border: 2px groove ThreeDFace !important;
	border-radius: 3px !important;
	margin: 3px !important;
	padding: 3px 3px 6px !important;
}
.groupbox-body {
	padding: inherit !important;
}
caption {
	margin: 0 6px !important;
	background-color: -moz-Dialog !important;
}
tabpanels caption {
	-moz-appearance: tabpanel !important;
}
/* !important is needed to override label in global.css */
.caption-text {
	margin: 0 2px !important;
}
dialogheader {
	font-size: x-small !important;
	font-weight: 600 !important;
	margin: 0 0 7px 0 !important;
	padding: 2px 0 2px 5px !important;
	border: none !important;
}
tab[selected=&amp;quot;true&amp;quot;] {
	font-weight: bold !important;
}
" type="text/css" ?&gt;
&lt;prefwindow id="%U_I_D%_settings_window"
			 xmlns:html="http://www.w3.org/1999/xhtml"
			 xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
			 onload="$.onLoad();"
			 onunload="$.onUnload();"
			 buttons="accept,cancel,extra1,extra2"
			 buttonlabelextra1="Apply"
			 buttonlabeldisclosure=""
			 ondialogextra1="$.onApply();"
			 buttonlabelextra2="Settings"
			 ondialogdisclosure="close();$.openHelpPage(event);"
			 title="Multi Translator settings"&gt;
				&lt;script&gt;
		&lt;![CDATA[
var Cc = Components.classes;
var Ci = Components.interfaces;
var Cu = Components.utils;
Cu.import("resource://gre/modules/Services.jsm");
var storage = window._storage;
var cb_btn = storage.button;

function $id(aId) {
	return document.getElementById(aId);
}

var $ = {
	_initialized: false,
	onLoad: function() {
		$._initialized = true;
		var docElt = document.documentElement;
		$.instantApply = docElt.instantApply;
		window.addEventListener("change", $, false);
		docElt.getButton("extra1").setAttribute("icon", "apply");
		docElt.getButton("extra2").setAttribute("popup", "multi-translator-preferences");
		docElt.setAttribute("cancelbuttonlabel", docElt.mStrBundle.GetStringFromName("button-cancel"));
		$.setHotKey();
		$.initMenulists();
		$.dealWithStyleSheets(false);
		$.setButtons(true);
	},
	handleEvent: function(aE) {
		switch (aE.type) {
			case "change":
				if (aE.target.localName != "preference")
					return;
				if (!$.instantApply)
					$.updateApplyButton(aE);
				break;
		}
	},
	changes: [],
	updateApplyButton: function(aE) {
		var item = aE.target;
		if (item.localName != "preference")
			return;
		var valueChanged = item.value != item.valueFromPreferences;
		var index = $.changes.indexOf(item);
		if (valueChanged &amp;&amp; index == -1)
			$.changes.push(item);
		else if (!valueChanged &amp;&amp; index &gt; -1)
			$.changes.splice(index, 1);
		$.setButtons(!$.changes.length);
	},
	onApply: function() {
		$.dealWithStyleSheets(true);
		$.setButtons(true);
		while ($.changes.length) {
			var preference = $.changes.shift();
			preference.batching = true;
			preference.valueFromPreferences = preference.value;
			preference.batching = false;
		}
		cb_btn.MultiTranslator.selfDestroy();
	},
	setButtons: function(aDisable) {
		var docElt = document.documentElement;
		// when in instantApply mode apply and accept buttons are hidden except when user
		// change min/max width value
		var applyButton = docElt.getButton("extra1");
		applyButton.disabled = aDisable;
		applyButton.hidden = $.instantApply &amp;&amp; aDisable;
		docElt.getButton("accept").hidden = aDisable;

		var action = aDisable ? "close" : "cancel";
		var cancelButton = docElt.getButton("cancel");
		cancelButton.label = docElt.getAttribute(action + "buttonlabel");
		cancelButton.setAttribute("icon", action);
	},
	setDisabled: function(aItemOrId, aVal) {
		var item = typeof(aItemOrId) == "string" ? $id(aItemOrId) : aItemOrId;
		if (!item)
			return;
		if (item.hasAttribute("inverseDependency"))
			aVal = !aVal;
		// remove disabled when the value is false
		$.setItem(item, "disabled", aVal || null);
	},
	setItem: function(aItemOrId, aAttr, aVal) {
		var el = typeof(aItemOrId) == "string" ? document.getElementById(aItemOrId) : aItemOrId;
		if (el) {
			if (aVal === null || aVal === undefined) {
				el.removeAttribute(aAttr);
				return;
			}
			if (typeof(aVal) == "boolean")
				aVal = aVal ? "true" : "false";

			if (!el.hasAttribute(aAttr) || el.getAttribute(aAttr) != aVal)
				el.setAttribute(aAttr, aVal);
		}
	},
	onUnload: function() {
		window.removeEventListener("change", $, false);
		cb_btn.MultiTranslator.selfDestroy();
		$.dealWithStyleSheets(true);
	},
	dealWithStyleSheets: function(aSave) {
		["textbox_pXULStyleSheet", "textbox_pHTMLStyleSheet"].forEach(function(aID) {
			if (aSave)
				cb_btn.MultiTranslator.sPref(aID.slice(8), encodeURIComponent($id(aID).value));
			else
				$id(aID).setAttribute("value", decodeURIComponent(cb_btn.MultiTranslator.gPref(aID.slice(8))));
		});
	},
	initMenulists: function() {
		var actionMPop = $id("click-on-button-action-primary-menulist").firstChild,
			whereTOPPMPop =  $id("where-to-open-page-primary-menulist").firstChild;
		var actionSMLists = document.getElementsByClassName("click-on-button-action-secondary-menulist"),
			whereTOPSMList = document.getElementsByClassName("where-to-open-page-secondary-menulist");
		for (var a = actionSMLists.length - 1; a &gt;= 0; a--) {
			actionSMLists[a].appendChild(actionMPop.cloneNode(true));
			$.setMenulistsCheckedState(actionSMLists[a]);
		}
		for (var b = whereTOPSMList.length - 1; b &gt;= 0; b--) {
			whereTOPSMList[b].appendChild(whereTOPPMPop.cloneNode(true));
			$.setMenulistsCheckedState(whereTOPSMList[b]);
		}
	},
	setMenulistsCheckedState: function(aMList) {
		let prefID = aMList.getAttribute("preference");
		let val = $id(prefID).value;
		if (val !== -1)
			aMList.selectedIndex = val;
	},
	setHotKey: function(aE) { // Taken from Custom Buttons add-on. I ♥ CB!!!
		let hki = document.getElementsByClassName("hotkey_capturer");
		let onInput = function(aE) {
			this.value = "";
			aE.stopPropagation();
		};
		let onKeypress = function(aE) {
			var that = this;
			var cbd = Cc["@xsms.nm.ru/custombuttons/cbkeymap;1"].getService(Ci.cbIKeyMapService);
			var key = cbd.getKey(aE);
			if (key == "ESCAPE") {
				aE.preventDefault();
				if (this.value !== "") {
					this.bExtendedMode = false;
					this.value = "";
					return;
				}
				if (!this.bExtendedMode) {
					this.bExtendedMode = true;
					return;
				}
			}
			if (key == "TAB") {
				if (!this.bExtendedMode)
					return;
				this.bExtendedMode = false;
				if (this.value !== "")
					return;
				aE.preventDefault();
			}
			this.bExtendedMode = false;
			var prefix = cbd.getKeyPrefix(aE);
			this.value = "";
			let tBH = $id(this.getAttribute("hotkey_box") + "_hotkey_box");
			tBH.value = prefix + key;
			aE.preventDefault();
			aE.stopPropagation();
			// The next crap is for the stupid window to register the preference change. ¬¬
			tBH.focus();
			var wU = window.QueryInterface(Ci.nsIInterfaceRequestor)
				.getInterface(Ci.nsIDOMWindowUtils);
			wU.sendKeyEvent("keypress", 35, 0, null, null);
			wU.sendKeyEvent("keyup", 35, 0, null, null);
			setTimeout(function() {
				// Send Spacebar key. ¬¬
				// keydown does not always work. ¬¬
				wU.sendKeyEvent("keypress", 0, 32, null, null);
				wU.sendKeyEvent("keyup", 0, 32, null, null);
				setTimeout(function() {
					that.focus();
				}, 100);
			}, 100);
		};
		Array.prototype.slice.call(hki).forEach(function(aEl) {
			aEl.addEventListener("input", onInput, false);
			aEl.addEventListener("keypress", onKeypress, false);
		});
	},
	editAPIKeys: function  (aPref) {
		window.close();
		cb_btn.MultiTranslator.editAPIKeys(aPref);
	}
};
]]&gt;&lt;/script&gt;
	&lt;prefpane id="%U_I_D%_PrefPane" flex="1"&gt;
		&lt;preferences&gt;
			&lt;preference id="pShowTransSelCtx" name="%B_R_A_N_C_H%pShowTransSelCtx" type="bool"/&gt;
			&lt;preference id="pShowTransClipCtx" name="%B_R_A_N_C_H%pShowTransClipCtx" type="bool"/&gt;
			&lt;preference id="pShowTransPageCtx" name="%B_R_A_N_C_H%pShowTransPageCtx" type="bool"/&gt;
			&lt;preference id="pShowTransPageCtxMenuMode" name="%B_R_A_N_C_H%pShowTransPageCtxMenuMode" type="bool"/&gt;
			&lt;preference id="pHotkeyTransPageEnabled" name="%B_R_A_N_C_H%pHotkeyTransPageEnabled" type="bool"/&gt;
			&lt;preference id="pHotkeyTransSelEnabled" name="%B_R_A_N_C_H%pHotkeyTransSelEnabled" type="bool"/&gt;
			&lt;preference id="pHotkeyTransClipEnabled" name="%B_R_A_N_C_H%pHotkeyTransClipEnabled" type="bool"/&gt;
			&lt;preference id="pHotkeyTransPage" name="%B_R_A_N_C_H%pHotkeyTransPage" type="string"/&gt;
			&lt;preference id="pHotkeyTransSel" name="%B_R_A_N_C_H%pHotkeyTransSel" type="string"/&gt;
			&lt;preference id="pHotkeyTransClip" name="%B_R_A_N_C_H%pHotkeyTransClip" type="string"/&gt;
			&lt;preference id="pButtonClickActionLeft" name="%B_R_A_N_C_H%pButtonClickActionLeft" type="int"/&gt;
			&lt;preference id="pButtonClickActionMiddle" name="%B_R_A_N_C_H%pButtonClickActionMiddle" type="int"/&gt;
			&lt;preference id="pButtonClickActionLeftCtrl" name="%B_R_A_N_C_H%pButtonClickActionLeftCtrl" type="int"/&gt;
			&lt;preference id="pButtonClickActionLeftShift" name="%B_R_A_N_C_H%pButtonClickActionLeftShift" type="int"/&gt;
			&lt;preference id="pButtonClickActionLeftCtrlShift" name="%B_R_A_N_C_H%pButtonClickActionLeftCtrlShift" type="int"/&gt;
			&lt;preference id="pPanelTransAnchorToSelection" name="%B_R_A_N_C_H%pPanelTransAnchorToSelection" type="bool"/&gt;
			&lt;preference id="pPanelTransAutoCloseOnClick" name="%B_R_A_N_C_H%pPanelTransAutoCloseOnClick" type="bool"/&gt;
			&lt;preference id="pPanelTransAutoCopyOnClick" name="%B_R_A_N_C_H%pPanelTransAutoCopyOnClick" type="bool"/&gt;
			&lt;preference id="pPanelTransFailSafe" name="%B_R_A_N_C_H%pPanelTransFailSafe" type="bool"/&gt;
			&lt;preference id="pPanelTransKeepItOpen" name="%B_R_A_N_C_H%pPanelTransKeepItOpen" type="bool"/&gt;
			&lt;preference id="pPanelTransShowTitleBar" name="%B_R_A_N_C_H%pPanelTransShowTitleBar" type="bool"/&gt;
			&lt;preference id="pTransOnRelease" name="%B_R_A_N_C_H%pTransOnRelease" type="bool"/&gt;
			&lt;preference id="pTransOnReleaseControlKey" name="%B_R_A_N_C_H%pTransOnReleaseControlKey" type="bool"/&gt;
			&lt;preference id="pTransOnReleaseShiftKey" name="%B_R_A_N_C_H%pTransOnReleaseShiftKey" type="bool"/&gt;
			&lt;preference id="pTransOnReleaseAltKey" name="%B_R_A_N_C_H%pTransOnReleaseAltKey" type="bool"/&gt;
			&lt;preference id="pTransOnReleaseShowIcon" name="%B_R_A_N_C_H%pTransOnReleaseShowIcon" type="bool"/&gt;
			&lt;preference id="pPageTransURLBarIconShow" name="%B_R_A_N_C_H%pPageTransURLBarIconShow" type="bool"/&gt;
			&lt;preference id="pPageTransURLBarIconMenuMode" name="%B_R_A_N_C_H%pPageTransURLBarIconMenuMode" type="bool"/&gt;
			&lt;preference id="pPageTransURLBarIconLeftClick" name="%B_R_A_N_C_H%pPageTransURLBarIconLeftClick" type="int"/&gt;
			&lt;preference id="pPageTransURLBarIconMiddleClick" name="%B_R_A_N_C_H%pPageTransURLBarIconMiddleClick" type="int"/&gt;
			&lt;preference id="pPanelTransShowFooter" name="%B_R_A_N_C_H%pPanelTransShowFooter" type="bool"/&gt;
			&lt;preference id="pPanelTransShowOptionsBox" name="%B_R_A_N_C_H%pPanelTransShowOptionsBox" type="bool"/&gt;
			&lt;preference id="pPanelTransFailSafeOpenURLWhere" name="%B_R_A_N_C_H%pPanelTransFailSafeOpenURLWhere" type="int"/&gt;
			&lt;preference id="pPanelMaxStringLength" name="%B_R_A_N_C_H%pPanelMaxStringLength" type="int"/&gt;
			&lt;preference id="pPanelTransMaxWidth" name="%B_R_A_N_C_H%pPanelTransMaxWidth" type="int"/&gt;
			&lt;preference id="pTransOnReleaseIconOffsetX" name="%B_R_A_N_C_H%pTransOnReleaseIconOffsetX" type="int"/&gt;
			&lt;preference id="pTransOnReleaseIconOffsetY" name="%B_R_A_N_C_H%pTransOnReleaseIconOffsetY" type="int"/&gt;
			&lt;preference id="pLanguagesShowHidden" name="%B_R_A_N_C_H%pLanguagesShowHidden" type="bool"/&gt;
			&lt;preference id="pShowCustomPanelEngines" name="%B_R_A_N_C_H%pShowCustomPanelEngines" type="bool"/&gt;
			&lt;preference id="pShowCustomURLBarEngines" name="%B_R_A_N_C_H%pShowCustomURLBarEngines" type="bool"/&gt;
			&lt;preference id="pPanelTransUseTextbox" name="%B_R_A_N_C_H%pPanelTransUseTextbox" type="bool"/&gt;
			&lt;preference id="pXULStyleSheetEnabled" name="%B_R_A_N_C_H%pXULStyleSheetEnabled" type="bool"/&gt;
			&lt;preference id="pXULStyleSheet" name="%B_R_A_N_C_H%pXULStyleSheet" type="string"/&gt;
			&lt;preference id="pHTMLStyleSheetEnabled" name="%B_R_A_N_C_H%pHTMLStyleSheetEnabled" type="bool"/&gt;
			&lt;preference id="pHTMLStyleSheet" name="%B_R_A_N_C_H%pHTMLStyleSheet" type="string"/&gt;
		&lt;/preferences&gt;
		&lt;tabbox persist="selectedIndex" id="main_tabbox" flex="1"&gt;
			&lt;tabs&gt;
				&lt;tab label=" General " /&gt;
				&lt;tab label=" Panel Translator " /&gt;
				&lt;tab label=" Page Translator " /&gt;
				&lt;tab label=" XUL style sheet " /&gt;
				&lt;tab label=" HTML style sheet " /&gt;
			&lt;/tabs&gt;
			&lt;tabpanels flex="1"&gt;
&lt;tabpanel flex="1"&gt;
	&lt;vbox flex="1"&gt;
		&lt;hbox flex="1"&gt;
			&lt;vbox flex="1"&gt;
				&lt;checkbox label="Show hidden languages" tooltip="tt_1" preference="pLanguagesShowHidden"/&gt;
				&lt;hbox align="center" tooltip="tt_2" &gt;
					&lt;checkbox label="Trans. Page hotkey" preference="pHotkeyTransPageEnabled"/&gt;
					&lt;spacer flex="1" /&gt;
					&lt;textbox id="translate_page_hotkey_box" flex="1" maxwidth="100" preference="pHotkeyTransPage"/&gt;
					&lt;textbox tooltip="tt_2_bis" hotkey_box="translate_page" maxwidth="20" flex="0" class="hotkey_capturer" /&gt;
				&lt;/hbox&gt;
				&lt;hbox align="center" tooltip="tt_2" &gt;
					&lt;checkbox label="Trans. Sel. hotkey" preference="pHotkeyTransSelEnabled"/&gt;
					&lt;spacer flex="1" /&gt;
					&lt;textbox id="translate_selection_hotkey_box" flex="1" maxwidth="100" preference="pHotkeyTransSel"/&gt;
					&lt;textbox tooltip="tt_2_bis" hotkey_box="translate_selection" maxwidth="20" flex="0" class="hotkey_capturer" /&gt;
				&lt;/hbox&gt;
				&lt;hbox align="center" tooltip="tt_2" &gt;
					&lt;checkbox label="Trans. Clip. hotkey" preference="pHotkeyTransClipEnabled"/&gt;
					&lt;spacer flex="1" /&gt;
					&lt;textbox id="translate_clipboard_hotkey_box" flex="1" maxwidth="100" preference="pHotkeyTransClip"/&gt;
					&lt;textbox tooltip="tt_2_bis" hotkey_box="translate_clipboard" maxwidth="20" flex="0" class="hotkey_capturer" /&gt;
				&lt;/hbox&gt;
			&lt;/vbox&gt;
			&lt;spacer flex="1" /&gt;
			&lt;groupbox orient="vertical" flex="1" &gt;
				&lt;caption label="Context menu items" /&gt;
				&lt;checkbox label="Show trans. selection" tooltip="tt_3" preference="pShowTransSelCtx"/&gt;
				&lt;checkbox label="Show trans. clip. content" tooltip="tt_4" preference="pShowTransClipCtx"/&gt;
				&lt;checkbox label="Show trans. page" tooltip="tt_5" preference="pShowTransPageCtx"/&gt;
				&lt;checkbox label="Trans. page menu mode" tooltip="tt_6" preference="pShowTransPageCtxMenuMode"/&gt;
			&lt;/groupbox&gt;
		&lt;/hbox&gt;
		&lt;groupbox orient="vertical" tooltip="tt_7" &gt;
			&lt;caption label="Clicks action on Multi Translator button" /&gt;
			&lt;hbox align="center"&gt;
				&lt;label value="Left click:" class="bold_text"/&gt;
				&lt;spacer flex="1" /&gt;
				&lt;menulist id="click-on-button-action-primary-menulist" sizetopopup="always" preference="pButtonClickActionLeft"&gt;
					&lt;menupopup&gt;
						&lt;menuitem label="Disabled." value="0" /&gt;
						&lt;menuitem label="Open main menu." value="1" /&gt;
						&lt;menuitem label="Translate selection." value="2" /&gt;
						&lt;menuitem label="Translate current page." value="3" /&gt;
						&lt;menuitem label="Translate clipboard content." value="4" /&gt;
						&lt;menuitem label="Open page translation menu." value="5" /&gt;
						&lt;menuitem label="Open options window." value="6" /&gt;
					&lt;/menupopup&gt;
				&lt;/menulist&gt;
			&lt;/hbox&gt;
			&lt;hbox align="center"&gt;
				&lt;label value="Middle click:" class="bold_text"/&gt;
				&lt;spacer flex="1" /&gt;
				&lt;menulist class="click-on-button-action-secondary-menulist" sizetopopup="always" preference="pButtonClickActionMiddle" /&gt;
			&lt;/hbox&gt;
			&lt;hbox align="center"&gt;
				&lt;label value="%A_C_C_E_L% + Left click:" class="bold_text" /&gt;
				&lt;spacer flex="1" /&gt;
				&lt;menulist class="click-on-button-action-secondary-menulist" sizetopopup="always" preference="pButtonClickActionLeftCtrl" /&gt;
			&lt;/hbox&gt;
			&lt;hbox align="center"&gt;
				&lt;label value="Shift + Left click:" class="bold_text" /&gt;
				&lt;spacer flex="1" /&gt;
				&lt;menulist class="click-on-button-action-secondary-menulist" sizetopopup="always" preference="pButtonClickActionLeftShift" /&gt;
			&lt;/hbox&gt;
			&lt;hbox align="center"&gt;
				&lt;label value="%A_C_C_E_L% + Shift + Left click:" class="bold_text"  /&gt;
				&lt;spacer flex="1" /&gt;
				&lt;menulist class="click-on-button-action-secondary-menulist" sizetopopup="always" preference="pButtonClickActionLeftCtrlShift" /&gt;
			&lt;/hbox&gt;
		&lt;/groupbox&gt;
	&lt;/vbox&gt;
&lt;/tabpanel&gt;
&lt;tabpanel flex="1"&gt;
	&lt;vbox flex="1"&gt;
		&lt;hbox&gt;
			&lt;vbox flex="1"&gt;
				&lt;checkbox label="Anchor panel to selection" tooltip="tt_8" preference="pPanelTransAnchorToSelection"/&gt;
				&lt;checkbox label="Auto close panel on click" tooltip="tt_9" preference="pPanelTransAutoCloseOnClick"/&gt;
				&lt;checkbox label="Auto copy on click" tooltip="tt_10" preference="pPanelTransAutoCopyOnClick"/&gt;
				&lt;checkbox label="Enable custom engines" tooltip="tt_28" preference="pShowCustomPanelEngines"/&gt;
				&lt;checkbox label="Keep panel open" tooltip="tt_12" preference="pPanelTransKeepItOpen"/&gt;
				&lt;checkbox label="Show footer inside panel" tooltip="tt_13" preference="pPanelTransShowFooter"/&gt;
				&lt;checkbox label="Show options box" tooltip="tt_13" preference="pPanelTransShowOptionsBox"/&gt;
			&lt;/vbox&gt;
			&lt;spacer flex="1"/&gt;
			&lt;vbox flex="1"&gt;
				&lt;checkbox label="Show titlebar" tooltip="tt_17" preference="pPanelTransShowTitleBar"/&gt;
				&lt;checkbox label="Translate on release" tooltip="tt_18" preference="pTransOnRelease"/&gt;
				&lt;checkbox label="Trans. on rel. - Req. %A_C_C_E_L%" tooltip="tt_19" preference="pTransOnReleaseControlKey"/&gt;
				&lt;checkbox label="Trans. on rel. - Req. Shift" tooltip="tt_35" preference="pTransOnReleaseShiftKey"/&gt;
				&lt;checkbox label="Trans. on rel. - Req. Alt" tooltip="tt_20" preference="pTransOnReleaseAltKey"/&gt;
				&lt;checkbox label="Trans. on rel. - Show icon" tooltip="tt_21" preference="pTransOnReleaseShowIcon"/&gt;
				&lt;checkbox label="Trans. result as textbox" tooltip="tt_31" preference="pPanelTransUseTextbox"/&gt;
			&lt;/vbox&gt;
		&lt;/hbox&gt;
		&lt;hbox&gt;
			&lt;vbox&gt;
				&lt;hbox align="center"&gt;
					&lt;label value="Panel max. string length" /&gt;
					&lt;spacer flex="1" /&gt;
					&lt;textbox maxwidth="50" flex="0" tooltip="tt_14" preference="pPanelMaxStringLength"/&gt;
				&lt;/hbox&gt;
				&lt;hbox align="center"&gt;
					&lt;label value="Panel max. width" /&gt;
					&lt;spacer flex="1" /&gt;
					&lt;textbox maxwidth="50" flex="0" tooltip="tt_15" preference="pPanelTransMaxWidth"/&gt;
				&lt;/hbox&gt;
			&lt;/vbox&gt;
			&lt;spacer flex="1"/&gt;
			&lt;vbox&gt;
				&lt;hbox align="center"&gt;
					&lt;label value="Trans. on rel. - Icon offset X" /&gt;
					&lt;spacer flex="1" /&gt;
					&lt;textbox maxwidth="35" flex="0" tooltip="tt_22" preference="pTransOnReleaseIconOffsetX"/&gt;
				&lt;/hbox&gt;
				&lt;hbox align="center"&gt;
					&lt;label value="Trans. on rel. - Icon offset Y" /&gt;
					&lt;spacer flex="1" /&gt;
					&lt;textbox maxwidth="35" flex="0" tooltip="tt_23" preference="pTransOnReleaseIconOffsetY"/&gt;
				&lt;/hbox&gt;
			&lt;/vbox&gt;
		&lt;/hbox&gt;
		&lt;hbox align="center"&gt;
			&lt;checkbox label="Fail safe translation" tooltip="tt_11" preference="pPanelTransFailSafe"/&gt;
			&lt;spacer flex="1" /&gt;
			&lt;menulist id="where-to-open-page-primary-menulist" sizetopopup="always" tooltip="tt_24" preference="pPanelTransFailSafeOpenURLWhere"&gt;
				&lt;menupopup&gt;
					&lt;menuitem label="Open in current tab." value="0" /&gt;
					&lt;menuitem label="Open in new tab next to current one." value="1" /&gt;
					&lt;menuitem label="Open in new tab in background." value="2" /&gt;
					&lt;menuitem label="Open in new tab in foreground." value="3" /&gt;
				&lt;/menupopup&gt;
			&lt;/menulist&gt;
		&lt;/hbox&gt;
		&lt;groupbox orient="horizontal" tooltip="tt_30"&gt;
			&lt;caption label="Manage API keys" /&gt;
			&lt;button label="Manage Bing API keys" image="%B_I_N_G_I_M_G%" oncommand="$.editAPIKeys('pAPIKeysBing');"/&gt;
			&lt;spacer flex="1" /&gt;
			&lt;button label="Manage Yandex API keys" image="%Y_A_N_D_E_X_I_M_G%" oncommand="$.editAPIKeys('pAPIKeysYandex');"/&gt;
		&lt;/groupbox&gt;
	&lt;/vbox&gt;
&lt;/tabpanel&gt;
&lt;tabpanel flex="1"&gt;
	&lt;vbox flex="1"&gt;
		&lt;hbox&gt;
			&lt;vbox&gt;
				&lt;checkbox label="Enable custom engines" tooltip="tt_29" preference="pShowCustomURLBarEngines"/&gt;
				&lt;checkbox label="Enable &amp;quot;Menu mode&amp;quot;" tooltip="tt_25" preference="pPageTransURLBarIconMenuMode"/&gt;
			&lt;/vbox&gt;
			&lt;spacer flex="1"/&gt;
			&lt;vbox&gt;
				&lt;checkbox label="Show icon inside URL bar" tooltip="tt_26" preference="pPageTransURLBarIconShow"/&gt;
			&lt;/vbox&gt;
		&lt;/hbox&gt;
		&lt;groupbox tooltip="tt_27" orient="vertical"&gt;
			&lt;caption label="Clicks action on URL bar icon"/&gt;
			&lt;hbox align="center"&gt;
				&lt;label value="Left click:" class="bold_text"/&gt;
				&lt;spacer flex="1" /&gt;
				&lt;menulist class="where-to-open-page-secondary-menulist" sizetopopup="always" preference="pPageTransURLBarIconLeftClick" /&gt;
			&lt;/hbox&gt;
			&lt;hbox align="center"&gt;
				&lt;label value="Middle click:" class="bold_text"/&gt;
				&lt;spacer flex="1" /&gt;
				&lt;menulist class="where-to-open-page-secondary-menulist" sizetopopup="always" preference="pPageTransURLBarIconMiddleClick" /&gt;
			&lt;/hbox&gt;
		&lt;/groupbox&gt;
	&lt;/vbox&gt;
&lt;/tabpanel&gt;
&lt;tabpanel flex="1"&gt;
	&lt;groupbox flex="1000"&gt;
		&lt;caption&gt;
			&lt;checkbox label="Enable XUL style sheet" tooltip="tt_32" preference="pXULStyleSheetEnabled"/&gt;
		&lt;/caption&gt;
		&lt;textbox multiline="true" wrap="off" tooltip="tt_34" newlines="pasteintact" flex="1000" id="textbox_pXULStyleSheet" /&gt;
	&lt;/groupbox&gt;
&lt;/tabpanel&gt;
&lt;tabpanel flex="1"&gt;
	&lt;groupbox flex="1000"&gt;
		&lt;caption&gt;
			&lt;checkbox label="Enable HTML style sheet" tooltip="tt_33" preference="pHTMLStyleSheetEnabled"/&gt;
		&lt;/caption&gt;
		&lt;textbox multiline="true" wrap="off" tooltip="tt_34" newlines="pasteintact" flex="1000" id="textbox_pHTMLStyleSheet" /&gt;
	&lt;/groupbox&gt;
&lt;/tabpanel&gt;
			&lt;/tabpanels&gt;
		&lt;/tabbox&gt;
	&lt;/prefpane&gt;
	&lt;popupset&gt;
		&lt;menupopup id="multi-translator-preferences" position="before_start"&gt;
			&lt;dialogheader title="Preferences" /&gt;
			&lt;menuitem label="Restore Defaults" oncommand="cb_btn.MultiTranslator.prefHandling.resetP();"/&gt;
			&lt;menuitem label="Import Multi Menu Preferences" oncommand="cb_btn.MultiTranslator.prefHandling.importP();"/&gt;
			&lt;menuitem label="Export Multi Menu Preferences" oncommand="cb_btn.MultiTranslator.prefHandling.exportP();"/&gt;
		&lt;/menupopup&gt;
		&lt;tooltip id="tt_1"&gt;
			&lt;description&gt;Display hidden languages on the language selection menus. Hidden languages will appear striked out.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_2"&gt;
			&lt;description&gt;Enable/Disable the use of a hotkey to perform this action.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_2_bis"&gt;
			&lt;description&gt;Capture hotkey.&lt;/description&gt;
			&lt;description&gt;&lt;/description&gt;
			&lt;description&gt;&lt;html:b&gt;Instructions&lt;/html:b&gt;&lt;/description&gt;
			&lt;description&gt;Just place the mouse cursor inside this textbox and press the desired keyboard key combination. A valid hotkey will be created/generated inside the textbox to the left.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_3"&gt;
			&lt;description&gt;Show &lt;html:em&gt;Translate selection&lt;/html:em&gt; item on the page context menu.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_4"&gt;
			&lt;description&gt;Show &lt;html:em&gt;Translate clipboard content&lt;/html:em&gt; item on the page context menu.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_5"&gt;
			&lt;description&gt;Show &lt;html:em&gt;Translate page&lt;/html:em&gt; item on the page context menu.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_6"&gt;
			&lt;description&gt;Show &lt;html:em&gt;Translate page&lt;/html:em&gt; on the page context menu as a menu with all available translate engines.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_7"&gt;
			&lt;description&gt;Configure Multi Translator button click actions.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_8"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, the panel with the translation will be displayed anchored to the selected text. If &lt;html:b&gt;disabled/unchecked&lt;/html:b&gt;, the popup will be displayed anchored to the top-left corner of the page content.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_9"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, the panel will be closed when the translation result is clicked.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_10"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, the translation result inside the panel will be copied to the clipboard when the text is clicked.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_11"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, and the selected text exceeds the max. length of characters allowed for the current translation engine, instead of showing the popup with the cut down text translated, it will translate the full length of the selection on a new tab.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_12"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, the panel with the translation will only be closed when &lt;html:b&gt;Auto close panel on click&lt;/html:b&gt; is enabled or when clicking the close button on the titlebar (if &lt;html:b&gt;Show titlebar&lt;/html:b&gt; is enabled). If &lt;html:b&gt;disabled/unchecked&lt;/html:b&gt;, the popup will close every time you click outside of it.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_13"&gt;
			&lt;description&gt;Show &lt;html:b&gt;Service provided by...&lt;/html:b&gt; footer inside the popup translation. Clicking on it will open the translation service provider page.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_14"&gt;
			&lt;description&gt;Maximum amount of characters to translate from the selected text (Default 1024 characters). Bing translator is cut down automatically to 150 characters and Yandex translator is cut down automatically to 500 characters.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_15"&gt;
			&lt;description&gt;Max. width for the translation panel.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_17"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, the panel with the translation will dispay a titlebar.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_18"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, the panel with the translation will show up when you finish to select text and the mouse button is released.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_19"&gt;
			&lt;description&gt;Require the &lt;html:b&gt;%A_C_C_E_L%&lt;/html:b&gt; key for triggering the translate on release action.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_20"&gt;
			&lt;description&gt;Require the &lt;html:b&gt;Alt&lt;/html:b&gt; key for triggering the translate on release action.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_21"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, and &lt;html:b&gt;Translate on release&lt;/html:b&gt; is enabled, instead of directly displaying the panel with the translation &lt;html:em&gt;on release&lt;/html:em&gt;, it will show an icon. The panel with the translation will show up only when hovering over this icon.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_22"&gt;
			&lt;description&gt;Horizontal offset with respect to the cursor in which the &lt;html:b&gt;Translate on release&lt;/html:b&gt; icon should appear.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_23"&gt;
			&lt;description&gt;Vertical offset with respect to the cursor in which the &lt;html:b&gt;Translate on release&lt;/html:b&gt; icon should appear.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_24"&gt;
			&lt;description&gt;Where to open the page if the option &lt;html:b&gt;Fail safe translation&lt;/html:b&gt; is enabled.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_25"&gt;
			&lt;description&gt;With this mode enabled, a left click on the URL bar icon will display a menu with all avaiable engines. Clicking on any menu item will directly translate the current page without the need to change the default engine.&lt;/description&gt;
			&lt;description&gt;The translated page will be opened obeying the preference &lt;html:b&gt;Left click&lt;/html:b&gt; of the &lt;html:b&gt;Clicks action on URL bar icon&lt;/html:b&gt; section.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_26"&gt;
			&lt;description&gt;Show &lt;html:b&gt;Page translator&lt;/html:b&gt; icon inside the URL bar.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_27"&gt;
			&lt;description&gt;Where to open the translated page.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_28"&gt;
			&lt;description&gt;Enable custom engines for the translation panel.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_29"&gt;
			&lt;description&gt;Enable custom engines for the page translator.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_30"&gt;
			&lt;description&gt;Add/Edit/Remove API keys.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_31"&gt;
			&lt;description&gt;If &lt;html:b&gt;enabled/checked&lt;/html:b&gt;, the translation result will be displayed inside a textbox element. This allows to select just the desired text to be copied.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_32"&gt;
			&lt;description&gt;&lt;html:b&gt;Enable/Disable&lt;/html:b&gt; the use of an style sheet that affects elements of the application. I added it mainly to style the panel translator.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_33"&gt;
			&lt;description&gt;&lt;html:b&gt;Enable/Disable&lt;/html:b&gt; the use of an style sheet that affects elements of web pages. I added it mainly to remove annoyances from the translator's pages.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_34"&gt;
			&lt;description class="warning"&gt;&lt;html:b&gt;This field is saved into a preference, so try not to use to much data here (like big images in Base64 format).&lt;/html:b&gt;&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_35"&gt;
			&lt;description&gt;Require the &lt;html:b&gt;Shift&lt;/html:b&gt; key for triggering the translate on release action.&lt;/description&gt;
		&lt;/tooltip&gt;
	&lt;/popupset&gt;
&lt;/prefwindow&gt;&lt;!--%OptionsWindow%--&gt;



&lt;!--%CustomEnginesEditor%--&gt;&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;?xml-stylesheet href="chrome://global/skin/" ?&gt;
&lt;?xml-stylesheet href="data:text/css;charset=utf-8,
window * {
	font-family: &amp;quot;Open Sans&amp;quot;, Helvetica, Arial, sans-serif !important;
}
.convert-to-panel {
	-moz-appearance: none !important;
	-moz-binding: url(&amp;quot;chrome://global/content/bindings/popup.xml%23arrowpanel&amp;quot;) !important;
	background: transparent !important;
	border: none !important;
	-moz-image-region: auto !important;
}
caption .caption-text,
.bold_text {
	font-weight: bold !important;
}
.warning{
	font-weight: bold !important;
	color: red !important;
}
button .button-text {
	display: inline-block !important;
	text-align: left !important;
}
button {
	min-width: 0 !important;
}
.optional {
	outline: 2px solid green !important;
}
.required {
	outline: 2px solid orange !important;
}
.experimental {
	outline: 2px solid red !important;
}
.optional,
.required,
.experimental {
	margin-top: 5px !important;
	margin-bottom: 5px !important;
}
tab[selected=&amp;quot;true&amp;quot;] {
	font-weight: bold !important;
}
groupbox {
	-moz-appearance: groupbox !important;
	border: 2px groove ThreeDFace !important;
	border-radius: 3px !important;
	margin: 3px !important;
	padding: 3px 3px 6px !important;
}
.groupbox-body {
	padding: inherit !important;
}
caption {
	margin: 0 6px !important;
	background-color: -moz-Dialog !important;
}
tabpanels caption {
	-moz-appearance: tabpanel !important;
}
tabpanel {
	overflow-x: auto !important;
}
/* !important is needed to override label in global.css */
.caption-text {
	margin: 0 2px !important;
}
.edit-custom-engine {
	list-style-image: url(&amp;quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABbklEQVQokX2QP0sCcRzGv+kZiC7+/PNT8w/INeh2kzl0bg4SUZESDSHkWwgMMsgGIdPBMDRvUQKXIpcgiTh0EITruPfgvY+n5YYG9YEPz/SBh4fICoDtWq0mtdvtCIAt2hQATlmWDwVB+Pb5fI1OpxNdKwGwZzKZA0EQVCL6JSKNMdYEEFgpAbCXSqU8Y+ydiKYWGmPsod/vr54HwKMoSiEWiw2I6MviJxgM3m2SXOPx+DQej78Q0YfFp9frvd80zzUcDk/C4XCHiF4dDsfA7Xa/BQKBW1VVfetO8IxGo2NRFB9FUax3u90LzvlTNpvdB2BfJ7kmk8lRKpVqcs7buVzuJplMXs7ncycBsCmKEq9Wq5Ku6/5KpSLpuu5vNBrp2Wx2Vi6Xr6LR6HMoFLqu1+sJAiDIslzknLd6vV76f+fz+XMACdM091qtVnE6ne4SAJthGJKmaYXlcrmzWCwKpmlGNE0rGIYhAbBZOAEIf/lbwByZlq46AAAAAElFTkSuQmCC&amp;quot;) !important;
	-moz-image-region: auto !important;
}
.delete-custom-engine {
	list-style-image: url(&amp;quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABVklEQVQokWNgoAT8//+f+////9xofB5cigXmGemnz9LRyX97+zbf29u3+Wbp6OTPN9TP+P//vwCGyavsrdLm8HH+XCDA/X6Fo33aSif71AUC3O/n8HH+XGFnmY5i0////7n3piTVH1aVfXFAVuT/aknB96skBd8fkBX5f0RV9sXelJQGZKdCNH3+LPaot7P2vL7yi1MaUv9PaUj9P6+v/OJxT0fd/8+fxTD9cPs23/6YoPSTJipvrxsr/L9urPD/pInK2/2xgRn/b9/mw/DDDh+7/AMGcu/vWKv9f+is++Khs+6LO9Zq/w8ayL3f4W1bgOKk////89yb0F763FPv22tfkxcfF0yo+7xwYu1rX5MXzz31vj2Y0F6KEbz///+X/r16Tsn3ma21/7+8FP//+bPY95mttT9WzS79//+/NK64EPv//7/E////GaFY4v///+JYFRMLAKUewtoAYB96AAAAAElFTkSuQmCC&amp;quot;) !important;
	-moz-image-region: auto !important;
}
.save_changes {
	list-style-image: url(&amp;quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACdElEQVQ4jWNgIBGE/mdgZvjPwEiqPgYGBgaGpCOGUhX3XFO630Zapp0xZiVJc/QSFb78aw4dXe/C3k/8lnCj73OkfcN/BiaiNEfsUpfKPGfV0fDE/33jc///PR8i/nW9iz5Rez/QnoGBgYHBYT4Dh/cGNdugHZqS6Jq9l8oJppyw6ml8FvCx6Lbz/7iThv8zL1n9r37k+6fgusdGBoYGBqbQvXpOmeecbqecsu33XKUiCtNsPJOBNXiHfm/NQ78veTcd/wcf0vofsF/9f+BBjX/RR40fxBwx8WNIOWinWHnPd3/di8B/1Q/93yYcse6yWSonqDddXCxgi/bkyge+XzOu2f332qv632238n+P3Sr//XZr3wnaoRvlOUmFnaHgivu2kocevz32qf5PvGT1r+Ke/2fvDdqz3NapL25+Efol8ZLVf8edCv9tt8n+t9sm999lu9oZv42adtqrtNkYGBgYGKy2yW212S73w2Sz5D+LrTL/k6/a/C+74/u/7I7P/9gLFv9NNknC8F+LdbIX7NcqO6IEkvpyLimdNcKLtdaK/tBaK/LfYKPE//Bzpv+DThn9198g/l9rrch/7TWif3SXS14wWSLvaTyTATP+pZYLycqvFFijuJL/p+JKgf9KqwT/K60U+K+4UuC/4gqBvyoLRS6oTRW1wZsCBRdxykks5loovoT7k/gS7v/iS7j/iy/i+S81i/eCTL+gJwMDEcmXdy6DOt88toW8C9h+8s1l+88/keOMSCuPI0MaFmfjAIwM/QwKbNMY1rJ0Mp5kKGOwIFYjDLAyCDAI8ITyaHH7cOszSDMIMzAQbzuqS4jxMwMDAwDtNu92OyP2UwAAAABJRU5ErkJggg==&amp;quot;) !important;
	-moz-image-region: auto !important;
}
.cancel_changes {
	list-style-image: url(&amp;quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADdklEQVQ4jXVTb0yUBRx+3n+8977vve/BcXhIBzg5CMZRCAvGSIZQMCXpRFhkagRjTkjStdr6M9bW1/rCt1tZ0vDUU1E4QMHrAMk7F4zDY4qYRBdkyzJK0eMC9+sLOGnr+fo8z2+/Pc8eYBVtgHZSH2NzqqoJ/4Muk0l1WSxZLovFuI4oAKTjVXu2Tbd++tmNhsbac9HR0f81d8CoTVZUVk01t3x+vGJ3+U5AXuOi7BbL9q79jRf/cp5duvNRa9Cfld3YqaqxawIXNOPlrOy6UPORwJ9tX0Z69tV7X0vc9CoAHarzi2u/2P3GlZm6g0sP322lB4c/WAlVVk+NbEpp+QZQHIDcn7y5aXa7/fr95vdWHh75mGbr3444il4e3ZWZ+ybeyi89PdBwKLywrYLu5hfTvXI7LVbtodmcvJ/G8l9850p2dtN0uu3H+6U76Peicrr7wlb6e2sZ9ReWRRqyCvtRkbblpQMZz53tS9z8IGTaQLfNCfSb7XlaTH2W7lVW/fpHUfH8gmkD3TEn0A8xsRSKNpInLv7RgbiN/fbEDDsACGmCkNek6DvcmmFxVBRpWBDopiDQgiWJfjbF0QTL0iDDkJ/jyC1EhQ/xUefTgWIAurWcuAIgvUXQdZxStMcXeIHOAdQHhroB6gSoh2HIyfGPDzPc+RIgBwC/rqYagHsfyOvOsA0PWJLoGMfRUYCOAvQVw5A72kiuBEvwQ6C8BuDWmdsA8YQk5Z9R9Kd6FH3YxfPUDpCTYegEy1I7QCd5ntx6/cppWd/ZLkkFn6y97wAEF8+XXFDUbo8kh3tZjnoA8jAMjcYYadwcT98yDPUC1Mdy5JHkcK+i9BwTxTIHIOD7fXU7v0uxDg6K4pKXZWkEoHGWpRuSRBMJlvlgivX2TVmmwCrnZVkaEnVLg0bTiDstw47x6tquyS05ER/H0RhA0yxLIVlevqaqtwZEsXlA0e29ZjAEQ6r6z61VjY/jacK8cdmfneuFL7egxm8yXbouSY/mFIV+0bTlSU0LDIniwUuAwQHIHp1ubzDG4JtX1chcVBRNSfLSVVX1X7Va6/E1oBvmUTKT+Ez3fGFheNJqDfgEYb8HeLKFPkAbkaRd43GxvrlUa2TGbPaOcNwr/YDyJEh3UlLpZZvtzFRm5utjTy3tqSNiID5+x1BqivNicnJFGyACwL8fh1x5BGHtQgAAAABJRU5ErkJggg==&amp;quot;) !important;
	-moz-image-region: auto !important;
}
" type="text/css" ?&gt;
&lt;window id="%U_I_D%_custom_engines_editor"
	    onload="$.onLoad();"
	    onunload="$.onUnLoad();"
	    xmlns:html="http://www.w3.org/1999/xhtml"
	    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"&gt;
&lt;script&gt;&lt;![CDATA[
var Cc = Components.classes;
var Ci = Components.interfaces;
var Cu = Components.utils;
Cu.import("resource://gre/modules/Services.jsm");
Cu.import("resource://gre/modules/osfile.jsm");
var stg = window._storage;
var cb_btn = stg.button;

function $id(aID, aParent) {
	if (!aParent)
		return document.getElementById(aID);
	return aParent.getElementById(aID);
}
var $ = {
	onLoad: function() {
		window.editPanelTarget = null;
		$.populateBox();
		window.addEventListener("focus", $ , false);
		window.addEventListener("blur", $ , false);
		$.highlightButton(cb_btn, 1);
	},
	handleEvent: function(aE) {
		switch (aE.type) {
			case "focus":
				$.highlightButton(cb_btn, 1);
				break;
			case "blur":
				$.highlightButton(cb_btn, 2);
				break;
		}
	},
	onUnLoad: function() {
		$.highlightButton(cb_btn);
	},
	populateBox: function() {
		let enginesArray = JSON.parse(stg.data);
		let caption = $id("container-caption");
		caption.label = "Custom engines for the " + (stg.fileName === "PanelEngines" ?
			"panel translator" :
			"page translator");
		let o = 0,
			oLen = enginesArray.length;
		for (; o &lt; oLen; o++) {
			let obj = enginesArray[o];
			let lbl = obj["label"] || "";
			$.createItems(lbl, obj);
		}
	},
	highlightButtonTimer: null,
	highlightButton: function(aEl, aStyle) {
		aEl.style.removeProperty("border-color");
		aEl.style.removeProperty("box-shadow");
		aEl.style.removeProperty("outline");
		aEl.style.removeProperty("outline-offset");
		aEl.style.removeProperty("transition-duration");
		if (!aStyle)
			return true;
		clearTimeout($.highlightButtonTimer);
		$.highlightButtonTimer = setTimeout(function() {
			switch (aStyle) {
				case 1:
					aEl.style.setProperty("border-color", "rgba(0,200,0,1)", "important");
					aEl.style.setProperty("box-shadow", "0 0 1px 1px rgba(0,200,0,1)", "important");
					aEl.style.setProperty("outline", "2px solid rgba(0,200,0,1)", "important");
					aEl.style.setProperty("outline-offset", "-2px", "important");
					aEl.style.setProperty("transition-duration", "10ms", "important");
					break;
				case 2:
					aEl.style.setProperty("border-color", "rgba(0,200,0,.2)", "important");
					aEl.style.setProperty("box-shadow", "0 0 1px 1px rgba(0,200,0,.2)", "important");
					aEl.style.setProperty("outline", "2px dotted rgba(0,200,0,.2)", "important");
					aEl.style.setProperty("outline-offset", "-2px", "important");
					aEl.style.setProperty("transition-duration", "10ms", "important");
					break;
			}
		}, 10);
	},
	highlightElement: function(aEl, aRem) {
		aEl.style.removeProperty("background");
		aEl.style.removeProperty("border-color");
		aEl.style.removeProperty("box-shadow");
		aEl.style.removeProperty("outline");
		aEl.style.removeProperty("outline-offset");
		if (aRem)
			return true;
		aEl.style.setProperty("background", "rgba(0,255,0,.25)", "important");
		aEl.style.setProperty("border-color", "rgba(0,200,0,1)", "important");
		aEl.style.setProperty("box-shadow", "0 0 1px 1px rgba(0,200,0,.5)", "important");
		aEl.style.setProperty("outline", "2px solid rgba(0,200,0,1)", "important");
		aEl.style.setProperty("outline-offset", "-2px", "important");
	},
	onAccept: function() {
		let enginesArray = [];
		try {
			let box = $id("container-box");
				Array.prototype.slice.call(box.getElementsByTagName("menuitem")).forEach(function(aMI) {
					enginesArray.push(aMI._data);
				});
		} finally {
			setTimeout(function() {
				let JSONData = JSON.stringify(enginesArray, null, "\t");
				let fPath = stg.filePath;
				let fName = stg.fileName + ".json";
				OS.File.copy(fPath, $.getBakDir(fName + ".bak1"), {
					noOverwrite: true
				}).then(function onSuccess() {
					$.saveJSONData(fPath, JSONData);
				}, function onFailure(aRejectReason) {
					OS.File.copy(fPath, $.getBakDir(fName + ".bak2"), {
						noOverwrite: true
					}).then(function onSuccess() {
						$.saveJSONData(fPath, JSONData);
					}, function onFailure(aRejectReason) {
						OS.File.copy(fPath, $.getBakDir(fName + ".bak3"), {
							noOverwrite: true
						}).then(function onSuccess() {
							$.saveJSONData(fPath, JSONData);
						}, function onFailure(aRejectReason) {
							OS.File.move($.getBakDir(fName + ".bak2"), $.getBakDir(fName + ".bak1"), {
								noOverwrite: false
							}).then(function onSuccess() {
								OS.File.move($.getBakDir(fName + ".bak3"), $.getBakDir(fName + ".bak2"), {
									noOverwrite: false
								}).then(function onSuccess() {
									OS.File.copy(fPath, $.getBakDir(fName + ".bak3"), {
										noOverwrite: true
									}).then(function onSuccess() {
										$.saveJSONData(fPath, JSONData);
									}, function onFailure(aRejectReason) {
										$.reportError(aRejectReason);
									});
								}, function onFailure(aRejectReason) {
									$.reportError(aRejectReason);
								});;
							}, function onFailure(aRejectReason) {
								$.reportError(aRejectReason);
							});
						});
					});
				});
			}, 100);
		}
	},
	getBakDir: function(aAppend) {
		let d = OS.Path.join(stg.storagePath, "Backups");
		OS.File.makeDir(d, {
			ignoreExisting: true
		});
		return OS.Path.join(d, aAppend)
	},
	saveJSONData: function(aPath, aData) {
		OS.File.writeAtomic(aPath, aData, {
			tmpPath: aPath + ".tmp",
			encoding: "utf-8"
		}).then(function onSuccess() {
			cb_btn.MultiTranslator.selfDestroy();
		}, function onFailure(aRejectReason) {
			$.reportError(aRejectReason);
		});
	},
	reportError: function(aRejectReason) {
		try {
			console.error(aRejectReason);
		} catch (aErr) {
			Cu.reportError([cb_btn.name + ": " + cb_btn.id, aRejectReason, aRejectReason.stack].join("\n"));
		}
	},
	dummyItems: function() {
		switch (stg.fileName) {
			case "URLBarEngines":
				return {
					"label": "Label",
					"command": "Bookmarklet",
					"image": 0,
					"tooltip": 0
				};
			case "PanelEngines":
				return {
					"label": "Label",
					"image": 0,
					"method": "",
					"referer": "",
					"action": "",
					"post": "",
					"code": "UTF-8",
					"xpath": "",
					"start": "",
					"end": ""
				};
		}
	},
	createItems: function(aLabel, aData) {
		if (!aLabel &amp;&amp; !aData) {
			aLabel = "label";
			aData = $.dummyItems();
		}
		let box = $id("container-box");
		let getImg = function() {
			if (aData.hasOwnProperty("image")) {
				switch (aData["image"]) {
					case "0":
					case 0:
					case "1":
					case 1:
					case "2":
					case 2:
					case "3":
					case 3:
						return cb_btn.MultiTranslator.images[parseInt(aData["image"], 10)];
					default:
						return aData["image"];
				}
			}
			return "";
		};
		let hbox = box.appendChild($.$CNS("hbox", {
			align: "center"
		}));
		let mI = hbox.appendChild($.$CNS("menuitem", {
			label: aLabel,
			flex: "1",
			image: getImg(),
			class: "menuitem-iconic",
		}));
		mI._data = aData;
		hbox.appendChild($.$CNS("button", {
			tooltiptext: "Delete custom engine",
			mousethrough: "never",
			class: "delete-custom-engine",
			oncommand: "$.removeCustomEngine(event, this);"
		}));
		hbox.appendChild($.$CNS("button", {
				tooltiptext: "Edit custom engine",
				mousethrough: "never",
				class: "edit-custom-engine",
				oncommand: "$.editCustomEngine(event, this.parentNode.firstChild.getAttribute('_type_'));"
			}));
	},
	removeCustomEngine: function(aE, aNode) {
		if (stg.accel(aE)) {
			aNode.parentNode.parentNode.removeChild(aNode.parentNode);
			return true;
		}
		let cBox = stg.custombuttons.confirmBox("Multi Translator", "Delete custom engine?\n\n" +
			"Keep the " + stg.accel() + " key pressed to delete items without confirmation.", "Yes", "Cancel");
		if (cBox) {
			aNode.parentNode.parentNode.removeChild(aNode.parentNode);
		} else
			return false;
	},
	populateEditPanel: function(aFakeMI, aNode, aTarget) {
		window.editPanelTarget = aTarget.parentNode;
		$.highlightElement(window.editPanelTarget);
		let dataObj = aFakeMI._data;
		let vbox = $id(stg.fileName + "_box");
		let tempBox;
		try {
			try {
				let id = vbox.getAttribute("id");
				tempBox = vbox.cloneNode(true);
				tempBox.setAttribute("id", id + "-cloned");
			} finally {
				aNode.appendChild(tempBox);
			}
		} finally {
			Array.prototype.slice.call(tempBox.getElementsByAttribute("data-attr", "*")).forEach(function(aEl) {
				let attrName = aEl.getAttribute("data-attr");
				let attrVal = dataObj[attrName];
				// This crap doesn't work on normal textboxes, but it does on number textboxes.
				aEl &amp;&amp; (aEl.value = attrVal);
				// And this crap doesn't work on number textboxes, but it does on normal textboxes. WTF!?!?!?!
				aEl &amp;&amp; aEl.setAttribute("value", attrVal);
			});
		}
	},
	editCustomEngine: function(aE, aType) {
		let panel = $.panel;
		if (panel &amp;&amp; (panel.state === "open" || panel.state === "opening"))
			return false;
		let fakeMI = aE.target.parentNode.firstChild;
		$.populateEditPanel(fakeMI, panel.firstChild, aE.target);
		panel.openPopup(aE.target, "", 0, 0, false, null, null);
	},
	onEditPanelAccept: function() {
		let panel = $.panel;
		let item = window.editPanelTarget.firstChild;
		try {
			Array.prototype.slice.call(panel.getElementsByAttribute("data-attr", "*")).forEach(function(aEl) {
				let attrName = aEl.getAttribute("data-attr");
				item._data[attrName] = aEl.value || "";
			});
		} finally {
			$.updateCustomEngine(item);
			$.onEditPanelCancel();
		}
	},
	updateCustomEngine: function(aItem) {
		let getImg = function() {
			if (aItem._data.hasOwnProperty("image")) {
				switch (aItem._data["image"]) {
					case "0":
					case 0:
					case "1":
					case 1:
					case "2":
					case 2:
					case "3":
					case 3:
						return cb_btn.MultiTranslator.images[parseInt(aItem._data["image"], 10)];
					default:
						return aItem._data["image"];
				}
			}
			return "";
		};
		aItem.setAttribute("image", getImg());
		aItem.setAttribute("label", aItem._data["label"] || "");
	},
	onEditPanelCancel: function() {
		let panel = $.panel;
		panel &amp;&amp; panel.hidePopup();
		if (window.editPanelTarget) {
			$.highlightElement(window.editPanelTarget, true);
		}
	},
	onEditPanelHidden: function(aE, aN) {
		if (aE.target !== aN)
			return false;
		aE.stopPropagation();
	},
	onEditPanelHiding: function(aE, aN) {
		if (aE.target !== aN)
			return false;
		aN.firstChild.textContent = "";
		$.highlightElement(window.editPanelTarget, true)
		window.editPanelTarget = null;
		aE.stopPropagation();
	},
	$CNS: function(aElName, aAttrs) { // Creates elements
		var el = document.createElement(aElName);
		if (aAttrs)
			Object.keys(aAttrs).forEach(function(n) {
				if (aAttrs[n] !== "")
					el.setAttribute(n, aAttrs[n])
			});
		return el;
	},
	draggedElement: null,
	DragAndDropHandler: {
		handleEvent: function(aE) {
			switch (aE.type) {
				case "dragstart":
					if (!stg.accel(aE) || !!window.editPanelTarget)
						return false;
					let target = aE.target;
					if (target.nodeName !== "hbox")
						$.draggedElement = target.parentNode;
					if ($.draggedElement.nodeName !== "hbox")
						$.draggedElement = null;
					if (getComputedStyle($.draggedElement).outlineStyle !== "none") {
						$.draggedElement = null;
						return false;
					}
					aE.dataTransfer.setData("text/plain", "dummy"); // Stupid piece of SHEET!!!!!
					break;
				case "dragover":
					aE.preventDefault();
					break;
				case "drop":
					aE.preventDefault();
					let insPoint = aE.target.parentNode;
					if (insPoint &amp;&amp; insPoint.nodeName === "hbox") {
						insPoint.parentNode.insertBefore($.draggedElement, insPoint);
					} else if (aE.target.nodeName === "groupbox") {
						aE.target.appendChild($.draggedElement);
					}
					break;
			}
			aE.stopPropagation();
		}
	},
	setTextboxValue: function(aE, aDataAttr) {
		let el = $.panel.getElementsByAttribute("data-attr", aDataAttr)[0];
		el &amp;&amp; (el.value = aE.target.value);
	},
	get panel() {
		return $id("edit-engines-panel");
	},
};
]]&gt;&lt;/script&gt;
	&lt;keyset&gt;
		&lt;key keycode="VK_ESCAPE" oncommand="return false;"/&gt;
	&lt;/keyset&gt;
	&lt;vbox flex="1"&gt;
		&lt;groupbox id="container-box"
				  minheight="50"
				  orient="vertical"
				  context="pseudo-item-context"
				  ondragstart="$.DragAndDropHandler.handleEvent(event);"
				  ondragover="$.DragAndDropHandler.handleEvent(event);"
				  ondrop="$.DragAndDropHandler.handleEvent(event);"&gt;
			&lt;caption id="container-caption" label="Main menu"/&gt;
		&lt;/groupbox&gt;
		&lt;spacer flex="1"/&gt;
		&lt;hbox&gt;
			&lt;spacer flex="1"/&gt;
			&lt;button label="Add custom engine" oncommand="$.createItems(null, null);"/&gt;
			&lt;spacer flex="1"/&gt;
		&lt;/hbox&gt;
		&lt;separator/&gt;
		&lt;hbox&gt;
			&lt;spacer flex="1"/&gt;
			&lt;button label="Save changes" class="save_changes" oncommand="$.onAccept();"/&gt;
			&lt;button label="Cancel" class="cancel_changes" oncommand="close();"/&gt;
			&lt;spacer flex="1"/&gt;
		&lt;/hbox&gt;
		&lt;vbox collapsed="true"&gt;
			&lt;groupbox id="PanelEngines_box" orient="vertical" flex="1"&gt;
				&lt;caption label="Edit custom engine"/&gt;
				&lt;grid&gt;
					&lt;columns&gt;
						&lt;column /&gt;
						&lt;column flex="1"/&gt;
					&lt;/columns&gt;
					&lt;rows&gt;
						&lt;row align="center" tooltip="tt_2"&gt;
							&lt;label value="Label"/&gt;
							&lt;textbox data-attr="label" class="required"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_1"&gt;
							&lt;label value="Image"/&gt;
							&lt;hbox align="center"&gt;
								&lt;textbox data-attr="image" flex="1" class="required"/&gt;
								&lt;button label="..." oncommand="$.selectLocalImage(this);"/&gt;
								&lt;button label="B64" oncommand="$.img_to_b64(this);"/&gt;
							&lt;/hbox&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_3"&gt;
							&lt;label value="Method"/&gt;
							&lt;hbox&gt;
								&lt;textbox data-attr="method" flex="1" class="required"/&gt;
								&lt;button label="Set method" type="menu"&gt;
									&lt;menupopup onpopuphiding="event.stopPropagation();"
											   oncommand="$.setTextboxValue(event, 'method');event.stopPropagation();"&gt;
										&lt;menuitem label="GET" value="GET" /&gt;
										&lt;menuitem label="POST" value="POST" /&gt;
									&lt;/menupopup&gt;
								&lt;/button&gt;
							&lt;/hbox&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_4"&gt;
							&lt;label value="Referer"/&gt;
							&lt;textbox flex="1" data-attr="referer" class="optional"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_5"&gt;
							&lt;label value="URL"/&gt;
							&lt;textbox flex="1" data-attr="action" class="optional"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_6"&gt;
							&lt;label value="Post data"/&gt;
							&lt;textbox flex="1" data-attr="post" class="optional"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_7"&gt;
							&lt;label value="Encoding"/&gt;
							&lt;textbox flex="1" data-attr="code" class="optional"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_8"&gt;
							&lt;label value="XPath"/&gt;
							&lt;textbox flex="1" data-attr="xpath" class="optional"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_9"&gt;
							&lt;label value="RegEx start"/&gt;
							&lt;textbox flex="1" data-attr="start" class="optional"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_10"&gt;
							&lt;label value="RegEx end"/&gt;
							&lt;textbox flex="1" data-attr="end" class="optional"/&gt;
						&lt;/row&gt;
					&lt;/rows&gt;
				&lt;/grid&gt;
			&lt;/groupbox&gt;
			&lt;groupbox id="URLBarEngines_box" orient="vertical" flex="1"&gt;
				&lt;caption label="Edit custom engine"/&gt;
				&lt;grid&gt;
					&lt;columns&gt;
						&lt;column /&gt;
						&lt;column flex="1"/&gt;
					&lt;/columns&gt;
					&lt;rows&gt;
						&lt;row align="center" tooltip="tt_2"&gt;
							&lt;label value="Label"/&gt;
							&lt;textbox data-attr="label"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_12"&gt;
							&lt;label value="Tooltip"/&gt;
							&lt;textbox data-attr="tooltip"/&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_1"&gt;
							&lt;label value="Image"/&gt;
							&lt;hbox align="center"&gt;
								&lt;textbox data-attr="image" flex="1"/&gt;
								&lt;button label="..." oncommand="$.selectLocalImage(this);"/&gt;
								&lt;button label="B64" oncommand="$.img_to_b64(this);"/&gt;
							&lt;/hbox&gt;
						&lt;/row&gt;
						&lt;row align="center" tooltip="tt_11"&gt;
							&lt;label value="Command"/&gt;
							&lt;textbox flex="1" data-attr="command"/&gt;
						&lt;/row&gt;
					&lt;/rows&gt;
				&lt;/grid&gt;
			&lt;/groupbox&gt;
		&lt;/vbox&gt;
	&lt;/vbox&gt;
	&lt;separator/&gt;
	&lt;popupset&gt;
		&lt;panel id="edit-engines-panel"
			   consumeoutsideclicks="false"
			   noautohide="true"
			   backdrag="true"
			   minwidth="400"
			   flip="slide"
			   flex="1"
			   class="convert-to-panel"
			   position="end_before"
			   onpopuphidden="$.onEditPanelHidden(event, this);"
			   onpopuphiding="$.onEditPanelHiding(event, this);"
			   orient="vertical"&gt;
			&lt;vbox flex="1" /&gt;
			&lt;spacer flex="0"/&gt;
			&lt;hbox&gt;
				&lt;spacer flex="1"/&gt;
				&lt;button label="Save" class="save_changes" oncommand="$.onEditPanelAccept();event.stopPropagation();"/&gt;
				&lt;button label="Cancel" class="cancel_changes" oncommand="$.onEditPanelCancel();event.stopPropagation();"/&gt;
				&lt;spacer flex="1"/&gt;
			&lt;/hbox&gt;
			&lt;hbox&gt;
				&lt;resizer type="window" dir="bottomleft" left="0" bottom="0" width="10" height="10"/&gt;
				&lt;spacer flex="1"/&gt;
				&lt;resizer type="window" dir="bottomright" right="0" bottom="0" width="10" height="10"/&gt;
			&lt;/hbox&gt;
		&lt;/panel&gt;
		&lt;tooltip id="tt_1"&gt;
			&lt;description&gt;Image for the engine. It can be an URL to an image, a data: image or a number between 0 to 3.&lt;/description&gt;
			&lt;html:ul&gt;
				&lt;html:li&gt;&lt;html:b&gt;0:&lt;/html:b&gt; Generic image.&lt;/html:li&gt;
				&lt;html:li&gt;&lt;html:b&gt;1:&lt;/html:b&gt; Bing translator image.&lt;/html:li&gt;
				&lt;html:li&gt;&lt;html:b&gt;2:&lt;/html:b&gt; Google translator image.&lt;/html:li&gt;
				&lt;html:li&gt;&lt;html:b&gt;3:&lt;/html:b&gt; Yandex translator image.&lt;/html:li&gt;
			&lt;/html:ul&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_2"&gt;
			&lt;description&gt;A label for the engine.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_3"&gt;
			&lt;description&gt;The HTTP method to use (&lt;html:b&gt;POST&lt;/html:b&gt; or &lt;html:b&gt;GET&lt;/html:b&gt;). If ignored, defaults to &lt;html:b&gt;GET&lt;/html:b&gt;.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_4"&gt;
			&lt;description&gt;Referer for the HTTP request header.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_5"&gt;
			&lt;description&gt;HTTP request URL.&lt;/description&gt;
			&lt;description&gt;Some placeholders can be used here:&lt;/description&gt;
			&lt;html:ul&gt;
				&lt;html:li&gt;&lt;html:b&gt;%%TEXT%%&lt;/html:b&gt; (&lt;html:b&gt;Required&lt;/html:b&gt;): Used to &lt;html:em&gt;inject&lt;/html:em&gt; the current selected text into the &lt;html:b&gt;URL&lt;/html:b&gt; and/or &lt;html:b&gt;Post data&lt;/html:b&gt; sections.&lt;/html:li&gt;
				&lt;html:li&gt;&lt;html:b&gt;%%LNGTO%%&lt;/html:b&gt; and/or &lt;html:b&gt;%%LNGFROM%%&lt;/html:b&gt; (Optionals): Used to &lt;html:em&gt;inject&lt;/html:em&gt; the language code to translate to/from. These language codes are configured from the language selection lists of the panel translator options menu.&lt;/html:li&gt;
			&lt;/html:ul&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_6"&gt;
			&lt;description&gt;For &lt;html:b&gt;POST&lt;/html:b&gt; requests only.&lt;/description&gt;
			&lt;description&gt;Some placeholders can be used here:&lt;/description&gt;
			&lt;html:ul&gt;
				&lt;html:li&gt;&lt;html:b&gt;%%TEXT%%&lt;/html:b&gt; (&lt;html:b&gt;Required&lt;/html:b&gt;): Used to &lt;html:em&gt;inject&lt;/html:em&gt; the current selected text into the &lt;html:b&gt;URL&lt;/html:b&gt; and/or &lt;html:b&gt;Post data&lt;/html:b&gt; sections.&lt;/html:li&gt;
				&lt;html:li&gt;&lt;html:b&gt;%%LNGTO%%&lt;/html:b&gt; and/or &lt;html:b&gt;%%LNGFROM%%&lt;/html:b&gt; (Optionals): Used to &lt;html:em&gt;inject&lt;/html:em&gt; the language code to translate to/from. These language codes are configured from the language selection lists of the panel translator options menu.&lt;/html:li&gt;
			&lt;/html:ul&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_7"&gt;
			&lt;description&gt;Encoding method. If ignored, defaults to &lt;html:b&gt;UTF-8&lt;/html:b&gt;.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_8"&gt;
			&lt;description&gt;XPath expression entered to get HTML elements with the translation results.&lt;/description&gt;
			&lt;description&gt;Choose this or a regular expression. Not both.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_9"&gt;
			&lt;description&gt;If you do not want to use an xpath expression, a string of HTML document that immediately precedes the translation results (regular expression).&lt;/description&gt;
			&lt;description&gt;Choose this or an XPath expression. Not both.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_10"&gt;
			&lt;description&gt;If you do not want to use an XPath expression, a string of HTML document that is immediately after the translation results (regular expression).&lt;/description&gt;
			&lt;description&gt;Choose this or an XPath expression. Not both.&lt;/description&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_11"&gt;
			&lt;description&gt;The bookmarklet/code to be executed when performing a page translation and/or clicking the icon inside the URL bar.&lt;/description&gt;
			&lt;description&gt;&lt;/description&gt;
			&lt;description&gt;Some (optionals) placeholders can be used here:&lt;/description&gt;
			&lt;html:ul&gt;
				&lt;html:li&gt;&lt;html:b&gt;%%URL%%:&lt;/html:b&gt; Used to &lt;html:em&gt;inject&lt;/html:em&gt; the current page URL into the bookmarklet/code.&lt;/html:li&gt;
				&lt;html:li&gt;&lt;html:b&gt;%%LNGTO%%:&lt;/html:b&gt; and/or &lt;html:b&gt;%%LNGFROM%%:&lt;/html:b&gt; Used to &lt;html:em&gt;inject&lt;/html:em&gt; the language code to translate to/from. These language codes are configured from the language selection lists on the page translation options menu.&lt;/html:li&gt;
			&lt;/html:ul&gt;
		&lt;/tooltip&gt;
		&lt;tooltip id="tt_12"&gt;
			&lt;description&gt;Tooltip for the engine.&lt;/description&gt;
		&lt;/tooltip&gt;
	&lt;/popupset&gt;
&lt;/window&gt;&lt;!--%CustomEnginesEditor%--&gt;


&lt;!--%APIKeysWindow%--&gt;&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;?xml-stylesheet href="chrome://global/skin/" ?&gt;
&lt;?xml-stylesheet href="data:text/css;charset=utf-8,
window * {
	font-family: &amp;quot;Open Sans&amp;quot;, Helvetica, Arial, sans-serif !important;
}
caption .caption-text,
.bold_text {
	font-weight: bold !important;
}
button {
	min-width: 0 !important;
}
button .button-text {
	display: inline-block !important;
	text-align: left !important;
}
groupbox {
	-moz-appearance: groupbox !important;
	border: 2px groove ThreeDFace !important;
	border-radius: 3px !important;
	margin: 3px !important;
	padding: 3px 3px 6px !important;
}
.groupbox-body {
	padding: inherit !important;
}
caption {
	margin: 0 6px !important;
	background-color: -moz-Dialog !important;
}
tabpanels caption {
	-moz-appearance: tabpanel !important;
}
tab[selected=&amp;quot;true&amp;quot;] {
	font-weight: bold !important;
}
tabpanel {
	overflow-x: auto !important;
}
.caption-text {
	margin: 0 2px !important;
}
.delete-api-key {
	list-style-image: url(&amp;quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABVklEQVQokWNgoAT8//+f+////9xofB5cigXmGemnz9LRyX97+zbf29u3+Wbp6OTPN9TP+P//vwCGyavsrdLm8HH+XCDA/X6Fo33aSif71AUC3O/n8HH+XGFnmY5i0////7n3piTVH1aVfXFAVuT/aknB96skBd8fkBX5f0RV9sXelJQGZKdCNH3+LPaot7P2vL7yi1MaUv9PaUj9P6+v/OJxT0fd/8+fxTD9cPs23/6YoPSTJipvrxsr/L9urPD/pInK2/2xgRn/b9/mw/DDDh+7/AMGcu/vWKv9f+is++Khs+6LO9Zq/w8ayL3f4W1bgOKk////89yb0F763FPv22tfkxcfF0yo+7xwYu1rX5MXzz31vj2Y0F6KEbz///+X/r16Tsn3ma21/7+8FP//+bPY95mttT9WzS79//+/NK64EPv//7/E////GaFY4v///+JYFRMLAKUewtoAYB96AAAAAElFTkSuQmCC&amp;quot;) !important;
	-moz-image-region: auto !important;
}
.save_changes {
	list-style-image: url(&amp;quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACdElEQVQ4jWNgIBGE/mdgZvjPwEiqPgYGBgaGpCOGUhX3XFO630Zapp0xZiVJc/QSFb78aw4dXe/C3k/8lnCj73OkfcN/BiaiNEfsUpfKPGfV0fDE/33jc///PR8i/nW9iz5Rez/QnoGBgYHBYT4Dh/cGNdugHZqS6Jq9l8oJppyw6ml8FvCx6Lbz/7iThv8zL1n9r37k+6fgusdGBoYGBqbQvXpOmeecbqecsu33XKUiCtNsPJOBNXiHfm/NQ78veTcd/wcf0vofsF/9f+BBjX/RR40fxBwx8WNIOWinWHnPd3/di8B/1Q/93yYcse6yWSonqDddXCxgi/bkyge+XzOu2f332qv632238n+P3Sr//XZr3wnaoRvlOUmFnaHgivu2kocevz32qf5PvGT1r+Ke/2fvDdqz3NapL25+Efol8ZLVf8edCv9tt8n+t9sm999lu9oZv42adtqrtNkYGBgYGKy2yW212S73w2Sz5D+LrTL/k6/a/C+74/u/7I7P/9gLFv9NNknC8F+LdbIX7NcqO6IEkvpyLimdNcKLtdaK/tBaK/LfYKPE//Bzpv+DThn9198g/l9rrch/7TWif3SXS14wWSLvaTyTATP+pZYLycqvFFijuJL/p+JKgf9KqwT/K60U+K+4UuC/4gqBvyoLRS6oTRW1wZsCBRdxykks5loovoT7k/gS7v/iS7j/iy/i+S81i/eCTL+gJwMDEcmXdy6DOt88toW8C9h+8s1l+88/keOMSCuPI0MaFmfjAIwM/QwKbNMY1rJ0Mp5kKGOwIFYjDLAyCDAI8ITyaHH7cOszSDMIMzAQbzuqS4jxMwMDAwDtNu92OyP2UwAAAABJRU5ErkJggg==&amp;quot;) !important;
	-moz-image-region: auto !important;
}
.cancel_changes {
	list-style-image: url(&amp;quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADdklEQVQ4jXVTb0yUBRx+3n+8977vve/BcXhIBzg5CMZRCAvGSIZQMCXpRFhkagRjTkjStdr6M9bW1/rCt1tZ0vDUU1E4QMHrAMk7F4zDY4qYRBdkyzJK0eMC9+sLOGnr+fo8z2+/Pc8eYBVtgHZSH2NzqqoJ/4Muk0l1WSxZLovFuI4oAKTjVXu2Tbd++tmNhsbac9HR0f81d8CoTVZUVk01t3x+vGJ3+U5AXuOi7BbL9q79jRf/cp5duvNRa9Cfld3YqaqxawIXNOPlrOy6UPORwJ9tX0Z69tV7X0vc9CoAHarzi2u/2P3GlZm6g0sP322lB4c/WAlVVk+NbEpp+QZQHIDcn7y5aXa7/fr95vdWHh75mGbr3444il4e3ZWZ+ybeyi89PdBwKLywrYLu5hfTvXI7LVbtodmcvJ/G8l9850p2dtN0uu3H+6U76Peicrr7wlb6e2sZ9ReWRRqyCvtRkbblpQMZz53tS9z8IGTaQLfNCfSb7XlaTH2W7lVW/fpHUfH8gmkD3TEn0A8xsRSKNpInLv7RgbiN/fbEDDsACGmCkNek6DvcmmFxVBRpWBDopiDQgiWJfjbF0QTL0iDDkJ/jyC1EhQ/xUefTgWIAurWcuAIgvUXQdZxStMcXeIHOAdQHhroB6gSoh2HIyfGPDzPc+RIgBwC/rqYagHsfyOvOsA0PWJLoGMfRUYCOAvQVw5A72kiuBEvwQ6C8BuDWmdsA8YQk5Z9R9Kd6FH3YxfPUDpCTYegEy1I7QCd5ntx6/cppWd/ZLkkFn6y97wAEF8+XXFDUbo8kh3tZjnoA8jAMjcYYadwcT98yDPUC1Mdy5JHkcK+i9BwTxTIHIOD7fXU7v0uxDg6K4pKXZWkEoHGWpRuSRBMJlvlgivX2TVmmwCrnZVkaEnVLg0bTiDstw47x6tquyS05ER/H0RhA0yxLIVlevqaqtwZEsXlA0e29ZjAEQ6r6z61VjY/jacK8cdmfneuFL7egxm8yXbouSY/mFIV+0bTlSU0LDIniwUuAwQHIHp1ubzDG4JtX1chcVBRNSfLSVVX1X7Va6/E1oBvmUTKT+Ez3fGFheNJqDfgEYb8HeLKFPkAbkaRd43GxvrlUa2TGbPaOcNwr/YDyJEh3UlLpZZvtzFRm5utjTy3tqSNiID5+x1BqivNicnJFGyACwL8fh1x5BGHtQgAAAABJRU5ErkJggg==&amp;quot;) !important;
	-moz-image-region: auto !important;
}
.warning{
	font-weight: bold !important;
	color: red !important;
}
" type="text/css" ?&gt;
&lt;window id="%U_I_D%_edit_api_keys_window"
	    onload="$.onLoad();"
	    minwidth="600"
	    title="Add/Remove API keys"
	    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"&gt;
&lt;script&gt;&lt;![CDATA[
var stg = window._storage;
var APIKeysObj = stg.APIKeysObj;
var cb_btn = stg.button;

function $id(aID, aParent) {
	if (!aParent)
		return document.getElementById(aID);
	return aParent.getElementById(aID);
}
var $ = {
	onLoad: function() {
		let browser = $id("%U_I_D%-browser");
		let source = stg.getHelp("%APIHelpPage%").split("\%HIDDEN_CLASS\%").join(stg.prefName);
		let helpPage = "data:text/html," + encodeURIComponent(source);
		browser.setAttribute("src", helpPage);
		$.populateAPIKeysBox();

		let timer = null;
		(function retry() {
			clearTimeout(timer);
			timer = setTimeout(function() {
				let body = browser.contentDocument.body;
				if (!body) {
					retry();
					return true;
				}
				Array.prototype.slice.call(body.getElementsByTagName("a")).forEach(function(aAnchor) {
					aAnchor.onclick = function(aE) {
						aE.preventDefault();
						stg.openPage(aAnchor.getAttribute("href"), aE);
						aE.stopPropagation();
					};
				});
				body.hidden = false;
			}, 200);
		})();
	},
	populateAPIKeysBox: function() {
		let box = $id("api-keys-box");
		$id("api-keys-box-caption").label = (stg.prefName === "pAPIKeysBing" ? "Bing" : "Yandex") + " Translator API keys";
		Array.prototype.slice.call(APIKeysObj).forEach(function(aAPIKey) {
			$.addNewRow(aAPIKey, box);
		});
	},
	addNewRow: function(aAPIKey, aBox) {
		let hBox = aBox.appendChild($.$CNS("hbox", {
			align: "center"
		}));
		if (stg.prefName === "pAPIKeysBing") {
			hBox.appendChild($.$CNS("label", {
				value: "Client ID",
				class: "bold_text",
			}));
			hBox.appendChild($.$CNS("textbox", {
				value: aAPIKey[0],
				"data-id": "client-id",
				flex: 1
			}));
			hBox.appendChild($.$CNS("label", {
				value: "Client Secret",
				class: "bold_text",
			}));
			hBox.appendChild($.$CNS("textbox", {
				value: aAPIKey[1],
				"data-secret": "client-secret",
				flex: 3
			}));
			hBox.appendChild($.$CNS("spacer"));
			hBox.appendChild($.$CNS("button", {
				class: "delete-api-key",
				oncommand: "$.removeAPI(event, this);"
			}));
		} else {
			hBox.appendChild($.$CNS("label", {
				value: "API key",
				class: "bold_text",
			}));
			hBox.appendChild($.$CNS("textbox", {
				value: aAPIKey,
				flex: 1
			}));
			hBox.appendChild($.$CNS("spacer"));
			hBox.appendChild($.$CNS("button", {
				class: "delete-api-key",
				oncommand: "$.removeAPI(event, this);"
			}));
		}
	},
	addNewAPI: function() {
		let box = $id("api-keys-box");
		if (stg.prefName === "pAPIKeysBing") {
			$.addNewRow(["",""], box);
		} else {
			$.addNewRow("", box);
		}

	},
	onAccept: function() {
		let box = $id("api-keys-box");
		let newAPIKeys = [];
		try {
			if (stg.prefName === "pAPIKeysBing") {
				Array.prototype.slice.call(box.getElementsByTagName("hbox")).forEach(function(aHBox) {
					newAPIKeys.push([aHBox.getElementsByAttribute("data-id", "client-id")[0].value,
						aHBox.getElementsByAttribute("data-secret", "client-secret")[0].value
					]);
				});
			} else {
				Array.prototype.slice.call(box.getElementsByTagName("textbox")).forEach(function(aTBox) {
					newAPIKeys.push(aTBox.value);
				});
			}
		} finally {
			newAPIKeys.filter(function(aVal) {
				if (aVal !== "")
					return true;
			});
			try {
				let prefVal = JSON.stringify(newAPIKeys);
				cb_btn.MultiTranslator.sPref(stg.prefName, prefVal);
			} finally {
				window.close();
			}
		}
	},
	removeAPI: function(aE, aNode) {
		if (stg.accel(aE)) {
			aNode.parentNode.parentNode.removeChild(aNode.parentNode);
			return true;
		}
		let cBox = stg.custombuttons.confirmBox("Multi Translator", "Delete API key?\n\n" +
			"Keep the " + stg.accel() + " key pressed to delete items without confirmation.", "Yes", "Cancel");
		if (cBox) {
			aNode.parentNode.parentNode.removeChild(aNode.parentNode);
		} else
			return false;
	},
	$CNS: function(aElName, aAttrs, aNameSpace) { // Creates elements
		var el = aNameSpace ?
			document.createElementNS(aNameSpace, aElName) :
			document.createElement(aElName);
		if (aAttrs)
			Object.keys(aAttrs).forEach(function(n) {
				if (aAttrs[n] !== "")
					el.setAttribute(n, aAttrs[n]);
			});
		return el;
	},

};
]]&gt;&lt;/script&gt;
	&lt;tabbox persist="selectedIndex" id="main_tabbox" flex="1"&gt;
		&lt;tabs&gt;
			&lt;tab label=" API keys " /&gt;
			&lt;tab class="warning" label=" Readme " /&gt;
		&lt;/tabs&gt;
		&lt;tabpanels flex="1"&gt;
			&lt;tabpanel flex="1" orient="vertical"&gt;
				&lt;vbox flex="1"&gt;
					&lt;groupbox id="api-keys-box" orient="vertical" &gt;
						&lt;caption id="api-keys-box-caption"/&gt;
					&lt;/groupbox&gt;
				&lt;/vbox&gt;
				&lt;spacer flex="1"/&gt;
				&lt;hbox&gt;
					&lt;spacer flex="1"/&gt;
					&lt;button label="Add new API" oncommand="$.addNewAPI();"/&gt;
					&lt;spacer flex="1"/&gt;
				&lt;/hbox&gt;
			&lt;/tabpanel&gt;
			&lt;tabpanel flex="1" orient="horizontal"&gt;
				&lt;browser id="%U_I_D%-browser"
						 type="content"
						 disablehistory="true"
						 autocompleteenabled="false"
						 autoscroll="false"
						 flex="1"/&gt;
			&lt;/tabpanel&gt;
		&lt;/tabpanels&gt;
	&lt;/tabbox&gt;
	&lt;separator/&gt;
	&lt;hbox&gt;
		&lt;spacer flex="1"/&gt;
		&lt;button label="Save changes" class="save_changes" oncommand="$.onAccept();"/&gt;
		&lt;button label="Cancel" class="cancel_changes" oncommand="close();"/&gt;
		&lt;spacer flex="1"/&gt;
	&lt;/hbox&gt;
	&lt;separator/&gt;
&lt;/window&gt;&lt;!--%APIKeysWindow%--&gt;

&lt;!--%APIHelpPage%--&gt;&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta http-equiv="content-type" content="text/html;charset=utf-8" /&gt;
		&lt;link rel="stylesheet" href="chrome://global/skin/xul.css" type="text/css"/&gt;
		&lt;style type="text/css"&gt;
		html {
			background: -moz-dialog !important;
			font: message-box !important;
		}
		body * {
			font-family: "Open Sans", Helvetica, Arial, sans-serif !important;
		}
		body {
			color: -moz-FieldText;
			position: relative;
			border: 1px solid;
			border-radius: 3px;
			padding: 1em;
			background: -moz-Field;
		}

		ul {
			margin: 0;
			-moz-margin-start: 1.5em;
			padding: 0;
			list-style: square;
		}
		ul &gt; li {
			margin-top: .5em;
		}
		.important-notes {
			border: 1px solid darkred;
			border-radius: 3px;
			background-color: rgba(255, 0, 0, 0.25) !important;
			padding: .5em;
		}
		.%HIDDEN_CLASS% {
			display: inline !important;
		}
		&lt;/style&gt;
	&lt;/head&gt;
&lt;body hidden="true"&gt;
&lt;span class="pAPIKeysBing" style="display: none;"&gt;
	&lt;h2&gt;How to get Bing translator API keys&lt;/h2&gt;
	&lt;p&gt;To get more Bing API keys, follow &lt;a href="http://blogs.msdn.com/b/translation/p/gettingstarted1.aspx"&gt;this instructions&lt;/a&gt;&lt;/p&gt;
	&lt;h3&gt;In a nutshell&lt;/h3&gt;
	&lt;ol&gt;
		&lt;li&gt;Register for an account on &lt;a href="https://datamarket.azure.com/home/"&gt;Windows Azure Marketplace&lt;/a&gt; with a Microsoft account.&lt;/li&gt;
		&lt;li&gt;&lt;a href="https://datamarket.azure.com/dataset/bing/microsofttranslator"&gt;Sign up for the Microsoft Translator API&lt;/a&gt;  using your registered account. Sign up for the free one ($0.00).&lt;/li&gt;
		&lt;li&gt;Register your application on &lt;a href="https://datamarket.azure.com/developer/applications/register"&gt;Windows Azure Marketplace.&lt;/a&gt; This step can be repeated several times to get several &lt;b&gt;Client IDs&lt;/b&gt; and &lt;b&gt;Client Secrets&lt;/b&gt;. &lt;b&gt;DO NOT ABUSE!!!&lt;/b&gt;&lt;/li&gt;
		&lt;li&gt;Get the &lt;b&gt;Client ID&lt;/b&gt; and &lt;b&gt;Client Secret&lt;/b&gt; for your registered application.
			&lt;ol&gt;
				&lt;li&gt;Fill out the &lt;b&gt;Client ID&lt;/b&gt;, and &lt;b&gt;Name&lt;/b&gt; fields.&lt;/li&gt;
				&lt;li&gt;The &lt;b&gt;Client Secret&lt;/b&gt; field is already completed for you. &lt;b&gt;DO NOT CHANGE IT.&lt;/b&gt;&lt;/li&gt;
				&lt;li&gt;Fill out the &lt;em&gt;&lt;b&gt;Redirect URI&lt;/b&gt;&lt;/em&gt; field with any valid URL that uses https, for example &lt;em&gt;https://microsoft.com&lt;/em&gt;. This field is not used by the Microsoft Translator API.&lt;/li&gt;
				&lt;li&gt;You can also leave the &lt;em&gt;&lt;b&gt;Enable subdomain access&lt;/b&gt;&lt;/em&gt; checkbox unchecked, as Translator doesn’t use it.&lt;/li&gt;
			&lt;/ol&gt;
		&lt;/li&gt;
		&lt;li&gt;The &lt;b&gt;Client ID&lt;/b&gt; and &lt;b&gt;Client Secret&lt;/b&gt; fields are the API keys used by Multi Translator button.&lt;/li&gt;
	&lt;/ol&gt;
&lt;/span&gt;
&lt;span class="pAPIKeysYandex" style="display: none;"&gt;
	&lt;h2&gt;How to get Yandex translator API keys&lt;/h2&gt;
	&lt;p&gt;Get more Yandex API keys &lt;a href="https://tech.yandex.com/key/form.xml?service=trnsl"&gt;here (English)&lt;/a&gt; or &lt;a href="https://tech.yandex.ru/key/form.xml?service=trnsl"&gt;here (Russian)&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;
	&lt;h3&gt;In a nutshell&lt;/h3&gt;
	&lt;ol&gt;
		&lt;li&gt;Visit the provided link and register a Yandex account (or use one of the available social services).&lt;/li&gt;
		&lt;li&gt;Once you successfully finish creating the Yandex account, you can visit the link provided at the beginning several times to create several API keys. &lt;b&gt;DO NOT ABUSE!!!&lt;/b&gt;&lt;/li&gt;
		&lt;li&gt;Once you have several API keys, you can use them to replace the ones that come with &lt;b&gt;Multi Translator&lt;/b&gt; button by default. &lt;b&gt;&lt;/b&gt;&lt;/li&gt;
	&lt;/ol&gt;
&lt;/span&gt;
&lt;div class="important-notes"&gt;
	&lt;h3&gt;Important notes&lt;/h3&gt;
	&lt;ul&gt;
		&lt;li&gt;API keys are only used by the translator panel. The page translator uses a totally different translation method.&lt;/li&gt;
		&lt;li&gt;The API keys are stored into a preference. Keep your API keys backed up outside the application in case you reset &lt;b&gt;Multi Translator's&lt;/b&gt; preferences.&lt;/li&gt;
		&lt;li&gt;&lt;b&gt;NEVER&lt;/b&gt; make your API keys public!!! The whole purpose of going to the trouble of getting your own API keys is that the only one &lt;em&gt;consuming&lt;/em&gt; their limits is you and nobody else.&lt;/li&gt;
	&lt;/ul&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;&lt;!--%APIHelpPage%--&gt;

&lt;!--%AlertImg%--&gt;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAIGUlEQVRoge2Z7VNTVx7H+Rfa16BbNOgkhbqJMIIBxMYtwrCttdgd1IgDiqTGB1IQCIwNbcDE2zgRiCUgLY9bgaAYwppC2JIhdEhQuyRYFoGW2UtnEMZdx0zbGV5890V67yYX7iWJjusL78z3Bcw5v9/nc865DzOJiHh1vbqe72UcPoE78yo4Hn3+UuXOvArG4RPghCd6pRhYPIuOH99F88zbIeWrOUlICbV+x4/vYmDxLIheKbtEl/tMyIVfdLrcZ9gFen/Kh3E69f8OyRbjdCp6f8rn2IF5KYzTqcFL/DN9TYxT+ziz3pxg4Y3Tqeia5zpC81I0PEilE9CYBbrJkwHj1D7UuiSodUmgs++F1pYGzVAKqq3JqLYmQzOUAq0tDTr7XnqccWofmjwZrDL+vf2ZOAU6Hx5G/WTyugLM1WvyZKDWJYHeIYHWlobmv8vx7fedmCM9WFpexL+fLMPr9cLr9WJlZQUL5CwmZx0YGG/AtcF8aG1p0Dt8MkwRZl+Kp34yGZ0PD28sQIVZqMmTQYPr7HtxeSALY24LvF4vVldXaeBgsrS8iIHxBlweyKJ3hqrP7OvPxCnQNv0hqwBVWO+QoKpfgnszQ1hdXQ0ZnJknTx/DOtGMqn7fbvr3Wk+gbfpDdoGWHz4IGGyYTKOL1Lp8R6Vp6ByePH28BpySCTdzpAdXzEegtaXR94hxah8Mk2kBTC0/fMAu8OXU+2sEDJO+gpqhFNwYqQkZbIGchc3ZjZWVlQ3Her1eGPpPQzOUglqXhO7vz/Tl1PvcAvp7u6G/t5sWqHVJUG1NRu+YLmR4u6sfxz+LxSndH5GnFoF89HDDOb/+9gsM/adRbU2mJeonk2kuToEmTwZ0rkR6sP7ebmiGUkD0SsM6FtVf5aKyTwytLQ2lHYnoGroa1Dyv1wvVXzOhGUoJYNG5EtHkyeAWIJwJtIR2VIxyUzxW/vNzWAI2ZzeqLEnQ2fdCaUrEHOkJeu7krAPlpnhoR8U0POFM4BZouJ9JC+hciaiyJOH22LVnujln/nUX1onmoI4PM3U35b4F+J2HcCag4X4mu4DhbjotUDOyCyXdwpBW7Xln3D2Ikm4hakZ20QKGu+nsArUuCQhnAjRjCVDZhKhoeyesxk+ePsbkrAPj7sFnesT++tsvKGpIgsomhGYsAYQzAbUuCbeAZiwBarsISrMQTeaKkMG1bTIcvfgWjlW/ieOX4nD04luwjLaGLfFZ62EozUKo7SJoxoIQUNtFUNtFKDfFo8WiDqnZz48WsEDOYo70oKLtHVRZkqA0JeL056lh70RdjwLlpniai1NAOyqG2i6CyiaEokeA9r9dDumzwL/xFzcvoMqShGprMvL1fCwtL4b1qdFiUUPRI4DK5tsF7ag4OIGizlho22Rhf+MU12Wi3BSPKksSFF+8HXYdXcc5FHXGhi6g6BGguC4zrKZLy4s4fikOlX2+90iTuSJsgcrG7OB3oGZkF1TDcbTAseo3w2r6zXfdKKz3CSg6hLA5u8Oqs7Kygjy1iBZQDcehZmQXu4DaLqIFyiyxyCViMDx+K6xtV3QIoTQLUVgfB5IkWQG5YnN2I5eIQZkllhZQ20XsAtQg1XAcyiyxkLfycV63f8NGzBRoklBuiofSLERlY3bI86moGqSQNfJ9Ar9zqWxCboFKaywdRY8AR9Q8DI/fCrrpAjmLI2oelGYhSrqF0LbJwoK3u/rxl4tboOgRBDBxCvgPrLTGoswSC1kjH3kqMWbmHgTVeGl5EaevJkJpFkLRIUSBJgnj7kFMTDqCrrFAziJPLaJXn8kVtECldQcUPQLk6/n4SPMnLJCzQQFYRlshb+WjqNN3H2VXRKP4yoGgBEiSROnVQ8glYtas/oYCZRbfqv/PeodvJXsEkBI8lF49BJIkNwSgdmLMbcG4ezBAnCRJ1iyQsyi+cgBH1DwUdVIcO+jTQCUoAX8Rpdn3YpMSPOSpxHBMDHKCrCe50XjHxCBOVO1hwK/l4RT4uC8GJbf5KLnND5igNAvpncjX83GgZAv07aUbQgWT+fk5GL6+iAMlW5BLxNDwSrMwgIHi+rgvhlsgGAlZIx8X6g4+E/g/plzQt5ciu1iA7IpoyBr5UPQI6D5s8EEJ+EswRSiB4fFba6Bm5h7g5mALbA4z/dSZn5/DfbcTdlc/THeaob1+Dieq9iDr3B+QXRGNfD0f8lYfPPOo+DP4s3EKnO/lrStBRd7Kx1nDHnr7qdx3O5GnEuO9C5uRVRSFrKIo7JdHYr88kv77vQubceiTNyAleCgwbqfBmfDMnhQPxcYqcL6XB/9QElQTeSsfMsNOzJGeAIG2W3pkF/teeoXXt6Hw+jacbNyKfAMP+QYeTjZuReH1bZC38gOgFT2CdReJCc/k4hSQd0VD3hVND5Z3RUPWHo18Aw+d3xBYWl4ESZL47q4dDTeqkacSI6soClKCtwaOLeuBMscwof25WAWoQf6RtUdDqt+EY5/Eo6LuKD66lIHsYgH2yyPx59JI5BBRONm4FbJ2X/FgBNjCBs0Mp4Ds681rBHKvbUYOERUQ6mjI2n1j2Jo9z1BsGwr4h5IoaHmDzouGZvKwCuQQUTjVuWlNmAVeFPB6LDlEFLvAzoOvQ9YejVOdm1DQEYmCjsh1i7zI+HPI2qOx8+DrnL8VQ5T1GnKIKJy5sT3wydEtpFNuiofSlIjKPnFAqvolAfnUko5PLelr/s+cpzQlotwUH9DDv/eZG9uRQ0RBlPUaIiIiuH/spkRe0ry6Xrrrvy2LglVqukRoAAAAAElFTkSuQmCC&lt;!--%AlertImg%--&gt;
</help>
  <attributes/>
</custombutton>