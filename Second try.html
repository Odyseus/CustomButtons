<h1>CBLibrary.jsm</h1>

<p>JavaScript library for CustomButtons addon.</p>

<p>###How to use the library</p>

<p>First, download the <a href="www.link.to/CBLibrary.jsm">CBLibrary.jsm file</a> and save it inside the<br>
folder called "custombuttons" inside your application profile. To load the library, just insert<br>
the code below at the beginning of the Initialization tab of your button.</p>

<p>###For Gecko version &gt; 27</p>

<p>Latest versions of Firefox (From ESR to Nightly), SeaMonkey and Thunderbird.</p>

<pre><code>if (!("_CustomButtonsLibrary" in window))
    Cu.import(OS.Path.toFileURI(OS.Path.join(OS.Constants.Path.profileDir, "custombuttons", "CBLibrary.jsm")));

var $ = _CustomButtonsLibrary;
</code></pre>

<p>###For Gecko version &lt;= 27</p>

<p>Latest versions of Palemoon and FossaMail.</p>

<pre><code>var libPath = Services.dirsvc.get("ProfD", Ci.nsIFile);
libPath.append("custombuttons");
libPath.append("CBLibrary.jsm");
if (!("_CustomButtonsLibrary" in window))
    Cu.import(Services.io.newFileURI(libPath).spec);

var $ = _CustomButtonsLibrary;
</code></pre>

<p><strong>Note 1:</strong> In theory, the CBLibrary.jsm file could be stored anywhere in your hard drive,<br>
but as this is a library for use with CustomButtons, what better place to put it than<br>
inside CustomButtons' folder.</p>

<p><strong>Note 2:</strong> <code>var $ = _CustomButtonsLibrary;</code> is declared for the sole purpose of shortening the use of the functions<br>
of this library. In all following examples, I will use the <code>$</code> variable.</p>

<p><strong>Author:</strong> Odyseus</p>

<p><strong>Version:</strong> 1.0.0</p>

<h2>appID(aAbbr)</h2>

<p>Application ID boolean return.</p>

<p>###Usage</p>

<pre><code>if ($.appID("CF"))
    LOG("This is Cyberfox");
else if ($.appID("FM"))
    LOG("This is FossaMail");
else if ($.appID("FX"))
    LOG("This is Firefox");
else if ($.appID("PM"))
    LOG("This is Palemoon");
else if ($.appID("SM"))
    LOG("This is SeaMonkey");
else if ($.appID("TB"))
    LOG("This is Thunderbird");
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aAbbr</strong> <em>{String}</em> Application name "abbreviation".</li>
</ul>

<h2>gID(aId)</h2>

<p>Return element by id.</p>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aId</strong> <em>{String}</em> String id of element.</li>
</ul>

<h2>getHelp(aPlaceholder, aId)</h2>

<p>Get specific data, surrounded by "placeholders", from the Help tab.</p>

<p>###Usage</p>

<pre><code>var css = $.getHelp("StyleSheet", this.Help);
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aPlaceholder</strong> <em>{String}</em>
</li>
<li>
<strong>aId</strong> <em>{String}</em>
</li>
</ul>

<h2>utf8_to_b64(aStr)</h2>

<p>String to Base64. Unicode workaround without using "unescape".</p>

<p>###Usage</p>

<pre><code>var encodedString = $.utf8_to_b64("Текстовый Unicode");
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aStr</strong> <em>{String}</em> String to be encoded to Base64.</li>
</ul>

<h2>b64_to_utf8(aStr)</h2>

<p>Base64 to String. Unicode workaround without using "escape".</p>

<p>###Usage</p>

<pre><code>var decodedString = $.b64_to_utf8("0KLQtdC60YHRgtC+0LLRi9C5IFVuaWNvZGU=");
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aStr</strong> <em>{String}</em> Base64 encoded string.</li>
</ul>

<h2>gBP(aKey)</h2>

<p>Get boolean preferences.</p>

<p>###Usage</p>

<pre><code>var clickHoldContextMenu = $.gBP("ui.click_hold_context_menus");
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aKey</strong> <em>{String}</em> Preference key.</li>
</ul>

<h2>sBP(aKey, aVal)</h2>

<p>Set boolean preferences.</p>

<p>###Usage</p>

<pre><code>$.sBP("ui.click_hold_context_menus", true);
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aKey</strong> <em>{String}</em> Preference key.</li>
<li>
<strong>aVal</strong> <em>{Boolean}</em> Preference value.</li>
</ul>

<h2>gIP(aKey)</h2>

<p>Get integer preferences.</p>

<p>###Usage</p>

<pre><code>var tooltipDelay = $.gIP("ui.tooltipDelay");
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aKey</strong> <em>{String}</em> Preference key.</li>
</ul>

<h3>Returns:</h3>

<ul>
<li><strong>Integer</strong></li>
</ul>

<h2>sIP(aKey, aVal)</h2>

<p>Set integer preferences.</p>

<p>###Usage</p>

<pre><code>$.sIP("ui.tooltipDelay", 100);
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aKey</strong> <em>{String}</em> Preference key.</li>
<li>
<strong>aVal</strong> <em>{Integer}</em> Preference value.</li>
</ul>

<h2>gCV(aKey)</h2>

<p>Get string preferences with unicode support.</p>

<p>###Usage</p>

<pre><code>var downloadFolder =  $.gCV("browser.download.dir");
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aKey</strong> <em>{String}</em> Preference key.</li>
</ul>

<h2>sCV(aKey, aVal)</h2>

<p>Set string preferences with unicode support</p>

<p>###Usage</p>

<pre><code>$.sCV("browser.download.dir", "D:\\Загрузок\\Music"); // Windows path.

$.sCV("browser.download.dir", "/home/user/Загрузок"); // "Linux" path.
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aKey</strong> <em>{String}</em> Preference key.</li>
<li>
<strong>aVal</strong> <em>{String}</em> Preference value.</li>
</ul>

<h2>notifyme(aImg, aTitle, aMsg)</h2>

<p>Notification function</p>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aImg</strong> <em>{String}</em> Image URL/URI. Could be null.</li>
<li>
<strong>aTitle</strong> <em>{String}</em> String title for the notification.</li>
<li>
<strong>aMsg</strong> <em>{String}</em> String message for the notification.</li>
</ul>

<h2>styleSheet(aCSS, aRemFlag)</h2>

<p>Load/Unload stylesheets.</p>

<p>###Usage</p>

<pre><code>var css = this.Help; // The "pure" css code is stored inside the Help tab of the button.

$.styleSheet(css); // Load the stylesheet.

$.styleSheet(css, true); // Unload the stylesheet.
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aCSS</strong> <em>{String}</em> String stylesheet to load.</li>
<li>
<strong>aRemFlag</strong> <em>{Boolean}</em> (Optional) if true unload aCSS.</li>
</ul>

<h2>parseXML(aXML)</h2>

<p>Converts an XML string into a DOM document ready to be appended to any  application's element.</p>

<p>###Usage</p>

<pre><code>var xulString = this.Help; // The "pure" XUL code is stored inside the Help tab of the button.

this.appendChild($.parseXML(xulString));
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aXML</strong> <em>{String}</em> XML sring to parse.</li>
</ul>

<h3>Returns:</h3>

<ul>
<li>
<strong>Object</strong> Returns a document ready to be appended.</li>
</ul>

<h2>readFile(aPath)</h2>

<p>Return file data content.</p>

<p>###Usage</p>

<pre><code>var fileContent = $.readFile(OS.Path.join(OS.Constants.Path.profileDir, "prefs.js"));
</code></pre>

<p>or...</p>

<pre><code>var libPath = Services.dirsvc.get("ProfD", Ci.nsIFile);
libPath.append("prefs.js");
var fileContent = $.readFile(libPath.path);
</code></pre>

<p>or...</p>

<pre><code>var fileContent = $.readFile("C:\\Windows\\System32\\drivers\\etc\\hosts");
</code></pre>

<p>or...</p>

<pre><code>var fileContent = $.readFile("/etc/hosts");
</code></pre>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aPath</strong> <em>{String}</em> Full path to a file.</li>
</ul>

<p><strong>Contributor/s:</strong> Odyseus</p>

<h2>writeFile(aPath, aData, aSaveType)</h2>

<p>Write data to file.</p>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aPath</strong> <em>{String}</em>
</li>
<li>
<strong>aData</strong> <em>{String}</em>
</li>
<li>
<strong>aSaveType</strong> <em>{String}</em>
</li>
</ul>

<h2>refreshLibrary()</h2>

<p>Used to refresh the library after library update.</p>

<h2>img_to_b64_cback(aURI, aCallback)</h2>

<p>Converts any image from any source to Base64.</p>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aURI</strong> <em>{Object|String}</em> An URI object or an URL string to the image.</li>
<li>
<strong>aCallback</strong> <em>{Function}</em> A function whose argument will be the Base64 image code.</li>
</ul>

<p><strong>Author:</strong> Odyseus</p>

<h2>padding(aNumber, aLength)</h2>

<h3>Arguments:</h3>

<ul>
<li>
<strong>aNumber</strong> <em>{Integer|String}</em>
</li>
<li>
<strong>aLength</strong> <em>{Integer}</em>
</li>
</ul>

<h2>escHTML()</h2>